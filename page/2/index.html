<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-mobxçš„ä½¿ç”¨" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/20/mobx%E7%9A%84%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2022-09-20T22:40:53.000Z" itemprop="datePublished">2022-09-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/react/">react</a>â–º<a class="article-category-link" href="/categories/react/mobx/">mobx</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/20/mobx%E7%9A%84%E4%BD%BF%E7%94%A8/">mobxçš„ä½¿ç”¨</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="å…¥é—¨"><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h2><p><em>ä»»ä½•å¯ä»¥ä»åº”ç”¨çŠ¶æ€ä¸­æ´¾ç”Ÿå‡ºæ¥çš„å€¼éƒ½åº”è¯¥è¢«è‡ªåŠ¨æ´¾ç”Ÿå‡ºæ¥ã€‚</em></p>
<p>MobX æ˜¯ä¸€ä¸ªèº«ç»ç™¾æˆ˜çš„åº“ï¼Œå®ƒé€šè¿‡è¿ç”¨é€æ˜çš„å‡½æ•°å¼å“åº”ç¼–ç¨‹ï¼ˆTransparent Functional Reactive Programmingï¼ŒTFRPï¼‰ä½¿çŠ¶æ€ç®¡ç†å˜å¾—ç®€å•å’Œå¯æ‰©å±•ã€‚</p>
<p>ğŸ˜™</p>
<h5 id="ç®€å•ç›´æ¥"><a href="#ç®€å•ç›´æ¥" class="headerlink" title="ç®€å•ç›´æ¥"></a>ç®€å•ç›´æ¥</h5><p>ç¼–å†™æ— æ¨¡æ¿çš„æç®€ä»£ç æ¥ç²¾å‡†æè¿°å‡ºä½ çš„æ„å›¾ã€‚è¦æ›´æ–°ä¸€ä¸ªè®°å½•å­—æ®µï¼Ÿä½¿ç”¨ç†Ÿæ‚‰çš„ JavaScript èµ‹å€¼å°±è¡Œã€‚è¦åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°æ•°æ®ï¼Ÿä¸éœ€è¦ç‰¹æ®Šçš„å·¥å…·ï¼Œå“åº”æ€§ç³»ç»Ÿä¼šä¾¦æµ‹åˆ°ä½ æ‰€æœ‰çš„å˜æ›´å¹¶æŠŠå®ƒä»¬ä¼ é€åˆ°å…¶ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<p>ğŸš…</p>
<h5 id="è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“"><a href="#è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“" class="headerlink" title="è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“"></a>è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“</h5><p>æ‰€æœ‰å¯¹æ•°æ®çš„å˜æ›´å’Œä½¿ç”¨éƒ½ä¼šåœ¨è¿è¡Œæ—¶è¢«è¿½è¸ªåˆ°ï¼Œå¹¶æ„æˆä¸€ä¸ªæˆªå–æ‰€æœ‰çŠ¶æ€å’Œè¾“å‡ºä¹‹é—´å…³ç³»çš„ä¾èµ–æ ‘ã€‚è¿™æ ·ä¿è¯äº†é‚£äº›ä¾èµ–äºçŠ¶æ€çš„è®¡ç®—åªæœ‰åœ¨çœŸæ­£éœ€è¦æ—¶æ‰ä¼šè¿è¡Œï¼Œå°±åƒ React ç»„ä»¶ä¸€æ ·ã€‚æ— éœ€ä½¿ç”¨è®°å¿†åŒ–æˆ–é€‰æ‹©å™¨ä¹‹ç±»å®¹æ˜“å‡ºé”™çš„æ¬¡ä¼˜æŠ€å·§æ¥å¯¹ç»„ä»¶è¿›è¡Œæ‰‹åŠ¨ä¼˜åŒ–ã€‚</p>
<p>ğŸ¤¹ğŸ»â€â™‚ï¸</p>
<h5 id="æ¶æ„è‡ªç”±"><a href="#æ¶æ„è‡ªç”±" class="headerlink" title="æ¶æ„è‡ªç”±"></a>æ¶æ„è‡ªç”±</h5><p>MobX ä¸ä¼šç”¨å®ƒè‡ªå·±çš„è§„åˆ™æ¥é™åˆ¶ä½ ï¼Œå®ƒå¯ä»¥è®©ä½ åœ¨ä»»æ„ UI æ¡†æ¶ä¹‹å¤–ç®¡ç†ä½ çš„åº”ç”¨çŠ¶æ€ã€‚è¿™æ ·ä¼šä½¿ä½ çš„ä»£ç ä½è€¦åˆã€å¯ç§»æ¤å’Œæœ€é‡è¦çš„â€”â€”å®¹æ˜“æµ‹è¯•ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; makeAutoObservable &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; observer &#125; <span class="keyword">from</span> <span class="string">&quot;mobx-react&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹åº”ç”¨çŠ¶æ€è¿›è¡Œå»ºæ¨¡ã€‚</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Timer</span> &#123;</span><br><span class="line">    secondsPassed = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">increase</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">secondsPassed</span> += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">reset</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">secondsPassed</span> = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myTimer = <span class="keyword">new</span> <span class="title class_">Timer</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„å»ºä¸€ä¸ªä½¿ç”¨ observable çŠ¶æ€çš„â€œç”¨æˆ·ç•Œé¢â€ã€‚</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TimerView</span> = <span class="title function_">observer</span>(<span class="function">(<span class="params">&#123; timer &#125;</span>) =&gt;</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> timer.reset()&#125;&gt;å·²è¿‡ç§’æ•°ï¼š&#123;timer.secondsPassed&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">TimerView</span> <span class="attr">timer</span>=<span class="string">&#123;myTimer&#125;</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="property">body</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯ç§’æ›´æ–°ä¸€æ¬¡â€˜å·²è¿‡ç§’æ•°ï¼šXâ€™ä¸­çš„æ–‡æœ¬ã€‚</span></span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    myTimer.<span class="title function_">increase</span>()</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<p>å›´ç»• React ç»„ä»¶ <code>TimerView</code> çš„ <code>observer</code> åŒ…è£…ä¼šè‡ªåŠ¨ä¾¦æµ‹åˆ°ä¾èµ–äº observable <code>timer.secondsPassed</code> çš„æ¸²æŸ“â€”â€”å³ä½¿è¿™ç§ä¾èµ–å…³ç³»æ²¡æœ‰è¢«æ˜ç¡®å®šä¹‰å‡ºæ¥ã€‚ å“åº”æ€§ç³»ç»Ÿä¼šè´Ÿè´£åœ¨æœªæ¥<em>æ°å¥½é‚£ä¸ª</em>å­—æ®µè¢«æ›´æ–°çš„æ—¶å€™å°†ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p>
<p>æ¯ä¸ªäº‹ä»¶ï¼ˆ<code>onClick</code> æˆ– <code>setInterval</code>ï¼‰éƒ½ä¼šè°ƒç”¨ä¸€ä¸ªç”¨æ¥æ›´æ–° <em>observable çŠ¶æ€</em> <code>myTimer.secondsPassed</code> çš„ <em>action</em>ï¼ˆ<code>myTimer.increase</code> æˆ– <code>myTimer.reset</code>ï¼‰ã€‚Observable çŠ¶æ€çš„å˜æ›´ä¼šè¢«ç²¾ç¡®åœ°ä¼ é€åˆ° <code>TimerView</code> ä¸­æ‰€æœ‰ä¾èµ–äºå®ƒä»¬çš„<em>è®¡ç®—</em>å’Œ<em>å‰¯ä½œç”¨</em>é‡Œã€‚</p>
<p><img src="https://zh.mobx.js.org/assets/zh.flow.png" alt="MobX å•å‘æµ"></p>
<h1 id="MobX-ä¸»æ—¨"><a href="#MobX-ä¸»æ—¨" class="headerlink" title="MobX ä¸»æ—¨"></a>MobX ä¸»æ—¨</h1><p>MobxåŒºåˆ†äº†åº”ç”¨ç¨‹åºçš„ä¸‰ä¸ªæ¦‚å¿µ</p>
<ul>
<li>State</li>
<li>Actions</li>
<li>Derivations</li>
</ul>
<h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><p><em>State(çŠ¶æ€)</em> æ˜¯é©±åŠ¨ä½ çš„åº”ç”¨ç¨‹åºçš„æ•°æ®ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Todo</span> &#123;</span><br><span class="line">    id = <span class="title class_">Math</span>.<span class="title function_">random</span>()</span><br><span class="line">    title = <span class="string">&quot;&quot;</span></span><br><span class="line">    finished = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">title</span>) &#123;</span><br><span class="line">        <span class="title function_">makeObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">title</span>: observable,</span><br><span class="line">            <span class="attr">finished</span>: observable,</span><br><span class="line">            <span class="attr">toggle</span>: action</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">title</span> = title</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">toggle</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">finished</span> = !<span class="variable language_">this</span>.<span class="property">finished</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°† State å­˜å‚¨åœ¨ä»»ä½•æ‚¨å–œæ¬¢çš„æ•°æ®ç»“æ„ä¸­ï¼šæ™®é€šå¯¹è±¡ã€æ•°ç»„ã€ç±»ã€å¾ªç¯æ•°æ®ç»“æ„æˆ–å¼•ç”¨ã€‚è¿™ä¸MobXçš„å·¥ä½œæ–¹å¼æ— å…³ã€‚</p>
<p>åªè¦ç¡®ä¿æ‰€æœ‰å“åº”å¼çš„å±æ€§éƒ½è¢«æ ‡è®°ä¸º<code>observable</code></p>
<h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p>actionæ˜¯ç”¨æ¥æ”¹å˜stateä¸­çš„æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·äº‹ä»¶å¤„ç†ã€åç«¯æ¨é€æ•°æ®å¤„ç†ã€è°ƒåº¦å™¨äº‹ä»¶å¤„ç†ç­‰ç­‰ã€‚</p>
<h3 id="åˆ›å»º-Derivations-ä»¥ä¾¿è‡ªåŠ¨å¯¹-State-å˜åŒ–è¿›è¡Œå“åº”"><a href="#åˆ›å»º-Derivations-ä»¥ä¾¿è‡ªåŠ¨å¯¹-State-å˜åŒ–è¿›è¡Œå“åº”" class="headerlink" title="åˆ›å»º Derivations ä»¥ä¾¿è‡ªåŠ¨å¯¹ State å˜åŒ–è¿›è¡Œå“åº”"></a>åˆ›å»º Derivations ä»¥ä¾¿è‡ªåŠ¨å¯¹ State å˜åŒ–è¿›è¡Œå“åº”</h3><p><em>ä»»ä½•</em> æ¥æºæ˜¯<em>State(çŠ¶æ€)</em> å¹¶ä¸”ä¸éœ€è¦è¿›ä¸€æ­¥äº¤äº’çš„ä¸œè¥¿éƒ½æ˜¯ Derivation(æ´¾ç”Ÿ)</p>
<p>Derivations åŒ…æ‹¬è®¸å¤šæ–¹å¼:</p>
<ul>
<li><em>ç”¨æˆ·ç•Œé¢</em></li>
<li><em>æ´¾ç”Ÿæ•°æ®</em> , æ¯”å¦‚å‰©ä½™æœªå®Œæˆ<code>todos</code>çš„æ•°é‡</li>
<li><em>åç«¯é›†æˆ</em> , æ¯”å¦‚å‘é€æ”¹å˜åˆ°æœåŠ¡å™¨ç«¯</li>
</ul>
<p>Mobx åŒºåˆ†äº†ä¸¤ç§ Derivation :</p>
<ul>
<li><em>Computed values</em>,æ€»æ˜¯å¯ä»¥é€šè¿‡çº¯å‡½æ•°ä»å½“å‰çš„å¯è§‚æµ‹ State ä¸­æ´¾ç”Ÿã€‚</li>
<li><em>Reactions</em>, å½“ State æ”¹å˜æ—¶éœ€è¦è‡ªåŠ¨è¿è¡Œçš„å‰¯ä½œç”¨ (å‘½ä»¤å¼ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹ä¹‹é—´çš„æ¡¥æ¢)</li>
</ul>
<p>å½“æœ€å¼€å§‹ä½¿ç”¨MobXæ—¶ï¼Œäººä»¬å®¹æ˜“è¿‡åº¦ä½¿ç”¨ <em>Reaction</em>ã€‚</p>
<p>é»„é‡‘æ³•åˆ™æ˜¯ï¼Œå¦‚æœè¦åŸºäºå½“å‰ State åˆ›å»ºå€¼ï¼Œè¯·å§‹ç»ˆä½¿ç”¨ <em>computed</em></p>
<h4 id="é€šè¿‡-computed-å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡"><a href="#é€šè¿‡-computed-å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡" class="headerlink" title="é€šè¿‡ computed å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡"></a>é€šè¿‡ computed å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡</h4><p>ä½ å¯ä»¥é€šè¿‡å®šä¹‰ getter æ–¹æ³•å¹¶ä½¿ç”¨ <code>makeObservable</code> å°†å…¶æ ‡è®°ä¸º <code>computed</code> çš„æ–¹å¼åˆ›å»ºä¸€ä¸ª <em>computed</em> å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeObservable, observable, computed &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TodoList</span> &#123;</span><br><span class="line">    todos = []</span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">unfinishedTodoCount</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">todos</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.<span class="property">finished</span>).<span class="property">length</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">todos</span>) &#123;</span><br><span class="line">        <span class="title function_">makeObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">todos</span>: observable,</span><br><span class="line">            <span class="attr">unfinishedTodoCount</span>: computed</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">todos</span> = todos</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Mobx ä¼šç¡®ä¿ <code>unfinishedTodoCount</code> ä¼šåœ¨todosæ•°ç»„å‘ç”Ÿå˜åŒ–ä¸­æˆ–è€… todosä¸­çš„ä¸€ä¸ªå¯¹è±¡ä¸­çš„ <code>finished</code>å±æ€§è¢«ä¿®æ”¹æ—¶è‡ªåŠ¨æ›´æ–°</p>
<h4 id="Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨"><a href="#Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨" class="headerlink" title="Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨"></a>Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨</h4><p>ä½œä¸ºç”¨æˆ·ï¼Œè¦æƒ³åœ¨å±å¹•ä¸Šçœ‹åˆ°çŠ¶æ€æˆ–è®¡ç®—å€¼çš„å˜åŒ–ï¼Œå°±éœ€è¦ä¸€ä¸ªé‡æ–°ç»˜åˆ¶éƒ¨åˆ†GUIçš„ <em>reactions</em> ã€‚</p>
<p>Reaction å’Œ computed ç±»ä¼¼ï¼Œä½†å¹¶ä¸äº§ç”Ÿä¿¡æ¯ï¼Œè€Œæ˜¯äº§ç”Ÿå‰¯ä½œç”¨ï¼Œå¦‚æ‰“å°åˆ°æ§åˆ¶å°ã€å‘å‡ºç½‘ç»œè¯·æ±‚ã€å¢é‡æ›´æ–° React ç»„ä»¶æ ‘ä»¥ä¾¿æ›´æ–°DOMç­‰ã€‚</p>
<p>ç®€è€Œè¨€ä¹‹ï¼Œ<em>reaction</em> æ˜¯ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Reactive_programming">å“åº”å¼ç¼–ç¨‹</a>å’Œ<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Imperative_programming">æŒ‡ä»¤å¼ç¼–ç¨‹</a>ä¹‹é—´çš„æ¡¥æ¢ã€‚</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ€å¸¸ç”¨çš„ reaction å½¢å¼æ˜¯UIç»„ä»¶ã€‚ æ³¨æ„ï¼Œaction å’Œ reaction éƒ½å¯èƒ½å¼•èµ·å‰¯ä½œç”¨ã€‚ å‰¯ä½œç”¨åº”æœ‰ä¸€ä¸ªæ¸…æ™°çš„ã€æ˜¾å¼çš„èµ·æºï¼Œä¾‹å¦‚åœ¨æäº¤è¡¨å•æ—¶å‘å‡ºç½‘ç»œè¯·æ±‚ï¼Œåº”è¯¥ä»ç›¸å…³çš„äº‹ä»¶å¤„ç†ç¨‹åºæ˜¾å¼è§¦å‘ã€‚</p>
<h2 id="åŸåˆ™"><a href="#åŸåˆ™" class="headerlink" title="åŸåˆ™"></a>åŸåˆ™</h2><p>Mobx ä½¿ç”¨å•å‘æ•°æ®æµï¼Œåˆ©ç”¨ <em>action</em> æ”¹å˜ <em>state</em> ï¼Œè¿›è€Œæ›´æ–°æ‰€æœ‰å—å½±å“çš„ <em>view</em></p>
<p><img src="https://zh.mobx.js.org/assets/action-state-view.png" alt="Action, State, View"></p>
<ol>
<li>æ‰€æœ‰çš„ <em>derivations</em> å°†åœ¨ <em>state</em> æ”¹å˜æ—¶<strong>è‡ªåŠ¨ä¸”åŸå­åŒ–åœ°æ›´æ–°</strong>ã€‚å› æ­¤ä¸å¯èƒ½è§‚å¯Ÿä¸­é—´å€¼ã€‚</li>
<li>æ‰€æœ‰çš„ <em>derivations</em> é»˜è®¤å°†ä¼š<strong>åŒæ­¥</strong>æ›´æ–°ï¼Œè¿™æ„å‘³ç€ <em>action</em> å¯ä»¥åœ¨ <em>state</em> æ”¹å˜ ä¹‹åå®‰å…¨çš„ç›´æ¥è·å¾— computed å€¼ã€‚</li>
<li><em>computed value</em> çš„æ›´æ–°æ˜¯<strong>æƒ°æ€§</strong>çš„ï¼Œä»»ä½• computed value åœ¨éœ€è¦ä»–ä»¬çš„å‰¯ä½œç”¨å‘ç”Ÿä¹‹å‰éƒ½æ˜¯ä¸æ¿€æ´»çš„ã€‚</li>
<li>æ‰€æœ‰çš„ <em>computed value</em> éƒ½åº”æ˜¯<strong>çº¯å‡½æ•°</strong>,ä»–ä»¬ä¸åº”è¯¥ä¿®æ”¹ <em>state</em>ã€‚</li>
</ol>
<h2 id="Observable-state"><a href="#Observable-state" class="headerlink" title="Observable state"></a>Observable state</h2><p>å±æ€§ï¼Œå®Œæ•´çš„å¯¹è±¡ï¼Œæ•°ç»„ï¼ŒMaps å’Œ Sets éƒ½å¯ä»¥è¢«è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ã€‚ ä½¿å¾—å¯¹è±¡å¯è§‚å¯Ÿçš„åŸºæœ¬æ–¹æ³•æ˜¯ä½¿ç”¨ <code>makeObservable</code> ä¸ºæ¯ä¸ªå±æ€§æŒ‡å®šä¸€ä¸ªæ³¨è§£ã€‚ æœ€é‡è¦çš„æ³¨è§£å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>observable</code> å®šä¹‰ä¸€ä¸ªå­˜å‚¨ state çš„å¯è¿½è¸ªå­—æ®µã€‚</li>
<li><code>action</code> å°†ä¸€ä¸ªæ–¹æ³•æ ‡è®°ä¸ºå¯ä»¥ä¿®æ”¹ state çš„ actionã€‚</li>
<li><code>computed</code> æ ‡è®°ä¸€ä¸ªå¯ä»¥ç”± state æ´¾ç”Ÿå‡ºæ–°çš„å€¼å¹¶ä¸”ç¼“å­˜å…¶è¾“å‡ºçš„ getterã€‚</li>
</ul>
<p>åƒæ•°ç»„ï¼ŒMaps å’Œ Sets è¿™æ ·çš„é›†åˆéƒ½å°†è¢«è‡ªåŠ¨è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡</p>
<h4 id="makeObservable"><a href="#makeObservable" class="headerlink" title="makeObservable"></a><code>makeObservable</code></h4><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>makeObservable(target, annotations?, options?)</code></li>
</ul>
<p>è¿™ä¸ªå‡½æ•°ä¼šå°†å·²å­˜åœ¨çš„å¯¹è±¡å±æ€§è½¬æ¢æˆå¯è§‚å¯Ÿåœ°å¯¹è±¡ï¼Œä»»ä½•targetå¯¹è±¡åŒ…æ‹¬classéƒ½å¯ä»¥ä½œä¸ºtargetä¼ é€’ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<code>makeObservable</code> æ˜¯åœ¨ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨çš„ï¼Œå¹¶ä¸”å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>this</code> ã€‚ <code>annotations</code> å‚æ•°å°†ä¼šä¸ºæ¯ä¸€ä¸ªæˆå‘˜æ˜ å°„ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/observable-state.html#%E5%8F%AF%E7%94%A8%E7%9A%84%E6%B3%A8%E8%A7%A3">æ³¨è§£</a>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/enabling-decorators.html">è£…é¥°å™¨</a> æ—¶ï¼Œ<code>annotations</code> å‚æ•°å°†ä¼šè¢«å¿½ç•¥ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeObservable, observable, computed, action, flow &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Doubler</span> &#123;</span><br><span class="line">    value</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="title function_">makeObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: observable,</span><br><span class="line">            <span class="attr">double</span>: computed,</span><br><span class="line">            <span class="attr">increment</span>: action,</span><br><span class="line">            <span class="attr">fetch</span>: flow</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span> = value</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">double</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">value</span> * <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    *<span class="title function_">fetch</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">yield</span> <span class="title function_">fetch</span>(<span class="string">&quot;/api/value&quot;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span> = response.<span class="title function_">json</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æ‰€æœ‰å¸¦æ³¨è§£ çš„å­—æ®µéƒ½æ˜¯ ä¸å¯é…ç½®çš„ã€‚</span><br><span class="line">æ‰€æœ‰çš„ä¸å¯è§‚å¯Ÿï¼ˆæ— çŠ¶æ€ï¼‰çš„å­—æ®µï¼ˆaction, flowï¼‰éƒ½æ˜¯ ä¸å¯å†™çš„ã€‚</span><br></pre></td></tr></table></figure>

<h4 id="makeAutoObservable"><a href="#makeAutoObservable" class="headerlink" title="makeAutoObservable"></a><code>makeAutoObservable</code></h4><p>ä½¿ç”¨ï¼š</p>
<ul>
<li><code>makeAutoObservable(target, overrides?, options?)</code></li>
</ul>
<p>ç›¸å½“äºæ˜¯åŠ å¼ºç‰ˆçš„makeObservableå‡½æ•°ï¼Œä»–ä¼šè‡ªåŠ¨æ ¹æ®ä¼ å…¥çš„å¯¹è±¡å±æ€§è‡ªåŠ¨è½¬æˆå¯è§‚å¯Ÿå±æ€§ï¼Œ</p>
<p>ä¸ä½¿ç”¨ <code>makeObservable</code> ç›¸æ¯”ï¼Œ<code>makeAutoObservable</code> å‡½æ•°æ›´ç´§å‡‘ï¼Œä¹Ÿæ›´å®¹æ˜“ç»´æŠ¤ï¼Œå› ä¸ºæ–°æˆå‘˜ä¸éœ€è¦æ˜¾å¼åœ°æåŠã€‚ ç„¶è€Œï¼Œ<code>makeAutoObservable</code> ä¸èƒ½è¢«ç”¨äºå¸¦æœ‰ super çš„ç±»æˆ– <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/subclassing.html">å­ç±»</a></p>
<p>æ¨æ–­è§„åˆ™ï¼š</p>
<ul>
<li>æ‰€æœ‰ <em>è‡ªæœ‰</em> å±æ€§éƒ½æˆä¸º <code>observable</code>ã€‚</li>
<li>æ‰€æœ‰ <code>get</code>ters éƒ½æˆä¸º <code>computed</code>ã€‚</li>
<li>æ‰€æœ‰ <code>set</code>ters éƒ½æˆä¸º <code>action</code>ã€‚</li>
<li>æ‰€æœ‰ <em>prototype ä¸­çš„ functions</em> éƒ½æˆä¸º <code>autoAction</code>ã€‚</li>
<li>æ‰€æœ‰ <em>prototype ä¸­çš„ generator functions</em> éƒ½æˆä¸º <code>flow</code>ã€‚ï¼ˆéœ€è¦æ³¨æ„ï¼Œgenerators å‡½æ•°åœ¨æŸäº›ç¼–è¯‘å™¨é…ç½®ä¸­æ— æ³•è¢«æ£€æµ‹åˆ°ï¼Œå¦‚æœ flow æ²¡æœ‰æ­£å¸¸è¿è¡Œï¼Œè¯·åŠ¡å¿…æ˜ç¡®åœ°æŒ‡å®š <code>flow</code> æ³¨è§£ã€‚ï¼‰</li>
<li>åœ¨ <code>overrides</code> å‚æ•°ä¸­æ ‡è®°ä¸º <code>false</code> çš„æˆå‘˜å°†ä¸ä¼šè¢«æ·»åŠ æ³¨è§£ã€‚ä¾‹å¦‚ï¼Œå°†å…¶ç”¨äºåƒæ ‡è¯†ç¬¦è¿™æ ·çš„åªè¯»å­—æ®µã€‚</li>
</ul>
<h4 id="observable"><a href="#observable" class="headerlink" title="observable"></a><code>observable</code></h4><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>observable(source, overrides?, options?)</code></li>
</ul>
<p><code>observable</code> æ³¨è§£å¯ä»¥ä½œä¸ºä¸€ä¸ªå‡½æ•°è¿›è¡Œè°ƒç”¨ï¼Œä»è€Œä¸€æ¬¡æ€§å°†æ•´ä¸ªå¯¹è±¡å˜æˆå¯è§‚å¯Ÿçš„ã€‚ <code>source</code> å¯¹è±¡å°†ä¼šè¢«å…‹éš†å¹¶ä¸”æ‰€æœ‰çš„æˆå‘˜éƒ½å°†ä¼šæˆä¸ºå¯è§‚å¯Ÿçš„ï¼Œç±»ä¼¼äº <code>makeAutoObservable</code> åšçš„é‚£æ ·ã€‚ åŒæ ·ï¼Œä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ª <code>overrides</code> å¯¹è±¡æ¥ä¸ºç‰¹å®šçš„æˆå‘˜æä¾›ç‰¹å®šçš„æ³¨è§£ã€‚ </p>
<p>ç”± <code>observable</code> è¿”å›çš„å¯¹è±¡å°†ä¼šä½¿ç”¨ Proxy åŒ…è£…ï¼Œè¿™æ„å‘³ç€ä¹‹åè¢«æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸­çš„å±æ€§ä¹Ÿå°†è¢«ä¾¦æµ‹å¹¶ä½¿å…¶è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ï¼ˆé™¤éç¦ç”¨ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/configuration.html#proxy-%E9%80%89%E9%A1%B9">proxy</a>ï¼‰ã€‚</p>
<p><code>observable</code> æ–¹æ³•ä¹Ÿå¯ä»¥è¢«åƒ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#observablearray">arrays</a>ï¼Œ<a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#observablemap">Maps</a> å’Œ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#observableset">Sets</a> è¿™æ ·çš„é›†åˆè°ƒç”¨ã€‚è¿™äº›é›†åˆä¹Ÿå°†è¢«å…‹éš†å¹¶è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; observable, autorun &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todos = <span class="title function_">observable</span>([</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">&quot;Spoil tea&quot;</span>, <span class="attr">completed</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">&quot;Make coffee&quot;</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="title function_">autorun</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">        <span class="string">&quot;Remaining:&quot;</span>,</span><br><span class="line">        todos</span><br><span class="line">            .<span class="title function_">filter</span>(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.<span class="property">completed</span>)</span><br><span class="line">            .<span class="title function_">map</span>(<span class="function"><span class="params">todo</span> =&gt;</span> todo.<span class="property">title</span>)</span><br><span class="line">            .<span class="title function_">join</span>(<span class="string">&quot;, &quot;</span>)</span><br><span class="line">    )</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// æ‰“å°: &#x27;Remaining: Make coffee&#x27;</span></span><br><span class="line"></span><br><span class="line">todos[<span class="number">0</span>].<span class="property">completed</span> = <span class="literal">false</span></span><br><span class="line"><span class="comment">// æ‰“å°: &#x27;Remaining: Spoil tea, Make coffee&#x27;</span></span><br><span class="line"></span><br><span class="line">todos[<span class="number">2</span>] = &#123; <span class="attr">title</span>: <span class="string">&quot;Take a nap&quot;</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;</span><br><span class="line"><span class="comment">// æ‰“å°: &#x27;Remaining: Spoil tea, Make coffee, Take a nap&#x27;</span></span><br><span class="line"></span><br><span class="line">todos.<span class="title function_">shift</span>()</span><br><span class="line"><span class="comment">// æ‰“å°: &#x27;Remaining: Make coffee, Take a nap&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨autorunå¯ä»¥åœ¨å“åº”å¼çš„æ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œè‡ªåŠ¨æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°</p>
<p>å¯è§‚å¯Ÿçš„æ•°ç»„è¿˜æœ‰ä¸€äº›ç‰¹åˆ«å¥½ç”¨çš„å®ç”¨å‡½æ•°ï¼š</p>
<ul>
<li><code>clear()</code> ä»æ•°ç»„ä¸­æ¸…é™¤æ‰€æœ‰å…ƒç´ ã€‚</li>
<li><code>replace(newItems)</code> å°†æ•°ç»„ä¸­ç°æœ‰çš„å…ƒç´ å…¨éƒ¨æ›¿æ¢æˆ newItemsã€‚</li>
<li><code>remove(value)</code> æ ¹æ® value ä»æ•°ç»„ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ‰¾åˆ°å¹¶åˆ é™¤äº†å…ƒç´ ï¼Œè¿”å› <code>true</code>ã€‚</li>
</ul>
<p><strong>æ³¨æ„ï¼šåŸºæœ¬æ•°æ®ç±»å‹å’Œç±»çš„å®ä¾‹ä¸èƒ½è½¬æ¢æˆå¯è§‚å¯Ÿçš„å¯¹è±¡</strong></p>
<p><strong><code>make(Auto)Observable</code> å’Œ <code>observable</code> ä¹‹é—´æœ€ä¸»è¦çš„åŒºåˆ«</strong>åœ¨äºï¼Œ<code>make(Auto)Observable</code> ä¼šä¿®æ”¹ä½ ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„å¯¹è±¡ï¼Œè€Œ <code>observable</code> ä¼šåˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„ <em>å‰¯æœ¬</em> å¯¹è±¡</p>
<p>ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ï¼Œ<code>observable</code> ä¼šåˆ›å»ºä¸€ä¸ª <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy"><code>Proxy</code></a> å¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨ä½ å°†è¯¥å¯¹è±¡å½“ä½œåŠ¨æ€æŸ¥è¯¢æ˜ å°„ä½¿ç”¨æ—¶æ•è·å°†è¦æ·»åŠ çš„å±æ€§ã€‚ å¦‚æœä½ æƒ³æŠŠä¸€ä¸ªå¯¹è±¡è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ï¼Œè€Œè¿™ä¸ªå¯¹è±¡å…·æœ‰ä¸€ä¸ªå¸¸è§„ç»“æ„ï¼Œå…¶ä¸­æ‰€æœ‰çš„æˆå‘˜éƒ½æ˜¯äº‹å…ˆå·²çŸ¥çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å»ºè®®ä½¿ç”¨ <code>makeObservable</code>ï¼Œå› ä¸ºéä»£ç†å¯¹è±¡çš„é€Ÿåº¦ç¨å¿«ä¸€äº›ï¼Œè€Œä¸”å®ƒä»¬åœ¨è°ƒè¯•å™¨å’Œ <code>console.log</code> ä¸­æ›´å®¹æ˜“æ£€æŸ¥ã€‚</p>
<p>å› æ­¤ï¼Œ<code>make(Auto)Observable</code> æ¨èåœ¨å·¥å‚å‡½æ•°ä¸­ä½¿ç”¨ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¯ä»¥å°† <code>&#123; proxy: false &#125;</code> ä½œä¸º option ä¼ å…¥ <code>observable</code> è·å–éä»£ç†å‰¯æœ¬</p>
<h2 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h2><h3 id="ä½¿ç”¨-actions-æ›´æ–°-state"><a href="#ä½¿ç”¨-actions-æ›´æ–°-state" class="headerlink" title="ä½¿ç”¨ actions æ›´æ–° state"></a>ä½¿ç”¨ actions æ›´æ–° state</h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>action</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li>
<li><code>action(fn)</code></li>
<li><code>action(name, fn)</code></li>
</ul>
<p>actionså°±æ˜¯ç”¨æ¥ä¿®æ”¹stateä¸­çš„æ•°æ®çš„ï¼Œ</p>
<p>å°½ç®¡ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/observable-state.html#makeautoobservable"><code>makeAutoObservable</code></a> å¯ä»¥è‡ªåŠ¨å¸®ä½ å£°æ˜ä¸€éƒ¨åˆ† actionsï¼Œä½†æ˜¯ MobX è¿˜æ˜¯è¦æ±‚ä½ å£°æ˜ä½ çš„ actionsã€‚Actions å¯ä»¥å¸®åŠ©ä½ æ›´å¥½çš„ç»„ç»‡ä½ çš„ä»£ç å¹¶æä¾›ä»¥ä¸‹æ€§èƒ½ä¼˜åŠ¿ï¼š</p>
<ol>
<li>å®ƒä»¬åœ¨ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#transaction">transactions</a> å†…éƒ¨è¿è¡Œã€‚ä»»ä½•å¯è§‚å¯Ÿå¯¹è±¡åœ¨æœ€å¤–å±‚çš„ action å®Œæˆä¹‹å‰éƒ½ä¸ä¼šè¢«æ›´æ–°ï¼Œè¿™ä¸€ç‚¹ä¿è¯äº†åœ¨ action å®Œæˆä¹‹å‰ï¼Œaction æ‰§è¡ŒæœŸé—´ç”Ÿæˆçš„ä¸­é—´å€¼æˆ–ä¸å®Œæ•´çš„å€¼å¯¹åº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†éƒ½æ˜¯ä¸å¯è§çš„ã€‚</li>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å…è®¸åœ¨ actions ä¹‹å¤–æ”¹å˜ stateã€‚è¿™æœ‰åŠ©äºåœ¨ä»£ç ä¸­æ¸…æ¥šåœ°å¯¹çŠ¶æ€æ›´æ–°å‘ç”Ÿçš„ä½ç½®è¿›è¡Œå®šä½ã€‚</li>
</ol>
<p><code>action</code> æ³¨è§£åº”è¯¥ä»…ç”¨äºä¼š<em>ä¿®æ”¹</em> state çš„å‡½æ•°ã€‚æ´¾ç”Ÿå…¶ä»–ä¿¡æ¯ï¼ˆæ‰§è¡ŒæŸ¥è¯¢æˆ–è€…è¿‡æ»¤æ•°æ®ï¼‰çš„å‡½æ•°<em>ä¸åº”è¯¥</em>è¢«æ ‡è®°ä¸º actionsï¼Œä»¥ä¾¿ MobX å¯ä»¥å¯¹å®ƒä»¬çš„è°ƒç”¨è¿›è¡Œè·Ÿè¸ªã€‚ å¸¦æœ‰ <code>action</code> æ³¨è§£çš„æˆå‘˜æ˜¯ä¸å¯æšä¸¾çš„ã€‚</p>
<p>makeObservable</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Doubler</span> &#123;</span><br><span class="line">    value = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="title function_">makeObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: observable,</span><br><span class="line">            <span class="attr">increment</span>: action</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// è§‚å¯Ÿè€…ä¸ä¼šçœ‹åˆ°ä¸­é—´çŠ¶æ€.</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>makeAutoObservable</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeAutoObservable &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Doubler</span> &#123;</span><br><span class="line">    value = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>action.bound</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Doubler</span> &#123;</span><br><span class="line">    value = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="title function_">makeObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: observable,</span><br><span class="line">            <span class="attr">increment</span>: action.<span class="property">bound</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> doubler = <span class="keyword">new</span> <span class="title class_">Doubler</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ ·è°ƒç”¨ increment æ˜¯å®‰å…¨çš„, å› ä¸ºå®ƒå·²ç»è¢«ç»‘å®šäº†ã€‚</span></span><br><span class="line"><span class="built_in">setInterval</span>(doubler.<span class="property">increment</span>, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<p>Action(fn)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; observable, action &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">observable</span>(&#123; <span class="attr">value</span>: <span class="number">0</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> increment = <span class="title function_">action</span>(<span class="function"><span class="params">state</span> =&gt;</span> &#123;</span><br><span class="line">    state.<span class="property">value</span>++</span><br><span class="line">    state.<span class="property">value</span>++</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">increment</span>(state)</span><br></pre></td></tr></table></figure>

<p>runInAction</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; observable, runInAction &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">observable</span>(&#123; <span class="attr">value</span>: <span class="number">0</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">runInAction</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    state.<span class="property">value</span>++</span><br><span class="line">    state.<span class="property">value</span>++</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-action-åŒ…è£…å‡½æ•°"><a href="#ä½¿ç”¨-action-åŒ…è£…å‡½æ•°" class="headerlink" title="ä½¿ç”¨ action åŒ…è£…å‡½æ•°"></a>ä½¿ç”¨ <code>action</code> åŒ…è£…å‡½æ•°</h3><p>ä¸ºäº†å°½å¯èƒ½åœ°åˆ©ç”¨ MobX çš„äº‹åŠ¡æ€§ï¼Œactions åº”è¯¥å°½å¯èƒ½è¢«ä¼ åˆ°å¤–å›´ã€‚å¦‚æœä¸€ä¸ªç±»æ–¹æ³•ä¼šä¿®æ”¹ stateï¼Œå¯ä»¥å°†å…¶æ ‡è®°ä¸º actionã€‚æŠŠäº‹ä»¶å¤„ç†å‡½æ•°æ ‡è®°ä¸º actions å°±æ›´å¥½äº†ï¼Œå› ä¸ºæœ€å¤–å±‚çš„äº‹åŠ¡èµ·ç€å†³å®šæ€§ä½œç”¨ã€‚ä¸€ä¸ªæœªè¢«æ ‡è®°çš„ã€ä¼šæ¥ç€è°ƒç”¨ä¸¤ä¸ª actions çš„äº‹ä»¶å¤„ç†å‡½æ•°ä»ç„¶å°†ä¼šç”Ÿæˆä¸¤ä¸ªäº‹åŠ¡ã€‚</p>
<p>ä¸ºäº†å¸®åŠ©åˆ›å»ºåŸºäº action çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œ<code>action</code> ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ³¨è§£ï¼Œæ›´æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ã€‚å¯ä»¥ä½¿ç”¨å‡½æ•°å°†å®ƒä½œä¸ºä¸€ä¸ªå‚æ•°æ¥è°ƒç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å®ƒå°†ä¼šè¿”å›ä¸€ä¸ªæœ‰ç€ç›¸åŒç­¾åçš„ä½¿ç”¨ <code>action</code> åŒ…è£…è¿‡çš„å‡½æ•°ã€‚</p>
<p>ä¾‹å¦‚åœ¨ React ä¸­ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼åŒ…è£… <code>onClick</code> äº‹ä»¶å¤„ç†å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">ResetButton</span> = (<span class="params">&#123; formState &#125;</span>) =&gt; (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;action(e</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            formState.resetPendingUploads()</span></span><br><span class="line"><span class="language-xml">            formState.resetValues()</span></span><br><span class="line"><span class="language-xml">            e.stopPropagation()</span></span><br><span class="line"><span class="language-xml">        &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">    &gt;</span></span><br><span class="line"><span class="language-xml">        Reset form</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†æ›´å¥½çš„è°ƒè¯•ä½“éªŒï¼Œæˆ‘ä»¬æ¨èä¸ºè¢«åŒ…è£…çš„å‡½æ•°å‘½åï¼Œæˆ–è€…å°†åç§°ä½œä¸º <code>action</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œä¼ é€’    </p>
<p><strong>æ³¨æ„ï¼šactionsä¸ä¼šè¢«è·Ÿè¸ª</strong>ï¼Œå°±æ˜¯ä¸èƒ½è§¦å‘autorun</p>
<p>actions çš„å¦ä¸€ä¸ªç‰¹å¾æ˜¯å®ƒä»¬æ˜¯ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#untracked">ä¸å¯è¿½è¸ª</a> çš„ã€‚å½“ä»å‰¯ä½œç”¨æˆ–è€…è®¡ç®—å€¼ï¼ˆéå¸¸ç½•è§ï¼‰ä¸­è°ƒç”¨ action æ—¶ï¼Œè¯¥ action è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡å°†ä¸ä¼šç®—ä½œè¯¥ derivation çš„ä¾èµ–é¡¹ã€‚</p>
<p><code>makeAutoObservable</code>ï¼Œ<code>extendObservable</code> å’Œ <code>observable</code> ä½¿ç”¨ä¸€ç§ç‰¹æ®Šçš„ <code>action</code>ï¼Œ å«åš <code>autoAction</code>ï¼Œ å®ƒä¼šåœ¨è¿è¡Œæ—¶ç¡®å®šå‡½æ•°æ˜¯ derivation è¿˜æ˜¯ actionã€‚</p>
<h3 id="action-bound"><a href="#action-bound" class="headerlink" title="action.bound"></a><code>action.bound</code></h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>action.bound</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li>
</ul>
<p><code>action.bound</code> æ³¨è§£å¯ç”¨äºå°†æ–¹æ³•è‡ªåŠ¨ç»‘å®šåˆ°æ­£ç¡®çš„å®ä¾‹ï¼Œè¿™æ · <code>this</code> ä¼šå§‹ç»ˆè¢«æ­£ç¡®ç»‘å®šåœ¨å‡½æ•°å†…éƒ¨</p>
<p>ä½¿ç”¨makeAutoObservable(o,{},{autoBind:true}) è‡ªåŠ¨ç»‘å®šæ‰€æœ‰çš„actionså’Œflow</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeAutoObservable &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Doubler</span> &#123;</span><br><span class="line">    value = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>, &#123;&#125;, &#123; <span class="attr">autoBind</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    *<span class="title function_">flow</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">yield</span> <span class="title function_">fetch</span>(<span class="string">&quot;http://example.com/value&quot;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span> = <span class="keyword">yield</span> response.<span class="title function_">json</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="runInAction"><a href="#runInAction" class="headerlink" title="runInAction"></a><code>runInAction</code></h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>runInAction(fn)</code></li>
</ul>
<p>ä½¿ç”¨è¿™ä¸ªå·¥å…·å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªä¼šè¢«ç«‹å³è°ƒç”¨çš„ä¸´æ—¶ actionã€‚åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­éå¸¸æœ‰ç”¨ã€‚ </p>
<h3 id="Actions-å’Œç»§æ‰¿"><a href="#Actions-å’Œç»§æ‰¿" class="headerlink" title="Actions å’Œç»§æ‰¿"></a>Actions å’Œç»§æ‰¿</h3><p>åªæœ‰å®šä¹‰åœ¨<strong>åŸå‹</strong>ä¸Šçš„å‡½æ•°å¯ä»¥è¢«å­ç±»<strong>è¦†ç›–</strong>ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">    <span class="comment">// on instance class filed</span></span><br><span class="line">    arrowAction = <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// on prototype</span></span><br><span class="line">    <span class="title function_">action</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">    <span class="title function_">boundAction</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">arrowAction</span>: action</span><br><span class="line">            <span class="attr">action</span>: action,</span><br><span class="line">            <span class="attr">boundAction</span>: action.<span class="property">bound</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">    <span class="comment">// THROWS: TypeError: Cannot redefine property: arrowAction</span></span><br><span class="line">    arrowAction = <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// OK</span></span><br><span class="line">    <span class="title function_">action</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">    <span class="title function_">boundAction</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>()</span><br><span class="line">        <span class="title function_">makeObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">arrowAction</span>: override,</span><br><span class="line">            <span class="attr">action</span>: override,</span><br><span class="line">            <span class="attr">boundAction</span>: override,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æƒ³è¦å°†å•ä¸ªçš„ <em>action</em> <strong>ç»‘å®š</strong> åˆ° <code>this</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>action.bound</code> ä»£æ›¿ç®­å¤´å‡½æ•°</p>
<h3 id="å¼‚æ­¥-actions"><a href="#å¼‚æ­¥-actions" class="headerlink" title="å¼‚æ­¥ actions"></a>å¼‚æ­¥ actions</h3><p>ä»æœ¬è´¨ä¸Šè®²ï¼Œå¼‚æ­¥è¿›ç¨‹åœ¨ MobX ä¸­ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šå¤„ç†ï¼Œå› ä¸ºä¸è®ºæ˜¯ä½•æ—¶å¼•å‘çš„æ‰€æœ‰ reactions éƒ½å°†ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ è€Œä¸”å› ä¸ºå¯è§‚å¯Ÿå¯¹è±¡æ˜¯å¯å˜çš„ï¼Œå› æ­¤åœ¨ action æ‰§è¡Œè¿‡ç¨‹ä¸­ä¿æŒå¯¹å®ƒä»¬çš„å¼•ç”¨ä¸€èˆ¬æ˜¯å®‰å…¨çš„ã€‚ ç„¶è€Œï¼Œåœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°å¯è§‚å¯Ÿå¯¹è±¡çš„æ¯ä¸ªæ­¥éª¤ï¼ˆtickï¼‰éƒ½åº”è¯¥è¢«æ ‡è¯†ä¸º <code>action</code>ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨ä¸Šè¿°çš„ API ä»¥å¤šç§æ–¹å¼å®ç°è¿™ä¸€ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨å¤„ç† Promise æ—¶ï¼Œæ›´æ–° state çš„å¤„ç†ç¨‹åºåº”è¯¥è¢« <code>action</code> åŒ…è£…èµ·æ¥ï¼Œæˆ–è€…è¢«æ ‡è®°ä¸º actionsï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span> çš„å†³è®®å¤„ç†ç¨‹åºæ˜¯æˆ‘ä»¬ä»¥å†…è”çš„æ–¹å¼å¤„ç†çš„ï¼Œä½†æ˜¯ä¼šåœ¨ä¸€å¼€å§‹çš„ action æ‰§è¡Œå®Œæˆä¹‹åè¿è¡Œï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ action å¯¹å®ƒä»¬è¿›è¡ŒåŒ…è£…ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; action, makeAutoObservable &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Store</span> &#123;</span><br><span class="line">    githubProjects = []</span><br><span class="line">    state = <span class="string">&quot;pending&quot;</span> <span class="comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">fetchProjects</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">githubProjects</span> = []</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;pending&quot;</span></span><br><span class="line">        <span class="title function_">fetchGithubProjectsSomehow</span>().<span class="title function_">then</span>(</span><br><span class="line">            <span class="title function_">action</span>(<span class="string">&quot;fetchSuccess&quot;</span>, <span class="function"><span class="params">projects</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> filteredProjects = <span class="title function_">somePreprocessing</span>(projects)</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">githubProjects</span> = filteredProjects</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;done&quot;</span></span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="title function_">action</span>(<span class="string">&quot;fetchError&quot;</span>, <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;error&quot;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å¦‚æœ Promise çš„å¤„ç†å‡½æ•°æ˜¯ç±»çš„å­—æ®µï¼Œå®ƒä»¬å°†ç”± <code>makeAutoObservable</code> è‡ªåŠ¨åŒ…è£…ä¸º <code>action</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeAutoObservable &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Store</span> &#123;</span><br><span class="line">    githubProjects = []</span><br><span class="line">    state = <span class="string">&quot;pending&quot;</span> <span class="comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">fetchProjects</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">githubProjects</span> = []</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;pending&quot;</span></span><br><span class="line">        <span class="title function_">fetchGithubProjectsSomehow</span>().<span class="title function_">then</span>(<span class="variable language_">this</span>.<span class="property">projectsFetchSuccess</span>, <span class="variable language_">this</span>.<span class="property">projectsFetchFailure</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    projectsFetchSuccess = <span class="function"><span class="params">projects</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> filteredProjects = <span class="title function_">somePreprocessing</span>(projects)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">githubProjects</span> = filteredProjects</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;done&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    projectsFetchFailure = <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;error&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>await</code> ä¹‹åçš„ä»»ä½•æ“ä½œéƒ½ä¸ä¸å…¶åŒåœ¨ä¸€ä¸ª tick ä¸­ï¼Œå› æ­¤å®ƒä»¬éœ€è¦ä½¿ç”¨ action åŒ…è£…ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>runInAction</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; runInAction, makeAutoObservable &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Store</span> &#123;</span><br><span class="line">    githubProjects = []</span><br><span class="line">    state = <span class="string">&quot;pending&quot;</span> <span class="comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">fetchProjects</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">githubProjects</span> = []</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;pending&quot;</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> projects = <span class="keyword">await</span> <span class="title function_">fetchGithubProjectsSomehow</span>()</span><br><span class="line">            <span class="keyword">const</span> filteredProjects = <span class="title function_">somePreprocessing</span>(projects)</span><br><span class="line">            <span class="title function_">runInAction</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">githubProjects</span> = filteredProjects</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;done&quot;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="title function_">runInAction</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;error&quot;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨flow+generator</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; flow, makeAutoObservable, flowResult &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Store</span> &#123;</span><br><span class="line">    githubProjects = []</span><br><span class="line">    state = <span class="string">&quot;pending&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">fetchProjects</span>: flow</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨æ„æ˜Ÿå·, è¿™æ˜¯ä¸€ä¸ª generator å‡½æ•°!</span></span><br><span class="line">    *<span class="title function_">fetchProjects</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">githubProjects</span> = []</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;pending&quot;</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// Yield ä»£æ›¿ await.</span></span><br><span class="line">            <span class="keyword">const</span> projects = <span class="keyword">yield</span> <span class="title function_">fetchGithubProjectsSomehow</span>()</span><br><span class="line">            <span class="keyword">const</span> filteredProjects = <span class="title function_">somePreprocessing</span>(projects)</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;done&quot;</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">githubProjects</span> = filteredProjects</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">state</span> = <span class="string">&quot;error&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Store</span>()</span><br><span class="line"><span class="keyword">const</span> projects = <span class="keyword">await</span> <span class="title function_">flowResult</span>(store.<span class="title function_">fetchProjects</span>())</span><br></pre></td></tr></table></figure>

<h2 id="Computers"><a href="#Computers" class="headerlink" title="Computers"></a>Computers</h2><p>ä½¿ç”¨ï¼š</p>
<ul>
<li><code>computed</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li>
<li><code>computed(options)</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li>
<li><code>computed(fn, options?)</code></li>
</ul>
<p>è®¡ç®—å€¼å¯ä»¥ç”¨æ¥ä»å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ä¸­æ´¾ç”Ÿä¿¡æ¯ã€‚ è®¡ç®—å€¼é‡‡ç”¨æƒ°æ€§æ±‚å€¼ï¼Œä¼šç¼“å­˜å…¶è¾“å‡ºï¼Œå¹¶ä¸”åªæœ‰å½“å…¶ä¾èµ–çš„å¯è§‚å¯Ÿå¯¹è±¡è¢«æ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®—ã€‚ å®ƒä»¬åœ¨ä¸è¢«ä»»ä½•å€¼è§‚å¯Ÿæ—¶ä¼šè¢«æš‚æ—¶åœç”¨ã€‚</p>
<p>è®¡ç®—å€¼å¯ä»¥é€šè¿‡åœ¨ JavaScript <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get">getters</a> ä¸Šæ·»åŠ  <code>computed</code> æ³¨è§£æ¥åˆ›å»ºã€‚ ä½¿ç”¨ <code>makeObservable</code> å°† getter å£°æ˜ä¸º computedã€‚æˆ–è€…å¦‚æœä½ å¸Œæœ›æ‰€æœ‰çš„ getters è¢«è‡ªåŠ¨å£°æ˜ä¸º <code>computed</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>makeAutoObservable</code>ï¼Œ<code>observable</code> æˆ–è€… <code>extendObservable</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeObservable, observable, computed, autorun &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OrderLine</span> &#123;</span><br><span class="line">    price = <span class="number">0</span></span><br><span class="line">    amount = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">price</span>) &#123;</span><br><span class="line">        <span class="title function_">makeObservable</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">price</span>: observable,</span><br><span class="line">            <span class="attr">amount</span>: observable,</span><br><span class="line">            <span class="attr">total</span>: computed</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">price</span> = price</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">total</span>() &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Computing...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">price</span> * <span class="variable language_">this</span>.<span class="property">amount</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> order = <span class="keyword">new</span> <span class="title class_">OrderLine</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stop = <span class="title function_">autorun</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Total: &quot;</span> + order.<span class="property">total</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// Computing...</span></span><br><span class="line"><span class="comment">// Total: 0</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(order.<span class="property">total</span>)</span><br><span class="line"><span class="comment">// (ä¸ä¼šé‡æ–°è®¡ç®—!)</span></span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line">order.<span class="property">amount</span> = <span class="number">5</span></span><br><span class="line"><span class="comment">// Computing...</span></span><br><span class="line"><span class="comment">// (æ— éœ€ autorun)</span></span><br><span class="line"></span><br><span class="line">order.<span class="property">price</span> = <span class="number">2</span></span><br><span class="line"><span class="comment">// Computing...</span></span><br><span class="line"><span class="comment">// Total: 10</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">stop</span>()</span><br><span class="line"></span><br><span class="line">order.<span class="property">price</span> = <span class="number">3</span></span><br><span class="line"><span class="comment">// è®¡ç®—å€¼å’Œ autorun éƒ½ä¸ä¼šè¢«é‡æ–°è®¡ç®—.</span></span><br></pre></td></tr></table></figure>

<p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœ <code>total</code> æ²¡æœ‰è¢«æ³¨è§£ï¼Œé‚£ä¹ˆ <code>autorun</code> ä¼šæŠŠå‰¯ä½œç”¨è¿è¡Œ 3 æ¬¡ï¼Œ å› ä¸ºå®ƒå°†ç›´æ¥ä¾èµ–äº <code>total</code> å’Œ <code>amount</code></p>
<p><img src="https://zh.mobx.js.org/assets/computed-example.png" alt="computed graph"></p>
<p>ä¸Šå›¾æ˜¯ä¸ºä»¥ä¸Šç¤ºä¾‹åˆ›å»ºçš„ä¾èµ–å›¾ã€‚</p>
<h3 id="è§„åˆ™"><a href="#è§„åˆ™" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h3><p>ä½¿ç”¨è®¡ç®—å€¼æ—¶ï¼Œè¯·éµå¾ªä¸‹é¢çš„æœ€ä½³å®è·µï¼š</p>
<ol>
<li>å®ƒä»¬ä¸åº”è¯¥æœ‰å‰¯ä½œç”¨æˆ–è€…æ›´æ–°å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ã€‚</li>
<li>é¿å…åˆ›å»ºå’Œè¿”å›æ–°çš„å¯è§‚å¯Ÿå¯¹è±¡ã€‚</li>
<li>å®ƒä»¬ä¸åº”è¯¥ä¾èµ–éå¯è§‚å¯Ÿå¯¹è±¡çš„å€¼</li>
</ol>
<h2 id="ä½¿ç”¨-reactions-å¤„ç†å‰¯ä½œç”¨-ğŸš€"><a href="#ä½¿ç”¨-reactions-å¤„ç†å‰¯ä½œç”¨-ğŸš€" class="headerlink" title="ä½¿ç”¨ reactions å¤„ç†å‰¯ä½œç”¨ {ğŸš€}"></a>ä½¿ç”¨ reactions å¤„ç†å‰¯ä½œç”¨ {ğŸš€}</h2><p>ä¸ºäº†ç†è§£ MobXï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•åˆ›å»º reactionsã€‚ æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/reactions.html#autorun"><code>autorun</code></a> å·¥å…·å‡½æ•°ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/reactions.html#reaction"><code>reaction</code></a> å’Œ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/reactions.html#when"><code>when</code></a></p>
<h3 id="Autorun"><a href="#Autorun" class="headerlink" title="Autorun"></a>Autorun</h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>autorun(effect: (reaction) =&gt; void)</code></li>
</ul>
<p><code>autorun</code> å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ¯å½“è¯¥å‡½æ•°æ‰€è§‚å¯Ÿçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒéƒ½åº”è¯¥è¿è¡Œã€‚ å½“ä½ è‡ªå·±åˆ›å»º <code>autorun</code> æ—¶ï¼Œå®ƒä¹Ÿä¼šè¿è¡Œä¸€æ¬¡ã€‚å®ƒä»…ä»…å¯¹å¯è§‚å¯ŸçŠ¶æ€çš„å˜åŒ–åšå‡ºå“åº”ï¼Œæ¯”å¦‚é‚£äº›ä½ ç”¨ <code>observable</code> æˆ–è€… <code>computed</code> æ³¨é‡Šçš„ã€‚</p>
<h3 id="tracking-å¦‚ä½•å·¥ä½œ"><a href="#tracking-å¦‚ä½•å·¥ä½œ" class="headerlink" title="tracking å¦‚ä½•å·¥ä½œ"></a>tracking å¦‚ä½•å·¥ä½œ</h3><p>Autorun é€šè¿‡åœ¨<em>å“åº”å¼ä¸Šä¸‹æ–‡</em>è¿è¡Œ <code>effect</code> æ¥å·¥ä½œã€‚åœ¨ç»™å®šçš„å‡½æ•°æ‰§è¡ŒæœŸé—´ï¼ŒMobX ä¼šæŒç»­è·Ÿè¸ªè¢« effect ç›´æ¥æˆ–é—´æ¥<em>è¯»å–</em>è¿‡çš„æ‰€æœ‰å¯è§‚å¯Ÿå¯¹è±¡å’Œè®¡ç®—å€¼ã€‚ ä¸€æ—¦å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼ŒMobX å°†æ”¶é›†å¹¶è®¢é˜…æ‰€æœ‰è¢«è¯»å–è¿‡çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå¹¶ç­‰å¾…å…¶ä¸­ä»»æ„ä¸€ä¸ªå†æ¬¡å‘ç”Ÿæ”¹å˜ã€‚ ä¸€æ—¦æœ‰æ”¹å˜å‘ç”Ÿï¼Œ<code>autorun</code> å°†ä¼šå†æ¬¡è§¦å‘ï¼Œé‡å¤æ•´ä¸ªè¿‡ç¨‹ã€‚</p>
<p><img src="https://zh.mobx.js.org/assets/autorun.png" alt="autorun"></p>
<p>è¿™å°±æ˜¯ä¸‹é¢çš„ç¤ºä¾‹çš„å·¥ä½œæ–¹å¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeAutoObservable, autorun &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    name</span><br><span class="line">    energyLevel</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">energyLevel</span> = <span class="number">100</span></span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">reduceEnergy</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">energyLevel</span> -= <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">isHungry</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">energyLevel</span> &lt; <span class="number">50</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> giraffe = <span class="keyword">new</span> <span class="title class_">Animal</span>(<span class="string">&quot;Gary&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">autorun</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Energy level:&quot;</span>, giraffe.<span class="property">energyLevel</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">autorun</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (giraffe.<span class="property">isHungry</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Now I&#x27;m hungry!&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;I&#x27;m not hungry!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Now let&#x27;s change state!&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    giraffe.<span class="title function_">reduceEnergy</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Energy level: 100</span><br><span class="line">I&#x27;m not hungry!</span><br><span class="line">Now let&#x27;s change state!</span><br><span class="line">Energy level: 90</span><br><span class="line">Energy level: 80</span><br><span class="line">Energy level: 70</span><br><span class="line">Energy level: 60</span><br><span class="line">Energy level: 50</span><br><span class="line">Energy level: 40</span><br><span class="line">Now I&#x27;m hungry!</span><br><span class="line">Energy level: 30</span><br><span class="line">Energy level: 20</span><br><span class="line">Energy level: 10</span><br><span class="line">Energy level: 0</span><br></pre></td></tr></table></figure>

<p>autorunä¼šæ¯”è¾ƒå‰åå€¼æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¸ä¼šæ‰§è¡Œï¼Œå½“å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ‰ä¼šé‡æ–°æ‰§è¡Œ</p>
<h3 id="Reaction"><a href="#Reaction" class="headerlink" title="Reaction"></a>Reaction</h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>reaction(() =&gt; value, (value, previousValue, reaction) =&gt; &#123; sideEffect &#125;, options?)</code>.</li>
</ul>
<p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯æŒ‡éœ€è¦ç›‘å¬é‚£ä¸ªstateçš„å˜åŒ–ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“æ•°æ®å˜åŒ–çš„æ—¶å€™éœ€è¦æ‰§è¡Œçš„å‡½æ•°ï¼Œreaction</p>
<p>å’Œautorunæ¯”è¾ƒï¼Œautorunæ˜¯é’ˆå¯¹æ‰€æœ‰çš„stateï¼Œreactionæ˜¯é’ˆå¯¹ç‰¹å®šçš„stateï¼Œè€Œä¸”reactionåœ¨åˆå§‹åŒ–ï¼Œä¸ä¼šæ‰§è¡Œï¼Œåªæœ‰åœ¨state</p>
<p>å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šæ‰§è¡Œ</p>
<p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œreaction åªä¼šåœ¨ <code>isHungry</code> å‘ç”Ÿæ”¹å˜æ—¶è¢«è§¦å‘ä¸€æ¬¡ã€‚ åœ¨ <em>effect</em> å‡½æ•°ä¸­ä½¿ç”¨çš„ <code>giraffe.energyLevel</code> çš„æ›´æ”¹ï¼Œå¹¶ä¸ä¼šè§¦å‘ <em>effect</em> å‡½æ•°ã€‚å¦‚æœä½ æƒ³è¦ <code>reaction</code> ä¹Ÿå¯¹è¿™ä¸ªå€¼çš„å˜åŒ–åšå‡ºååº”ï¼Œ ä½ éœ€è¦åœ¨ <em>data</em> å‡½æ•°ä¸­è®¿é—®å¹¶è¿”å›å®ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; makeAutoObservable, reaction &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    name</span><br><span class="line">    energyLevel</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">energyLevel</span> = <span class="number">100</span></span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">reduceEnergy</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">energyLevel</span> -= <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">isHungry</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">energyLevel</span> &lt; <span class="number">50</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> giraffe = <span class="keyword">new</span> <span class="title class_">Animal</span>(<span class="string">&quot;Gary&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">reaction</span>(</span><br><span class="line">    <span class="function">() =&gt;</span> giraffe.<span class="property">isHungry</span>,</span><br><span class="line">    <span class="function"><span class="params">isHungry</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isHungry) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Now I&#x27;m hungry!&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;I&#x27;m not hungry!&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Energy level:&quot;</span>, giraffe.<span class="property">energyLevel</span>)</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Now let&#x27;s change state!&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    giraffe.<span class="title function_">reduceEnergy</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Now let&#x27;s change state!</span><br><span class="line">Now I&#x27;m hungry!</span><br><span class="line">Energy level: 40</span><br></pre></td></tr></table></figure>

<h3 id="When"><a href="#When" class="headerlink" title="When"></a>When</h3><p>ä½¿ç”¨ï¼š</p>
<ul>
<li><code>when(predicate: () =&gt; boolean, effect?: () =&gt; void, options?)</code></li>
<li><code>when(predicate: () =&gt; boolean, options?): Promise</code></li>
</ul>
<p><code>when</code> ä¼šè§‚å¯Ÿå¹¶è¿è¡Œç»™å®šçš„ <em>predicate</em> å‡½æ•°ï¼Œç›´åˆ°å…¶è¿”å› <code>true</code>ã€‚ ä¸€æ—¦ predicate è¿”å›äº† trueï¼Œç»™å®šçš„ <em>effect</em> å‡½æ•°å°±ä¼šæ‰§è¡Œå¹¶ä¸”è‡ªåŠ¨æ‰§è¡Œå™¨å‡½æ•°å°†ä¼šè¢«æ¸…ç†æ‰ã€‚</p>
<p>å¦‚æœä½ æ²¡æœ‰ä¼ å…¥ <code>effect</code> å‡½æ•°ï¼Œ<code>when</code> å‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code> ç±»å‹çš„ disposerï¼Œå¹¶å…è®¸ä½ æ‰‹åŠ¨å–æ¶ˆ</p>
<p><code>when</code> å¯¹äºä»¥å“åº”å¼çš„æ–¹å¼å°†å€¼æ¸…ç†æˆ–å–æ¶ˆæ‰ååˆ†æœ‰ç”¨ã€‚ ä¾‹å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; when, makeAutoObservable &#125; <span class="keyword">from</span> <span class="string">&quot;mobx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyResource</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>, &#123; <span class="attr">dispose</span>: <span class="literal">false</span> &#125;)</span><br><span class="line">        <span class="title function_">when</span>(</span><br><span class="line">            <span class="comment">// Once...</span></span><br><span class="line">            <span class="function">() =&gt;</span> !<span class="variable language_">this</span>.<span class="property">isVisible</span>,</span><br><span class="line">            <span class="comment">// ... then.</span></span><br><span class="line">            <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">dispose</span>()</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">isVisible</span>() &#123;</span><br><span class="line">        <span class="comment">// è¡¨ç¤ºæ­¤é¡¹ç›®æ˜¯å¦å¯è§.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">dispose</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// æ¸…ç†ä¸€äº›èµ„æº.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€æ—¦ <code>isVisible</code> å˜æˆ <code>false</code>ï¼Œ<code>dispose</code> æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼Œ å¹¶å¯¹ <code>MyResource</code> åšä¸€äº›æ¸…ç†æ“ä½œ</p>
<h3 id="await-when"><a href="#await-when" class="headerlink" title="await when(...)"></a><code>await when(...)</code></h3><p>å¦‚æœä½ æ²¡æœ‰æä¾› <code>effect</code> å‡½æ•°ï¼Œ<code>when</code> å°†ä¼šè¿”å›ä¸€ä¸ª <code>Promise</code>ã€‚è¿™æ ·ä¼šè·Ÿ <code>async / await</code> å¾ˆå¥½åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œè®©ä½ å¯ä»¥ç­‰å¾…å¯è§‚å¯Ÿå¯¹è±¡ä¸­çš„å˜åŒ–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">when</span>(<span class="function">() =&gt;</span> that.<span class="property">isVisible</span>)</span><br><span class="line">    <span class="comment">// etc...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¦æå‰å–æ¶ˆ <code>when</code>ï¼Œå¯ä»¥å¯¹å®ƒè¿”å›çš„ Promise è°ƒç”¨ <code>.cancel()</code> å‡½æ•°ã€‚</p>
<h4 id="è§„åˆ™-1"><a href="#è§„åˆ™-1" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h4><p>è¿™é‡Œæ˜¯ä¸€äº› reactive context éœ€è¦éµå®ˆçš„è§„åˆ™ï¼š</p>
<ol>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå¯è§‚å¯Ÿå¯¹è±¡å‘ç”Ÿäº†æ”¹å˜ï¼Œå—å…¶å½±å“çš„ reactions ä¼šç«‹å³ï¼ˆåŒæ­¥ï¼‰è¿è¡Œã€‚ç„¶è€Œï¼Œå®ƒä»¬ç›´åˆ°å½“å‰æœ€å¤–å±‚çš„ (trans)action æ‰§è¡Œç»“æŸåæ‰ä¼šè¿è¡Œã€‚</li>
<li>autorun åªä¼šè·Ÿè¸ªç»™å®šå‡½æ•°åœ¨åŒæ­¥æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œä¸ä¼šè·Ÿè¸ªå¼‚æ­¥å‘ç”Ÿçš„å˜åŒ–ã€‚</li>
<li>autorun ä¸ä¼šè·Ÿè¸ªè¢«å…¶è°ƒç”¨çš„ action æ‰€è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå› ä¸º action å§‹ç»ˆ<em>ä¸ä¼šè¢«è¿½è¸ª</em>ã€‚</li>
</ol>
<h3 id="Always-dispose-of-reactions"><a href="#Always-dispose-of-reactions" class="headerlink" title="Always dispose of reactions"></a>Always dispose of reactions</h3><p>ä¼ é€’ç»™ <code>autorun</code>ï¼Œ<code>reaction</code> å’Œ <code>when</code> çš„å‡½æ•°åªæœ‰åœ¨å®ƒä»¬è§‚å¯Ÿçš„æ‰€æœ‰å¯¹è±¡éƒ½è¢« GC ä¹‹åæ‰ä¼šè¢« GCã€‚åŸåˆ™ä¸Šï¼Œå®ƒä»¬ä¸€ç›´ç­‰å¾…å¯è§‚å¯Ÿå¯¹è±¡å‘ç”Ÿæ–°çš„å˜åŒ–ã€‚ ä¸ºäº†é˜»æ­¢ reactions æ°¸è¿œåœ°ç­‰å¾…ä¸‹å»ï¼Œå®ƒä»¬æ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ª disposer å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥ç”¨æ¥åœæ­¢æ‰§è¡Œå¹¶ä¸”å–æ¶ˆè®¢é˜…æ‰€ä½¿ç”¨çš„ä»»ä½•å¯è§‚å¯Ÿå¯¹è±¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const counter = observable(&#123; count: 0 &#125;)</span><br><span class="line"></span><br><span class="line">// åˆå§‹åŒ–ä¸€ä¸ª autorun å¹¶ä¸”æ‰“å° 0.</span><br><span class="line">const disposer = autorun(() =&gt; &#123;</span><br><span class="line">    console.log(counter.count)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// æ‰“å°: 1</span><br><span class="line">counter.count++</span><br><span class="line"></span><br><span class="line">// åœæ­¢ autorun.</span><br><span class="line">disposer()</span><br><span class="line"></span><br><span class="line">// ä¸ä¼šæ‰“å°æ¶ˆæ¯.</span><br><span class="line">counter.count++</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ï¼Œä¸€æ—¦ä¸å†éœ€è¦è¿™äº›æ–¹æ³•ä¸­çš„å‰¯ä½œç”¨æ—¶ï¼Œè¯·åŠ¡å¿…è°ƒç”¨å®ƒä»¬æ‰€è¿”å›çš„ disposer å‡½æ•°ã€‚ å¦åˆ™å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p>
<p><code>reaction</code> å’Œ <code>autorun</code> ä¸­ effect å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° <code>reaction</code> ä¹Ÿå¯ä»¥è¢«ç”¨æ¥æå‰æŠŠ reaction æ¸…ç†æ‰ï¼ˆé€šè¿‡è°ƒç”¨ <code>reaction.dispose()</code>ï¼‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vat</span> &#123;</span><br><span class="line">    value = <span class="number">1.2</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vat = <span class="keyword">new</span> <span class="title class_">Vat</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OrderLine</span> &#123;</span><br><span class="line">    price = <span class="number">10</span></span><br><span class="line">    amount = <span class="number">1</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">makeAutoObservable</span>(<span class="variable language_">this</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿™ä¸ª autorun å°†ä¼šå’Œæœ¬ OrderLine å®ä¾‹ä¸€èµ·è¿›è¡Œ GC,</span></span><br><span class="line">        <span class="comment">// å› ä¸ºå®ƒåªä½¿ç”¨äº†æ¥è‡ª `this` çš„å¯è§‚å¯Ÿå¯¹è±¡.</span></span><br><span class="line">        <span class="comment">// æ‰€ä»¥ä¸ä¸€å®šéè¦åœ¨åˆ é™¤ OrderLine å®ä¾‹åç«‹åˆ»æŠŠå®ƒæ¸…ç†æ‰ã€‚</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">disposer1</span> = <span class="title function_">autorun</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">doSomethingWith</span>(<span class="variable language_">this</span>.<span class="property">price</span> * <span class="variable language_">this</span>.<span class="property">amount</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿™ä¸ª autorun å°†ä¸ä¼šå’Œæœ¬ OrderLine å®ä¾‹ä¸€èµ·è¿›è¡Œ GC,</span></span><br><span class="line">        <span class="comment">// å› ä¸º vat ä¿å­˜äº†å¯¹è¿™ä¸ª autorun çš„å¼•ç”¨ç”¨äºé€šçŸ¥æ”¹å˜,</span></span><br><span class="line">        <span class="comment">// è¿™æ ·åè¿‡æ¥åˆä¼šæŠŠ &#x27;this&#x27; ä¿å­˜åœ¨ä½œç”¨åŸŸä¸­ã€‚</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">disposer2</span> = <span class="title function_">autorun</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">doSomethingWith</span>(<span class="variable language_">this</span>.<span class="property">price</span> * <span class="variable language_">this</span>.<span class="property">amount</span> * vat.<span class="property">value</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">dispose</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// æ‰€ä»¥, ä¸ºäº†é¿å…å†…å­˜é—®é¢˜, å½“ä¸å†éœ€è¦ reactions ä¹‹å</span></span><br><span class="line">        <span class="comment">// åŠ¡å¿…è¦è°ƒç”¨ disposers.</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">disposer1</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">disposer2</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è°¨æ…åœ°ä½¿ç”¨-reactionsï¼"><a href="#è°¨æ…åœ°ä½¿ç”¨-reactionsï¼" class="headerlink" title="è°¨æ…åœ°ä½¿ç”¨ reactionsï¼"></a>è°¨æ…åœ°ä½¿ç”¨ reactionsï¼</h2><p>å°±åƒä¸Šé¢å·²ç»è¯´è¿‡çš„é‚£æ ·ï¼Œä½ ä¸ä¼šç»å¸¸åˆ›å»º reactionsã€‚ å¾ˆæœ‰å¯èƒ½ä½ çš„åº”ç”¨ç¨‹åºä¸ä¼šç›´æ¥ä½¿ç”¨è¿™äº› API ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œè€Œåªä¼šé€šè¿‡æ¯”å¦‚ä½¿ç”¨ mobx-react ç»‘å®šä¸­çš„ <code>observer</code> è¿™æ ·é—´æ¥çš„æ–¹å¼åˆ›å»ºå‡º reactionã€‚</p>
<p>åœ¨ä½ åˆ›å»º reaction ä¹‹å‰ï¼Œæœ€å¥½æ£€æŸ¥ä¸€ä¸‹å®ƒæ˜¯å¦ç¬¦åˆä¸‹é¢å‡ æ¡åŸåˆ™ï¼š</p>
<ol>
<li><strong>åªæœ‰åœ¨å¼•èµ·å‰¯ä½œç”¨çš„ä¸€æ–¹ä¸å‰¯ä½œç”¨ä¹‹é—´æ²¡æœ‰ç›´æ¥å…³ç³»çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨ reaction</strong>ï¼š å¦‚æœä¸€ä¸ªå‰¯ä½œç”¨ä¼šä¸ºäº†å“åº”å¾ˆå°çš„ä¸€ç»„ events æˆ– actions è€Œæ‰§è¡Œï¼Œé‚£ä¹ˆç›´æ¥ä»é‚£äº›ç‰¹å®šçš„ action ä¸­è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨é€šå¸¸ä¼šæ›´å®¹æ˜“ç†è§£ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŒ‰ä¸‹è¡¨å•æäº¤æŒ‰é’®ä¼šå¯¼è‡´ä¸€ä¸ª POST ç½‘ç»œè¯·æ±‚çš„å‘é€ï¼Œé‚£ä¹ˆä¸ºäº†å“åº” <code>onclick</code> äº‹ä»¶ï¼Œç›´æ¥è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨å°±ä¼šæ¯”é€šè¿‡ reaction é—´æ¥è§¦å‘æ›´å®¹æ˜“ç†è§£ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœä½ å¯¹è¡¨å•çŠ¶æ€çš„ä¸€åˆ‡ä¿®æ”¹æœ€åéƒ½ä¼šè¢«è‡ªåŠ¨å­˜å‚¨åˆ° localStorageï¼Œé‚£ä¹ˆä½¿ç”¨ä¸€ä¸ª reaction å¯èƒ½å°±ä¼šå¾ˆæœ‰å¸®åŠ©ï¼Œè¿™æ ·ä½ å°±ä¸ç”¨åœ¨æ¯ä¸ªç‹¬ç«‹çš„ <code>onChange</code> äº‹ä»¶ä¸­è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨äº†ã€‚</li>
<li><strong>reactions ä¸åº”è¯¥æ›´æ–°å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡</strong>ï¼šè¿™ä¸ª reaction æ˜¯å¦ä¼šä¿®æ”¹å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ï¼Ÿå¦‚æœç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œé‚£ä¹ˆä½ ä¸€èˆ¬åº”è¯¥æŠŠä½ æƒ³è¦æ›´æ–°çš„å¯è§‚å¯Ÿå¯¹è±¡æ³¨è§£ä¸º <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/computeds.html"><code>computed</code></a> å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå¾…åŠäº‹é¡¹çš„é›†åˆ <code>todos</code> å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆè¯·ä¸è¦ä½¿ç”¨ reaction æ¥è®¡ç®—å‰©ä½™å¾…åŠ <code>remainingTodos</code> çš„æ•°é‡ï¼Œè€Œè¦æŠŠ <code>remainingTodos</code> æ³¨è§£ä¸ºè®¡ç®—å€¼ã€‚è¿™å°†ä½¿å¾—ä»£ç æ›´å®¹æ˜“ç†è§£å’Œè°ƒè¯•ã€‚reaction ä¸åº”è¯¥è®¡ç®—ç”Ÿæˆæ–°çš„æ•°æ®ï¼Œè€Œåªåº”è¯¥è§¦å‘å‰¯ä½œç”¨ã€‚</li>
<li><strong>reactions åº”è¯¥æ˜¯ç‹¬ç«‹çš„</strong>ï¼šä½ çš„ä»£ç æ˜¯å¦ä¾èµ–å…¶ä»–å¿…é¡»é¦–å…ˆè¿è¡Œçš„ reactionï¼Ÿå¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œä½ å¯èƒ½è¿åäº†ç¬¬ä¸€æ¡è§„åˆ™ï¼Œ ä½ å¯ä»¥é€‰æ‹©å°†ä½ éœ€è¦åˆ›å»ºçš„æ–° reaction åˆå¹¶åˆ°å®ƒæ‰€ä¾èµ– reaction ä¸­ã€‚MobX å¹¶ä¸èƒ½ä¿è¯ reaction çš„æ‰§è¡Œé¡ºåºã€‚</li>
</ol>
<p>æœ‰äº›å®è·µå¹¶ä¸ç¬¦åˆä¸Šè¿°åŸåˆ™ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä»¬æ˜¯<em>åŸåˆ™</em>ï¼Œè€Œä¸æ˜¯<em>æ³•åˆ™</em>ã€‚ ä½†æ˜¯ï¼Œä¾‹å¤–æƒ…å†µå¾ˆå°‘è§ï¼Œåªæœ‰åœ¨ä¸‡ä¸å¾—å·²çš„æƒ…å†µä¸‹æ‰è¿åå®ƒä»¬ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/20/mobx%E7%9A%84%E4%BD%BF%E7%94%A8/" data-id="cl9770wpz0074k2oo6vn84zpq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-jestå¸¸è§é—®é¢˜è§£æ" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/19/jest%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90/" class="article-date">
  <time datetime="2022-09-19T20:55:59.000Z" itemprop="datePublished">2022-09-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">å•å…ƒæµ‹è¯•</a>â–º<a class="article-category-link" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/jest/">jest</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/19/jest%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90/">jestå¸¸è§é—®é¢˜è§£æ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="jest-â€˜beforeEachâ€™-is-not-defined-eslint-no-undef"><a href="#jest-â€˜beforeEachâ€™-is-not-defined-eslint-no-undef" class="headerlink" title="##jest â€˜beforeEachâ€™ is not defined .eslint no-undef"></a>##jest â€˜beforeEachâ€™ is not defined .eslint no-undef</h4><p><img src="https://img1.imgtp.com/2022/09/19/mkE2sSaP.png" alt="QQæˆªå›¾20220919211238.png"></p>
<p>éœ€è¦åœ¨.eslintrcæ–‡ä»¶åŠ ä¸Šè¿™ä¸€æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;overrides&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;files&quot;: [</span><br><span class="line">        &quot;**/*.spec.js&quot;,</span><br><span class="line">        &quot;**/*.spec.jsx&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;env&quot;: &#123;</span><br><span class="line">        &quot;jest&quot;: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/19/jest%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90/" data-id="cl9770wmg000tk2oo7rvydwit" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰ç¬¬å…­ç« é“¾è¡¨" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E5%85%AD%E7%AB%A0%E9%93%BE%E8%A1%A8/" class="article-date">
  <time datetime="2022-09-17T13:46:40.000Z" itemprop="datePublished">2022-09-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E5%85%AD%E7%AB%A0%E9%93%BE%E8%A1%A8/">å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰ç¬¬å…­ç« é“¾è¡¨</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E5%85%AD%E7%AB%A0%E9%93%BE%E8%A1%A8/" data-id="cl9770wni0023k2oohfhdappf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰ç¬¬äº”ç« -é˜Ÿåˆ—ä¸åŒç«¯é˜Ÿåˆ—" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E4%BA%94%E7%AB%A0-%E9%98%9F%E5%88%97%E4%B8%8E%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/" class="article-date">
  <time datetime="2022-09-17T00:07:31.000Z" itemprop="datePublished">2022-09-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E4%BA%94%E7%AB%A0-%E9%98%9F%E5%88%97%E4%B8%8E%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/">å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰ç¬¬äº”ç«  é˜Ÿåˆ—ä¸åŒç«¯é˜Ÿåˆ—</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—" class="headerlink" title="##é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—"></a>##é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Queue</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * é¦–å…ˆéœ€è¦ä¸€ä¸ªç”¨äºå­˜å‚¨é˜Ÿåˆ—ä¸­å…ƒç´ çš„æ•°æ®ç»“æ„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„ï¼Œå°±åƒä¸Šä¸€ç« çš„ Stack</span></span><br><span class="line"><span class="comment">ç±»é‚£æ ·ã€‚ä½†æ˜¯ï¼Œä¸ºäº†å†™å‡ºä¸€ä¸ªåœ¨è·å–å…ƒç´ æ—¶æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡æ¥å­˜å‚¨æˆ‘ä»¬</span></span><br><span class="line"><span class="comment">çš„å…ƒç´ ï¼ˆè¡Œ&#123;3&#125;ï¼‰ã€‚ä½ ä¼šå‘ç° Queue ç±»å’Œ Stack ç±»éå¸¸ç±»ä¼¼ï¼Œåªæ˜¯æ·»åŠ å’Œç§»é™¤å…ƒç´ çš„åŸåˆ™ä¸åŒ</span></span><br><span class="line"><span class="comment">ä¹Ÿå¯ä»¥å£°æ˜ä¸€ä¸ª count å±æ€§æ¥å¸®åŠ©æˆ‘ä»¬æ§åˆ¶é˜Ÿåˆ—çš„å¤§å°ï¼ˆè¡Œ&#123;1&#125;ï¼‰ã€‚æ­¤å¤–ï¼Œç”±äºæˆ‘ä»¬å°†è¦ä»é˜Ÿ</span></span><br><span class="line"><span class="comment">åˆ—å‰ç«¯ç§»é™¤å…ƒç´ ï¼ŒåŒæ ·éœ€è¦ä¸€ä¸ªå˜é‡æ¥å¸®åŠ©æˆ‘ä»¬è¿½è¸ªç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å› æ­¤ï¼Œå£°æ˜ä¸€ä¸ª lowestCount</span></span><br><span class="line"><span class="comment">å˜é‡ï¼ˆè¡Œ&#123;2&#125;ï¼‰</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lowestCount</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span> = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å‘é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰æ–°çš„é¡¹</span></span><br><span class="line">  <span class="title function_">enqueue</span>(<span class="params">...elements</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; elements.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span>] = elements[i];</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç§»é™¤é˜Ÿåˆ—çš„ç¬¬ä¸€é¡¹ï¼ˆå³æ’åœ¨é˜Ÿåˆ—æœ€å‰é¢çš„é¡¹ï¼‰å¹¶è¿”å›è¢«ç§»é™¤çš„å…ƒç´ </span></span><br><span class="line">  <span class="title function_">dequeue</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">count</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> result = <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>];</span><br><span class="line">    <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lowestCount</span>++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¿”å›é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ â€”â€”æœ€å…ˆè¢«æ·»åŠ ï¼Œä¹Ÿå°†æ˜¯æœ€å…ˆè¢«ç§»é™¤çš„å…ƒç´ ã€‚é˜Ÿåˆ—ä¸åš</span></span><br><span class="line">  <span class="comment">// ä»»ä½•å˜åŠ¨ï¼ˆä¸ç§»é™¤å…ƒç´ ï¼Œåªè¿”å›å…ƒç´ ä¿¡æ¯â€”â€”ä¸ Stack ç±»çš„ peek æ–¹æ³•éå¸¸ç±»ä¼¼ï¼‰ã€‚è¯¥æ–¹</span></span><br><span class="line">  <span class="comment">// æ³•åœ¨å…¶ä»–è¯­è¨€ä¸­ä¹Ÿå¯ä»¥å«ä½œ front æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">peek</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">count</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å¦‚æœé˜Ÿåˆ—ä¸­ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line">  <span class="title function_">isEmpty</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">count</span> - <span class="variable language_">this</span>.<span class="property">lowestCount</span> === <span class="number">0</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¿”å›é˜Ÿåˆ—åŒ…å«çš„å…ƒç´ ä¸ªæ•°ï¼Œä¸æ•°ç»„çš„ length å±æ€§ç±»ä¼¼</span></span><br><span class="line">  <span class="title function_">size</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">count</span> - <span class="variable language_">this</span>.<span class="property">lowestCount</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">clear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lowestCount</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span> = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">    str = <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">lowestCount</span> + <span class="number">1</span>; i &lt; <span class="variable language_">this</span>.<span class="property">count</span>; i++) &#123;</span><br><span class="line">      str += <span class="string">`,<span class="subst">$&#123;<span class="variable language_">this</span>.items[i]&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const queue = new Queue();</span></span><br><span class="line"><span class="comment">// console.log(queue.isEmpty()); // è¾“å‡º true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// queue.enqueue(&quot;John&quot;);</span></span><br><span class="line"><span class="comment">// queue.enqueue(&quot;Jack&quot;);</span></span><br><span class="line"><span class="comment">// console.log(queue.toString()); // John,Jack</span></span><br><span class="line"><span class="comment">// queue.enqueue(&quot;Camila&quot;);</span></span><br><span class="line"><span class="comment">// console.log(queue.toString()); // John, Jack, Camila</span></span><br><span class="line"><span class="comment">// console.log(queue.size()); // è¾“å‡º 3</span></span><br><span class="line"><span class="comment">// console.log(queue.isEmpty()); // è¾“å‡º false</span></span><br><span class="line"><span class="comment">// queue.dequeue(); // ç§»é™¤ John</span></span><br><span class="line"><span class="comment">// queue.dequeue(); // ç§»é™¤ Jack</span></span><br><span class="line"><span class="comment">// console.log(queue.toString()); // Camila</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Queue</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="åŒç«¯é˜Ÿåˆ—æ•°æ®ç»“æ„"><a href="#åŒç«¯é˜Ÿåˆ—æ•°æ®ç»“æ„" class="headerlink" title="åŒç«¯é˜Ÿåˆ—æ•°æ®ç»“æ„"></a>åŒç«¯é˜Ÿåˆ—æ•°æ®ç»“æ„</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Deque</span> &#123;</span><br><span class="line">  <span class="comment">// åŒç«¯é˜Ÿåˆ—ï¼Œéµå¾ªå…ˆè¿›å…ˆå‡ºå’Œåè¿›å…ˆå‡º</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span> = &#123;&#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lowestCount</span> = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">isEmpty</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">count</span> - <span class="variable language_">this</span>.<span class="property">lowestCount</span> === <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">clear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span> = &#123;&#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lowestCount</span> = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">size</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">count</span> - <span class="variable language_">this</span>.<span class="property">lowestCount</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    str = <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">lowestCount</span> + <span class="number">1</span>; i &lt; <span class="variable language_">this</span>.<span class="property">count</span>; i++) &#123;</span><br><span class="line">      str += <span class="string">`,<span class="subst">$&#123;<span class="variable language_">this</span>.items[i]&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¯¥æ–¹æ³•åœ¨åŒç«¯é˜Ÿåˆ—å‰ç«¯æ·»åŠ æ–°çš„å…ƒç´ </span></span><br><span class="line">  <span class="title function_">addFront</span>(<span class="params">element</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">addBack</span>(element);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">lowestCount</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">lowestCount</span>--;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>] = element;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">count</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">items</span>[i] = <span class="variable language_">this</span>.<span class="property">items</span>[i - <span class="number">1</span>];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">items</span>[<span class="number">0</span>] = element;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">lowestCount</span> = <span class="number">0</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯¥æ–¹æ³•åœ¨åŒç«¯é˜Ÿåˆ—åç«¯æ·»åŠ æ–°çš„å…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Queue ç±»ä¸­çš„enqueue æ–¹æ³•ç›¸åŒï¼‰</span></span><br><span class="line">  <span class="title function_">addBack</span>(<span class="params">element</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span>] = element;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span>++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¯¥æ–¹æ³•ä¼šä»åŒç«¯é˜Ÿåˆ—å‰ç«¯ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Queue ç±»ä¸­çš„dequeue æ–¹æ³•ç›¸åŒï¼‰</span></span><br><span class="line">  <span class="title function_">removeFront</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>];</span><br><span class="line">    <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lowestCount</span>++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//è¯¥æ–¹æ³•ä¼šä»åŒç«¯é˜Ÿåˆ—åç«¯ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Stack ç±»ä¸­çš„pop æ–¹æ³•ä¸€æ ·ï¼‰ã€‚</span></span><br><span class="line">  <span class="title function_">removeBack</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span>--;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> result = <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯¥æ–¹æ³•è¿”å›åŒç«¯é˜Ÿåˆ—å‰ç«¯çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Queue ç±»ä¸­çš„ peekæ–¹æ³•ä¸€æ ·ï¼‰ã€‚</span></span><br><span class="line">  <span class="title function_">peekFront</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">lowestCount</span>];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯¥æ–¹æ³•è¿”å›åŒç«¯é˜Ÿåˆ—åç«¯çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Stack ç±»ä¸­çš„ peekæ–¹æ³•ä¸€æ ·ï¼‰</span></span><br><span class="line">  <span class="title function_">peekBack</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const deque = new Deque();</span></span><br><span class="line"><span class="comment">// console.log(deque.isEmpty()); // è¾“å‡º true</span></span><br><span class="line"><span class="comment">// deque.addBack(&quot;John&quot;);</span></span><br><span class="line"><span class="comment">// deque.addBack(&quot;Jack&quot;);</span></span><br><span class="line"><span class="comment">// console.log(deque.toString()); // John, Jack</span></span><br><span class="line"><span class="comment">// deque.addBack(&quot;Camila&quot;);</span></span><br><span class="line"><span class="comment">// console.log(deque.toString()); // John, Jack, Camila</span></span><br><span class="line"><span class="comment">// console.log(deque.size()); // è¾“å‡º 3</span></span><br><span class="line"><span class="comment">// console.log(deque.isEmpty()); // è¾“å‡º false</span></span><br><span class="line"><span class="comment">// deque.removeFront(); // ç§»é™¤ John</span></span><br><span class="line"><span class="comment">// console.log(deque.toString()); // Jack, Camila</span></span><br><span class="line"><span class="comment">// deque.removeBack(); // Camila å†³å®šç¦»å¼€</span></span><br><span class="line"><span class="comment">// console.log(deque.toString()); // Jack</span></span><br><span class="line"><span class="comment">// deque.addFront(&quot;John&quot;); // John å›æ¥è¯¢é—®ä¸€äº›ä¿¡æ¯</span></span><br><span class="line"><span class="comment">// console.log(deque.toString()); // John, Jack</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Deque</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—æ¥è§£å†³é—®é¢˜"><a href="#ä½¿ç”¨é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—æ¥è§£å†³é—®é¢˜" class="headerlink" title="ä½¿ç”¨é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—æ¥è§£å†³é—®é¢˜"></a>ä½¿ç”¨é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—æ¥è§£å†³é—®é¢˜</h4><h5 id="å¾ªç¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±æ¸¸æˆ"><a href="#å¾ªç¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±æ¸¸æˆ" class="headerlink" title="å¾ªç¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±æ¸¸æˆ"></a>å¾ªç¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±æ¸¸æˆ</h5><p>è¿™å…¶ä¸­çš„ä¸€ç§å«ä½œå¾ªç¯é˜Ÿåˆ—ã€‚å¾ªç¯é˜Ÿåˆ—çš„ä¸€ä¸ªä¾‹å­å°±æ˜¯å‡»é¼“ä¼ èŠ±æ¸¸æˆï¼ˆhot  potatoï¼‰ã€‚åœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œå­©å­ä»¬å›´æˆä¸€ä¸ªåœ†åœˆï¼ŒæŠŠèŠ±å°½å¿«åœ°ä¼ é€’ç»™æ—è¾¹çš„äººã€‚æŸä¸€æ—¶åˆ»ä¼ èŠ±åœæ­¢ï¼Œ è¿™ä¸ªæ—¶å€™èŠ±åœ¨è°æ‰‹é‡Œï¼Œè°å°±é€€å‡ºåœ†åœˆã€ç»“æŸæ¸¸æˆã€‚é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°åªå‰©ä¸€ä¸ªå­©å­ï¼ˆèƒœè€…ï¼‰ã€‚</p>
<p>å®ç°ä¸€ä¸ªæ¨¡æ‹Ÿçš„å‡»é¼“ä¼ èŠ±æ¸¸æˆï¼Œè¦ç”¨åˆ°æœ¬ç« å¼€å¤´å®ç°çš„ Queue ç±»ï¼ˆè¡Œ{1}ï¼‰ã€‚æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ ä»½åå•ï¼ŒæŠŠé‡Œé¢çš„åå­—å…¨éƒ½åŠ å…¥é˜Ÿåˆ—ï¼ˆè¡Œ{2}ï¼‰ã€‚ç»™å®šä¸€ä¸ªæ•°å­—ï¼Œç„¶åè¿­ä»£é˜Ÿåˆ—ã€‚ä»é˜Ÿåˆ—å¼€å¤´ç§» é™¤ä¸€é¡¹ï¼Œå†å°†å…¶æ·»åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ï¼ˆè¡Œ{3}ï¼‰ï¼Œæ¨¡æ‹Ÿå‡»é¼“ä¼ èŠ±ï¼ˆå¦‚æœä½ æŠŠèŠ±ä¼ ç»™äº†æ—è¾¹çš„äººï¼Œä½ è¢« æ·˜æ±°çš„å¨èƒå°±ç«‹åˆ»è§£é™¤äº†ï¼‰ã€‚ä¸€æ—¦è¾¾åˆ°ç»™å®šçš„ä¼ é€’æ¬¡æ•°ï¼Œæ‹¿ç€èŠ±çš„é‚£ä¸ªäººå°±è¢«æ·˜æ±°äº†ï¼ˆä»é˜Ÿåˆ—ä¸­ ç§»é™¤â€”â€”è¡Œ{4}ï¼‰ã€‚æœ€ååªå‰©ä¸‹ä¸€ä¸ªäººçš„æ—¶å€™ï¼Œè¿™ä¸ªäººå°±æ˜¯èƒœè€…ï¼ˆè¡Œ{5}ï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Queue</span> <span class="keyword">from</span> <span class="string">&quot;./Queue.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hotPotato</span>(<span class="params">elementsList, num</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> queue = <span class="keyword">new</span> <span class="title class_">Queue</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> elimitatedList = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; elementsList.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    queue.<span class="title function_">enqueue</span>(elementsList[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(queue.<span class="title function_">toString</span>(), <span class="string">&quot;----&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> (queue.<span class="title function_">size</span>() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">      queue.<span class="title function_">enqueue</span>(queue.<span class="title function_">dequeue</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    elimitatedList.<span class="title function_">push</span>(queue.<span class="title function_">dequeue</span>());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">winner</span>: queue.<span class="title function_">dequeue</span>(),</span><br><span class="line">    <span class="attr">eliminated</span>: elimitatedList,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> names = [<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;Camila&quot;</span>, <span class="string">&quot;Ingrid&quot;</span>, <span class="string">&quot;Carl&quot;</span>];</span><br><span class="line"><span class="keyword">const</span> result = <span class="title function_">hotPotato</span>(names, <span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">result.<span class="property">eliminated</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span>åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`èƒœåˆ©è€…ï¼š <span class="subst">$&#123;result.winner&#125;</span>`</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šç®—æ³•çš„è¾“å‡ºå¦‚ä¸‹ã€‚</p>
<p> Camila åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚</p>
<p> Jack åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚</p>
<p> Carl åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚</p>
<p> Ingrid åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚ </p>
<p> èƒœåˆ©è€…ï¼šJohn</p>
<h5 id="å›æ–‡æ£€æŸ¥å™¨"><a href="#å›æ–‡æ£€æŸ¥å™¨" class="headerlink" title="å›æ–‡æ£€æŸ¥å™¨"></a>å›æ–‡æ£€æŸ¥å™¨</h5><p>ä¸‹é¢æ˜¯ç»´åŸºç™¾ç§‘å¯¹å›æ–‡çš„è§£é‡Šã€‚ å›æ–‡æ˜¯æ­£åéƒ½èƒ½è¯»é€šçš„å•è¯ã€è¯ç»„ã€æ•°æˆ–ä¸€ç³»åˆ—å­—ç¬¦çš„åºåˆ—ï¼Œä¾‹å¦‚ madamæˆ– racecarã€‚ æœ‰ä¸åŒçš„ç®—æ³•å¯ä»¥æ£€æŸ¥ä¸€ä¸ªè¯ç»„æˆ–å­—ç¬¦ä¸²æ˜¯å¦ä¸ºå›æ–‡ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯å°†å­—ç¬¦ä¸²åå‘æ’åˆ—å¹¶ æ£€æŸ¥å®ƒå’ŒåŸå­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªå›æ–‡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ ˆæ¥å®Œæˆï¼Œä½† æ˜¯åˆ©ç”¨æ•°æ®ç»“æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨åŒç«¯é˜Ÿåˆ—</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Deque</span> <span class="keyword">from</span> <span class="string">&quot;./Deque.js&quot;</span>;</span><br><span class="line"><span class="comment">// å›æ–‡å­—ç¬¦ä¸²æ£€æµ‹</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">palindromeChecker</span>(<span class="params">aString</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (aString == <span class="literal">null</span> || (aString != <span class="literal">null</span> &amp;&amp; aString.<span class="property">length</span> === <span class="number">0</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰å°±è¿”å›</span></span><br><span class="line">  <span class="keyword">let</span> isEqual = <span class="literal">true</span>;</span><br><span class="line">  <span class="comment">// è·å¾—ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">  <span class="keyword">let</span> firstChar, lastChar;</span><br><span class="line">  <span class="keyword">const</span> deque = <span class="keyword">new</span> <span class="title class_">Deque</span>();</span><br><span class="line">  <span class="comment">// å…ˆå°†å­—ç¬¦ä¸²è½¬æˆå°å†™ç„¶åå†å»æ‰ç©ºæ ¼é‡æ–°æ‹¼æ¥</span></span><br><span class="line">  aString = aString.<span class="title function_">toLocaleLowerCase</span>().<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>).<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(aString);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; aString.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    deque.<span class="title function_">addBack</span>(aString.<span class="title function_">charAt</span>(i));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// whileå¾ªç¯æ‹¿åˆ°ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªè¿›è¡Œæ¯”è¾ƒï¼Œåªæœ‰åœ¨isEqualä¸ºtrueæ‰ç»§ç»­æ¯”å¥¥,åªæœ‰ä¸€ä¸ªçš„æ—¶å€™è·³å‡º</span></span><br><span class="line">  <span class="keyword">while</span> (deque.<span class="title function_">size</span>() &gt; <span class="number">1</span> &amp;&amp; isEqual) &#123;</span><br><span class="line">    firstChar = deque.<span class="title function_">removeFront</span>();</span><br><span class="line">    lastChar = deque.<span class="title function_">removeBack</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (lastChar !== firstChar) &#123;</span><br><span class="line">      isEqual = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> isEqual;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å…¨æ˜¯true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;a&quot;</span>, <span class="title function_">palindromeChecker</span>(<span class="string">&quot;a&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;aa&quot;</span>, <span class="title function_">palindromeChecker</span>(<span class="string">&quot;aa&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;kayak&quot;</span>, <span class="title function_">palindromeChecker</span>(<span class="string">&quot;kayak&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;level&quot;</span>, <span class="title function_">palindromeChecker</span>(<span class="string">&quot;level&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">  <span class="string">&quot;Was it a car or a cat I saw&quot;</span>,</span><br><span class="line">  <span class="title function_">palindromeChecker</span>(<span class="string">&quot;Was it a car or a cat I saw&quot;</span>)</span><br><span class="line">);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Step on no pets&quot;</span>, <span class="title function_">palindromeChecker</span>(<span class="string">&quot;Step on no pets&quot;</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨æˆ‘ä»¬å¼€å§‹è§£é‡Šç®—æ³•é€»è¾‘ä¹‹å‰ï¼Œéœ€è¦æ£€æŸ¥ä¼ å…¥çš„å­—ç¬¦ä¸²å‚æ•°æ˜¯å¦åˆæ³•ï¼ˆè¡Œ{1}ï¼‰ã€‚å¦‚æœä¸åˆ æ³•ï¼Œæˆ‘ä»¬è¿”å› falseã€‚ å¯¹äºè¿™ä¸ªç®—æ³•ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åœ¨æœ¬ç« å®ç°çš„ Deque ç±»ï¼ˆè¡Œ{2}ï¼‰ã€‚ç”±äºå¯èƒ½æ¥æ”¶åˆ°åŒæ—¶åŒ…å«å¤§ å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬ä¼šå°†æ‰€æœ‰å­—æ¯è½¬åŒ–ä¸ºå°å†™ï¼ŒåŒæ—¶ç§»é™¤æ‰€æœ‰çš„ç©ºæ ¼ï¼ˆè¡Œ{3}ï¼‰ã€‚å¦‚æœä½ æ„¿æ„ï¼Œ ä¹Ÿå¯ä»¥ç§»é™¤æ‰€æœ‰çš„ç‰¹æ®Šå­—ç¬¦ï¼Œä¾‹å¦‚!ã€?ã€-ã€(å’Œ)ç­‰ã€‚ä¸ºäº†ä¿è¯ç®—æ³•ç®€æ´ï¼Œæˆ‘ä»¬ä¼šè·³è¿‡è¿™éƒ¨åˆ†ã€‚ ç„¶åï¼Œæˆ‘ä»¬ä¼šå¯¹å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦æ‰§è¡Œ enqueue æ“ä½œï¼ˆè¡Œ{4}ï¼‰ã€‚å¦‚æœæ‰€æœ‰å…ƒç´ éƒ½åœ¨åŒç«¯ é˜Ÿåˆ—ä¸­ï¼ˆå¦‚æœåªæœ‰ä¸€ä¸ªå­—ç¬¦çš„è¯ï¼Œé‚£å®ƒè‚¯å®šæ˜¯å›æ–‡ï¼‰å¹¶ä¸”é¦–å°¾å­—ç¬¦ç›¸åŒçš„è¯ï¼ˆè¡Œ{5}ï¼‰ï¼Œæˆ‘ä»¬å°† ä»å‰ç«¯ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼ˆè¡Œ{6}ï¼‰ï¼Œå†ä»åç«¯ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼ˆè¡Œ{7}ï¼‰ã€‚è¦ä½¿å­—ç¬¦ä¸²ä¸ºå›æ–‡ï¼Œç§»é™¤çš„ ä¸¤ä¸ªå­—ç¬¦å¿…é¡»ç›¸åŒã€‚å¦‚æœå­—ç¬¦ä¸åŒçš„è¯ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±ä¸æ˜¯ä¸€ä¸ªå›æ–‡ï¼ˆè¡Œ{8}ï¼‰</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E4%BA%94%E7%AB%A0-%E9%98%9F%E5%88%97%E4%B8%8E%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/" data-id="cl9770wnh0021k2oo16b211zl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-jestå­¦ä¹ ç¬”è®°" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/16/jest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="article-date">
  <time datetime="2022-09-16T13:43:47.000Z" itemprop="datePublished">2022-09-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">å•å…ƒæµ‹è¯•</a>â–º<a class="article-category-link" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/jest/">jest</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/16/jest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">jestå­¦ä¹ ç¬”è®°</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="Jestå®‰è£…"><a href="#Jestå®‰è£…" class="headerlink" title="##Jestå®‰è£…"></a>##Jestå®‰è£…</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev jest</span><br></pre></td></tr></table></figure>

<h4 id="å¸¸è§çš„åŒ¹é…å™¨"><a href="#å¸¸è§çš„åŒ¹é…å™¨" class="headerlink" title="å¸¸è§çš„åŒ¹é…å™¨"></a>å¸¸è§çš„åŒ¹é…å™¨</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;two plus two is four&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="number">2</span> + <span class="number">2</span>).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>toBe</code>ä½¿ç”¨ <code>Object.is</code>æ¥è¿›è¡Œç²¾å‡†åŒ¹é…çš„æµ‹è¯•ã€‚ å¦‚æœæ‚¨æƒ³è¦æ£€æŸ¥å¯¹è±¡çš„å€¼ï¼Œè¯·ä½¿ç”¨ <code>toEqual</code> ä»£æ›¿ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;å¯¹è±¡èµ‹å€¼&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> data = &#123;<span class="attr">one</span>: <span class="number">1</span>&#125;;</span><br><span class="line">  data[<span class="string">&#x27;two&#x27;</span>] = <span class="number">2</span>;</span><br><span class="line">  <span class="title function_">expect</span>(data).<span class="title function_">toEqual</span>(&#123;<span class="attr">one</span>: <span class="number">1</span>, <span class="attr">two</span>: <span class="number">2</span>&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>toEqual</code> é€’å½’æ£€æŸ¥å¯¹è±¡æˆ–æ•°ç»„çš„æ¯ä¸ªå­—æ®µ</p>
<h5 id="çœŸå€¼"><a href="#çœŸå€¼" class="headerlink" title="çœŸå€¼"></a>çœŸå€¼</h5><p>ä»£ç ä¸­çš„<code>undefined</code>, <code>null</code>, and <code>false</code>æœ‰ä¸åŒå«ä¹‰ï¼Œè‹¥ä½ åœ¨æµ‹è¯•æ—¶ä¸æƒ³åŒºåˆ†ä»–ä»¬ï¼Œå¯ä»¥ç”¨çœŸå€¼åˆ¤æ–­ã€‚ Jestæä¾›helpersä¾›ä½ ä½¿ç”¨ã€‚</p>
<ul>
<li><code>toBeNull</code> åªåŒ¹é… <code>null</code></li>
<li><code>toBeUndefined</code> åªåŒ¹é… <code>undefined</code></li>
<li><code>toBeDefined</code> ä¸ <code>toBeUndefined</code> ç›¸å</li>
<li><code>toBeTruthy</code> åŒ¹é…ä»»ä½• <code>if</code> è¯­å¥ä¸ºçœŸ</li>
<li><code>toBeFalsy</code> åŒ¹é…ä»»ä½• <code>if</code> è¯­å¥ä¸ºå‡</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;null&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> n = <span class="literal">null</span>;</span><br><span class="line">  <span class="title function_">expect</span>(n).<span class="title function_">toBeNull</span>();</span><br><span class="line">  <span class="title function_">expect</span>(n).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  <span class="title function_">expect</span>(n).<span class="property">not</span>.<span class="title function_">toBeUndefined</span>();</span><br><span class="line">  <span class="title function_">expect</span>(n).<span class="property">not</span>.<span class="title function_">toBeTruthy</span>();</span><br><span class="line">  <span class="title function_">expect</span>(n).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;zero&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> z = <span class="number">0</span>;</span><br><span class="line">  <span class="title function_">expect</span>(z).<span class="property">not</span>.<span class="title function_">toBeNull</span>();</span><br><span class="line">  <span class="title function_">expect</span>(z).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  <span class="title function_">expect</span>(z).<span class="property">not</span>.<span class="title function_">toBeUndefined</span>();</span><br><span class="line">  <span class="title function_">expect</span>(z).<span class="property">not</span>.<span class="title function_">toBeTruthy</span>();</span><br><span class="line">  <span class="title function_">expect</span>(z).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="æ•°å­—"><a href="#æ•°å­—" class="headerlink" title="æ•°å­—"></a>æ•°å­—</h5><p>å¤§å¤šæ•°çš„æ¯”è¾ƒæ•°å­—æœ‰ç­‰ä»·çš„åŒ¹é…å™¨</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;two plus two&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> value = <span class="number">2</span> + <span class="number">2</span>;</span><br><span class="line">  <span class="title function_">expect</span>(value).<span class="title function_">toBeGreaterThan</span>(<span class="number">3</span>);<span class="comment">//å¤§äº</span></span><br><span class="line">  <span class="title function_">expect</span>(value).<span class="title function_">toBeGreaterThanOrEqual</span>(<span class="number">3.5</span>);<span class="comment">//å¤§äºç­‰äº</span></span><br><span class="line">  <span class="title function_">expect</span>(value).<span class="title function_">toBeLessThan</span>(<span class="number">5</span>);<span class="comment">//å°äº</span></span><br><span class="line">  <span class="title function_">expect</span>(value).<span class="title function_">toBeLessThanOrEqual</span>(<span class="number">4.5</span>);<span class="comment">//å°äºç­‰äº</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// toBe and toEqual are equivalent for numbers</span></span><br><span class="line">  <span class="title function_">expect</span>(value).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">  <span class="title function_">expect</span>(value).<span class="title function_">toEqual</span>(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å¯¹äºæ¯”è¾ƒæµ®ç‚¹æ•°ç›¸ç­‰ï¼Œä½¿ç”¨ <code>toBeCloseTo</code> è€Œä¸æ˜¯ <code>toEqual</code>ï¼Œå› ä¸ºä½ ä¸å¸Œæœ›æµ‹è¯•å–å†³äºä¸€ä¸ªå°å°çš„èˆå…¥è¯¯å·®ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;ä¸¤ä¸ªæµ®ç‚¹æ•°å­—ç›¸åŠ &#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> value = <span class="number">0.1</span> + <span class="number">0.2</span>;</span><br><span class="line">  <span class="comment">//expect(value).toBe(0.3);           è¿™å¥ä¼šæŠ¥é”™ï¼Œå› ä¸ºæµ®ç‚¹æ•°æœ‰èˆå…¥è¯¯å·®</span></span><br><span class="line">  <span class="title function_">expect</span>(value).<span class="title function_">toBeCloseTo</span>(<span class="number">0.3</span>); <span class="comment">// è¿™å¥å¯ä»¥è¿è¡Œ</span></span><br><span class="line">&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h5><p>æ‚¨å¯ä»¥æ£€æŸ¥å¯¹å…·æœ‰ <code>toMatch</code> æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ï¸°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;there is no I in team&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="string">&#x27;team&#x27;</span>).<span class="property">not</span>.<span class="title function_">toMatch</span>(<span class="regexp">/I/</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;but there is a &quot;stop&quot; in Christoph&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="string">&#x27;Christoph&#x27;</span>).<span class="title function_">toMatch</span>(<span class="regexp">/stop/</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡"><a href="#æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡" class="headerlink" title="æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡"></a>æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡</h5><p> <code>toContain</code>æ¥æ£€æŸ¥ä¸€ä¸ªæ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡æ˜¯å¦åŒ…å«æŸä¸ªç‰¹å®šé¡¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shoppingList = [</span><br><span class="line">  <span class="string">&#x27;diapers&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;kleenex&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;trash bags&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;paper towels&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;milk&#x27;</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;shoppingListæ•°ç»„ä¸­åŒ…å«milk&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(shoppingList).<span class="title function_">toContain</span>(<span class="string">&#x27;milk&#x27;</span>);</span><br><span class="line">  <span class="title function_">expect</span>(<span class="keyword">new</span> <span class="title class_">Set</span>(shoppingList)).<span class="title function_">toContain</span>(<span class="string">&#x27;milk&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="thorw"><a href="#thorw" class="headerlink" title="thorw"></a>thorw</h5><p>ä½ æƒ³æµ‹è¯•æŸå‡½æ•°åœ¨è°ƒç”¨æ—¶æ˜¯å¦æŠ›å‡ºäº†é”™è¯¯ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>toThrow</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compileAndroidCode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;you are using the wrong JDK&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;compiling android goes as expected&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="function">() =&gt;</span> <span class="title function_">compileAndroidCode</span>()).<span class="title function_">toThrow</span>();</span><br><span class="line">  <span class="title function_">expect</span>(<span class="function">() =&gt;</span> <span class="title function_">compileAndroidCode</span>()).<span class="title function_">toThrow</span>(<span class="title class_">Error</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½ å¯ä»¥è‡ªå·±å®šä¹‰ç¡®åˆ‡çš„é”™è¯¯æ¶ˆæ¯å†…å®¹æˆ–è€…ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">  <span class="title function_">expect</span>(<span class="function">() =&gt;</span> <span class="title function_">compileAndroidCode</span>()).<span class="title function_">toThrow</span>(<span class="string">&#x27;you are using the wrong JDK&#x27;</span>);</span><br><span class="line">  <span class="title function_">expect</span>(<span class="function">() =&gt;</span> <span class="title function_">compileAndroidCode</span>()).<span class="title function_">toThrow</span>(<span class="regexp">/JDK/</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="æµ‹è¯•å¼‚æ­¥ä»£ç "><a href="#æµ‹è¯•å¼‚æ­¥ä»£ç " class="headerlink" title="æµ‹è¯•å¼‚æ­¥ä»£ç "></a>æµ‹è¯•å¼‚æ­¥ä»£ç </h4><h5 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h5><p>ä¸ºä½ çš„æµ‹è¯•è¿”å›ä¸€ä¸ªPromiseï¼Œåˆ™Jestä¼šç­‰å¾…Promiseçš„resoveçŠ¶æ€ å¦‚æœ Promise çš„çŠ¶æ€å˜ä¸º rejected, æµ‹è¯•å°†ä¼šå¤±è´¥</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;the data is peanut butter&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetchData</span>().<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(data).<span class="title function_">toBe</span>(<span class="string">&#x27;peanut butter&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async/Await"></a>Async/Await</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;the data is peanut butter&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetchData</span>();</span><br><span class="line">  <span class="title function_">expect</span>(data).<span class="title function_">toBe</span>(<span class="string">&#x27;peanut butter&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;the fetch fails with an error&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  expect.<span class="title function_">assertions</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">fetchData</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="title function_">expect</span>(e).<span class="title function_">toMatch</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä½ ä¹Ÿå¯ä»¥å°† <code>async</code> and <code>await</code>å’Œ <code>.resolves</code> or <code>.rejects</code>ä¸€èµ·ä½¿ç”¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;the data is peanut butter&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">expect</span>(<span class="title function_">fetchData</span>()).<span class="property">resolves</span>.<span class="title function_">toBe</span>(<span class="string">&#x27;peanut butter&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;the fetch fails with an error&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">expect</span>(<span class="title function_">fetchData</span>()).<span class="property">rejects</span>.<span class="title function_">toMatch</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœŸæœ›Promiseè¢«Rejectï¼Œåˆ™éœ€è¦ä½¿ç”¨ <code>.catch</code> æ–¹æ³•ã€‚ è¯·ç¡®ä¿æ·»åŠ  <code>expect.assertions</code> æ¥éªŒè¯ä¸€å®šæ•°é‡çš„æ–­è¨€è¢«è°ƒç”¨ã€‚ å¦åˆ™ï¼Œä¸€ä¸ªfulfilledçŠ¶æ€çš„Promiseä¸ä¼šè®©æµ‹è¯•ç”¨ä¾‹å¤±è´¥ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;the fetch fails with an error&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect.<span class="title function_">assertions</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetchData</span>().<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="title function_">expect</span>(e).<span class="title function_">toMatch</span>(<span class="string">&#x27;error&#x27;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="æµ‹è¯•å›è°ƒå‡½æ•°"><a href="#æµ‹è¯•å›è°ƒå‡½æ•°" class="headerlink" title="æµ‹è¯•å›è°ƒå‡½æ•°"></a>æµ‹è¯•å›è°ƒå‡½æ•°</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;the data is peanut butter&#x27;</span>, <span class="function"><span class="params">done</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">callback</span>(<span class="params">error, data</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">      <span class="title function_">done</span>(error);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(data).<span class="title function_">toBe</span>(<span class="string">&#x27;peanut butter&#x27;</span>);</span><br><span class="line">      <span class="title function_">done</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="title function_">done</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">fetchData</span>(callback);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•å›è°ƒå‡½æ•°æ—¶ï¼Œéœ€è¦ä½¿ç”¨doneæ–¹æ³•ï¼Œä¸èƒ½ç›´æ¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå¦åˆ™æ²¡åŠæ³•æµ‹è¯•ï¼Œéœ€è¦ä½¿ç”¨ä¸Šä¸Šé¢çš„æ ¼å¼</p>
<h5 id="resolves-rejects"><a href="#resolves-rejects" class="headerlink" title=".resolves / .rejects"></a><code>.resolves</code> / <code>.rejects</code></h5><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ <code>.resolves</code> åŒ¹é…å™¨åœ¨æ‚¨æœŸæœ›çš„å£°æ˜ï¼ŒJest ä¼šç­‰å¾…è¿™ä¸€ Promise æ¥è§£å†³ã€‚ å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™æµ‹è¯•å°†è‡ªåŠ¨å¤±è´¥ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test(&#x27;the data is peanut butter&#x27;, () =&gt; &#123;</span><br><span class="line">  return expect(fetchData()).resolves.toBe(&#x27;peanut butter&#x27;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å¿…é¡»è¦ä½¿ç”¨returnï¼Œåœ¨ <code>fetchData</code> è¿”å›çš„è¿™ä¸ª promise å˜æ›´ä¸º resolved çŠ¶æ€ã€then() æœ‰æœºä¼šæ‰§è¡Œä¹‹å‰ï¼Œæµ‹è¯•å°±å·²ç»è¢«è§†ä¸ºå·²ç»å®Œæˆäº†ã€‚</p>
<p>å¦‚æœä½ å¸Œæœ›Promiseè¿”å›rejectedï¼Œä½ éœ€è¦ä½¿ç”¨ <code>.rejects</code> åŒ¹é…å™¨ã€‚ å®ƒå’Œ <code>.resolves</code> åŒ¹é…å™¨æ˜¯ä¸€æ ·çš„ä½¿ç”¨æ–¹å¼ã€‚ å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™æµ‹è¯•å°†è‡ªåŠ¨å¤±è´¥ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test(&#x27;the fetch fails with an error&#x27;, () =&gt; &#123;</span><br><span class="line">  return expect(fetchData()).rejects.toMatch(&#x27;error&#x27;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="Jestçš„é’©å­å‡½æ•°"><a href="#Jestçš„é’©å­å‡½æ•°" class="headerlink" title="Jestçš„é’©å­å‡½æ•°"></a>Jestçš„é’©å­å‡½æ•°</h4><p>jestæœ‰4ä¸ªé’©å­å‡½æ•°</p>
<ul>
<li>beforeAll()é’©å­å‡½æ•°ä¼šåœ¨æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ä¹‹å‰æ‰§è¡Œ  åªä¼šæ‰§è¡Œä¸€æ¬¡</li>
<li>beforeEach()é’©å­å‡½æ•° ä¼šåœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œä¹‹å‰æ‰§è¡Œä¸€æ¬¡ï¼Œæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œå‰éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡</li>
<li>afterEach() é’©å­å‡½æ•°ä¼šåœ¨æ¯ä¸ªæµ‹è¯•ç”¨é‡Œæ‰§è¡Œå®Œä¹‹åæ‰§è¡Œæ‰§è¡Œä¸€æ¬¡</li>
<li>alfterAll() é’©å­å‡½æ•°ä¼šåœ¨æ‰€æœ‰ç”¨åŠ›æ‰§è¡Œå®Œåæ‰§è¡Œ</li>
</ul>
<h4 id="ç”Ÿæˆjesté…ç½®æ–‡ä»¶jest-config-js"><a href="#ç”Ÿæˆjesté…ç½®æ–‡ä»¶jest-config-js" class="headerlink" title="ç”Ÿæˆjesté…ç½®æ–‡ä»¶jest.config.js"></a>ç”Ÿæˆjesté…ç½®æ–‡ä»¶jest.config.js</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx jest --init</span><br></pre></td></tr></table></figure>

<h4 id="mockå‡½æ•°"><a href="#mockå‡½æ•°" class="headerlink" title="mockå‡½æ•°"></a>mockå‡½æ•°</h4><p>Mock å‡½æ•°å…è®¸ä½ æµ‹è¯•ä»£ç ä¹‹é—´çš„è¿æ¥â€”â€”å®ç°æ–¹å¼åŒ…æ‹¬ï¼šæ“¦é™¤å‡½æ•°çš„å®é™…å®ç°ã€æ•è·å¯¹å‡½æ•°çš„è°ƒç”¨ ( ä»¥åŠåœ¨è¿™äº›è°ƒç”¨ä¸­ä¼ é€’çš„å‚æ•°) ã€åœ¨ä½¿ç”¨ <code>new</code> å®ä¾‹åŒ–æ—¶æ•è·æ„é€ å‡½æ•°çš„å®ä¾‹ã€å…è®¸æµ‹è¯•æ—¶é…ç½®è¿”å›å€¼ã€‚</p>
<p>æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ¨¡æ‹Ÿå‡½æ•°ï¼šè¦ä¹ˆåœ¨æµ‹è¯•ä»£ç ä¸­åˆ›å»ºä¸€ä¸ª mock å‡½æ•°ï¼Œè¦ä¹ˆç¼–å†™ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://jestjs.io/zh-Hans/docs/manual-mocks"><code>æ‰‹åŠ¨ mock</code></a>æ¥è¦†ç›–æ¨¡å—ä¾èµ–ã€‚</p>
<h5 id="ä½¿ç”¨-mock-å‡½æ•°"><a href="#ä½¿ç”¨-mock-å‡½æ•°" class="headerlink" title="ä½¿ç”¨ mock å‡½æ•°"></a>ä½¿ç”¨ mock å‡½æ•°<a target="_blank" rel="noopener" href="https://jestjs.io/zh-Hans/docs/mock-functions#%E4%BD%BF%E7%94%A8-mock-%E5%87%BD%E6%95%B0"></a></h5><p>å‡è®¾æˆ‘ä»¬è¦æµ‹è¯•å‡½æ•° <code>forEach</code> çš„å†…éƒ¨å®ç°ï¼Œè¿™ä¸ªå‡½æ•°ä¸ºä¼ å…¥çš„æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function forEach(items, callback) &#123;</span><br><span class="line">  for (let index = 0; index &lt; items.length; index++) &#123;</span><br><span class="line">    callback(items[index]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†æµ‹è¯•æ­¤å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª mock å‡½æ•°ï¼Œç„¶åæ£€æŸ¥ mock å‡½æ•°çš„çŠ¶æ€æ¥ç¡®ä¿å›è°ƒå‡½æ•°å¦‚æœŸè°ƒç”¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mockCallback = jest.<span class="title function_">fn</span>(<span class="function"><span class="params">x</span> =&gt;</span> <span class="number">42</span> + x);</span><br><span class="line"><span class="title function_">forEach</span>([<span class="number">0</span>, <span class="number">1</span>], mockCallback);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤ mock å‡½æ•°è¢«è°ƒç”¨äº†ä¸¤æ¬¡</span></span><br><span class="line"><span class="title function_">expect</span>(mockCallback.<span class="property">mock</span>.<span class="property">calls</span>.<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨å‡½æ•°æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ 0</span></span><br><span class="line"><span class="title function_">expect</span>(mockCallback.<span class="property">mock</span>.<span class="property">calls</span>[<span class="number">0</span>][<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒæ¬¡è°ƒç”¨å‡½æ•°æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ 1</span></span><br><span class="line"><span class="title function_">expect</span>(mockCallback.<span class="property">mock</span>.<span class="property">calls</span>[<span class="number">1</span>][<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ¬¡å‡½æ•°è°ƒç”¨çš„è¿”å›å€¼æ˜¯ 42</span></span><br><span class="line"><span class="title function_">expect</span>(mockCallback.<span class="property">mock</span>.<span class="property">results</span>[<span class="number">0</span>].<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="number">42</span>);</span><br></pre></td></tr></table></figure>

<h5 id="mock-å±æ€§"><a href="#mock-å±æ€§" class="headerlink" title=".mock å±æ€§"></a><code>.mock</code> å±æ€§</h5><p>æ‰€æœ‰çš„ mock å‡½æ•°éƒ½æœ‰è¿™ä¸ªç‰¹æ®Šçš„ <code>.mock</code>å±æ€§ï¼Œå®ƒä¿å­˜äº†å…³äºæ­¤å‡½æ•°å¦‚ä½•è¢«è°ƒç”¨ã€è°ƒç”¨æ—¶çš„è¿”å›å€¼çš„ä¿¡æ¯ã€‚ <code>.mock</code> å±æ€§è¿˜è¿½è¸ªæ¯æ¬¡è°ƒç”¨æ—¶ <code>this</code>çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åŒæ ·å¯ä»¥ä¹Ÿæ£€è§†ï¼ˆinspectï¼‰ <code>this</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myMock1 = jest.<span class="title function_">fn</span>();</span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">new</span> <span class="title function_">myMock1</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myMock1.<span class="property">mock</span>.<span class="property">instances</span>);</span><br><span class="line"><span class="comment">// &gt; [ &lt;a&gt; ]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myMock2 = jest.<span class="title function_">fn</span>();</span><br><span class="line"><span class="keyword">const</span> b = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> bound = myMock2.<span class="title function_">bind</span>(b);</span><br><span class="line"><span class="title function_">bound</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myMock2.<span class="property">mock</span>.<span class="property">contexts</span>);</span><br><span class="line"><span class="comment">// &gt; [ &lt;b&gt; ]</span></span><br></pre></td></tr></table></figure>

<p>è¿™äº› mock æˆå‘˜å˜é‡åœ¨æµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ï¼Œç”¨äºè¯´æ˜è¿™äº› function æ˜¯å¦‚ä½•è¢«è°ƒç”¨ã€å®ä¾‹åŒ–æˆ–è¿”å›çš„ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The function was called exactly once</span></span><br><span class="line"><span class="title function_">expect</span>(someMockFunction.<span class="property">mock</span>.<span class="property">calls</span>.<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The first arg of the first call to the function was &#x27;first arg&#x27;</span></span><br><span class="line"><span class="title function_">expect</span>(someMockFunction.<span class="property">mock</span>.<span class="property">calls</span>[<span class="number">0</span>][<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;first arg&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The second arg of the first call to the function was &#x27;second arg&#x27;</span></span><br><span class="line"><span class="title function_">expect</span>(someMockFunction.<span class="property">mock</span>.<span class="property">calls</span>[<span class="number">0</span>][<span class="number">1</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;second arg&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The return value of the first call to the function was &#x27;return value&#x27;</span></span><br><span class="line"><span class="title function_">expect</span>(someMockFunction.<span class="property">mock</span>.<span class="property">results</span>[<span class="number">0</span>].<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;return value&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The function was called with a certain `this` context: the `element` object.</span></span><br><span class="line"><span class="title function_">expect</span>(someMockFunction.<span class="property">mock</span>.<span class="property">contexts</span>[<span class="number">0</span>]).<span class="title function_">toBe</span>(element);</span><br><span class="line"></span><br><span class="line"><span class="comment">// This function was instantiated exactly twice</span></span><br><span class="line"><span class="title function_">expect</span>(someMockFunction.<span class="property">mock</span>.<span class="property">instances</span>.<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The object returned by the first instantiation of this function</span></span><br><span class="line"><span class="comment">// had a `name` property whose value was set to &#x27;test&#x27;</span></span><br><span class="line"><span class="title function_">expect</span>(someMockFunction.<span class="property">mock</span>.<span class="property">instances</span>[<span class="number">0</span>].<span class="property">name</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The first argument of the last call to the function was &#x27;test&#x27;</span></span><br><span class="line"><span class="title function_">expect</span>(someMockFunction.<span class="property">mock</span>.<span class="property">lastCall</span>[<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;test&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="Mock-çš„è¿”å›å€¼"><a href="#Mock-çš„è¿”å›å€¼" class="headerlink" title="Mock çš„è¿”å›å€¼"></a>Mock çš„è¿”å›å€¼<a target="_blank" rel="noopener" href="https://jestjs.io/zh-Hans/docs/mock-functions#mock-%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"></a></h5><p>Mock å‡½æ•°ä¹Ÿå¯ä»¥ç”¨äºåœ¨æµ‹è¯•æœŸé—´å°†æµ‹è¯•å€¼æ³¨å…¥ä»£ç ï¸°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myMock = jest.<span class="title function_">fn</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">myMock</span>());</span><br><span class="line"><span class="comment">// &gt; undefined</span></span><br><span class="line"></span><br><span class="line">myMock.<span class="title function_">mockReturnValueOnce</span>(<span class="number">10</span>).<span class="title function_">mockReturnValueOnce</span>(<span class="string">&#x27;x&#x27;</span>).<span class="title function_">mockReturnValue</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">myMock</span>(), <span class="title function_">myMock</span>(), <span class="title function_">myMock</span>(), <span class="title function_">myMock</span>());</span><br><span class="line"><span class="comment">// &gt; 10, &#x27;x&#x27;, true, true</span></span><br></pre></td></tr></table></figure>

<p>åœ¨å‡½æ•°è¿ç»­ä¼ é€’é£æ ¼ï¼ˆfunctional continuation-passing styleï¼‰çš„ä»£ç ä¸­æ—¶ï¼ŒMock å‡½æ•°ä¹Ÿéå¸¸æœ‰æ•ˆã€‚ ä»¥è¿™ç§ä»£ç é£æ ¼æœ‰åŠ©äºé¿å…å¤æ‚çš„ä¸­é—´æ“ä½œï¼Œä¾¿äºç›´è§‚è¡¨ç°ç»„ä»¶çš„çœŸå®æ„å›¾ï¼Œè¿™æœ‰åˆ©äºåœ¨å®ƒä»¬è¢«è°ƒç”¨ä¹‹å‰ï¼Œå°†å€¼ç›´æ¥æ³¨å…¥åˆ°æµ‹è¯•ä¸­ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filterTestFn = jest.<span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Make the mock return `true` for the first call,</span></span><br><span class="line"><span class="comment">// and `false` for the second call</span></span><br><span class="line">filterTestFn.<span class="title function_">mockReturnValueOnce</span>(<span class="literal">true</span>).<span class="title function_">mockReturnValueOnce</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = [<span class="number">11</span>, <span class="number">12</span>].<span class="title function_">filter</span>(<span class="function"><span class="params">num</span> =&gt;</span> <span class="title function_">filterTestFn</span>(num));</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line"><span class="comment">// &gt; [11]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(filterTestFn.<span class="property">mock</span>.<span class="property">calls</span>[<span class="number">0</span>][<span class="number">0</span>]); <span class="comment">// 11</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(filterTestFn.<span class="property">mock</span>.<span class="property">calls</span>[<span class="number">1</span>][<span class="number">0</span>]); <span class="comment">// 12</span></span><br></pre></td></tr></table></figure>

<p>å¤§å¤šæ•°ç°å®ä¸–ç•Œä¾‹å­ä¸­ï¼Œå®é™…æ˜¯åœ¨ä¾èµ–çš„ç»„ä»¶ä¸Šé…ä¸€ä¸ªæ¨¡æ‹Ÿå‡½æ•°å¹¶é…ç½®å®ƒï¼Œä½†æ‰‹æ³•æ˜¯ç›¸åŒçš„ã€‚ åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå°½é‡é¿å…åœ¨éçœŸæ­£æƒ³è¦è¿›è¡Œæµ‹è¯•çš„ä»»ä½•å‡½æ•°å†…å®ç°é€»è¾‘ã€‚</p>
<h5 id="æ¨¡æ‹Ÿæ¨¡å—"><a href="#æ¨¡æ‹Ÿæ¨¡å—" class="headerlink" title="æ¨¡æ‹Ÿæ¨¡å—"></a>æ¨¡æ‹Ÿæ¨¡å—<a target="_blank" rel="noopener" href="https://jestjs.io/zh-Hans/docs/mock-functions#%E6%A8%A1%E6%8B%9F%E6%A8%A1%E5%9D%97"></a></h5><p>å‡å®šæœ‰ä¸ªä» API è·å–ç”¨æˆ·çš„ç±»ã€‚ è¯¥ç±»ç”¨ <a target="_blank" rel="noopener" href="https://github.com/axios/axios">axios</a> è°ƒç”¨ API ç„¶åè¿”å› <code>data</code>ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰ç”¨æˆ·çš„å±æ€§ï¼š</p>
<p>users.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Users</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">all</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;/users.json&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">resp</span> =&gt;</span> resp.<span class="property">data</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Users</span>;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œä¸ºæµ‹è¯•è¯¥æ–¹æ³•è€Œä¸å®é™…è°ƒç”¨ API (ä½¿æµ‹è¯•ç¼“æ…¢ä¸è„†å¼±)ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>jest.mock(...)</code> å‡½æ•°è‡ªåŠ¨æ¨¡æ‹Ÿ axios æ¨¡å—ã€‚</p>
<p>ä¸€æ—¦æ¨¡æ‹Ÿæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä¸º <code>.get</code> æä¾›ä¸€ä¸ª <code>mockResolvedValue</code> ï¼Œå®ƒä¼šè¿”å›å‡æ•°æ®ç”¨äºæµ‹è¯•ã€‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬æƒ³è¯´çš„æ˜¯æˆ‘ä»¬æƒ³è®©<code>axios.get(&#39;/users.json&#39;)</code> æœ‰ä¸ªä¼ªé€ çš„å“åº”ç»“æœã€‚</p>
<p>users.test.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Users</span> <span class="keyword">from</span> <span class="string">&#x27;./users&#x27;</span>;</span><br><span class="line"></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;should fetch users&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> users = [&#123;<span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>&#125;];</span><br><span class="line">  <span class="keyword">const</span> resp = &#123;<span class="attr">data</span>: users&#125;;</span><br><span class="line">  axios.<span class="property">get</span>.<span class="title function_">mockResolvedValue</span>(resp);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// or you could use the following depending on your use case:</span></span><br><span class="line">  <span class="comment">// axios.get.mockImplementation(() =&gt; Promise.resolve(resp))</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Users</span>.<span class="title function_">all</span>().<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="title function_">expect</span>(data).<span class="title function_">toEqual</span>(users));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="æ¨¡æ‹Ÿ-éƒ¨åˆ†æ¨¡å—"><a href="#æ¨¡æ‹Ÿ-éƒ¨åˆ†æ¨¡å—" class="headerlink" title="æ¨¡æ‹Ÿ éƒ¨åˆ†æ¨¡å—"></a>æ¨¡æ‹Ÿ éƒ¨åˆ†æ¨¡å—</h5><p>æ¨¡å—çš„å­é›†å¯ä»¥è¢«æ¨¡æ‹Ÿï¼Œæ¨¡å—çš„å…¶ä»–éƒ¨åˆ†å¯ä»¥ç»´æŒå½“å‰å®ç°ï¼š</p>
<p>foo-bar-baz.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> foo = <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">bar</span> = (<span class="params"></span>) =&gt; <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; <span class="string">&#x27;baz&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//test.js</span></span><br><span class="line"><span class="keyword">import</span> defaultExport, &#123;bar, foo&#125; <span class="keyword">from</span> <span class="string">&#x27;../foo-bar-baz&#x27;</span>;</span><br><span class="line"></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;../foo-bar-baz&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> originalModule = jest.requireActual(<span class="string">&#x27;../foo-bar-baz&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Mock the default export and named export &#x27;foo&#x27;</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">__esModule</span>: <span class="literal">true</span>,</span><br><span class="line">    ...originalModule,</span><br><span class="line">    <span class="attr">default</span>: jest.<span class="title function_">fn</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;mocked baz&#x27;</span>),</span><br><span class="line">    <span class="attr">foo</span>: <span class="string">&#x27;mocked foo&#x27;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;should do a partial mock&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> defaultExportResult = <span class="title function_">defaultExport</span>();</span><br><span class="line">  <span class="title function_">expect</span>(defaultExportResult).<span class="title function_">toBe</span>(<span class="string">&#x27;mocked baz&#x27;</span>);</span><br><span class="line">  <span class="title function_">expect</span>(defaultExport).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">expect</span>(foo).<span class="title function_">toBe</span>(<span class="string">&#x27;mocked foo&#x27;</span>);</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">bar</span>()).<span class="title function_">toBe</span>(<span class="string">&#x27;bar&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="Mock-å®ç°"><a href="#Mock-å®ç°" class="headerlink" title="Mock å®ç°"></a>Mock å®ç°<a target="_blank" rel="noopener" href="https://jestjs.io/zh-Hans/docs/mock-functions#mock-%E5%AE%9E%E7%8E%B0"></a></h5><p>è¿˜æœ‰ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ç”¨Mockå‡½æ•°æ›¿æ¢æŒ‡å®šè¿”å›å€¼æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ å¯ä»¥ç”¨ <code>jest.fn</code> æˆ– <code>mockImplementationOnce</code>æ–¹æ³•æ¥å®ç°Mockå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myMockFn = jest.<span class="title function_">fn</span>(<span class="function"><span class="params">cb</span> =&gt;</span> <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line"><span class="title function_">myMockFn</span>(<span class="function">(<span class="params">err, val</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(val));</span><br><span class="line"><span class="comment">// &gt; true</span></span><br></pre></td></tr></table></figure>



<p>å½“ä½ éœ€è¦æ ¹æ®åˆ«çš„æ¨¡å—å®šä¹‰é»˜è®¤çš„Mockå‡½æ•°å®ç°æ—¶ï¼Œ<code>mockImplementation</code> æ–¹æ³•æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p>
<p>foo.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// some implementation;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>test.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;../foo&#x27;</span>); <span class="comment">// this happens automatically with automocking</span></span><br><span class="line"><span class="keyword">const</span> foo = <span class="built_in">require</span>(<span class="string">&#x27;../foo&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// foo is a mock function</span></span><br><span class="line">foo.<span class="title function_">mockImplementation</span>(<span class="function">() =&gt;</span> <span class="number">42</span>);</span><br><span class="line"><span class="title function_">foo</span>();</span><br><span class="line"><span class="comment">// &gt; 42</span></span><br></pre></td></tr></table></figure>



<p>å½“ä½ éœ€è¦æ¨¡æ‹ŸæŸä¸ªå‡½æ•°è°ƒç”¨è¿”å›ä¸åŒç»“æœæ—¶ï¼Œè¯·ä½¿ç”¨ <code>mockImplementationOnce</code> æ–¹æ³•ï¸°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myMockFn = jest</span><br><span class="line">  .<span class="title function_">fn</span>()</span><br><span class="line">  .<span class="title function_">mockImplementationOnce</span>(<span class="function"><span class="params">cb</span> =&gt;</span> <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="literal">true</span>))</span><br><span class="line">  .<span class="title function_">mockImplementationOnce</span>(<span class="function"><span class="params">cb</span> =&gt;</span> <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="literal">false</span>));</span><br><span class="line"></span><br><span class="line"><span class="title function_">myMockFn</span>(<span class="function">(<span class="params">err, val</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(val));</span><br><span class="line"><span class="comment">// &gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">myMockFn</span>(<span class="function">(<span class="params">err, val</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(val));</span><br><span class="line"><span class="comment">// &gt; false</span></span><br></pre></td></tr></table></figure>



<p>å½“ <code>mockImplementationOne</code>å®šä¹‰çš„å®ç°é€ä¸ªè°ƒç”¨å®Œæ¯•æ—¶ï¼Œ å¦‚æœå®šä¹‰äº†<code>jest.fn </code>ï¼Œå®ƒå°†ä½¿ç”¨ <code>jest.fn </code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myMockFn = jest</span><br><span class="line">  .<span class="title function_">fn</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;default&#x27;</span>)</span><br><span class="line">  .<span class="title function_">mockImplementationOnce</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;first call&#x27;</span>)</span><br><span class="line">  .<span class="title function_">mockImplementationOnce</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;second call&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">myMockFn</span>(), <span class="title function_">myMockFn</span>(), <span class="title function_">myMockFn</span>(), <span class="title function_">myMockFn</span>());</span><br><span class="line"><span class="comment">// &gt; &#x27;first call&#x27;, &#x27;second call&#x27;, &#x27;default&#x27;, &#x27;default&#x27;</span></span><br></pre></td></tr></table></figure>



<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å‡½æ•°è°ƒç”¨éƒ½æ˜¯é“¾å¼çš„ï¼Œå¦‚æœä½ å¸Œæœ›åˆ›å»ºçš„å‡½æ•°æ”¯æŒé“¾å¼è°ƒç”¨ï¼ˆå› ä¸ºè¿”å›äº†thisï¼‰ï¼Œå¯ä»¥ä½¿ç”¨<code>.mockReturnThis()</code> å‡½æ•°æ¥æ”¯æŒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myObj = &#123;</span><br><span class="line">  <span class="attr">myMethod</span>: jest.<span class="title function_">fn</span>().<span class="title function_">mockReturnThis</span>(),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// is the same as</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> otherObj = &#123;</span><br><span class="line">  <span class="attr">myMethod</span>: jest.<span class="title function_">fn</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="è‡ªå®šä¹‰åŒ¹é…å™¨"><a href="#è‡ªå®šä¹‰åŒ¹é…å™¨" class="headerlink" title="è‡ªå®šä¹‰åŒ¹é…å™¨"></a>è‡ªå®šä¹‰åŒ¹é…å™¨<a target="_blank" rel="noopener" href="https://jestjs.io/zh-Hans/docs/mock-functions#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%B9%E9%85%8D%E5%99%A8"></a></h5><p>æœ€åï¼Œæµ‹è¯•Mockå‡½æ•°éœ€è¦å†™å¤§é‡çš„æ–­è¨€ï¼Œä¸ºäº†å‡å°‘ä»£ç é‡ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€äº›è‡ªå®šä¹‰åŒ¹é…å™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The mock function was called at least once</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// The mock function was called at least once with the specified args</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc).<span class="title function_">toHaveBeenCalledWith</span>(arg1, arg2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The last call to the mock function was called with the specified args</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc).<span class="title function_">toHaveBeenLastCalledWith</span>(arg1, arg2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// All calls and the name of the mock is written as a snapshot</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc).<span class="title function_">toMatchSnapshot</span>();</span><br></pre></td></tr></table></figure>



<p>è¿™äº›åŒ¹é…å™¨æ˜¯æ–­è¨€Mockå‡½æ•°çš„è¯­æ³•ç³–ã€‚ ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è‡ªè¡Œé€‰æ‹©åŒ¹é…å™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The mock function was called at least once</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc.<span class="property">mock</span>.<span class="property">calls</span>.<span class="property">length</span>).<span class="title function_">toBeGreaterThan</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The mock function was called at least once with the specified args</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc.<span class="property">mock</span>.<span class="property">calls</span>).<span class="title function_">toContainEqual</span>([arg1, arg2]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The last call to the mock function was called with the specified args</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc.<span class="property">mock</span>.<span class="property">calls</span>[mockFunc.<span class="property">mock</span>.<span class="property">calls</span>.<span class="property">length</span> - <span class="number">1</span>]).<span class="title function_">toEqual</span>([</span><br><span class="line">  arg1,</span><br><span class="line">  arg2,</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The first arg of the last call to the mock function was `42`</span></span><br><span class="line"><span class="comment">// (note that there is no sugar helper for this specific of an assertion)</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc.<span class="property">mock</span>.<span class="property">calls</span>[mockFunc.<span class="property">mock</span>.<span class="property">calls</span>.<span class="property">length</span> - <span class="number">1</span>][<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// A snapshot will check that a mock was invoked the same number of times,</span></span><br><span class="line"><span class="comment">// in the same order, with the same arguments. å®ƒè¿˜ä¼šåœ¨åç§°ä¸Šæ–­è¨€ã€‚ å®ƒè¿˜ä¼šåœ¨åç§°ä¸Šæ–­è¨€ã€‚</span></span><br><span class="line"><span class="title function_">expect</span>(mockFunc.<span class="property">mock</span>.<span class="property">calls</span>).<span class="title function_">toEqual</span>([[arg1, arg2]]);</span><br><span class="line"><span class="title function_">expect</span>(mockFunc.<span class="title function_">getMockName</span>()).<span class="title function_">toBe</span>(<span class="string">&#x27;a mock name&#x27;</span>);</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/16/jest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" data-id="cl9770wpq006lk2oo26mz365x" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰è¯»ä¹¦ç¬”è®°" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/14/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" class="article-date">
  <time datetime="2022-09-14T13:50:51.000Z" itemprop="datePublished">2022-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/14/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰è¯»ä¹¦ç¬”è®°</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="ç¬¬å››ç« æ ˆ"><a href="#ç¬¬å››ç« æ ˆ" class="headerlink" title="##ç¬¬å››ç« æ ˆ"></a>##ç¬¬å››ç« æ ˆ</h4><p>ä½¿ç”¨æ•°ç»„æ¥å®šä¹‰æ•°æ®ç»“æ„</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Stack</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span> = [];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ ä¸€ä¸ªï¼ˆæˆ–å‡ ä¸ªï¼‰æ–°å…ƒç´ åˆ°æ ˆé¡¶,è¿”å›å€¼æ˜¯æ•°ç»„çš„é•¿åº¦</span></span><br><span class="line">  <span class="title function_">push</span>(<span class="params">element</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>.<span class="title function_">push</span>(element);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç§»é™¤æ ˆé¡¶çš„å…ƒç´ ï¼ŒåŒæ—¶è¿”å›è¢«ç§»é™¤çš„å…ƒç´ </span></span><br><span class="line">  <span class="title function_">pop</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>.<span class="title function_">pop</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//è¿”å›æ ˆé¡¶çš„å…ƒç´ ï¼Œä¸å¯¹æ ˆåšä»»ä½•ä¿®æ”¹ï¼ˆè¯¥æ–¹æ³•ä¸ä¼šç§»é™¤æ ˆé¡¶çš„å…ƒç´ ï¼Œä»…ä»…è¿”å›å®ƒï¼‰</span></span><br><span class="line">  <span class="title function_">peek</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">items</span>.<span class="property">length</span> - <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¦‚æœæ ˆé‡Œæ²¡æœ‰ä»»ä½•å…ƒç´ å°±è¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line">  <span class="title function_">isEmpty</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="literal">false</span> : <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç§»é™¤æ ˆé‡Œçš„æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">  <span class="title function_">clear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span> = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//è¿”å›æ ˆé‡Œçš„å…ƒç´ ä¸ªæ•°ã€‚è¯¥æ–¹æ³•å’Œæ•°ç»„çš„ length å±æ€§å¾ˆç±»ä¼¼</span></span><br><span class="line">  <span class="title function_">size</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>.<span class="property">length</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨å¯¹è±¡æ¥å®šä¹‰æ ˆ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Stack</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span> = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">push</span>(<span class="params">element</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span>] = element;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span>++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">size</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">count</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">isEmpty</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">count</span> === <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">pop</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span>--;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span>];</span><br><span class="line">    <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span>];</span><br><span class="line">    <span class="keyword">return</span> result;  &#125;</span><br><span class="line">  <span class="title function_">clear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span> = &#123;&#125;;</span><br><span class="line">    <span class="comment">// while(!this.isEmpty())&#123;</span></span><br><span class="line">    <span class="comment">//   this.pop()</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">peek</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>[<span class="variable language_">this</span>.<span class="property">count</span> - <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> str = <span class="variable language_">this</span>.<span class="property">items</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="variable language_">this</span>.<span class="property">count</span>; i++) &#123;</span><br><span class="line">      str = str + <span class="string">`,<span class="subst">$&#123;<span class="variable language_">this</span>.items[i]&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿æŠ¤æ•°æ®ç»“æ„å†…éƒ¨å…ƒç´ </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> stack = <span class="keyword">new</span> <span class="title class_">Stack</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(stack)); <span class="comment">// &#123;1&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(stack)); <span class="comment">// &#123;2&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stack.<span class="property">items</span>);</span><br></pre></td></tr></table></figure>

<p>å¤–éƒ¨å¯ä»¥ç›´æ¥æ‹¿åˆ°å†…éƒ¨çš„æ•°æ®ï¼Œå› ä¸ºjsä¸­æ²¡æœ‰ç§æœ‰å±æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Stack</span> &#123; </span><br><span class="line"> <span class="title function_">constructor</span>(<span class="params"></span>) &#123; </span><br><span class="line"> <span class="variable language_">this</span>.<span class="property">_count</span> = <span class="number">0</span>; </span><br><span class="line"> <span class="variable language_">this</span>.<span class="property">_items</span> = &#123;&#125;; </span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€éƒ¨åˆ†å¼€å‘è€…èƒ¡ä½¿ç”¨ä¸‹åˆ’çº¿ä½œä¸ºç§æœ‰å±æ€§çš„è§„èŒƒï¼Œä½†æ˜¯è¿™æ ·ä¾ç„¶å¯ä»¥è¢«è®¿é—®ï¼Œæ²¡æœ‰å®è´¨æ€§çš„ä½œç”¨</p>
<h5 id="ç”¨-ES2015-çš„é™å®šä½œç”¨åŸŸ-Symbol-å®ç°ç±»"><a href="#ç”¨-ES2015-çš„é™å®šä½œç”¨åŸŸ-Symbol-å®ç°ç±»" class="headerlink" title="ç”¨ ES2015 çš„é™å®šä½œç”¨åŸŸ Symbol å®ç°ç±»"></a>ç”¨ ES2015 çš„é™å®šä½œç”¨åŸŸ Symbol å®ç°ç±»</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _items = <span class="keyword">new</span> <span class="title class_">Symbol</span>(<span class="string">&quot;stackItem&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stack</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨è®¡ç®—å±æ€§å’Œsymbolçš„å½¢å¼</span></span><br><span class="line">    <span class="variable language_">this</span>[_items] = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è™½ç„¶è¿™ç§æ–¹å¼å¯ä»¥è®©ä¸Šè¿°æ–¹æ³•æ²¡åŠæ³•è®¿é—®å†…éƒ¨å±æ€§ä½†æ˜¯å¯ä»¥é€šè¿‡<code>Object.getOwnPropertySymbol(stack)</code>å¯ä»¥è®¿é—®åˆ°ä»¥Symbolä¸ºkeyçš„å±æ€§</p>
<h5 id="ç”¨-ES2015-çš„-WeakMap-å®ç°ç±»"><a href="#ç”¨-ES2015-çš„-WeakMap-å®ç°ç±»" class="headerlink" title="ç”¨ ES2015 çš„ WeakMap å®ç°ç±»"></a>ç”¨ ES2015 çš„ WeakMap å®ç°ç±»</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items=<span class="keyword">new</span> <span class="title class_">WeakMap</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WeakMapStack</span>&#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span><br><span class="line">    items.<span class="title function_">set</span>(<span class="variable language_">this</span>,[])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">push</span>(<span class="params">element</span>)&#123;</span><br><span class="line">    items.<span class="title function_">get</span>(<span class="variable language_">this</span>).<span class="title function_">push</span>(element)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">pop</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> items.<span class="title function_">get</span>(<span class="variable language_">this</span>).<span class="title function_">pop</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ï¼Œitems åœ¨ Stack ç±»é‡Œæ˜¯çœŸæ­£çš„ç§æœ‰å±æ€§ã€‚é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œä»£ç çš„å¯è¯»æ€§ ä¸å¼ºï¼Œè€Œä¸”åœ¨æ‰©å±•è¯¥ç±»æ—¶æ— æ³•ç»§æ‰¿ç§æœ‰å±æ€§ã€‚é±¼å’Œç†ŠæŒä¸å¯å…¼å¾—ï¼</p>
<h5 id="ä½¿ç”¨æ ˆçš„å®ä¾‹"><a href="#ä½¿ç”¨æ ˆçš„å®ä¾‹" class="headerlink" title="ä½¿ç”¨æ ˆçš„å®ä¾‹"></a>ä½¿ç”¨æ ˆçš„å®ä¾‹</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†åè¿›åˆ¶è½¬æˆäºŒè¿›åˆ¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Stack</span> <span class="keyword">from</span> <span class="string">&quot;./Stack.js&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">decimalToBinary</span>(<span class="params">decNumber</span>) &#123;</span><br><span class="line">  decNumber = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Number</span>(decNumber));</span><br><span class="line">  <span class="keyword">const</span> stack = <span class="keyword">new</span> <span class="title class_">Stack</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> dec = decNumber;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (dec &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(dec % <span class="number">2</span>));</span><br><span class="line">    stack.<span class="title function_">push</span>(dec % <span class="number">2</span>);</span><br><span class="line">    dec = <span class="title class_">Math</span>.<span class="title function_">floor</span>(dec / <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> binaryString = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">while</span> (!stack.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">    binaryString += stack.<span class="title function_">pop</span>().<span class="title function_">toString</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> binaryString;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŠŠåè¿›åˆ¶è½¬æ¢æˆåŸºæ•°ä¸º 2ï½36 çš„ä»»æ„è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Stack</span> <span class="keyword">from</span> <span class="string">&quot;./Stack.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">baseConverter</span>(<span class="params">decNumber, base</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> dec = decNumber;</span><br><span class="line">  <span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="title class_">Stack</span>();</span><br><span class="line">  <span class="keyword">const</span> digits = <span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span> (!(base &gt;= <span class="number">2</span> &amp;&amp; base &lt;= <span class="number">36</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (dec &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    arr.<span class="title function_">push</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(dec % base));</span><br><span class="line">    dec = <span class="title class_">Math</span>.<span class="title function_">floor</span>(dec / base);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (!arr.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">    str += digits[arr.<span class="title function_">pop</span>()];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">baseConverter</span>(<span class="number">100345</span>, <span class="number">2</span>)); <span class="comment">// 11000011111111001</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">baseConverter</span>(<span class="number">100345</span>, <span class="number">8</span>)); <span class="comment">// 303771</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">baseConverter</span>(<span class="number">100345</span>, <span class="number">16</span>)); <span class="comment">// 187F9</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">baseConverter</span>(<span class="number">100345</span>, <span class="number">35</span>)); <span class="comment">// 2BW0</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/14/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" data-id="cl9770wnj0025k2ooavp388dx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-è®¡ç®—æœºç½‘ç»œ" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" class="article-date">
  <time datetime="2022-09-14T10:29:03.000Z" itemprop="datePublished">2022-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">è®¡ç®—æœºç½‘ç»œ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" data-id="cl9770wo40034k2oo4b5w4umi" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-æ“ä½œç³»ç»Ÿ" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" class="article-date">
  <time datetime="2022-09-14T10:28:42.000Z" itemprop="datePublished">2022-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" data-id="cl9770wnr002ik2ood3kdbwmz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-è®¡ç®—æœºç»„æˆåŸç†" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" class="article-date">
  <time datetime="2022-09-14T10:28:13.000Z" itemprop="datePublished">2022-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/">è®¡ç®—æœºç»„æˆåŸç†</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/">è®¡ç®—æœºç»„æˆåŸç†</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" data-id="cl9770wo30032k2oof22m3w6l" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-æ•°æ®ç»“æ„" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/09/14/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2022-09-14T10:27:42.000Z" itemprop="datePublished">2022-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/09/14/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/14/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" data-id="cl9770wns002kk2oo2y2n8rjh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Electron/">Electron</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Electron/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Puppeteer/">Puppeteer</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/git/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/interview/">interview</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/interview/daily/">daily</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/%E5%8E%9F%E7%90%86/">åŸç†</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/%E5%B7%A5%E5%85%B7/">å·¥å…·</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/%E6%90%9C%E9%9B%86/">æœé›†</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/node/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/note/">note</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/note/%E5%89%8D%E7%AB%AF%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%AC%94%E8%AE%B0/">å‰ç«¯ç³»ç»Ÿè¯¾ç¬”è®°</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/react/">react</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/react/Typescript/">Typescript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/react/mobx/">mobx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/react/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/typescript/">typescript</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/typescript/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/">vue</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/vue/daily/">daily</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87/">å‰ç«¯å…«è‚¡æ–‡</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">å•å…ƒæµ‹è¯•</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/Enzyme/">Enzyme</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/jest/">jest</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B8%B8%E7%94%A8%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/">å¸¸ç”¨æ„å»ºå·¥å…·</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B8%B8%E7%94%A8%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/glup/">glup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B8%B8%E7%94%A8%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/rollup/">rollup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B8%B8%E7%94%A8%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/vite/">vite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B8%B8%E7%94%A8%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/webpack/">webpack</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">æ­£åˆ™è¡¨è¾¾å¼</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/">è®¡ç®—æœºç»„æˆåŸç†</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">è®¡ç®—æœºç½‘ç»œ</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/Ajax/">Ajax</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/HTTP/">HTTP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/axios/">axios</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/fetch/">fetch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/websocket/">websocket</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE/">é¡¹ç›®</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/11/08/Puppeteer/">ä»€ä¹ˆæ˜¯Puppeteer</a>
          </li>
        
          <li>
            <a href="/2022/10/13/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2022/10/12/canvas%E7%AC%94%E8%AE%B0/">canvasç¬”è®°</a>
          </li>
        
          <li>
            <a href="/2022/10/08/mobx%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%89/">mobxçš„ä½¿ç”¨3âƒ£ï¸</a>
          </li>
        
          <li>
            <a href="/2022/10/08/mobx%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BA%8C/">mobxçš„ä½¿ç”¨äºŒ</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>