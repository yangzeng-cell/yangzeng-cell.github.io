<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ä»€ä¹ˆæ˜¯Puppeteer</title>
    <link href="/2022/11/08/Puppeteer/"/>
    <url>/2022/11/08/Puppeteer/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>Puppeteer</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/10/16/hello-world/"/>
    <url>/2022/10/16/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span></code></pre></div><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo server</code></pre></div><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo generate</code></pre></div><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo deploy</code></pre></div><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>canvasç¬”è®°</title>
    <link href="/2022/10/12/canvas%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/10/12/canvas%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>mobxçš„ä½¿ç”¨3âƒ£ï¸</title>
    <link href="/2022/10/08/mobx%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%89/"/>
    <url>/2022/10/08/mobx%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%89/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>react</category>
      
      <category>mobx</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>mobxçš„ä½¿ç”¨äºŒ</title>
    <link href="/2022/10/08/mobx%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BA%8C/"/>
    <url>/2022/10/08/mobx%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="é›†æˆReactï¼ˆreact-integrationï¼‰"><a href="#é›†æˆReactï¼ˆreact-integrationï¼‰" class="headerlink" title="é›†æˆReactï¼ˆreact-integrationï¼‰"></a>é›†æˆReactï¼ˆreact-integrationï¼‰</h1><p>ç”¨æ³•:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react-lite&quot;</span> <span class="hljs-comment">// Or &quot;mobx-react&quot;.</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">MyComponent</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> <span class="hljs-title class_">ReactElement</span>)</code></pre></div><p>MobX å¯ä»¥ç‹¬ç«‹äº React è¿è¡Œ, ä½†æ˜¯ä»–ä»¬é€šå¸¸æ˜¯ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨, åœ¨ <a href="https://zh.mobx.js.org/the-gist-of-mobx.html">Mobxçš„å®—æ—¨ï¼ˆThe gist of MobXï¼‰</a> ä¸€æ–‡ä¸­ä½ ä¼šç»å¸¸çœ‹è§é›†æˆReactæœ€é‡è¦çš„ä¸€éƒ¨åˆ†ï¼šç”¨äºåŒ…è£¹React Componentçš„ <code>observer</code> <a href="https://reactjs.org/docs/higher-order-components.html">HOC</a>æ–¹æ³•ã€‚</p><p><code>observer</code> æ˜¯ä½ å¯ä»¥è‡ªä¸»é€‰æ‹©çš„ï¼Œ<a href="https://zh.mobx.js.org/installation.html#installation">åœ¨å®‰è£…æ—¶ï¼ˆduring installationï¼‰</a>ç‹¬ç«‹æä¾›çš„ React bindings åŒ…ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­,æˆ‘ä»¬å°†ä½¿ç”¨æ›´åŠ è½»é‡çš„<a href="https://github.com/mobxjs/mobx/tree/main/packages/mobx-react-lite"><code>mobx-react-lite</code> åŒ…</a>ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react-lite&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Timer</span> &#123;    secondsPassed = <span class="hljs-number">0</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-title function_">increaseTimer</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span> += <span class="hljs-number">1</span>    &#125;&#125;<span class="hljs-keyword">const</span> myTimer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Timer</span>()<span class="hljs-comment">//è¢«`observer`åŒ…è£¹çš„å‡½æ•°å¼ç»„ä»¶ä¼šè¢«ç›‘å¬åœ¨å®ƒæ¯ä¸€æ¬¡è°ƒç”¨å‰å‘ç”Ÿçš„ä»»ä½•å˜åŒ–</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">(<span class="hljs-params">&#123; timer &#125;</span>) =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> <span class="hljs-attr">timer</span>=<span class="hljs-string">&#123;myTimer&#125;</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;    myTimer.<span class="hljs-title function_">increaseTimer</span>()&#125;, <span class="hljs-number">1000</span>)</code></pre></div><p><code>observer</code> HOC å°†è‡ªåŠ¨è®¢é˜… React components ä¸­ä»»ä½• <em>åœ¨æ¸²æŸ“æœŸé—´</em> è¢«ä½¿ç”¨çš„ <em>å¯è¢«è§‚å¯Ÿçš„å¯¹è±¡</em> ã€‚ å› æ­¤, å½“ä»»ä½•å¯è¢«è§‚å¯Ÿçš„å¯¹è±¡ <em>å˜åŒ–</em> å‘ç”Ÿæ—¶å€™ ç»„ä»¶ä¼šè‡ªåŠ¨è¿›è¡Œé‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰ã€‚ å®ƒè¿˜ä¼šç¡®ä¿ç»„ä»¶åœ¨ <em>æ²¡æœ‰å˜åŒ–</em> å‘ç”Ÿçš„æ—¶å€™ä¸ä¼šè¿›è¡Œé‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰ã€‚ ä½†æ˜¯, æ›´æ”¹ç»„ä»¶çš„å¯è§‚å¯Ÿå¯¹è±¡çš„ä¸å¯è¯»å±æ€§, ä¹Ÿä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰ã€‚</p><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™ä¸€ç‰¹æ€§ä½¿å¾—MobXåº”ç”¨ç¨‹åºèƒ½å¤Ÿå¾ˆå¥½çš„è¿›è¡Œå¼€ç®±å³ç”¨çš„ä¼˜åŒ–ï¼Œå¹¶ä¸”é€šå¸¸ä¸éœ€è¦ä»»ä½•é¢å¤–çš„ä»£ç æ¥é˜²æ­¢è¿‡åº¦æ¸²æŸ“ã€‚</p><p>è¦æƒ³è®©<code>observer</code>ç”Ÿæ•ˆ, å¹¶ä¸éœ€è¦å…³å¿ƒè¿™äº›å¯¹è±¡ <em>å¦‚ä½•ä¼ é€’åˆ°</em> ç»„ä»¶çš„ï¼ˆå®ƒä»¬åªè¦èƒ½ä¼ é€’ç»™ç»„ä»¶å³å¯ Â·è¯‘è€…æ³¨ï¼‰, åªéœ€è¦å…³å¿ƒä»–ä»¬æ˜¯å¦æ˜¯å¯è¯»çš„ã€‚ æ·±å±‚åµŒå¥—çš„å¯è§‚å¯Ÿå¯¹è±¡ä¹Ÿæ²¡æœ‰é—®é¢˜, å¤æ‚çš„è¡¨è¾¾å¼ç±»ä¼¼ <code>todos[0].author.displayName</code> ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚ ä¸å…¶ä»–å¿…é¡»æ˜¾å¼å£°æ˜æˆ–é¢„å…ˆè®¡ç®—æ•°æ®ä¾èµ–å…³ç³»çš„æ¡†æ¶ï¼ˆä¾‹å¦‚ selectorsï¼‰ç›¸æ¯”ï¼Œè¿™ç§å‘ç”Ÿçš„è®¢é˜…æœºåˆ¶å°±æ˜¾å¾—æ›´åŠ ç²¾ç¡®å’Œé«˜æ•ˆã€‚</p><h3 id="observer-ç»„ä»¶ä¸­ä½¿ç”¨å¤–éƒ¨çŠ¶æ€-ï¼ˆUsing-external-state-in-observer-componentsï¼‰"><a href="#observer-ç»„ä»¶ä¸­ä½¿ç”¨å¤–éƒ¨çŠ¶æ€-ï¼ˆUsing-external-state-in-observer-componentsï¼‰" class="headerlink" title="observer ç»„ä»¶ä¸­ä½¿ç”¨å¤–éƒ¨çŠ¶æ€ ï¼ˆUsing external state in observer componentsï¼‰"></a><code>observer</code> ç»„ä»¶ä¸­ä½¿ç”¨å¤–éƒ¨çŠ¶æ€ ï¼ˆUsing external state in <code>observer</code> componentsï¼‰</h3><p>ä½¿ç”¨propsçš„æ–¹å¼</p><p>å¯è¢«è§‚å¯Ÿå¯¹è±¡å¯ä»¥é€šè¿‡ç»„ä»¶çš„propså±æ€§ä¼ å…¥ (åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­):</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react-lite&quot;</span><span class="hljs-keyword">const</span> myTimer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Timer</span>() <span class="hljs-comment">// See the Timer definition above.</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">(<span class="hljs-params">&#123; timer &#125;</span>) =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)<span class="hljs-comment">// é€šè¿‡propsä¼ é€’myTimer.</span><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> <span class="hljs-attr">timer</span>=<span class="hljs-string">&#123;myTimer&#125;</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)</code></pre></div><p>ä½¿ç”¨å…¨å±€å˜é‡çš„æ–¹å¼</p><p>è™½ç„¶æˆ‘ä»¬ä¸å…³å¿ƒæ˜¯ <em>å¦‚ä½•</em> å¼•ç”¨ï¼ˆreferenceï¼‰çš„å¯è§‚å¯Ÿå¯¹è±¡,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ï¼ˆconsumeï¼‰ å¤–éƒ¨ä½œç”¨åŸŸï¼ˆouter scopes directlyï¼‰çš„å¯è§‚å¯Ÿå¯¹è±¡ (ç±»ä¼¼é€šè¿‡ importè¿™æ ·çš„æ–¹æ³•, ç­‰ç­‰)ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myTimer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Timer</span>() <span class="hljs-comment">//  Timer å®šä¹‰åœ¨ä¸Šé¢.</span><span class="hljs-comment">// æ²¡æœ‰props, `myTimer` ç«‹åˆ»å˜æˆäº†é—­åŒ…ã€‚</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">() =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;myTimer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)</code></pre></div><p>ç›´æ¥ä½¿ç”¨å¯è§‚å¯Ÿå¯¹è±¡æ•ˆæœå¾ˆå¥½ï¼Œä½†æ˜¯è¿™é€šå¸¸ä¼šæ˜¯é€šè¿‡æ¨¡å—å¼•å…¥ï¼Œè¿™ç§å†™æ³•å¯èƒ½ä¼šä½¿å•å…ƒæµ‹è¯•å˜å¾—å¤æ‚ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨React Contextã€‚</p><p>ä½¿ç”¨<a href="https://reactjs.org/docs/context.html">React Context</a>å…±äº«æ•´ä¸ªå¯è§‚å¯Ÿå­æ ‘æ˜¯ä¸€ç§å¾ˆä¸é”™çš„é€‰æ‹©ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;observer&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-react-lite&#x27;</span><span class="hljs-keyword">import</span> &#123;createContext, useContext&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerContext</span> = createContext&lt;<span class="hljs-title class_">Timer</span>&gt;()<span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// ä»contextä¸­è·å–timer.</span>    <span class="hljs-keyword">const</span> timer = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">TimerContext</span>) <span class="hljs-comment">// å¯ä»¥åœ¨ä¸Šé¢æŸ¥çœ‹ Timerçš„å®šä¹‰ã€‚</span>    <span class="hljs-keyword">return</span> (        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>    )&#125;)<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;new</span> <span class="hljs-attr">Timer</span>()&#125;&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">TimerContext.Provider</span>&gt;</span></span>,    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)</code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬å¹¶ä¸æ¨èæ¯ä¸€ä¸ªä¸åŒçš„ <code>å€¼ï¼ˆvalueï¼‰</code> éƒ½é€šè¿‡ä¸åŒçš„ <code>Provider</code>æ¥ä¼ é€’ . åœ¨ä½¿ç”¨Mobxçš„è¿‡ç¨‹ä¸­ä¸éœ€è¦è¿™æ ·åš, å› ä¸ºå…±äº«çš„å¯è§‚å¯Ÿå¯¹è±¡ä¼šæ›´æ–°ä»–è‡ªå·±ã€‚</p><h3 id="åœ¨observer-ç»„ä»¶ä¸­ä½¿ç”¨å…¨å±€å¯è§‚å¯Ÿå¯¹è±¡ï¼ˆUsing-local-observable-state-in-observer-componentsï¼‰"><a href="#åœ¨observer-ç»„ä»¶ä¸­ä½¿ç”¨å…¨å±€å¯è§‚å¯Ÿå¯¹è±¡ï¼ˆUsing-local-observable-state-in-observer-componentsï¼‰" class="headerlink" title="åœ¨observer ç»„ä»¶ä¸­ä½¿ç”¨å…¨å±€å¯è§‚å¯Ÿå¯¹è±¡ï¼ˆUsing local observable state in observer componentsï¼‰"></a>åœ¨<code>observer</code> ç»„ä»¶ä¸­ä½¿ç”¨å…¨å±€å¯è§‚å¯Ÿå¯¹è±¡ï¼ˆUsing local observable state in <code>observer</code> componentsï¼‰</h3><p>å› ä¸ºä½¿ç”¨ <code>observer</code> çš„å¯è§‚å¯Ÿå¯¹è±¡å¯ä»¥æ¥è‡ªä»»ä½•åœ°æ–¹, ä»–ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨local stateï¼ˆå…¨å±€çš„stateÂ·è¯‘è€…æ³¨ï¼‰ã€‚ å†æ¬¡å£°æ˜ï¼Œä¸åŒæ“ä½œæ–¹å¼å¯¹äºæˆ‘ä»¬è€Œè¨€éƒ½æ˜¯æœ‰ä»·å€¼çš„ã€‚</p><p>ä½¿ç”¨å…¨å±€å¯è§‚å¯Ÿå¯¹è±¡çš„æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯é€šè¿‡<code>useState</code>å»å­˜å‚¨ä¸€ä¸ªå…¨å±€å¯è§‚å¯Ÿå¯¹è±¡çš„å¼•ç”¨ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯, å› ä¸ºæˆ‘ä»¬ä¸éœ€è¦æ›¿æ¢å…¨å±€å¯è§‚å¯Ÿå¯¹è±¡çš„å¼•ç”¨,æ‰€ä»¥æˆ‘ä»¬å…¶å®å¯ä»¥å®Œå…¨ä¸å£°æ˜<code>useState</code>çš„æ›´æ–°æ–¹æ³•:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react-lite&quot;</span><span class="hljs-keyword">import</span> &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">const</span> [timer] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Timer</span>()) <span class="hljs-comment">// Timerçš„å®šä¹‰åœ¨ä¸Šé¢ï¼ˆæ­£å¦‚ä¸Šé¢æ‰€è¯´çš„é‚£æ ·è¿™é‡Œæˆ‘ä»¬å¿½ç•¥äº†æ›´æ–°æ–¹æ³•çš„å®šä¹‰Â·è¯‘è€…æ³¨ï¼‰ã€‚</span>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>&#125;)<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)</code></pre></div><p>å¦‚æœä½ æƒ³è¦ç±»ä¼¼æˆ‘ä»¬å®˜æ–¹çš„ä¾‹å­é‚£æ ·è‡ªåŠ¨æ›´æ–° timer , ä½¿ç”¨<code>useEffect</code> å¯èƒ½æ˜¯ React ä¸­æ¯”è¾ƒå…¸å‹çš„å†™æ³•ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">const</span> handle = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;        timer.<span class="hljs-title function_">increaseTimer</span>()    &#125;, <span class="hljs-number">1000</span>)    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-built_in">clearInterval</span>(handle)    &#125;&#125;, [timer])</code></pre></div><p>å¦‚åˆšæ‰è¯´çš„é‚£æ ·, ç›´æ¥åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨classesï¼ˆè¿™é‡Œçš„ç±»æŒ‡çš„æ˜¯å…¨å±€å®šä¹‰çš„Mobx stateï¼Œåœ¨å®ƒä»¬æ˜¯ä½¿ç”¨classå£°æ˜çš„ï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥å‚è€ƒ <a href="https://zh.mobx.js.org/observable-state.html#observable">observable</a>è¿™ç¯‡æ–‡ç« ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react-lite&quot;</span><span class="hljs-keyword">import</span> &#123; observable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">import</span> &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">const</span> [timer] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span>        <span class="hljs-title function_">observable</span>(&#123;            <span class="hljs-attr">secondsPassed</span>: <span class="hljs-number">0</span>,            <span class="hljs-title function_">increaseTimer</span>(<span class="hljs-params"></span>) &#123;                <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span>++            &#125;        &#125;)    )    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>&#125;)<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)</code></pre></div><p><code>const [store] = useState(() =&gt; observable(&#123; /* something */&#125;))</code> æ˜¯éå¸¸é€šç”¨çš„ä¸€å¥—å†™æ³•ï¼Œ ä¸ºäº†ç®€åŒ–è¿™ä¸ªå†™æ³•æˆ‘ä»¬å¯ä»¥è°ƒç”¨<code>mobx-react-lite</code> åŒ…ä¸­çš„ <a href="https://github.com/mobxjs/mobx-react#uselocalobservable-hook"><code>useLocalObservable</code></a> hook ,å¯ä»¥å°†ä¸Šé¢çš„ä¾‹å­ç®€åŒ–æˆï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; observer, useLocalObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react-lite&quot;</span><span class="hljs-keyword">import</span> &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">const</span> timer = <span class="hljs-title function_">useLocalObservable</span>(<span class="hljs-function">() =&gt;</span> (&#123;        <span class="hljs-attr">secondsPassed</span>: <span class="hljs-number">0</span>,        <span class="hljs-title function_">increaseTimer</span>(<span class="hljs-params"></span>) &#123;            <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span>++        &#125;    &#125;))    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>&#125;)<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)</code></pre></div><h3 id="ä¸è¦å°†å¯è§‚å¯Ÿå¯¹è±¡ä¼ é€’åˆ°-ä¸æ˜¯observerçš„ç»„ä»¶ä¸­ï¼ˆDonâ€™t-pass-observables-into-components-that-arenâ€™t-observerï¼‰"><a href="#ä¸è¦å°†å¯è§‚å¯Ÿå¯¹è±¡ä¼ é€’åˆ°-ä¸æ˜¯observerçš„ç»„ä»¶ä¸­ï¼ˆDonâ€™t-pass-observables-into-components-that-arenâ€™t-observerï¼‰" class="headerlink" title="ä¸è¦å°†å¯è§‚å¯Ÿå¯¹è±¡ä¼ é€’åˆ° ä¸æ˜¯observerçš„ç»„ä»¶ä¸­ï¼ˆDonâ€™t pass observables into components that arenâ€™t observerï¼‰"></a>ä¸è¦å°†å¯è§‚å¯Ÿå¯¹è±¡ä¼ é€’åˆ° ä¸æ˜¯<code>observer</code>çš„ç»„ä»¶ä¸­ï¼ˆDonâ€™t pass observables into components that arenâ€™t <code>observer</code>ï¼‰</h3><p>é€šè¿‡<code>observer</code>åŒ…è£¹çš„ç»„ä»¶ <em>åªå¯ä»¥</em> è®¢é˜…åˆ°åœ¨ <em>ä»–ä»¬è‡ªå·±</em> æ¸²æŸ“çš„æœŸé—´çš„å¯è§‚å¯Ÿå¯¹è±¡. å¦‚æœè¦å°†å¯è§‚å¯Ÿå¯¹è±¡ objects / arrays / maps ä¼ é€’åˆ°å­ç»„ä»¶ä¸­, ä»–ä»¬å¿…é¡»è¢« <code>observer</code> åŒ…è£¹ã€‚ é€šè¿‡callbackå›è°ƒçš„ç»„ä»¶ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p><p>å¦‚æœä½ éè¦ä¼ é€’å¯è§‚å¯Ÿå¯¹è±¡åˆ°æœªè¢«<code>observer</code>åŒ…è£¹çš„ç»„ä»¶ä¸­ï¼Œ è¦ä¹ˆæ˜¯å› ä¸ºå®ƒæ˜¯ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œè¦ä¹ˆä½ éœ€è¦ç»„ä»¶å¯¹Mobxæ— æ„ŸçŸ¥ï¼Œé‚£ä½ å¿…é¡»åœ¨ä¼ é€’å‰ <a href="https://zh.mobx.js.org/observable-state.html#%E5%B0%86-observable-%E8%BD%AC%E6%8D%A2%E5%9B%9E%E6%99%AE%E9%80%9A%E7%9A%84-javascript-%E9%9B%86%E5%90%88">è½¬æ¢å¯è§‚å¯Ÿå¯¹è±¡ä¸ºæ˜¾å¼ ï¼ˆconvert the observables to plain JavaScript values or structuresï¼‰</a> ã€‚</p><p>å…³äºä¸Šè¿°çš„è¯¦ç»†æè¿°, å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä½¿ç”¨ <code>todo</code> å¯¹è±¡çš„ä¾‹å­ï¼Œ ä¸€ä¸ª <code>TodoView</code> (observer)ç»„ä»¶å’Œä¸€ä¸ªè™šæ„çš„æ¥æ”¶ä¸€ç»„å¯¹è±¡æ˜ å°„å…¥å‚çš„ä¸æ˜¯<code>observer</code>çš„<code>GridRow</code>ç»„ä»¶</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Todo</span> &#123;    title = <span class="hljs-string">&quot;test&quot;</span>    done = <span class="hljs-literal">true</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;&#125;<span class="hljs-keyword">const</span> <span class="hljs-title class_">TodoView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">(<span class="hljs-params">&#123; todo &#125;: &#123; todo: Todo &#125;</span>) =&gt;</span>   <span class="hljs-comment">// é”™è¯¯: GridRow ä¸èƒ½è·å–åˆ° todo.title/ todo.done çš„å˜æ›´</span>   <span class="hljs-comment">//       å› ä¸ºä»–ä¸æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼ˆobserverã€‚</span>   <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">GridRow</span> <span class="hljs-attr">data</span>=<span class="hljs-string">&#123;todo&#125;</span> /&gt;</span></span>   <span class="hljs-comment">// æ­£ç¡®:åœ¨ `TodoView` ä¸­æ˜¾å¼çš„å£°æ˜ç›¸å…³çš„`todo` ï¼Œ</span>   <span class="hljs-comment">//      åˆ°dataä¸­ã€‚</span>   <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">GridRow</span> <span class="hljs-attr">data</span>=<span class="hljs-string">&#123;&#123;</span></span></span><span class="hljs-tag"><span class="language-xml">       <span class="hljs-attr">title:</span> <span class="hljs-attr">todo.title</span>,</span></span><span class="hljs-tag"><span class="language-xml">       <span class="hljs-attr">done:</span> <span class="hljs-attr">todo.done</span></span></span><span class="hljs-tag"><span class="language-xml">   &#125;&#125; /&gt;</span></span>   <span class="hljs-comment">// æ­£ç¡®: ä½¿ç”¨ `toJS`ä¹Ÿæ˜¯å¯ä»¥çš„, å¹¶ä¸”æ˜¯æ›´æ¸…æ™°ç›´ç™½çš„æ–¹å¼ã€‚</span>   <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">GridRow</span> <span class="hljs-attr">data</span>=<span class="hljs-string">&#123;toJS(todo)&#125;</span> /&gt;</span></span>)</code></pre></div><h3 id="å›è°ƒç»„ä»¶å¯èƒ½ä¼šéœ€è¦-lt-Observer-gt-ï¼ˆ-Callback-components-might-require-lt-Observer-gt-ï¼‰"><a href="#å›è°ƒç»„ä»¶å¯èƒ½ä¼šéœ€è¦-lt-Observer-gt-ï¼ˆ-Callback-components-might-require-lt-Observer-gt-ï¼‰" class="headerlink" title="å›è°ƒç»„ä»¶å¯èƒ½ä¼šéœ€è¦&lt;Observer&gt;ï¼ˆ Callback components might require &lt;Observer&gt;ï¼‰"></a>å›è°ƒç»„ä»¶å¯èƒ½ä¼šéœ€è¦<code>&lt;Observer&gt;</code>ï¼ˆ Callback components might require <code>&lt;Observer&gt;</code>ï¼‰</h3><p>æƒ³è±¡ä¸€ä¸‹åœ¨åŒæ ·çš„ä¾‹å­ä¸­, <code>GridRow</code> æºå¸¦ä¸€ä¸ª <code>onRender</code>å›è°ƒå‡½æ•°ã€‚ <code>onRender</code> æ˜¯ <code>GridRow</code>æ¸²æŸ“ç”Ÿå‘½å‘¨æœŸçš„ä¸€éƒ¨åˆ†, è€Œä¸æ˜¯ <code>TodoView</code> çš„render (ç”šè‡³åœ¨è¯­æ³•å±‚é¢éƒ½èƒ½çœ‹å‡ºæ¥)ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ä¿è¯å›è°ƒç»„ä»¶æ˜¯ä¸€ä¸ª <code>observer</code> ç»„ä»¶ã€‚ æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://github.com/mobxjs/mobx-react#observer">``</a>åˆ›å»ºä¸€ä¸ªåŒ¿åè§‚å¯Ÿè€…ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">TodoView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">(<span class="hljs-params">&#123; todo &#125;: &#123; todo: Todo &#125;</span>) =&gt;</span> &#123;    <span class="hljs-comment">// é”™è¯¯: GridRow.onRender ä¸èƒ½è·å¾— todo.title / todo.done ä¸­çš„æ”¹å˜</span>    <span class="hljs-comment">//        å› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼ˆobserverï¼‰ ã€‚</span>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">GridRow</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>&#123;todo.title&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>&#125; /&gt;</span>    <span class="hljs-comment">// æ­£ç¡®: å°†å›è°ƒç»„ä»¶é€šè¿‡ObserveråŒ…è£¹å°†ä¼šæ­£ç¡®çš„è·å¾—å˜åŒ–ã€‚</span>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">GridRow</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">Observer</span>&gt;</span>&#123;() =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>&#123;todo.title&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Observer</span>&gt;</span>&#125; /&gt;</span>&#125;)</code></pre></div><p><strong>mobx-react vs. mobx-react-lite</strong></p><p>åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬ä½¿ç”¨ <code>mobx-react-lite</code> ä½œä¸ºé»˜è®¤åŒ…ã€‚ <a href="https://github.com/mobxjs/mobx-react/">mobx-react</a> æ˜¯ä»–çš„å¤§å…„å¼Ÿï¼Œå®ƒé‡Œé¢ä¹Ÿå¼•ç”¨äº† <code>mobx-react-lite</code> åŒ…ã€‚ å®ƒæä¾›äº†å¾ˆå¤šåœ¨æ–°é¡¹ç›®ä¸­ä¸å†éœ€è¦çš„ç‰¹æ€§ï¼Œ mobx-reacté™„åŠ çš„ç‰¹æ€§æœ‰ï¼š</p><ol><li>å¯¹äºReact class componentsçš„æ”¯æŒã€‚</li><li><code>Provider</code> å’Œ<code>inject</code>. MobXçš„è¿™äº›ä¸œè¥¿åœ¨æœ‰ React.createContext æ›¿ä»£åå˜å¾—ä¸å¿…è¦äº†ã€‚</li><li>ç‰¹æ®Šçš„è§‚å¯Ÿå¯¹è±¡ <code>propTypes</code>ã€‚</li></ol><p>è¦æ³¨æ„ <code>mobx-react</code> æ˜¯å…¨é‡åŒ…ï¼Œä¹Ÿä¼šæš´éœ² <code>mobx-react-lite</code>åŒ…ä¸­çš„ä»»ä½•æ–¹æ³•,å…¶ä¸­åŒ…å«å¯¹å‡½æ•°ç»„ä»¶çš„æ”¯æŒã€‚ å¦‚æœä½ ä½¿ç”¨ <code>mobx-react</code>ï¼Œé‚£å°±ä¸è¦æ·»åŠ  <code>mobx-react-lite</code> çš„ä¾èµ–å’Œå¼•ç”¨äº†ã€‚</p><p><strong>observer ğŸ†š React.memo</strong></p><p><code>observer</code> ä¼šè‡ªåŠ¨çš„ä½¿ç”¨ <code>memo</code>, æ‰€ä»¥ <code>observer</code> ä¸éœ€è¦å†åŒ…è£¹ <code>memo</code>ã€‚ <code>memo</code> ä¼šè¢« observer ç»„ä»¶å®‰å…¨çš„ä½¿ç”¨ï¼Œå› ä¸ºä»»ä½•åœ¨propsä¸­çš„æ”¹å˜(å¾ˆæ·±çš„) éƒ½ä¼šè¢«<code>observer</code>å“åº”ã€‚</p><p><strong>åº”ç”¨<code>observer</code> åˆ°åŸºäºclassçš„ç»„ä»¶</strong></p><p>å¦‚ä¸Šæ‰€è¿°ï¼Œclass ç»„ä»¶åªåœ¨<code>mobx-react</code>åŒ…ä¸­å¾—åˆ°æ”¯æŒï¼Œ <code>mobx-react-lite</code>å¹¶ä¸æ”¯æŒã€‚ ç®€è€Œè¨€ä¹‹ï¼Œä½ å¯ä»¥å’Œå‡½æ•°å¼ç»„ä»¶ä¸€æ ·ä½¿ç”¨ <code>observer</code>åŒ…è£¹class ç»„ä»¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;React&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(    <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimerView</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;        <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;            <span class="hljs-keyword">const</span> &#123; timer &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>            <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.secondsPassed&#125; <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>        &#125;    &#125;)</code></pre></div><p>å¯ä»¥é˜…è¯» <a href="https://github.com/mobxjs/mobx-react#api-documentation">mobx-react æ–‡æ¡£</a> è·å¾—æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚</p><p><strong>å½“ä½ æƒ³è¦å°†<code>observer</code> å’Œå…¶ä»–é«˜é˜¶ç»„ä»¶ï¼ˆHOCÂ·è¯‘è€…æ³¨ï¼‰ä¸€èµ·ä½¿ç”¨, éœ€è¦é¦–å…ˆè°ƒç”¨ <code>observer</code></strong></p><p>å½“ <code>observer</code> éœ€è¦å’Œè£…é¥°å™¨æˆ–è€…å…¶ä»–é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œè¯·ç¡®ä¿ <code>observer</code> æ˜¯æœ€å†…å±‚çš„ (æœ€å…ˆè°ƒç”¨çš„) è£…é¥°å™¨ï¼Œå¦åˆ™çš„è¯å®ƒå¯èƒ½ä¸ä¼šå·¥ä½œ</p><p><strong>ä» propså¯¼å‡ºè®¡ç®—å±æ€§</strong></p><p>åœ¨æŸäº›æƒ…å†µä¸‹ä½ çš„ç»„ä»¶æœ¬åœ°å¯è§‚å¯Ÿå¯¹è±¡ï¼ˆlocal observablesï¼‰çš„è®¡ç®—å±æ€§å¯èƒ½ä¾èµ–äºä¸€äº›ä½ ç»„ä»¶æ¥å—åˆ°çš„å‚æ•°ï¼ˆpropsï¼‰ã€‚ ä½†æ˜¯,è¿™ä¸€ç³»åˆ—ä»Reactç»„ä»¶æ¥æ”¶åˆ°çš„å‚æ•°ï¼ˆpropsï¼‰æœ¬èº«å¹¶ä¸æ˜¯å¯è§‚å¯Ÿå¯¹è±¡ï¼Œæ‰€ä»¥æ›´æ”¹è¿™äº›ç»„ä»¶çš„å±æ€§ï¼ˆpropsï¼‰å¹¶ä¸ä¼šä½¿å¾—è®¡ç®—å±æ€§å“åº”ã€‚ä½ å¯èƒ½éœ€è¦æ‰‹åŠ¨çš„ä»æœ€æ–°çš„æ•°æ®æ¥æ›´æ–°å…¨å±€å¯è§‚å¯Ÿå¯¹è±¡çš„çŠ¶æ€æ¥è§¦å‘è®¡ç®—å±æ€§æ›´æ–°ã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; observer, useLocalObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react-lite&quot;</span><span class="hljs-keyword">import</span> &#123; useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">(<span class="hljs-params">&#123; offset &#125;</span>) =&gt;</span> &#123;    <span class="hljs-keyword">const</span> timer = <span class="hljs-title function_">useLocalObservable</span>(<span class="hljs-function">() =&gt;</span> (&#123;        offset, <span class="hljs-comment">// åˆå§‹åŒ–offset</span>        <span class="hljs-attr">secondsPassed</span>: <span class="hljs-number">0</span>,        <span class="hljs-title function_">increaseTimer</span>(<span class="hljs-params"></span>) &#123;            <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span>++        &#125;,        <span class="hljs-keyword">get</span> <span class="hljs-title function_">offsetTime</span>() &#123;            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">offset</span> <span class="hljs-comment">// è¿™é‡Œçš„&#x27;offset&#x27;ä¸æ˜¯&#x27;props&#x27;ä¼ å…¥çš„é‚£ä¸ª</span>        &#125;    &#125;))    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-comment">//åŒæ­¥æ¥è‡ª &#x27;props&#x27; çš„åå·®åˆ°å¯è§‚å¯Ÿå¯¹è±¡ &#x27;timer&#x27;</span>        timer.<span class="hljs-property">offset</span> = offset    &#125;, [offset])    <span class="hljs-comment">//ä½œä¸ºdemoç”¨é€”ï¼Œåˆå§‹åŒ–ä¸€ä¸ªå®šæ—¶å™¨.</span>    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-keyword">const</span> handle = <span class="hljs-built_in">setInterval</span>(timer.<span class="hljs-property">increaseTimer</span>, <span class="hljs-number">1000</span>)        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-built_in">clearInterval</span>(handle)        &#125;    &#125;, [])    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.offsetTime&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>&#125;)<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)</code></pre></div><p>åœ¨å®é™…é¡¹ç›®ä¸­ä½ å¯èƒ½å¾ˆå°‘éœ€è¦è¿™ç§å†™æ³•, å› ä¸º <code>return &lt;span&gt;Seconds passed: &#123;timer.secondsPassed - offset&#125;&lt;/span&gt;</code> æ›´åŠ ç®€å•, è™½ç„¶æ˜¯ç¨å¾®ä½æ•ˆç‡çš„è§£å†³æ–¹æ¡ˆã€‚</p><p><strong>useEffect ä¸ å¯è§‚å¯Ÿå¯¹è±¡</strong></p><p><code>useEffect</code> å¯ä»¥è¢«ç”¨äºè§¦å‘éœ€è¦å‘ç”Ÿçš„å‰¯ä½œç”¨, å®ƒå°†ä¼šè¢«çº¦æŸåœ¨React ç»„å»ºçš„ç”Ÿå‘½å‘¨æœŸä¸­ã€‚ ä½¿ç”¨ <code>useEffect</code>éœ€è¦æŒ‡å®šè¯¦ç»†çš„ä¾èµ–ã€‚ å¯¹äº MobX å´ä¸æ˜¯å¿…é¡»çš„, å› ä¸º MobX æ‹¥æœ‰ä¸€ç§çœŸæ­£çš„èƒ½æ£€æŸ¥åˆ°ä¾èµ–å‘å‘ç”Ÿçš„æ–¹æ³•ï¼Œ <code>autorun</code>ã€‚ ç»“åˆ <code>autorun</code>å¯ä»¥å¾ˆè½»æ¾çš„åœ¨ç”Ÿå‘½å‘¨æœŸç»„ä»¶ä¸­ä½¿ç”¨<code>useEffect</code>ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; observer, useLocalObservable, useAsObservableSource &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react-lite&quot;</span><span class="hljs-keyword">import</span> &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">const</span> timer = <span class="hljs-title function_">useLocalObservable</span>(<span class="hljs-function">() =&gt;</span> (&#123;        <span class="hljs-attr">secondsPassed</span>: <span class="hljs-number">0</span>,        <span class="hljs-title function_">increaseTimer</span>(<span class="hljs-params"></span>) &#123;            <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span>++        &#125;    &#125;))    <span class="hljs-comment">// åœ¨Effectæ–¹æ³•ä¹‹ä¸Šè§¦å‘å¯è§‚å¯Ÿå¯¹è±¡å˜åŒ–ã€‚</span>    <span class="hljs-title function_">useEffect</span>(        <span class="hljs-function">() =&gt;</span>            <span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;                <span class="hljs-keyword">if</span> (timer.<span class="hljs-property">secondsPassed</span> &gt; <span class="hljs-number">60</span>) <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;Still there. It&#x27;s a minute already?!!&quot;</span>)            &#125;),        []    )    <span class="hljs-comment">// ä½œä¸ºdemoç”¨é€”åœ¨Effecté‡Œå®šä¹‰ä¸€ä¸ªå®šæ—¶å™¨ã€‚</span>    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-keyword">const</span> handle = <span class="hljs-built_in">setInterval</span>(timer.<span class="hljs-property">increaseTimer</span>, <span class="hljs-number">1000</span>)        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-built_in">clearInterval</span>(handle)        &#125;    &#125;, [])    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Seconds passed: &#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>&#125;)<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)</code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬åœ¨effectæ–¹æ³•è¿”å›äº†ä¸€ä¸ªåˆ›å»ºè‡ª<code>autorun</code> çš„æ¸…é™¤æ–¹æ³•ã€‚ è¿™ä¸€ç‚¹æ˜¯éå¸¸é‡è¦çš„, å› ä¸ºä»–ç¡®ä¿äº† <code>autorun</code> åœ¨ç»„ä»¶å¸è½½çš„æ—¶å€™è¢«æ¸…é™¤äº†ï¼</p><p>ä¾èµ–æ•°ç»„å¯ä»¥ä¿æŒä¸ºç©ºï¼Œé™¤éæ˜¯ä¸€ä¸ªä¸å¯è§‚å¯Ÿå¯¹è±¡çš„å€¼éœ€è¦è§¦å‘autoruné‡æ–°è¿è¡Œï¼Œä½ æ‰éœ€è¦å°†å®ƒæ·»åŠ åˆ°è¿™é‡Œé¢ã€‚ è¯·ç¡®ä¿ä½ çš„æ ¼å¼æ­£ç¡®,ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª<code>å®šæ—¶å™¨ï¼ˆtimerï¼‰</code> (ä¸Šé¢çš„ä¾‹å­ä¸­) ä½œä¸ºä¾èµ–ã€‚ è¿™æ˜¯å®‰å…¨å¹¶ä¸”æ— å‰¯ä½œç”¨çš„ï¼Œ å› ä¸ºå®ƒå¼•ç”¨çš„ä¾èµ–æ ¹æœ¬ä¸ä¼šæ”¹å˜ã€‚</p><p>å¦‚æœä½ ä¸æƒ³æ˜¾å¼çš„åœ¨Effectä¸­å®šä¹‰å¯è§‚å¯Ÿå¯¹è±¡è¯·ä½¿ç”¨<code>reaction</code>è€Œä¸æ˜¯<code>autorun</code>ï¼Œä»–ä»¬çš„ä¼ å‚æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚</p><h1 id="ä¼˜åŒ–Reactç»„ä»¶æ¸²æŸ“-ğŸš€"><a href="#ä¼˜åŒ–Reactç»„ä»¶æ¸²æŸ“-ğŸš€" class="headerlink" title="ä¼˜åŒ–Reactç»„ä»¶æ¸²æŸ“ {ğŸš€}"></a>ä¼˜åŒ–Reactç»„ä»¶æ¸²æŸ“ {ğŸš€}</h1>]]></content>
    
    
    <categories>
      
      <category>react</category>
      
      <category>mobx</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ€æ‰‹çº§çš„TypeScriptåŠŸèƒ½ï¼šconstæ–­è¨€</title>
    <link href="/2022/10/06/%E6%9D%80%E6%89%8B%E7%BA%A7%E7%9A%84TypeScript%E5%8A%9F%E8%83%BD%EF%BC%9Aconst%E6%96%AD%E8%A8%80/"/>
    <url>/2022/10/06/%E6%9D%80%E6%89%8B%E7%BA%A7%E7%9A%84TypeScript%E5%8A%9F%E8%83%BD%EF%BC%9Aconst%E6%96%AD%E8%A8%80/</url>
    
    <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><code>const assertions</code>æ˜¯ts3.4æ–°å¢çš„åŠŸèƒ½ï¼Œä»¬å¯ä»¥ç”¨è¿™ä¸ªæ–°åŠŸèƒ½çœç•¥å¾ˆå¤šç¹ççš„ç±»å‹å£°æ˜</p><h3 id="const-assertions"><a href="#const-assertions" class="headerlink" title="const assertions"></a>const assertions</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> x = &#123; <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;hello&quot;</span> &#125; <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;</code></pre></div><p>å®˜æ–¹çš„è§£é‡Šæ˜¯</p><p>constæ–­è¨€æ˜¯ts3.4æ–°å¢çš„ä¸€ç§æ„é€ å‡½æ•°ï¼Œä»–çš„è¯­æ³•æ˜¯ç”¨constä»£æ›¿typeçš„ç±»å‹æ–­è¨€ï¼Œä¾‹å¦‚ <code>123 as const</code>ï¼‰ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨constè¿›è¡Œæ–­è¨€literal expressionçš„æ—¶å€™ï¼Œä¼šåšä»¥ä¸‹å¤„ç†</p><ol><li>è¯¥è¡¨è¾¾å¼çš„å­—é¢é‡ç±»å‹ä¸ä¼šè¢«æ‰©å±•</li><li>å¯¹è±¡å­—é¢é‡è·å–çš„æ˜¯readonlyå±æ€§</li><li>array literalså°†ä¼šå˜æˆreadonly tuples</li></ol><p>å®˜æ–¹çš„è§£é‡Šä¼šæ¯”è¾ƒå›°æƒ‘</p><h3 id="No-type-widening-for-literal-types-æ–‡å­—ç±»å‹æ²¡æœ‰ç±»å‹æ‰©å±•"><a href="#No-type-widening-for-literal-types-æ–‡å­—ç±»å‹æ²¡æœ‰ç±»å‹æ‰©å±•" class="headerlink" title="No type widening for literal types [æ–‡å­—ç±»å‹æ²¡æœ‰ç±»å‹æ‰©å±•]"></a>No type widening for literal types [æ–‡å­—ç±»å‹æ²¡æœ‰ç±»å‹æ‰©å±•]</h3><p>é€šè¿‡constæ–­è¨€ï¼Œæ–‡å­—ç±»å‹ä¸ä¼šè¢«æ‰©å±•ä¸ºæ›´åŠ å®½æ³›çš„ç±»å‹ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨constå£°æ˜å­—é¢é‡å˜é‡çš„æ—¶å€™ï¼Œç±»å‹å°±ä¼šç­‰äºå³ä¾§çš„å­—é¢é‡</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> x = <span class="hljs-string">&#x27;x&#x27;</span>; <span class="hljs-comment">// x has the type &#x27;x&#x27;</span></code></pre></div><p>constå…³é”®å­—å¯ä»¥ç¡®ä¿ä¸ä¼šé‡æ–°åˆ†é…å˜é‡ç±»å‹å¹¶ä¸”ä¼šä¿è¯æ›´åŠ ä¸¥æ ¼çš„ç±»å‹å®šä¹‰ï¼Œä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨letæ›¿ä»£constçš„æ—¶å€™ï¼Œletå°±ä¼šå˜æˆæ›´åŠ å®½æ³›çš„ç±»å‹</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> x = <span class="hljs-string">&#x27;x&#x27;</span>; <span class="hljs-comment">// has the type &#x27;x&#x27; </span><span class="hljs-keyword">let</span> y = <span class="hljs-string">&#x27;x&#x27;</span>;   <span class="hljs-comment">// has the type string</span></code></pre></div><p>yä¼šæ‰©å±•ä¸ºæ›´åŠ å®½æ³›çš„å€¼ï¼Œå…è®¸åˆ†é…å…¶ä»–å€¼ç»™y,è€Œxåªèƒ½æ˜¯å­—é¢é‡çš„x,å¦‚æœæˆ‘ä»¬å‘è®©letä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼Œå°±å¯ä»¥ä½¿ç”¨constæ–­è¨€</p><div class="code-wrapper"><pre><code class="hljs csharp"><span class="hljs-keyword">let</span> y = <span class="hljs-string">&#x27;x&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>; <span class="hljs-comment">// y has type &#x27;x&#x27;</span></code></pre></div><h3 id="object-literals-get-readonly-properties-å¯¹è±¡å­—é¢é‡è·å¾—åªè¯»å±æ€§"><a href="#object-literals-get-readonly-properties-å¯¹è±¡å­—é¢é‡è·å¾—åªè¯»å±æ€§" class="headerlink" title="object literals get readonly properties [å¯¹è±¡å­—é¢é‡è·å¾—åªè¯»å±æ€§]"></a>object literals get readonly properties [å¯¹è±¡å­—é¢é‡è·å¾—åªè¯»å±æ€§]</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> action = &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;INCREMENT&#x27;</span>, &#125; <span class="hljs-comment">// has type &#123; type: string &#125;</span></code></pre></div><p>constå£°æ˜å¯¹è±¡æ—¶ï¼Œå´ä¾ç„¶ä¼šå‡ºç°å±æ€§çš„æ‰©å±•</p><p>å¦‚æœä½ ç†Ÿæ‚‰ä½¿ç”¨reduxçš„æ—¶å€™ï¼Œactionç”¨äºæ‰§è¡Œä¿®æ”¹å˜é‡ï¼Œå¯¹å¤–ç•Œæ¥è¯´ï¼Œreduxæ˜¯å…¨å±€ä¸å¯ä¿®æ”¹çš„state store,stateåªèƒ½é€šè¿‡actionåœ¨reducerä¸­è¿›è¡Œä¿®æ”¹ï¼Œreduceræ˜¯çº¯å‡½æ•°ï¼Œä»–ä¼šè¿”å›æ›´æ–°ä¹‹åçš„stateçš„ç‰ˆæœ¬ï¼Œåœ¨actionè¢«dispatchä¹‹åã€</p><p>åœ¨reduxä¸­ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ˜¯åœ¨actionCreatorä¸­åˆ›å»ºaction,actionCreatorsæ˜¯çº¯å‡½æ•°ï¼Œå®ƒä¼šè¿”å›redux actionçš„å­—é¢é‡çš„å¯¹è±¡ï¼Œä»¥åŠæä¾›å‚æ•°ç»™action</p><p>ç”¨ä¸€ä¸ªä¾‹å­è¿›è¡Œè§£é‡Šè¯´æ˜</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params">n: number</span>) =&gt; &#123;  <span class="hljs-keyword">return</span> &#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET_COUNT&#x27;</span>,    <span class="hljs-attr">payload</span>: n,  &#125;&#125;<span class="hljs-keyword">const</span> action = <span class="hljs-title function_">setCount</span>(<span class="hljs-number">3</span>)<span class="hljs-comment">// action has type</span><span class="hljs-comment">// &#123; type: string, payload: number &#125;</span></code></pre></div><p>typeçš„ç±»å‹åº”è¯¥æ˜¯å­—é¢é‡çš„ï¼Œä½†æ˜¯ä¼šè¢«è‡ªåŠ¨è½¬æ¢æˆæ›´åŠ å®½æ³›çš„ç±»å‹ï¼Œåœ¨TS3.4ä»¥å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜¾ç¤ºçš„æŒ‡å®šè¿”å›å€¼ç±»å‹æ‰å¯ä»¥è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœï¼Œ</p><div class="code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SetCount</span> &#123;  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET_COUNT&#x27;</span>;  <span class="hljs-attr">payload</span>: <span class="hljs-built_in">number</span>;&#125;<span class="hljs-keyword">const</span> setCount = (<span class="hljs-attr">n</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">SetCount</span> =&gt;</span> &#123;  <span class="hljs-keyword">return</span> &#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET_COUNT&#x27;</span>,    <span class="hljs-attr">payload</span>: n,  &#125;&#125;<span class="hljs-keyword">const</span> action = <span class="hljs-title function_">setCount</span>(<span class="hljs-number">3</span>)<span class="hljs-comment">// action has type SetCount</span></code></pre></div><p>ts3.4ä»¥åä½¿ç”¨constæ–­è¨€ä¹Ÿå¯ä»¥å®ç°åŒæ ·çš„æ•ˆæœ,è€Œä¸”æ˜¯åªè¯»å±æ€§çš„</p><div class="code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params">n: <span class="hljs-built_in">number</span></span>) =&gt; &#123;  <span class="hljs-keyword">return</span> &lt;<span class="hljs-keyword">const</span>&gt;&#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET_COUNT&#x27;</span>,    <span class="hljs-attr">payload</span>: n  &#125;&#125;<span class="hljs-keyword">const</span> action = <span class="hljs-title function_">setCount</span>(<span class="hljs-number">3</span>);<span class="hljs-comment">// action has type</span><span class="hljs-comment">//  &#123; readonly type: &quot;SET_COUNT&quot;; readonly payload: number &#125;;</span></code></pre></div><p>å¯¹äºä½¿ç”¨äº†è”åˆç±»å‹çš„action,åœ¨æ²¡æœ‰ä½¿ç”¨constæ–­è¨€çš„æ—¶å€™ä¼šæ¯”è¾ƒéº»çƒ¦</p><div class="code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SetCount</span> &#123;  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET_COUNT&#x27;</span>;  <span class="hljs-attr">payload</span>: <span class="hljs-built_in">number</span>;&#125;<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ResetCount</span> &#123;  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;RESET_COUNT&#x27;</span>;&#125;<span class="hljs-keyword">const</span> setCount = (<span class="hljs-attr">n</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">SetCount</span> =&gt;</span> &#123;  <span class="hljs-keyword">return</span> &#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET_COUNT&#x27;</span>,    <span class="hljs-attr">payload</span>: n,  &#125;&#125;<span class="hljs-keyword">const</span> resetCount = (): <span class="hljs-function"><span class="hljs-params">ResetCount</span> =&gt;</span> &#123;  <span class="hljs-keyword">return</span> &#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;RESET_COUNT&#x27;</span>,  &#125;&#125;<span class="hljs-keyword">type</span> <span class="hljs-title class_">CountActions</span> = <span class="hljs-title class_">SetCount</span> | <span class="hljs-title class_">ResetCount</span></code></pre></div><p>é€šè¿‡ä½¿ç”¨constçš„ç”¨æ³•</p><div class="code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params">n: <span class="hljs-built_in">number</span></span>) =&gt; &#123;  <span class="hljs-keyword">return</span> &lt;<span class="hljs-keyword">const</span>&gt;&#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET_COUNT&#x27;</span>,    <span class="hljs-attr">payload</span>: n  &#125;&#125;<span class="hljs-keyword">const</span> <span class="hljs-title function_">resetCount</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-keyword">return</span> &lt;<span class="hljs-keyword">const</span>&gt;&#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;RESET_COUNT&#x27;</span>  &#125;&#125;<span class="hljs-keyword">type</span> <span class="hljs-title class_">CountActions</span> = <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> setCount&gt; | <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> resetCount&gt;;</code></pre></div><h3 id="Array-literals-become-readonly-tuples"><a href="#Array-literals-become-readonly-tuples" class="headerlink" title="Array literals become readonly tuples"></a>Array literals become <code>readonly</code> tuples</h3><div class="code-wrapper"><pre><code class="hljs sqf">const <span class="hljs-built_in">action</span> = &#123;  <span class="hljs-built_in">type</span>: <span class="hljs-string">&#x27;SET_HOURS&#x27;</span>,  payload: [<span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>],&#125;<span class="hljs-comment">//  &#123; type: string; payload: number[]; &#125;</span><span class="hljs-built_in">action</span>.payload.push(<span class="hljs-number">12</span>) <span class="hljs-comment">// no error</span></code></pre></div><p>actionã€‚payloadæ˜¯å¯ä»¥ä¿®æ”¹çš„</p><p>å¦‚æœä½¿ç”¨äº†constæ–­è¨€</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> action = &lt;<span class="hljs-keyword">const</span>&gt;&#123;  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET_HOURS&#x27;</span>,  <span class="hljs-attr">payload</span>: [<span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>]&#125;<span class="hljs-comment">// &#123;</span><span class="hljs-comment">//  readonly type: &quot;SET_HOURS&quot;;</span><span class="hljs-comment">//  readonly payload: readonly [8, 12, 5, 8];</span><span class="hljs-comment">// &#125;</span>action.<span class="hljs-property">payload</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">12</span>);  <span class="hljs-comment">// error - Property &#x27;push&#x27; does not exist on type &#x27;readonly [8, 12, 5, 8]&#x27;.</span></code></pre></div><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">let</span> obj = &#123;  <span class="hljs-attr">x</span>: <span class="hljs-number">10</span>,  <span class="hljs-attr">y</span>: [<span class="hljs-number">20</span>, <span class="hljs-number">30</span>],  <span class="hljs-attr">z</span>: &#123;    <span class="hljs-attr">a</span>:      &#123;  <span class="hljs-attr">b</span>: <span class="hljs-number">42</span> &#125;  &#125; &#125; <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;</code></pre></div><p>è½¬æ¢æˆ</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: &#123;  readonly <span class="hljs-attr">x</span>: <span class="hljs-number">10</span>;  readonly <span class="hljs-attr">y</span>: readonly [<span class="hljs-number">20</span>, <span class="hljs-number">30</span>];  readonly <span class="hljs-attr">z</span>: &#123;    readonly <span class="hljs-attr">a</span>: &#123;      readonly <span class="hljs-attr">b</span>: <span class="hljs-number">42</span>;    &#125;;  &#125;;&#125;;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>typescript</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>React18+Typescriptçš„ä½¿ç”¨</title>
    <link href="/2022/10/05/React18-Typescript%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/10/05/React18-Typescript%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>react</category>
      
      <category>Typescript</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Enzyme react å•å…ƒæµ‹è¯•</title>
    <link href="/2022/09/25/Enzyme-react-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"/>
    <url>/2022/09/25/Enzyme-react-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h1 id="enyzmeä¸å†æ”¯æŒreact18ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¯·ä½¿ç”¨å®˜æ–¹çš„æµ‹è¯•å·¥å…·React-Testing-Library"><a href="#enyzmeä¸å†æ”¯æŒreact18ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¯·ä½¿ç”¨å®˜æ–¹çš„æµ‹è¯•å·¥å…·React-Testing-Library" class="headerlink" title="enyzmeä¸å†æ”¯æŒreact18ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¯·ä½¿ç”¨å®˜æ–¹çš„æµ‹è¯•å·¥å…·React Testing Library"></a>enyzmeä¸å†æ”¯æŒreact18ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¯·ä½¿ç”¨å®˜æ–¹çš„æµ‹è¯•å·¥å…·React Testing Library</h1><p><strong>enzyme</strong> / ËˆenzaÉªm /</p><p>Enzymeæ˜¯ä¸€ç§reactçš„javascriptçš„å•å…ƒæµ‹è¯•å·¥å…·ï¼Œå¯ä»¥è½»æ¾çš„æµ‹è¯•reactç»„ä»¶çš„è¾“å‡ºï¼ŒEnyzmeçš„APIä¸»è¦æ˜¯æ¨¡ä»¿jqçš„apiæ¥è¿›è¡ŒDOMçš„éå†å’Œæ“ä½œ</p><p>å®‰è£…æ–¹å¼</p><div class="code-wrapper"><pre><code class="hljs bash">npm i --save-dev enzyme enzyme-adapter-react-17</code></pre></div><p>enzymeçš„é…ç½®æ–¹å¼</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Enzyme</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;enzyme&#x27;</span>;<span class="hljs-keyword">import</span> <span class="hljs-title class_">Adapter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;enzyme-adapter-react-17&#x27;</span>;<span class="hljs-title class_">Enzyme</span>.<span class="hljs-title function_">configure</span>(&#123; <span class="hljs-attr">adapter</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Adapter</span>() &#125;);</code></pre></div><p>Enzymeçš„ä¸‰ç§æ¸²æŸ“ç»„ä»¶çš„æ–¹å¼</p><h4 id="Shallow-Rendering"><a href="#Shallow-Rendering" class="headerlink" title="Shallow Rendering"></a>Shallow Rendering</h4><p>æ˜¯å¯¹å®˜æ–¹çš„Shallow Rendererçš„å°è£…ï¼Œå°†ç»„ä»¶æ¸²æŸ“æˆè™šæ‹ŸDOMå¯¹è±¡ï¼Œåªä¼šæ¸²æŸ“ç¬¬ä¸€å±‚ï¼Œå­ç»„ä»¶å°†ä¸ä¼šæ¸²æŸ“å‡ºæ¥ï¼Œå› æ­¤æ•ˆç‡éå¸¸é«˜ï¼Œä¸éœ€è¦DOMç¯å¢ƒï¼Œå¹¶ä¸”å¯ä»¥ä»¥JQçš„æ–¹å¼è®¿é—®ç»„ä»¶</p><div class="code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> &#123; shallow &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;enzyme&#x27;</span>;<span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">shallow</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span></span>);<span class="hljs-comment">// ...</span></code></pre></div><h5 id="å¸¸è§çš„api"><a href="#å¸¸è§çš„api" class="headerlink" title="å¸¸è§çš„api"></a>å¸¸è§çš„api</h5><h6 id="at-index-gt-ShallowWrapper"><a href="#at-index-gt-ShallowWrapper" class="headerlink" title=".at(index) =&gt; ShallowWrapper"></a><code>.at(index) =&gt; ShallowWrapper</code></h6><p>é€šè¿‡ç´¢å¼•è·å–å¯¹åº”çš„wrapper</p><div class="code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">shallow</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span></span>);<span class="hljs-title function_">expect</span>(wrapper.<span class="hljs-title function_">find</span>(<span class="hljs-title class_">Foo</span>).<span class="hljs-title function_">at</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">props</span>().<span class="hljs-property">foo</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-string">&#x27;bar&#x27;</span>);</code></pre></div><p>å’Œgetæ–¹æ³•ç›¸ä¼¼ï¼Œä½†æ˜¯è¿”å›å€¼æ˜¯reactElementä¸æ˜¯wrapper</p><p>firstæ–¹æ³•ç›¸å½“äºat(0),lastæ–¹æ³•ç›¸å½“äºè¿”å›æœ€åä¸€ä¸ª</p><h6 id="childAt-index-gt-ShallowWrapper"><a href="#childAt-index-gt-ShallowWrapper" class="headerlink" title=".childAt(index) =&gt; ShallowWrapper"></a><code>.childAt(index) =&gt; ShallowWrapper</code></h6><p>é€šè¿‡ç´¢å¼•æ‰¾åˆ°ç¬¬å‡ ä¸ªå­å…ƒç´ ï¼Œè¿”å›wrapper</p><div class="code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">shallow</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoList</span> <span class="hljs-attr">items</span>=<span class="hljs-string">&#123;items&#125;</span> /&gt;</span></span>);<span class="hljs-title function_">expect</span>(wrapper.<span class="hljs-title function_">find</span>(<span class="hljs-string">&#x27;ul&#x27;</span>).<span class="hljs-title function_">childAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">type</span>()).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</code></pre></div><h6 id="children-selector-gt-ShallowWrapper"><a href="#children-selector-gt-ShallowWrapper" class="headerlink" title=".children([selector]) =&gt; ShallowWrapper"></a><code>.children([selector]) =&gt; ShallowWrapper</code></h6><p>æ‰¾åˆ°æ‰€æœ‰å­å…ƒç´ ï¼Œå¯ä»¥ä¼ å…¥å¯é€‰å‚æ•°ï¼Œè¿”å›wrapper</p><div class="code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">shallow</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoList</span> <span class="hljs-attr">items</span>=<span class="hljs-string">&#123;items&#125;</span> /&gt;</span></span>);<span class="hljs-title function_">expect</span>(wrapper.<span class="hljs-title function_">find</span>(<span class="hljs-string">&#x27;ul&#x27;</span>).<span class="hljs-title function_">children</span>()).<span class="hljs-property">to</span>.<span class="hljs-property">have</span>.<span class="hljs-title function_">lengthOf</span>(items.<span class="hljs-property">length</span>);</code></pre></div><h6 id="closest-selector-gt-ShallowWrapper"><a href="#closest-selector-gt-ShallowWrapper" class="headerlink" title=".closest(selector) =&gt; ShallowWrapper"></a><code>.closest(selector) =&gt; ShallowWrapper</code></h6><p>è¿”å›åŒ¹é…åˆ°çš„é€‰æ‹©å™¨çš„ç¬¬ä¸€ä¸ªé€‰æ‹©å™¨çš„wrapper</p><div class="code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">shallow</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span></span>);<span class="hljs-title function_">expect</span>(wrapper.<span class="hljs-title function_">find</span>(<span class="hljs-title class_">Foo</span>).<span class="hljs-title function_">closest</span>(<span class="hljs-string">&#x27;.bar&#x27;</span>)).<span class="hljs-property">to</span>.<span class="hljs-property">have</span>.<span class="hljs-title function_">lengthOf</span>(<span class="hljs-number">1</span>);</code></pre></div><h4 id="Full-DOM-Rendering"><a href="#Full-DOM-Rendering" class="headerlink" title="Full DOM Rendering"></a>Full DOM Rendering</h4><p>å®Œå…¨æ¸²æŸ“ï¼Œå®ƒå°†ç»„ä»¶æ¸²æŸ“åŠ è½½æˆä¸€ä¸ªçœŸå®çš„DOMèŠ‚ç‚¹ï¼Œç”¨æ¥æµ‹è¯•DOM APIçš„äº¤äº’å’Œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œç”¨åˆ°äº†jsdomæ¥æ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒ</p><div class="code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> &#123; mount &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;enzyme&#x27;</span>;<span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">mount</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span></span>);</code></pre></div><h4 id="Static-Rendered-Markup"><a href="#Static-Rendered-Markup" class="headerlink" title="Static Rendered Markup"></a>Static Rendered Markup</h4><p>é™æ€æ¸²æŸ“ï¼Œå®ƒå°†Reactç»„ä»¶æ¸²æŸ“æˆé™æ€çš„HTMLå­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨Cheerioè¿™ä¸ªåº“è§£æè¿™æ®µå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ä¸€ä¸ªCheerioçš„å®ä¾‹å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥åˆ†æç»„ä»¶çš„htmlç»“æ„</p><div class="code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> &#123; render &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;enzyme&#x27;</span>;<span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span></span>);<span class="hljs-comment">// ...</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å•å…ƒæµ‹è¯•</category>
      
      <category>Enzyme</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>secket.ioç¬”è®°</title>
    <link href="/2022/09/24/secket-io%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/09/24/secket-io%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>ç›®å‰æ˜¯4.xç‰ˆæœ¬</p><h2 id="ä»€ä¹ˆæ˜¯-Socket-IO"><a href="#ä»€ä¹ˆæ˜¯-Socket-IO" class="headerlink" title="ä»€ä¹ˆæ˜¯ Socket.IO"></a>ä»€ä¹ˆæ˜¯ Socket.IO</h2><p>Socket.IO æ˜¯ä¸€ä¸ªåº“ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å®ç° <strong>ä½å»¶è¿Ÿ</strong>, <strong>åŒå‘</strong> å’Œ <strong>åŸºäºäº‹ä»¶çš„</strong> é€šä¿¡ã€‚</p><p><img src="https://socket.io/zh-CN/images/bidirectional-communication2.png" alt="Diagram of a communication between a server and a client"></p><p>å®ƒå»ºç«‹åœ¨ <a href="https://fr.wikipedia.org/wiki/WebSocket">WebSocket</a> åè®®ä¹‹ä¸Šï¼Œå¹¶æä¾›é¢å¤–çš„ä¿è¯ï¼Œä¾‹å¦‚å›é€€åˆ° HTTP é•¿è½®è¯¢æˆ–è‡ªåŠ¨é‡æ–°è¿æ¥ã€‚</p><p>è¿™é‡Œåªä»‹ç»socket.ioåœ¨webç«¯çš„ä½¿ç”¨</p><p>è¿™æ˜¯ä¸€ä¸ªwebsocketçš„å®ä¾‹</p><p><em>æœåŠ¡å™¨</em> (åŸºäº <a href="https://github.com/websockets/ws">ws</a>)</p><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> i ws</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">WebSocketServer</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;ws&quot;</span>;<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketServer</span>(&#123; <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span> &#125;);server.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</span>  socket.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;hello from server&quot;</span>,    <span class="hljs-attr">content</span>: [ <span class="hljs-number">1</span>, <span class="hljs-string">&quot;2&quot;</span> ]  &#125;));  <span class="hljs-comment">// ä»å®¢æˆ·ç«¯æ¥æ”¶æ¶ˆæ¯</span>  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;    <span class="hljs-keyword">const</span> packet = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);    <span class="hljs-keyword">switch</span> (packet.<span class="hljs-property">type</span>) &#123;      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;hello from server&quot;</span>:        <span class="hljs-comment">// ...</span>        <span class="hljs-keyword">break</span>;    &#125;  &#125;);&#125;);</code></pre></div><p>å®¢æˆ·ç«¯</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">WebSocket</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;ws&quot;</span>;<span class="hljs-keyword">const</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&quot;ws://localhost:3000&quot;</span>);socket.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;open&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">// å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯</span>  socket.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;    <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;hello from server&quot;</span>,    <span class="hljs-attr">content</span>: [ <span class="hljs-number">3</span>, <span class="hljs-string">&quot;4&quot;</span> ]  &#125;));&#125;);<span class="hljs-comment">// ä»æœåŠ¡å™¨æ¥æ”¶æ¶ˆæ¯</span>socket.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-function">(<span class="hljs-params">&#123; data &#125;</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> packet = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);  <span class="hljs-keyword">switch</span> (packet.<span class="hljs-property">type</span>) &#123;    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;hello from server&quot;</span>:      <span class="hljs-comment">// ...</span>      <span class="hljs-keyword">break</span>;  &#125;&#125;);</code></pre></div><p>socket.ioçš„ç¤ºä¾‹,éœ€è¦å…ˆå®‰è£…socket.ioå’Œsocket.io-client</p><p>æœåŠ¡ç«¯</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(<span class="hljs-number">3000</span>);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</span>  socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello from server&quot;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;2&quot;</span>, &#123; <span class="hljs-number">3</span>: <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>([<span class="hljs-number">4</span>]) &#125;);  <span class="hljs-comment">// ä»å®¢æˆ·ç«¯æ¥æ”¶æ¶ˆæ¯</span>  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;hello from server&quot;</span>, <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;    <span class="hljs-comment">// ...</span>  &#125;);&#125;);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; io &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io-client&quot;</span>;<span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;ws://localhost:3000&quot;</span>);<span class="hljs-comment">// å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯</span>socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello from server&quot;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;6&quot;</span>, &#123; <span class="hljs-number">7</span>: <span class="hljs-title class_">Uint8Array</span>.<span class="hljs-title function_">from</span>([<span class="hljs-number">8</span>]) &#125;);<span class="hljs-comment">// ä»æœåŠ¡å™¨æ¥æ”¶æ¶ˆæ¯</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;hello from server&quot;</span>, <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><h2 id="Socket-IO-ä¸æ˜¯ä»€ä¹ˆ"><a href="#Socket-IO-ä¸æ˜¯ä»€ä¹ˆ" class="headerlink" title="Socket.IO ä¸æ˜¯ä»€ä¹ˆ"></a>Socket.IO ä¸æ˜¯ä»€ä¹ˆ</h2><p>Socket.IO <strong>ä¸æ˜¯</strong> WebSocketå®ç°ã€‚æ˜¯åŸºäºWebSocketåè®®</p><p>å°½ç®¡ Socket.IO ç¡®å®åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ WebSocket è¿›è¡Œä¼ è¾“ï¼Œä½†å®ƒä¸ºæ¯ä¸ªæ•°æ®åŒ…æ·»åŠ äº†é¢å¤–çš„å…ƒæ•°æ®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ WebSocket å®¢æˆ·ç«¯å°†æ— æ³•æˆåŠŸè¿æ¥åˆ° Socket.IO æœåŠ¡å™¨ï¼Œè€Œ Socket.IO å®¢æˆ·ç«¯ä¹Ÿå°†æ— æ³•è¿æ¥åˆ°æ™®é€š WebSocket æœåŠ¡å™¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs abnf">// è­¦å‘Šï¼šå®¢æˆ·ç«¯å°†æ— æ³•è¿æ¥ï¼const socket <span class="hljs-operator">=</span> io(<span class="hljs-string">&quot;ws://echo.websocket.org&quot;</span>)<span class="hljs-comment">;</span></code></pre></div><h2 id="Socket-IOç‰¹ç‚¹"><a href="#Socket-IOç‰¹ç‚¹" class="headerlink" title="Socket.IOç‰¹ç‚¹"></a>Socket.IOç‰¹ç‚¹</h2><h3 id="HTTP-é•¿è½®è¯¢å›é€€"><a href="#HTTP-é•¿è½®è¯¢å›é€€" class="headerlink" title="HTTP é•¿è½®è¯¢å›é€€"></a>HTTP é•¿è½®è¯¢å›é€€</h3><p>å¦‚æœæ— æ³•å»ºç«‹ WebSocket è¿æ¥ï¼Œè¿æ¥å°†å›é€€åˆ° HTTP é•¿è½®è¯¢ã€‚</p><h3 id="è‡ªåŠ¨é‡æ–°è¿æ¥"><a href="#è‡ªåŠ¨é‡æ–°è¿æ¥" class="headerlink" title="è‡ªåŠ¨é‡æ–°è¿æ¥"></a>è‡ªåŠ¨é‡æ–°è¿æ¥</h3><p>åœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„ WebSocket è¿æ¥å¯èƒ½ä¼šä¸­æ–­ï¼Œè€ŒåŒæ–¹éƒ½ä¸çŸ¥é“é“¾æ¥çš„æ–­å¼€çŠ¶æ€ã€‚</p><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Socket.IO åŒ…å«ä¸€ä¸ªå¿ƒè·³æœºåˆ¶ï¼Œå®ƒä¼šå®šæœŸæ£€æŸ¥è¿æ¥çš„çŠ¶æ€ã€‚</p><p>å½“å®¢æˆ·ç«¯æœ€ç»ˆæ–­å¼€è¿æ¥æ—¶ï¼Œå®ƒä¼šä»¥æŒ‡æ•°å›é€€å»¶è¿Ÿè‡ªåŠ¨é‡æ–°è¿æ¥ï¼Œä»¥å…ä½¿æœåŠ¡å™¨ä¸å ªé‡è´Ÿã€‚</p><h3 id="æ•°æ®åŒ…ç¼“å†²"><a href="#æ•°æ®åŒ…ç¼“å†²" class="headerlink" title="æ•°æ®åŒ…ç¼“å†²"></a>æ•°æ®åŒ…ç¼“å†²</h3><p>å½“å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œæ•°æ®åŒ…ä¼šè‡ªåŠ¨ç¼“å†²ï¼Œå¹¶åœ¨é‡æ–°è¿æ¥æ—¶å‘é€</p><h3 id="æ”¶åˆ°åçš„å›è°ƒ"><a href="#æ”¶åˆ°åçš„å›è°ƒ" class="headerlink" title="æ”¶åˆ°åçš„å›è°ƒ"></a>æ”¶åˆ°åçš„å›è°ƒ</h3><p>Socket.IO æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥å‘é€äº‹ä»¶å’Œæ¥æ”¶å“åº”    </p><p><em>å‘ä»¶äºº</em></p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>, <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response); <span class="hljs-comment">// &quot;got it&quot;</span>&#125;);</code></pre></div><p><em>æ¥æ”¶è€…</em></p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-function">(<span class="hljs-params">arg, callback</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg); <span class="hljs-comment">// &quot;world&quot;</span>  <span class="hljs-title function_">callback</span>(<span class="hljs-string">&quot;got it!&quot;</span>);&#125;);</code></pre></div><h3 id="å¹¿æ’­"><a href="#å¹¿æ’­" class="headerlink" title="å¹¿æ’­"></a>å¹¿æ’­</h3><p><a href="https://socket.io/zh-CN/docs/v4/broadcasting-events/">åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ‚¨å¯ä»¥å‘æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯</a>æˆ–<a href="https://socket.io/zh-CN/docs/v4/rooms/">å®¢æˆ·ç«¯çš„å­é›†</a>å‘é€äº‹ä»¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// åˆ°æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯</span>io.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>);<span class="hljs-comment">// è‡´â€œnewsâ€æˆ¿é—´ä¸­çš„æ‰€æœ‰è¿æ¥å®¢æˆ·ç«¯</span>io.<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;news&quot;</span>).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>);</code></pre></div><h3 id="å¤šè·¯å¤ç”¨"><a href="#å¤šè·¯å¤ç”¨" class="headerlink" title="å¤šè·¯å¤ç”¨"></a>å¤šè·¯å¤ç”¨</h3><p>å‘½åç©ºé—´å…è®¸æ‚¨åœ¨å•ä¸ªå…±äº«è¿æ¥ä¸Šæ‹†åˆ†åº”ç”¨ç¨‹åºçš„é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³åˆ›å»ºä¸€ä¸ªåªæœ‰æˆæƒç”¨æˆ·æ‰èƒ½åŠ å…¥çš„â€œç®¡ç†å‘˜â€é¢‘é“ï¼Œè¿™å¯èƒ½å¾ˆæœ‰ç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// æ™®é€šç”¨æˆ·</span>&#125;);io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/admin&quot;</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ç®¡ç†å‘˜ç”¨æˆ·</span>&#125;);</code></pre></div><h2 id="è¿ä½œåŸç†"><a href="#è¿ä½œåŸç†" class="headerlink" title="è¿ä½œåŸç†"></a>è¿ä½œåŸç†</h2><p>Socket.IO æœåŠ¡å™¨ (Node.js) å’Œ Socket.IO å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨, Node.js, or <a href="https://socket.io/zh-CN/docs/v4/#what-socketio-is">å…¶ä»–ç¼–ç¨‹è¯­è¨€</a>ï¼‰ä¹‹é—´çš„åŒå‘é€šé“å°½å¯èƒ½ä½¿ç”¨<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket">WebSocket è¿æ¥</a>å»ºç«‹ï¼Œå¹¶å°†ä½¿ç”¨ HTTP é•¿è½®è¯¢ä½œä¸ºåå¤‡ã€‚</p><p>Socket.IO ä»£ç åº“åˆ†ä¸ºä¸¤ä¸ªä¸åŒçš„å±‚ï¼š</p><ul><li>åº•å±‚é€šé“ï¼šæˆ‘ä»¬ç§°ä¹‹ä¸ºEngine.IOï¼ŒSocket.IOå†…éƒ¨çš„å¼•æ“</li><li>é«˜çº§ APIï¼šSocket.IO æœ¬èº«</li></ul><h2 id="Engine-IO"><a href="#Engine-IO" class="headerlink" title="Engine.IO"></a>Engine.IO</h2><p>Engine.IO è´Ÿè´£å»ºç«‹æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„ä½çº§è¿æ¥ã€‚å®ƒå¤„ç†ï¼š</p><ul><li>å„ç§<a href="https://socket.io/zh-CN/docs/v4/how-it-works/#transports">ä¼ è¾“</a>å’Œ<a href="https://socket.io/zh-CN/docs/v4/how-it-works/#upgrade-mechanism">å‡çº§æœºåˆ¶</a></li><li><a href="https://socket.io/zh-CN/docs/v4/how-it-works/#disconnection-detection">æ–­çº¿æ£€æµ‹</a></li></ul><p>æºä»£ç å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š</p><ul><li>æœåŠ¡å™¨ï¼š<a href="https://github.com/socketio/engine.io">https://github.com/socketio/engine.io</a></li><li>å®¢æˆ·ç«¯ï¼š<a href="https://github.com/socketio/engine.io-client">https://github.com/socketio/engine.io-client</a></li><li>è§£æå™¨ï¼š<a href="https://github.com/socketio/engine.io-parser">https://github.com/socketio/engine.io-parser</a></li><li>åè®®è¯´æ˜ï¼š<a href="https://github.com/socketio/engine.io-protocol">https://github.com/socketio/engine.io-protocol</a></li></ul><h3 id="ä¼ è¾“"><a href="#ä¼ è¾“" class="headerlink" title="ä¼ è¾“"></a>ä¼ è¾“</h3><p>ç›®å‰æœ‰ä¸¤ç§å®ç°çš„ä¼ è¾“:</p><ul><li><a href="https://socket.io/zh-CN/docs/v4/how-it-works/#http-long-polling">HTTP é•¿è½®è¯¢</a></li><li><a href="https://socket.io/zh-CN/docs/v4/how-it-works/#websocket">WebSocket</a></li></ul><h4 id="HTTP-é•¿è½®è¯¢"><a href="#HTTP-é•¿è½®è¯¢" class="headerlink" title="HTTP é•¿è½®è¯¢"></a>HTTP é•¿è½®è¯¢</h4><p>THTTP é•¿è½®è¯¢ä¼ è¾“ï¼ˆä¹Ÿç®€ç§°ä¸ºâ€œè½®è¯¢â€ï¼‰ç”±è¿ç»­çš„ HTTP è¯·æ±‚ç»„æˆï¼š</p><ul><li>é•¿æ—¶é—´è¿è¡Œçš„ <code>GET</code> è¯·æ±‚ï¼Œç”¨äºä»æœåŠ¡å™¨æ¥æ”¶æ•°æ®</li><li>çŸ­æ—¶ <code>POST</code> è¯·æ±‚ï¼Œç”¨äºå‘æœåŠ¡å™¨å‘é€æ•°æ®</li></ul><p>ç”±äºä¼ è¾“çš„æ€§è´¨ï¼Œå¯èƒ½ä¼šåœ¨åŒä¸€ä¸ª HTTP è¯·æ±‚ä¸­è¿æ¥å¹¶å‘é€è¿ç»­çš„è¯·æ±‚ã€‚</p><h4 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h4><p>WebSocket ä¼ è¾“ç”±<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API">WebSocket è¿æ¥</a>ç»„æˆï¼Œå®ƒåœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´æä¾›åŒå‘å’Œä½å»¶è¿Ÿçš„é€šä¿¡é€šé“ã€‚</p><p>ç”±äºä¼ è¾“çš„æ€§è´¨ï¼Œæ¯ä¸ªå‘å°„éƒ½åœ¨å…¶è‡ªå·±çš„ WebSocket å¸§ä¸­å‘é€ï¼ˆæœ‰äº›å‘å°„ç”šè‡³å¯èƒ½å¯¼è‡´ä¸¤ä¸ªä¸åŒçš„ WebSocket å¸§ï¼Œæ›´å¤šä¿¡æ¯<a href="https://socket.io/zh-CN/docs/v4/custom-parser/#the-default-parser">åœ¨è¿™é‡Œ</a>).</p><h3 id="æ¡æ‰‹"><a href="#æ¡æ‰‹" class="headerlink" title="æ¡æ‰‹"></a>æ¡æ‰‹</h3><p>åœ¨ Engine.IO è¿æ¥å¼€å§‹æ—¶ï¼ŒæœåŠ¡å™¨å‘é€ä¸€äº›ä¿¡æ¯ï¼š</p><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>  <span class="hljs-attr">&quot;sid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;FSDjX-WRwSA4zTZMALqx&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;upgrades&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;websocket&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;pingInterval&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25000</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;pingTimeout&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20000</span><span class="hljs-punctuation">&#125;</span></code></pre></div><p>å¤åˆ¶</p><ul><li><code>sid</code> æ˜¯ä¼šè¯çš„IDï¼Œå®ƒå¿…é¡»åŒ…å«åœ¨sidæ‰€æœ‰åç»­HTTPè¯·æ±‚çš„æŸ¥è¯¢å‚æ•°ä¸­</li><li><code>upgrades</code> æ•°ç»„åŒ…å«æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰â€œæ›´å¥½â€ä¼ è¾“çš„åˆ—è¡¨</li><li><code>pingInterval</code> å’Œ <code>pingTimeout</code> å€¼ç”¨äºå¿ƒè·³</li></ul><h3 id="å‡çº§æœºåˆ¶"><a href="#å‡çº§æœºåˆ¶" class="headerlink" title="å‡çº§æœºåˆ¶"></a>å‡çº§æœºåˆ¶</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ HTTP é•¿è½®è¯¢ä¼ è¾“å»ºç«‹è¿æ¥ã€‚</p><p><strong>ä¸ºä»€ä¹ˆå‘¢?</strong></p><p>è™½ç„¶ WebSocket æ˜¾ç„¶æ˜¯å»ºç«‹åŒå‘é€šä¿¡çš„æœ€ä½³æ–¹å¼ï¼Œä½†ç»éªŒè¡¨æ˜ï¼Œç”±äºä¼ä¸šä»£ç†ã€ä¸ªäººé˜²ç«å¢™ã€é˜²ç—…æ¯’è½¯ä»¶â€¦</p><p>ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ªä¸æˆåŠŸçš„ WebSocket è¿æ¥å¯ä»¥è½¬åŒ–ä¸ºç­‰å¾…å®æ—¶åº”ç”¨ç¨‹åºå¼€å§‹äº¤æ¢æ•°æ®çš„è‡³å°‘ 10 ç§’ã€‚ è¿™åœ¨<strong>æ„ŸçŸ¥</strong>ä¸Šä¼šæŸå®³ç”¨æˆ·ä½“éªŒã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼ŒEngine.ioé¦–å…ˆå…³æ³¨å¯é æ€§å’Œç”¨æˆ·ä½“éªŒï¼Œå…¶æ¬¡å…³æ³¨æ½œåœ¨çš„ UX æ”¹è¿›å’Œæé«˜æœåŠ¡å™¨æ€§èƒ½ã€‚</p><p>è¦å‡çº§ï¼Œå®¢æˆ·ç«¯å°†ï¼š</p><ul><li>ç¡®ä¿å…¶ä¼ å‡ºç¼“å†²åŒºä¸ºç©º</li><li>å°†å½“å‰ä¼ è¾“è®¾ç½®ä¸ºåªè¯»æ¨¡å¼</li><li>å°è¯•ä¸å…¶ä»–ä¼ è¾“å»ºç«‹è¿æ¥</li><li>å¦‚æœæˆåŠŸï¼Œå…³é—­ç¬¬ä¸€ä¸ªä¼ è¾“</li></ul><p>æ‚¨å¯ä»¥åœ¨æµè§ˆå™¨çš„ç½‘ç»œç›‘è§†å™¨ä¸­æŸ¥çœ‹ï¼š</p><p><img src="https://socket.io/zh-CN/assets/images/network-monitor-2e47dbe233100aa290595f8687a9fcba.png" alt="Successful upgrade"></p><ol><li>æ¡æ‰‹ (åŒ…å«ä¼šè¯ ID â€” æ­¤å¤„, <code>zBjrh...AAAK</code> â€” ç”¨äºåç»­è¯·æ±‚)</li><li>å‘é€æ•°æ® (HTTP é•¿è½®è¯¢)</li><li>æ¥æ”¶æ•°æ® (HTTP é•¿è½®è¯¢)</li><li>å‡çº§ (WebSocket)</li><li>æ¥æ”¶æ•°æ® (HTTP é•¿è½®è¯¢, WebSocketè¿æ¥å»ºç«‹æˆåŠŸåå…³é—­)</li></ol><h3 id="æ–­çº¿æ£€æµ‹"><a href="#æ–­çº¿æ£€æµ‹" class="headerlink" title="æ–­çº¿æ£€æµ‹"></a>æ–­çº¿æ£€æµ‹</h3><p>Engine.IO è¿æ¥åœ¨ä»¥ä¸‹æƒ…å†µä¸‹è¢«è§†ä¸ºå…³é—­ï¼š</p><ul><li>ä¸€ä¸ª HTTP è¯·æ±‚ï¼ˆGET æˆ– POSTï¼‰å¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œå½“æœåŠ¡å™¨å…³é—­æ—¶ï¼‰</li><li>WebSocket è¿æ¥å…³é—­ï¼ˆä¾‹å¦‚ï¼Œå½“ç”¨æˆ·å…³é—­å…¶æµè§ˆå™¨ä¸­çš„é€‰é¡¹å¡æ—¶ï¼‰</li><li><code>socket.disconnect()</code> åœ¨æœåŠ¡å™¨ç«¯æˆ–å®¢æˆ·ç«¯è°ƒç”¨</li></ul><p>è¿˜æœ‰ä¸€ä¸ªå¿ƒè·³æœºåˆ¶æ£€æŸ¥æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„è¿æ¥æ˜¯å¦ä»ç„¶æ­£å¸¸è¿è¡Œï¼š</p><p>åœ¨ç»™å®šçš„æ—¶é—´é—´éš”ï¼ˆ <code>pingInterval</code>æ¡æ‰‹ä¸­å‘é€çš„å€¼ï¼‰ï¼ŒæœåŠ¡å™¨å‘é€ä¸€ä¸ª PING æ•°æ®åŒ…ï¼Œå®¢æˆ·ç«¯æœ‰å‡ ç§’é’Ÿï¼ˆè¯¥<code>pingTimeout</code>å€¼ï¼‰å‘é€ä¸€ä¸ª PONG æ•°æ®åŒ…ã€‚å¦‚æœæœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°è¿”å›çš„ PONG æ•°æ®åŒ…ï¼Œåˆ™è®¤ä¸ºè¿æ¥å·²å…³é—­ã€‚åä¹‹ï¼Œå¦‚æœå®¢æˆ·ç«¯åœ¨ å†…æ²¡æœ‰æ”¶åˆ° PING åŒ…<code>pingInterval + pingTimeout</code>ï¼Œåˆ™è®¤ä¸ºè¿æ¥å·²å…³é—­ã€‚</p><h2 id="Socket-IO"><a href="#Socket-IO" class="headerlink" title="Socket.IO"></a>Socket.IO</h2><p>Socket.IO é€šè¿‡ Engine.IO è¿æ¥æä¾›äº†ä¸€äº›é™„åŠ åŠŸèƒ½ï¼š</p><ul><li>è‡ªåŠ¨é‡è¿</li><li><a href="https://socket.io/zh-CN/docs/v4/client-offline-behavior/#buffered-events">æ•°æ®åŒ…ç¼“å†²</a></li><li><a href="https://socket.io/zh-CN/docs/v4/emitting-events/#acknowledgements">æ”¶åˆ°åçš„å›è°ƒ</a></li><li>å¹¿æ’­ <a href="https://socket.io/zh-CN/docs/v4/broadcasting-events/">åˆ°æ‰€æœ‰å®¢æˆ·ç«¯</a> æˆ– <a href="https://socket.io/zh-CN/docs/v4/rooms/">å®¢æˆ·ç«¯çš„å­é›†</a>ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œæˆ¿é—´â€ï¼‰</li><li><a href="https://socket.io/zh-CN/docs/v4/namespaces/">å¤šè·¯å¤ç”¨</a>ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œå‘½åç©ºé—´â€ï¼‰</li></ul><p>æºä»£ç å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š</p><ul><li>æœåŠ¡å™¨ï¼š<a href="https://github.com/socketio/socket.io">https://github.com/socketio/socket.io</a></li><li>å®¢æˆ·ç«¯ï¼š<a href="https://github.com/socketio/socket.io-client">https://github.com/socketio/socket.io-client</a></li><li>è§£æå™¨ï¼š<a href="https://github.com/socketio/socket.io-parser">https://github.com/socketio/socket.io-parser</a></li><li>åè®®è¯´æ˜ï¼š<a href="https://github.com/socketio/socket.io-protocol">https://github.com/socketio/socket.io-protocol</a></li></ul><h1 id="æœåŠ¡å™¨å®‰è£…"><a href="#æœåŠ¡å™¨å®‰è£…" class="headerlink" title="æœåŠ¡å™¨å®‰è£…"></a>æœåŠ¡å™¨å®‰è£…</h1><div class="code-wrapper"><pre><code class="hljs sh">npm install socket.io</code></pre></div><p>å®‰è£…ç‰¹å®šç‰ˆæœ¬ï¼š</p><div class="code-wrapper"><pre><code class="hljs sh">npm install socket.io@version</code></pre></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSocket.IO ä½¿ç”¨<a href="https://www.npmjs.com/package/ws">ws</a>åŒ…æä¾›çš„ WebSocket æœåŠ¡å™¨ã€‚</p><h1 id="æœåŠ¡å™¨åˆå§‹åŒ–"><a href="#æœåŠ¡å™¨åˆå§‹åŒ–" class="headerlink" title="æœåŠ¡å™¨åˆå§‹åŒ–"></a>æœåŠ¡å™¨åˆå§‹åŒ–</h1><h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><h3 id="åªä½¿ç”¨Socket"><a href="#åªä½¿ç”¨Socket" class="headerlink" title="åªä½¿ç”¨Socket"></a>åªä½¿ç”¨Socket</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//commonjs</span><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">Server</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;socket.io&quot;</span>);<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(&#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);io.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//esmodule</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(&#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);io.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(&#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);io.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><p>æ‚¨è¿˜å¯ä»¥å°†ç«¯å£ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(<span class="hljs-number">3000</span>, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><p>è¿™éšå¼å¯åŠ¨äº†ä¸€ä¸ª Node.js<a href="https://nodejs.org/docs/latest/api/http.html#http_class_http_server">HTTP æœåŠ¡å™¨</a>ï¼Œå¯ä»¥é€šè¿‡ <code>io.httpServer</code>ã€‚</p><h3 id="ä½¿ç”¨HTTPæœåŠ¡å™¨"><a href="#ä½¿ç”¨HTTPæœåŠ¡å™¨" class="headerlink" title="ä½¿ç”¨HTTPæœåŠ¡å™¨"></a>ä½¿ç”¨HTTPæœåŠ¡å™¨</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>();<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><h3 id="ä½¿ç”¨HTTPSæœåŠ¡å™¨"><a href="#ä½¿ç”¨HTTPSæœåŠ¡å™¨" class="headerlink" title="ä½¿ç”¨HTTPSæœåŠ¡å™¨"></a>ä½¿ç”¨HTTPSæœåŠ¡å™¨</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; readFileSync &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;fs&quot;</span>;<span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;https&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>(&#123;  <span class="hljs-attr">key</span>: <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/my/key.pem&quot;</span>),  <span class="hljs-attr">cert</span>: <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/my/cert.pem&quot;</span>)&#125;);<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><p>ä½¿ç”¨å®¢æˆ·ç«¯è¯ä¹¦èº«ä»½éªŒè¯ï¼š</p><p><em>æœåŠ¡å™¨</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; readFileSync &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;fs&quot;</span>;<span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;https&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>(&#123;  <span class="hljs-attr">key</span>: <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/server-key.pem&quot;</span>),  <span class="hljs-attr">cert</span>: <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/server-cert.pem&quot;</span>),  <span class="hljs-attr">requestCert</span>: <span class="hljs-literal">true</span>,  <span class="hljs-attr">ca</span>: [    <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/client-cert.pem&quot;</span>)  ]&#125;);<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-property">engine</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">rawSocket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// if you need the certificate details (it is no longer available once the handshake is completed)</span>  rawSocket.<span class="hljs-property">peerCertificate</span> = rawSocket.<span class="hljs-property">request</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">getPeerCertificate</span>();&#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">conn</span>.<span class="hljs-property">peerCertificate</span>);  <span class="hljs-comment">// ...</span>&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; readFileSync &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;fs&quot;</span>;<span class="hljs-keyword">import</span> &#123; io &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io-client&quot;</span>;<span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;https://example.com&quot;</span>, &#123;  <span class="hljs-attr">key</span>: <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/client-key.pem&quot;</span>),  <span class="hljs-attr">cert</span>: <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/client-cert.pem&quot;</span>),  <span class="hljs-attr">ca</span>: [    <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/server-cert.pem&quot;</span>)  ]&#125;);</code></pre></div><h3 id="ä½¿ç”¨HTTP-2æœåŠ¡å™¨"><a href="#ä½¿ç”¨HTTP-2æœåŠ¡å™¨" class="headerlink" title="ä½¿ç”¨HTTP/2æœåŠ¡å™¨"></a>ä½¿ç”¨HTTP/2æœåŠ¡å™¨</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; readFileSync &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;fs&quot;</span>;<span class="hljs-keyword">import</span> &#123; createSecureServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http2&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createSecureServer</span>(&#123;  <span class="hljs-attr">allowHTTP1</span>: <span class="hljs-literal">true</span>,  <span class="hljs-attr">key</span>: <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/my/key.pem&quot;</span>),  <span class="hljs-attr">cert</span>: <span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;/path/to/my/cert.pem&quot;</span>)&#125;);<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><h3 id="ä½¿ç”¨-Express"><a href="#ä½¿ç”¨-Express" class="headerlink" title="ä½¿ç”¨ Express"></a>ä½¿ç”¨ Express</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//esmodule</span><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;express&quot;</span>;<span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>(app);<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//ts</span><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;express&quot;</span>;<span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>(app);<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><p><u>åœ¨è¿™é‡Œä½¿ç”¨<code>app.listen(3000)</code>å°†ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ HTTP æœåŠ¡å™¨ã€‚</u></p><h3 id="ä½¿ç”¨-Koa"><a href="#ä½¿ç”¨-Koa" class="headerlink" title="ä½¿ç”¨ Koa"></a>ä½¿ç”¨ Koa</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Koa</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;koa&quot;</span>;<span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Koa</span>();<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>(app.<span class="hljs-title function_">callback</span>());<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Koa</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;koa&quot;</span>;<span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Koa</span>();<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>(app.<span class="hljs-title function_">callback</span>());<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123; <span class="hljs-comment">/* options */</span> &#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><h3 id="ä½¿ç”¨-ÂµWebSockets-js"><a href="#ä½¿ç”¨-ÂµWebSockets-js" class="headerlink" title="ä½¿ç”¨ ÂµWebSockets.js"></a>ä½¿ç”¨ ÂµWebSockets.js</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">App</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;uWebSockets.js&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">App</span>();<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>();io.<span class="hljs-title function_">attachApp</span>(app);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">(<span class="hljs-params">token</span>) =&gt;</span> &#123;  <span class="hljs-keyword">if</span> (!token) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&quot;port already in use&quot;</span>);  &#125;&#125;);</code></pre></div><h3 id="ä½¿ç”¨-Fastify"><a href="#ä½¿ç”¨-Fastify" class="headerlink" title="ä½¿ç”¨ Fastify"></a>ä½¿ç”¨ Fastify</h3><p>æ‚¨éœ€è¦æ³¨å†Œ<a href="https://github.com/alemagio/fastify-socket.io"><code>fastify-socket.io</code></a>æ’ä»¶ï¼š</p><ul><li><p>CommonJS</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fastify&quot;</span>);<span class="hljs-keyword">const</span> fastifyIO = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fastify-socket.io&quot;</span>);<span class="hljs-keyword">const</span> server = <span class="hljs-title function_">fastify</span>();server.<span class="hljs-title function_">register</span>(fastifyIO);server.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, reply</span>) =&gt;</span> &#123;  server.<span class="hljs-property">io</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>);&#125;);server.<span class="hljs-title function_">ready</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">// we need to wait for the server to be ready, else `server.io` is undefined</span>  server.<span class="hljs-property">io</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;    <span class="hljs-comment">// ...</span>  &#125;);&#125;);server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div></li><li><p>ES modules</p></li><li><p>```js<br>import fastify from â€œfastifyâ€;<br>import fastifyIO from â€œfastify-socket.ioâ€;</p><p>const server = fastify();<br>server.register(fastifyIO);</p><p>server.get(â€œ/â€œ, (req, reply) =&gt; {<br>  server.io.emit(â€œhelloâ€);<br>});</p><p>server.ready().then(() =&gt; {<br>  // we need to wait for the server to be ready, else <code>server.io</code> is undefined<br>  server.io.on(â€œconnectionâ€, (socket) =&gt; {</p><div class="code-wrapper"><pre><code class="hljs">// ...</code></pre></div><p>  });<br>});</p><p>server.listen(3000);</p><div class="code-wrapper"><pre><code class="hljs moonscript">  - TypeScript```ts<span class="hljs-keyword">import</span> fastify <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;fastify&quot;</span>;<span class="hljs-keyword">import</span> fastifyIO <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;fastify-socket.io&quot;</span>;const server = fastify();server.register(fastifyIO);server.get(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-function"><span class="hljs-params">(req, reply)</span> =&gt;</span> &#123;  server.<span class="hljs-built_in">io</span>.emit(<span class="hljs-string">&quot;hello&quot;</span>);&#125;);server.ready().<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;  // we need to wait <span class="hljs-keyword">for</span> the server to be ready, <span class="hljs-keyword">else</span> `server.<span class="hljs-built_in">io</span>` is undefined  server.<span class="hljs-built_in">io</span>.on(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function"><span class="hljs-params">(socket)</span> =&gt;</span> &#123;    // ...  &#125;);&#125;);server.listen(<span class="hljs-number">3000</span>);</code></pre></div></li></ul><h1 id="æœåŠ¡å™¨å®ä¾‹"><a href="#æœåŠ¡å™¨å®ä¾‹" class="headerlink" title="æœåŠ¡å™¨å®ä¾‹"></a>æœåŠ¡å™¨å®ä¾‹</h1><p>æœåŠ¡å™¨å®ä¾‹ï¼ˆé€šå¸¸<code>io</code>åœ¨ä»£ç ç¤ºä¾‹ä¸­è°ƒç”¨ï¼‰å…·æœ‰ä¸€äº›å¯èƒ½åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å±æ€§ã€‚</p><p>å®ƒè¿˜ç»§æ‰¿äº†<a href="https://socket.io/zh-CN/docs/v4/namespaces/#main-namespace">ä¸»å‘½åç©ºé—´</a>çš„æ‰€æœ‰æ–¹æ³•ï¼Œä¾‹å¦‚<a href="https://socket.io/zh-CN/docs/v4/server-api/#namespaceusefn"><code>namespace.use()</code></a>ï¼ˆå‚è§<a href="https://socket.io/zh-CN/docs/v4/middlewares/">æ­¤å¤„</a>ï¼‰æˆ– <a href="https://socket.io/zh-CN/docs/v4/server-api/#namespaceallsockets"><code>namespace.allSockets()</code></a>.</p><h2 id="æœåŠ¡å™¨-engine"><a href="#æœåŠ¡å™¨-engine" class="headerlink" title="æœåŠ¡å™¨#engine"></a>æœåŠ¡å™¨#engine</h2><p>å¯¹åº•å±‚ Engine.IO æœåŠ¡å™¨çš„å¼•ç”¨ã€‚</p><p>å®ƒå¯ç”¨äºè·å–å½“å‰è¿æ¥çš„å®¢æˆ·ç«¯æ•°é‡ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> count = io.<span class="hljs-property">engine</span>.<span class="hljs-property">clientsCount</span>;<span class="hljs-comment">// æ ¹æ®æ‚¨çš„ç”¨æ³•ï¼Œå¯èƒ½ä¸ä¸»å‘½åç©ºé—´ä¸­çš„Socketå®ä¾‹è®¡æ•°ç›¸ä¼¼æˆ–ä¸ç›¸ä¼¼</span><span class="hljs-keyword">const</span> count2 = io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/&quot;</span>).<span class="hljs-property">sockets</span>.<span class="hljs-property">size</span>;</code></pre></div><p>æˆ–è€…ç”Ÿæˆè‡ªå®šä¹‰ä¼šè¯ IDï¼ˆ<code>sid</code>æŸ¥è¯¢å‚æ•°ï¼‰ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> uuid = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;uuid&quot;</span>);io.<span class="hljs-property">engine</span>.<span class="hljs-property">generateId</span> = <span class="hljs-function">(<span class="hljs-params">req</span>) =&gt;</span> &#123;  <span class="hljs-keyword">return</span> uuid.<span class="hljs-title function_">v4</span>(); <span class="hljs-comment">// å¿…é¡»åœ¨æ‰€æœ‰socket.ioæœåŠ¡å™¨ä¸Šéƒ½æ˜¯å”¯ä¸€çš„</span>&#125;</code></pre></div><p>ä»<code>socket.io@4.1.0</code>å¼€å§‹ï¼ŒEngine.IO æœåŠ¡å™¨å‘å‡ºä¸‰ä¸ªç‰¹æ®Šäº‹ä»¶ï¼š</p><ul><li><code>initial_headers</code>: å°†åœ¨ç¼–å†™ä¼šè¯çš„ç¬¬ä¸€ä¸ª HTTP è¯·æ±‚ï¼ˆæ¡æ‰‹ï¼‰çš„å“åº”æ ‡å¤´ä¹‹å‰å‘å‡ºï¼Œå…è®¸æ‚¨è‡ªå®šä¹‰å®ƒä»¬ã€‚</li></ul><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-property">engine</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;initial_headers&quot;</span>, <span class="hljs-function">(<span class="hljs-params">headers, req</span>) =&gt;</span> &#123;  headers[<span class="hljs-string">&quot;test&quot;</span>] = <span class="hljs-string">&quot;123&quot;</span>;  headers[<span class="hljs-string">&quot;set-cookie&quot;</span>] = <span class="hljs-string">&quot;mycookie=456&quot;</span>;&#125;);</code></pre></div><ul><li><code>headers</code>: å°†åœ¨ç¼–å†™ä¼šè¯çš„æ¯ä¸ª HTTP è¯·æ±‚çš„å“åº”å¤´ä¹‹å‰å‘å‡ºï¼ˆåŒ…æ‹¬ WebSocket å‡çº§ï¼‰ï¼Œå…è®¸æ‚¨è‡ªå®šä¹‰å®ƒä»¬ã€‚</li></ul><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-property">engine</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;headers&quot;</span>, <span class="hljs-function">(<span class="hljs-params">headers, req</span>) =&gt;</span> &#123;  headers[<span class="hljs-string">&quot;test&quot;</span>] = <span class="hljs-string">&quot;789&quot;</span>;&#125;);</code></pre></div><ul><li><code>connection_error</code>: å½“è¿æ¥å¼‚å¸¸å…³é—­æ—¶å‘å‡º</li></ul><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-property">engine</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection_error&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">req</span>);      <span class="hljs-comment">// the request object</span>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">code</span>);     <span class="hljs-comment">// the error code, for example 1</span>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>);  <span class="hljs-comment">// the error message, for example &quot;Session ID unknown&quot;</span>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">context</span>);  <span class="hljs-comment">// some additional error context</span>&#125;);</code></pre></div><p>ä»¥ä¸‹æ˜¯å¯èƒ½çš„é”™è¯¯ä»£ç åˆ—è¡¨ï¼š</p><table><thead><tr><th>Code</th><th>Message</th></tr></thead><tbody><tr><td>0</td><td>â€œTransport unknownâ€</td></tr><tr><td>1</td><td>â€œSession ID unknownâ€</td></tr><tr><td>2</td><td>â€œBad handshake methodâ€</td></tr><tr><td>3</td><td>â€œBad requestâ€</td></tr><tr><td>4</td><td>â€œForbiddenâ€</td></tr><tr><td>5</td><td>â€œUnsupported protocol versionâ€</td></tr></tbody></table><h3 id="socketsJoin"><a href="#socketsJoin" class="headerlink" title="socketsJoin"></a><code>socketsJoin</code></h3><p>æ­¤æ–¹æ³•ä½¿åŒ¹é…çš„ Socket å®ä¾‹åŠ å…¥æŒ‡å®šçš„æˆ¿é—´ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// make all Socket instances join the &quot;room1&quot; room</span>io.<span class="hljs-title function_">socketsJoin</span>(<span class="hljs-string">&quot;room1&quot;</span>);<span class="hljs-comment">// make all Socket instances in the &quot;room1&quot; room join the &quot;room2&quot; and &quot;room3&quot; rooms</span>io.<span class="hljs-title function_">in</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">socketsJoin</span>([<span class="hljs-string">&quot;room2&quot;</span>, <span class="hljs-string">&quot;room3&quot;</span>]);<span class="hljs-comment">// make all Socket instances in the &quot;room1&quot; room of the &quot;admin&quot; namespace join the &quot;room2&quot; room</span>io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/admin&quot;</span>).<span class="hljs-title function_">in</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">socketsJoin</span>(<span class="hljs-string">&quot;room2&quot;</span>);<span class="hljs-comment">// this also works with a single socket ID</span>io.<span class="hljs-title function_">in</span>(theSocketId).<span class="hljs-title function_">socketsJoin</span>(<span class="hljs-string">&quot;room1&quot;</span>);</code></pre></div><h3 id="socketsLeave"><a href="#socketsLeave" class="headerlink" title="socketsLeave"></a><code>socketsLeave</code></h3><p>è¯¥æ–¹æ³•ä½¿åŒ¹é…çš„ Socket å®ä¾‹ç¦»å¼€æŒ‡å®šæˆ¿é—´ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// make all Socket instances leave the &quot;room1&quot; room</span>io.<span class="hljs-title function_">socketsLeave</span>(<span class="hljs-string">&quot;room1&quot;</span>);<span class="hljs-comment">// make all Socket instances in the &quot;room1&quot; room leave the &quot;room2&quot; and &quot;room3&quot; rooms</span>io.<span class="hljs-title function_">in</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">socketsLeave</span>([<span class="hljs-string">&quot;room2&quot;</span>, <span class="hljs-string">&quot;room3&quot;</span>]);<span class="hljs-comment">// make all Socket instances in the &quot;room1&quot; room of the &quot;admin&quot; namespace leave the &quot;room2&quot; room</span>io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/admin&quot;</span>).<span class="hljs-title function_">in</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">socketsLeave</span>(<span class="hljs-string">&quot;room2&quot;</span>);<span class="hljs-comment">// this also works with a single socket ID</span>io.<span class="hljs-title function_">in</span>(theSocketId).<span class="hljs-title function_">socketsLeave</span>(<span class="hljs-string">&quot;room1&quot;</span>);</code></pre></div><h3 id="disconnectSockets"><a href="#disconnectSockets" class="headerlink" title="disconnectSockets"></a><code>disconnectSockets</code></h3><p>æ­¤æ–¹æ³•ä½¿åŒ¹é…çš„ Socket å®ä¾‹æ–­å¼€è¿æ¥ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// make all Socket instances disconnect</span>io.<span class="hljs-title function_">disconnectSockets</span>();<span class="hljs-comment">// make all Socket instances in the &quot;room1&quot; room disconnect (and discard the low-level connection)</span>io.<span class="hljs-title function_">in</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">disconnectSockets</span>(<span class="hljs-literal">true</span>);<span class="hljs-comment">// make all Socket instances in the &quot;room1&quot; room of the &quot;admin&quot; namespace disconnect</span>io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/admin&quot;</span>).<span class="hljs-title function_">in</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">disconnectSockets</span>();<span class="hljs-comment">// this also works with a single socket ID</span>io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/admin&quot;</span>).<span class="hljs-title function_">in</span>(theSocketId).<span class="hljs-title function_">disconnectSockets</span>();</code></pre></div><h3 id="fetchSockets"><a href="#fetchSockets" class="headerlink" title="fetchSockets"></a><code>fetchSockets</code></h3><p>æ­¤æ–¹æ³•è¿”å›åŒ¹é…çš„ Socket å®ä¾‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// return all Socket instances of the main namespace</span><span class="hljs-keyword">const</span> sockets = <span class="hljs-keyword">await</span> io.<span class="hljs-title function_">fetchSockets</span>();<span class="hljs-comment">// return all Socket instances in the &quot;room1&quot; room of the main namespace</span><span class="hljs-keyword">const</span> sockets = <span class="hljs-keyword">await</span> io.<span class="hljs-title function_">in</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">fetchSockets</span>();<span class="hljs-comment">// return all Socket instances in the &quot;room1&quot; room of the &quot;admin&quot; namespace</span><span class="hljs-keyword">const</span> sockets = <span class="hljs-keyword">await</span> io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/admin&quot;</span>).<span class="hljs-title function_">in</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">fetchSockets</span>();<span class="hljs-comment">// this also works with a single socket ID</span><span class="hljs-keyword">const</span> sockets = <span class="hljs-keyword">await</span> io.<span class="hljs-title function_">in</span>(theSocketId).<span class="hljs-title function_">fetchSockets</span>();</code></pre></div><p>ä¸Šä¾‹ä¸­çš„<code>sockets</code>å˜é‡æ˜¯ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæš´éœ²äº†é€šå¸¸çš„ Socket ç±»çš„ä¸€ä¸ªå­é›†ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> socket <span class="hljs-keyword">of</span> sockets) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">id</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">handshake</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">rooms</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">data</span>);  socket.<span class="hljs-title function_">emit</span>(<span class="hljs-comment">/* ... */</span>);  socket.<span class="hljs-title function_">join</span>(<span class="hljs-comment">/* ... */</span>);  socket.<span class="hljs-title function_">leave</span>(<span class="hljs-comment">/* ... */</span>);  socket.<span class="hljs-title function_">disconnect</span>(<span class="hljs-comment">/* ... */</span>);&#125;</code></pre></div><p><code>data</code>å±æ€§æ˜¯ä¸€ä¸ªä»»æ„å¯¹è±¡ï¼Œå¯ç”¨äºåœ¨ Socket.IO æœåŠ¡å™¨ä¹‹é—´å…±äº«ä¿¡æ¯ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// server A</span>io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-property">data</span>.<span class="hljs-property">username</span> = <span class="hljs-string">&quot;alice&quot;</span>;&#125;);<span class="hljs-comment">// server B</span><span class="hljs-keyword">const</span> sockets = <span class="hljs-keyword">await</span> io.<span class="hljs-title function_">fetchSockets</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sockets[<span class="hljs-number">0</span>].<span class="hljs-property">data</span>.<span class="hljs-property">username</span>); <span class="hljs-comment">// &quot;alice&quot;</span></code></pre></div><h3 id="serverSideEmit"><a href="#serverSideEmit" class="headerlink" title="serverSideEmit"></a><code>serverSideEmit</code></h3><p>æ­¤æ–¹æ³•å…è®¸åœ¨<a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/">å¤šæœåŠ¡å™¨è®¾ç½®</a>ä¸­å‘é›†ç¾¤çš„å…¶ä»– Socket.IO æœåŠ¡å™¨å‘å‡ºäº‹ä»¶ã€‚</p><p>è¯­æ³•ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">serverSideEmit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);</code></pre></div><p>åœ¨æ¥æ”¶æ–¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-function">(<span class="hljs-params">arg1</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg1); <span class="hljs-comment">// prints &quot;world&quot;</span>&#125;);</code></pre></div><p>ä¹Ÿæ”¯æŒç¡®è®¤ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// server A</span>io.<span class="hljs-title function_">serverSideEmit</span>(<span class="hljs-string">&quot;ping&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err, responses</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(responses[<span class="hljs-number">0</span>]); <span class="hljs-comment">// prints &quot;pong&quot;</span>&#125;);<span class="hljs-comment">// server B</span>io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;ping&quot;</span>, <span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> &#123;  <span class="hljs-title function_">cb</span>(<span class="hljs-string">&quot;pong&quot;</span>);&#125;);</code></pre></div><p>ç¬”è®°ï¼š</p><ul><li><code>connection</code>ï¼Œ<code>connect</code> å’Œ <code>new_namespace</code> å­—ç¬¦ä¸²æ˜¯ä¿ç•™çš„ï¼Œä¸èƒ½åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚</li><li>æ‚¨å¯ä»¥å‘é€ä»»æ„æ•°é‡çš„å‚æ•°ï¼Œä½†ç›®å‰ä¸æ”¯æŒäºŒè¿›åˆ¶ç»“æ„ï¼ˆå‚æ•°æ•°ç»„å°†è¢«<code>JSON.stringify</code>-edï¼‰</li></ul><p>ä¾‹å­ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">serverSideEmit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;2&quot;</span>, &#123; <span class="hljs-number">3</span>: <span class="hljs-string">&quot;4&quot;</span> &#125;);</code></pre></div><ul><li>å¦‚æœå…¶ä»– Socket.IO æœåŠ¡å™¨åœ¨ç»™å®šå»¶è¿Ÿåæ²¡æœ‰å“åº”ï¼Œåˆ™è°ƒç”¨ç¡®è®¤å›è°ƒå¯èƒ½ä¼šå‡ºé”™</li></ul><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">serverSideEmit</span>(<span class="hljs-string">&quot;ping&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err, responses</span>) =&gt;</span> &#123;  <span class="hljs-keyword">if</span> (err) &#123;    <span class="hljs-comment">// at least one Socket.IO server has not responded</span>    <span class="hljs-comment">// the &#x27;responses&#x27; array contains all the responses already received though</span>  &#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-comment">// success! the &#x27;responses&#x27; array contains one object per other Socket.IO server in the cluster</span>  &#125;&#125;);</code></pre></div><h2 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h2><p>Server å®ä¾‹å‘å‡ºä¸€ä¸ªäº‹ä»¶ï¼ˆå¥½å§ï¼Œä»æŠ€æœ¯ä¸Šè®²æ˜¯ä¸¤ä¸ªï¼Œä½†<code>connect</code>å®ƒæ˜¯<code>connection</code>çš„åˆ«åï¼‰ï¼š</p><ul><li><a href="https://socket.io/zh-CN/docs/v4/server-instance/#connection"><code>connection</code></a></li></ul><h3 id="connection"><a href="#connection" class="headerlink" title="connection"></a><code>connection</code></h3><p>æ­¤äº‹ä»¶åœ¨æ–°è¿æ¥æ—¶è§¦å‘ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª<a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/">Socketå®ä¾‹</a>.</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><h1 id="Socket-å®ä¾‹ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰"><a href="#Socket-å®ä¾‹ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰" class="headerlink" title="Socket å®ä¾‹ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰"></a>Socket å®ä¾‹ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰</h1><p><code>Socket</code>æ˜¯ä¸å®¢æˆ·ç«¯äº¤äº’çš„åŸºç¡€ç±»ã€‚å®ƒç»§æ‰¿äº† Node.js<a href="https://nodejs.org/api/events.html#class-eventemitter">EventEmitter</a>çš„æ‰€æœ‰æ–¹æ³•ï¼Œä¾‹å¦‚<a href="https://socket.io/zh-CN/docs/v4/server-api/#socketemiteventname-args">emit</a>, <a href="https://socket.io/zh-CN/docs/v4/server-api/#socketoneventname-callback">on</a>, <a href="https://socket.io/zh-CN/docs/v4/server-api/#socketonceeventname-listener">once</a> æˆ– <a href="https://socket.io/zh-CN/docs/v4/server-api/#socketremovelistenereventname-listener">removeListener</a>.</p><p><img src="https://socket.io/zh-CN/images/bidirectional-communication-socket.png" alt="Bidirectional communication between server and client"></p><p>é™¤äº†ï¼š</p><ul><li><a href="https://socket.io/zh-CN/docs/v4/emitting-events/#basic-emit">å‘å‡º</a> å’Œ <a href="https://socket.io/zh-CN/docs/v4/listening-to-events/">ç›‘å¬</a> äº‹ä»¶</li><li><a href="https://socket.io/zh-CN/docs/v4/broadcasting-events/#to-all-connected-clients-except-the-sender">å¹¿æ’­äº‹ä»¶</a></li><li><a href="https://socket.io/zh-CN/docs/v4/rooms/#joining-and-leaving">åŠ å…¥å’Œç¦»å¼€æˆ¿é—´</a></li></ul><p>Socket å®ä¾‹æœ‰ä¸€äº›å¯èƒ½åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å±æ€§ï¼š</p><h2 id="Socket-id"><a href="#Socket-id" class="headerlink" title="Socket#id"></a>Socket#id</h2><p>æ¯ä¸ªæ–°è¿æ¥éƒ½åˆ†é…æœ‰ä¸€ä¸ªéšæœºçš„ 20 ä¸ªå­—ç¬¦çš„æ ‡è¯†ç¬¦ã€‚</p><p>æ­¤æ ‡è¯†ç¬¦ä¸å®¢æˆ·ç«¯çš„å€¼åŒæ­¥ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// server-side</span>io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">id</span>); <span class="hljs-comment">// ojIckSD2jqNzOqIrAGzL</span>&#125;);<span class="hljs-comment">// client-side</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">id</span>); <span class="hljs-comment">// ojIckSD2jqNzOqIrAGzL</span>&#125;);</code></pre></div><p>åˆ›å»ºåï¼ŒSocket ä¼šåŠ å…¥ç”±å…¶è‡ªå·±çš„ id æ ‡è¯†çš„æˆ¿é—´ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥å°†å…¶ç”¨äºç§äººæ¶ˆæ¯ä¼ é€’ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function"><span class="hljs-params">socket</span> =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;private message&quot;</span>, <span class="hljs-function">(<span class="hljs-params">anotherSocketId, msg</span>) =&gt;</span> &#123;    socket.<span class="hljs-title function_">to</span>(anotherSocketId).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;private message&quot;</span>, socket.<span class="hljs-property">id</span>, msg);  &#125;);&#125;);</code></pre></div><p>æ³¨æ„ï¼šæ‚¨ä¸èƒ½è¦†ç›–æ­¤æ ‡è¯†ç¬¦ï¼Œå› ä¸ºå®ƒåœ¨ Socket.IO ä»£ç åº“çš„å¤šä¸ªéƒ¨åˆ†ä¸­ä½¿ç”¨ã€‚</p><h2 id="Socket-handshake"><a href="#Socket-handshake" class="headerlink" title="Socket#handshake"></a>Socket#handshake</h2><p>æ­¤å¯¹è±¡åŒ…å«æœ‰å…³åœ¨ Socket.IO ä¼šè¯å¼€å§‹æ—¶å‘ç”Ÿçš„æ¡æ‰‹çš„ä¸€äº›è¯¦ç»†ä¿¡æ¯ã€‚</p><div class="code-wrapper"><pre><code class="hljs text">&#123;  headers: /* the headers of the initial request */  query: /* the query params of the initial request */  auth: /* the authentication payload */  time: /* the date of creation (as string) */  issued: /* the date of creation (unix timestamp) */  url: /* the request URL string */  address: /* the ip of the client */  xdomain: /* whether the connection is cross-domain */  secure: /* whether the connection is secure */&#125;</code></pre></div><p>ä¾‹å­ï¼š</p><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>  <span class="hljs-attr">&quot;headers&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;user-agent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;xxxx&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;accept&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;*/*&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;example.com&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;connection&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;close&quot;</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;EIO&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;transport&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;polling&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;t&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;NNjNltH&quot;</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;auth&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;token&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;123&quot;</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Sun Nov 22 2020 01:33:46 GMT+0100 (Central European Standard Time)&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;issued&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1606005226969</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;url&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/socket.io/?EIO=4&amp;transport=polling&amp;t=NNjNltH&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;::ffff:1.2.3.4&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;xdomain&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;secure&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">&#125;</span></code></pre></div><h2 id="Socket-rooms"><a href="#Socket-rooms" class="headerlink" title="Socket#rooms"></a>Socket#rooms</h2><p>è¿™æ˜¯å¯¹ Socket å½“å‰æ‰€åœ¨<a href="https://socket.io/zh-CN/docs/v4/rooms/">æˆ¿é—´</a>çš„å¼•ç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">rooms</span>); <span class="hljs-comment">// Set &#123; &lt;socket.id&gt; &#125;</span>  socket.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;room1&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">rooms</span>); <span class="hljs-comment">// Set &#123; &lt;socket.id&gt;, &quot;room1&quot; &#125;</span>&#125;);</code></pre></div><h2 id="Socket-data"><a href="#Socket-data" class="headerlink" title="Socket#data"></a>Socket#data</h2><p>å¯ä»¥ä¸<code>fetchSockets()</code>å®ç”¨ç¨‹åºæ–¹æ³•ç»“åˆä½¿ç”¨çš„ä»»æ„å¯¹è±¡ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// server A</span>io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-property">data</span>.<span class="hljs-property">username</span> = <span class="hljs-string">&quot;alice&quot;</span>;&#125;);<span class="hljs-comment">// server B</span><span class="hljs-keyword">const</span> sockets = <span class="hljs-keyword">await</span> io.<span class="hljs-title function_">fetchSockets</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sockets[<span class="hljs-number">0</span>].<span class="hljs-property">data</span>.<span class="hljs-property">username</span>); <span class="hljs-comment">// &quot;alice&quot;</span></code></pre></div><h2 id="Socket-conn"><a href="#Socket-conn" class="headerlink" title="Socket#conn"></a>Socket#conn</h2><p>å¯¹åº•å±‚ Engine.IO å¥—æ¥å­—çš„å¼•ç”¨ï¼ˆå‚è§<a href="https://socket.io/zh-CN/docs/v4/how-it-works/">æ­¤å¤„</a>ï¼‰ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;initial transport&quot;</span>, socket.<span class="hljs-property">conn</span>.<span class="hljs-property">transport</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// prints &quot;polling&quot;</span>  socket.<span class="hljs-property">conn</span>.<span class="hljs-title function_">once</span>(<span class="hljs-string">&quot;upgrade&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// called when the transport is upgraded (i.e. from HTTP long-polling to WebSocket)</span>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;upgraded transport&quot;</span>, socket.<span class="hljs-property">conn</span>.<span class="hljs-property">transport</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// prints &quot;websocket&quot;</span>  &#125;);  socket.<span class="hljs-property">conn</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;packet&quot;</span>, <span class="hljs-function">(<span class="hljs-params">&#123; type, data &#125;</span>) =&gt;</span> &#123;    <span class="hljs-comment">// called for each packet received</span>  &#125;);  socket.<span class="hljs-property">conn</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;packetCreate&quot;</span>, <span class="hljs-function">(<span class="hljs-params">&#123; type, data &#125;</span>) =&gt;</span> &#123;    <span class="hljs-comment">// called for each packet sent</span>  &#125;);  socket.<span class="hljs-property">conn</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;drain&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// called when the write buffer is drained</span>  &#125;);  socket.<span class="hljs-property">conn</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;close&quot;</span>, <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;    <span class="hljs-comment">// called when the underlying connection is closed</span>  &#125;);&#125;);</code></pre></div><h2 id="Additional-attributes"><a href="#Additional-attributes" class="headerlink" title="Additional attributes"></a>Additional attributes</h2><p>åªè¦æ‚¨ä¸è¦†ç›–ä»»ä½•ç°æœ‰å±æ€§ï¼Œæ‚¨å°±å¯ä»¥å°†ä»»ä½•å±æ€§é™„åŠ åˆ° Socket å®ä¾‹å¹¶åœ¨ä»¥åä½¿ç”¨å®ƒï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// in a middleware</span>io.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (socket, next) =&gt; &#123;  <span class="hljs-keyword">try</span> &#123;    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUser</span>(socket);    socket.<span class="hljs-property">user</span> = user;  &#125; <span class="hljs-keyword">catch</span> (e) &#123;    <span class="hljs-title function_">next</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;unknown user&quot;</span>));  &#125;&#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">user</span>);  <span class="hljs-comment">// in a listener</span>  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;set username&quot;</span>, <span class="hljs-function">(<span class="hljs-params">username</span>) =&gt;</span> &#123;    socket.<span class="hljs-property">username</span> = username;  &#125;);&#125;);</code></pre></div><h2 id="Socket-middlewares"><a href="#Socket-middlewares" class="headerlink" title="Socket middlewares"></a>Socket middlewares</h2><p>è¿™äº›ä¸­é—´ä»¶çœ‹èµ·æ¥å¾ˆåƒé€šå¸¸çš„<a href="https://socket.io/zh-CN/docs/v4/middlewares/">ä¸­é—´ä»·</a>ï¼Œé™¤äº†å®ƒä»¬æ˜¯ä¸ºæ¯ä¸ªä¼ å…¥çš„æ•°æ®åŒ…è°ƒç”¨çš„ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">[event, ...args], next</span>) =&gt;</span> &#123;  <span class="hljs-comment">// do something with the packet (logging, authorization, rate limiting...)</span>  <span class="hljs-comment">// do not forget to call next() at the end</span>  <span class="hljs-title function_">next</span>();&#125;);</code></pre></div><p>å¤åˆ¶</p><p><code>next</code>ä¹Ÿå¯ä»¥ä½¿ç”¨é”™è¯¯å¯¹è±¡è°ƒç”¨è¯¥æ–¹æ³•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹ä»¶å°†ä¸ä¼šåˆ°è¾¾æ³¨å†Œçš„äº‹ä»¶å¤„ç†ç¨‹åºï¼Œè€Œ<code>error</code>æ˜¯ä¼šå‘å‡ºä¸€ä¸ªäº‹ä»¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">[event, ...args], next</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUnauthorized</span>(event)) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-title function_">next</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;unauthorized event&quot;</span>));    &#125;    <span class="hljs-title function_">next</span>();  &#125;);  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;error&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">message</span> === <span class="hljs-string">&quot;unauthorized event&quot;</span>) &#123;      socket.<span class="hljs-title function_">disconnect</span>();    &#125;  &#125;);&#125;);</code></pre></div><p>å¤åˆ¶</p><p>æ³¨æ„ï¼šæ­¤åŠŸèƒ½ä»…å­˜åœ¨äºæœåŠ¡å™¨ç«¯ã€‚å¯¹äºå®¢æˆ·ç«¯ï¼Œæ‚¨å¯èƒ½å¯¹<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#catch-all-listeners">catch-all listeners</a>æ„Ÿå…´è¶£ã€‚</p><h2 id="Events-1"><a href="#Events-1" class="headerlink" title="Events"></a>Events<a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/#events"></a></h2><p>åœ¨æœåŠ¡å™¨ç«¯ï¼ŒSocket å®ä¾‹å‘å‡ºä¸¤ä¸ªç‰¹æ®Šäº‹ä»¶ï¼š</p><ul><li><a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/#disconnect"><code>disconnect</code></a></li><li><a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/#disconnecting"><code>disconnecting</code></a></li></ul><h3 id="disconnect"><a href="#disconnect" class="headerlink" title="disconnect"></a><code>disconnect</code><a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/#disconnect"></a></h3><p>æ­¤äº‹ä»¶ç”± Socket å®ä¾‹åœ¨æ–­å¼€è¿æ¥æ—¶è§¦å‘ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnect&quot;</span>, <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;    <span class="hljs-comment">// ...</span>  &#125;);&#125;);</code></pre></div><p>å¤åˆ¶</p><p>ä»¥ä¸‹æ˜¯å¯èƒ½çš„åŸå› åˆ—è¡¨ï¼š</p><table><thead><tr><th>Reason</th><th>Description</th></tr></thead><tbody><tr><td><code>server namespace disconnect</code></td><td>socketè¢«<a href="https://socket.io/zh-CN/docs/v4/server-api/#socketdisconnectclose">socket.disconnect</a>å¼ºè¡Œæ–­å¼€</td></tr><tr><td><code>client namespace disconnect</code></td><td>å®¢æˆ·ç«¯ä½¿ç”¨<a href="https://socket.io/zh-CN/docs/v4/client-api/#socketdisconnect">socket.disconnect()</a>æ‰‹åŠ¨æ–­å¼€socket</td></tr><tr><td><code>server shutting down</code></td><td>æœåŠ¡å™¨æ­£åœ¨å…³é—­</td></tr><tr><td><code>ping timeout</code></td><td><code>pingTimeout</code> å®¢æˆ·ç«¯åœ¨å»¶è¿Ÿä¸­æ²¡æœ‰å‘é€ PONG æ•°æ®åŒ…</td></tr><tr><td><code>transport close</code></td><td>è¿æ¥å·²å…³é—­ï¼ˆä¾‹å¦‚ï¼šç”¨æˆ·å¤±å»è¿æ¥ï¼Œæˆ–ç½‘ç»œä» WiFi æ›´æ”¹ä¸º 4Gï¼‰</td></tr><tr><td><code>transport error</code></td><td>è¿æ¥é‡åˆ°é”™è¯¯</td></tr></tbody></table><h3 id="disconnecting"><a href="#disconnecting" class="headerlink" title="disconnecting"></a><code>disconnecting</code><a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/#disconnecting"></a></h3><p>å½“<a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/#socketrooms">Socket#rooms</a>é›†ä¸ä¸ºç©ºæ—¶ï¼Œæ­¤äº‹ä»¶ç±»ä¼¼äº<code>disconnect</code>ä½†æ›´æ—©è§¦å‘ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnecting&quot;</span>, <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> room <span class="hljs-keyword">of</span> socket.<span class="hljs-property">rooms</span>) &#123;      <span class="hljs-keyword">if</span> (room !== socket.<span class="hljs-property">id</span>) &#123;        socket.<span class="hljs-title function_">to</span>(room).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;user has left&quot;</span>, socket.<span class="hljs-property">id</span>);      &#125;    &#125;  &#125;);&#125;);</code></pre></div><p>æ³¨æ„ï¼šè¿™äº›äº‹ä»¶ä»¥åŠ<code>connect</code>, <code>connect_error</code>, <code>newListener</code> å’Œ <code>removeListener</code>æ˜¯ä¸åº”åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„ç‰¹æ®Šäº‹ä»¶:</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// BAD, will throw an error</span>socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;disconnect&quot;</span>);</code></pre></div><h1 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h1><p>ä¸­é—´ä»¶å‡½æ•°æ˜¯ä¸ºæ¯ä¸ªä¼ å…¥è¿æ¥æ‰§è¡Œçš„å‡½æ•°ã€‚</p><p>ä¸­é—´ä»¶å‡½æ•°å¯ç”¨äºï¼š</p><ul><li>logging</li><li>authentication / authorization</li><li>rate limiting</li></ul><p>Note: this function will be executed only once per connection (even if the connection consists in multiple HTTP requests).</p><h2 id="æ³¨å†Œä¸­é—´ä»¶"><a href="#æ³¨å†Œä¸­é—´ä»¶" class="headerlink" title="æ³¨å†Œä¸­é—´ä»¶"></a>æ³¨å†Œä¸­é—´ä»¶</h2><p>ä¸­é—´ä»¶å‡½æ•°å¯ä»¥è®¿é—®<a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/">Socket å®ä¾‹</a>å’Œä¸‹ä¸€ä¸ªæ³¨å†Œçš„ä¸­é—´ä»¶å‡½æ•°ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">socket, next</span>) =&gt;</span> &#123;  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isValid</span>(socket.<span class="hljs-property">request</span>)) &#123;    <span class="hljs-title function_">next</span>();  &#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-title function_">next</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;invalid&quot;</span>));  &#125;&#125;);</code></pre></div><p>æ‚¨å¯ä»¥æ³¨å†Œå‡ ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œå®ƒä»¬å°†æŒ‰é¡ºåºæ‰§è¡Œï¼š</p><div class="code-wrapper"><pre><code class="hljs moonscript"><span class="hljs-built_in">io</span>.use(<span class="hljs-function"><span class="hljs-params">(socket, <span class="hljs-built_in">next</span>)</span> =&gt;</span> &#123;  <span class="hljs-built_in">next</span>();&#125;);<span class="hljs-built_in">io</span>.use(<span class="hljs-function"><span class="hljs-params">(socket, <span class="hljs-built_in">next</span>)</span> =&gt;</span> &#123;  <span class="hljs-built_in">next</span>(new Error(<span class="hljs-string">&quot;thou shall not pass&quot;</span>));//<span class="hljs-built_in">error</span>å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’åˆ°ä¸‹ä¸€å±‚ï¼Œå…¶ä»–ä¸å¯ä»¥&#125;);<span class="hljs-built_in">io</span>.use(<span class="hljs-function"><span class="hljs-params">(socket, <span class="hljs-built_in">next</span>)</span> =&gt;</span> &#123;  // <span class="hljs-keyword">not</span> executed, since the previous middleware has returned an <span class="hljs-built_in">error</span>  <span class="hljs-built_in">next</span>();&#125;);</code></pre></div><p>è¯·ç¡®ä¿åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½è°ƒç”¨<code>nextï¼ˆï¼‰</code>ã€‚ å¦åˆ™ï¼Œè¿æ¥å°†ä¸€ç›´æŒ‚èµ·ï¼Œç›´åˆ°åœ¨ç»™å®šè¶…æ—¶åå…³é—­ã€‚</p><p><strong>é‡è¦æç¤º</strong>ï¼šæ‰§è¡Œä¸­é—´ä»¶æ—¶ï¼ŒSocket å®ä¾‹å®é™…ä¸Šå¹¶æœªè¿æ¥ï¼Œè¿™æ„å‘³ç€<code>disconnect</code>å¦‚æœè¿æ¥æœ€ç»ˆå¤±è´¥ï¼Œåˆ™ä¸ä¼šå‘å‡ºä»»ä½•äº‹ä»¶ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœå®¢æˆ·ç«¯æ‰‹åŠ¨å…³é—­è¿æ¥ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// server-side</span>io.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">socket, next</span>) =&gt;</span> &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// next is called after the client disconnection</span>    <span class="hljs-title function_">next</span>();  &#125;, <span class="hljs-number">1000</span>);  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// not triggered</span>  &#125;);&#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-comment">// not triggered</span>&#125;);<span class="hljs-comment">// client-side</span><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>();<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;  socket.<span class="hljs-title function_">disconnect</span>();&#125;, <span class="hljs-number">500</span>);</code></pre></div><h2 id="å‘é€å‡­æ®"><a href="#å‘é€å‡­æ®" class="headerlink" title="å‘é€å‡­æ®"></a>å‘é€å‡­æ®</h2><p><code>auth</code>å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹å‘é€å‡­æ®ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// plain object</span><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(&#123;  <span class="hljs-attr">auth</span>: &#123;    <span class="hljs-attr">token</span>: <span class="hljs-string">&quot;abc&quot;</span>  &#125;&#125;);<span class="hljs-comment">// or with a function</span><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(&#123;  <span class="hljs-attr">auth</span>: <span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> &#123;    <span class="hljs-title function_">cb</span>(&#123;      <span class="hljs-attr">token</span>: <span class="hljs-string">&quot;abc&quot;</span>    &#125;);  &#125;&#125;);</code></pre></div><p>å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯çš„<a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/#sockethandshake">æ¡æ‰‹</a>å¯¹è±¡ä¸­è®¿é—®è¿™äº›å‡­æ®ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">socket, next</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> token = socket.<span class="hljs-property">handshake</span>.<span class="hljs-property">auth</span>.<span class="hljs-property">token</span>;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><h2 id="å¤„ç†ä¸­é—´ä»¶é”™è¯¯"><a href="#å¤„ç†ä¸­é—´ä»¶é”™è¯¯" class="headerlink" title="å¤„ç†ä¸­é—´ä»¶é”™è¯¯"></a>å¤„ç†ä¸­é—´ä»¶é”™è¯¯</h2><p>å¦‚æœ<code>next</code>ä½¿ç”¨ Error å¯¹è±¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™è¿æ¥å°†è¢«æ‹’ç»å¹¶ä¸”å®¢æˆ·ç«¯å°†æ”¶åˆ°ä¸€ä¸ª<code>connect_error</code>äº‹ä»¶ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// client-side</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect_error&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>); <span class="hljs-comment">// prints the message associated with the error</span>&#125;);</code></pre></div><p>æ‚¨å¯ä»¥å°†å…¶ä»–è¯¦ç»†ä¿¡æ¯é™„åŠ åˆ°é”™è¯¯å¯¹è±¡ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// server-side</span>io.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">socket, next</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> err = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;not authorized&quot;</span>);  err.<span class="hljs-property">data</span> = &#123; <span class="hljs-attr">content</span>: <span class="hljs-string">&quot;Please retry later&quot;</span> &#125;; <span class="hljs-comment">// additional details</span>  <span class="hljs-title function_">next</span>(err);&#125;);<span class="hljs-comment">// client-side</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect_error&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>); <span class="hljs-comment">// true</span>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>); <span class="hljs-comment">// not authorized</span>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">data</span>); <span class="hljs-comment">// &#123; content: &quot;Please retry later&quot; &#125;</span>&#125;);</code></pre></div><h2 id="ä¸Expressä¸­é—´ä»¶çš„å…¼å®¹æ€§"><a href="#ä¸Expressä¸­é—´ä»¶çš„å…¼å®¹æ€§" class="headerlink" title="ä¸Expressä¸­é—´ä»¶çš„å…¼å®¹æ€§"></a>ä¸Expressä¸­é—´ä»¶çš„å…¼å®¹æ€§</h2><p>å¤§å¤šæ•°ç°æœ‰çš„<a href="http://expressjs.com/en/resources/middleware.html">Express ä¸­é—´ä»¶</a>æ¨¡å—åº”è¯¥ä¸ Socket.IO å…¼å®¹ï¼Œæ‚¨åªéœ€è¦ä¸€ä¸ªå°åŒ…è£…å‡½æ•°æ¥ä½¿æ–¹æ³•ç­¾ååŒ¹é…ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">wrap</span> = middleware =&gt; <span class="hljs-function">(<span class="hljs-params">socket, next</span>) =&gt;</span> <span class="hljs-title function_">middleware</span>(socket.<span class="hljs-property">request</span>, &#123;&#125;, next);</code></pre></div><p>å¤åˆ¶</p><p>ç»“æŸè¯·æ±‚-å“åº”å‘¨æœŸå¹¶ä¸”ä¸è°ƒç”¨çš„ä¸­é—´ä»¶å‡½æ•°<code>next()</code>å°†ä¸èµ·ä½œç”¨ã€‚</p><p><a href="https://www.npmjs.com/package/express-session">express-session</a>ç¤ºä¾‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;express-session&quot;</span>);io.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">wrap</span>(<span class="hljs-title function_">session</span>(&#123; <span class="hljs-attr">secret</span>: <span class="hljs-string">&quot;cats&quot;</span> &#125;)));io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> session = socket.<span class="hljs-property">request</span>.<span class="hljs-property">session</span>;&#125;);</code></pre></div><p><a href="http://www.passportjs.org/">Passport</a>ç¤ºä¾‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;express-session&quot;</span>);<span class="hljs-keyword">const</span> passport = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;passport&quot;</span>);io.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">wrap</span>(<span class="hljs-title function_">session</span>(&#123; <span class="hljs-attr">secret</span>: <span class="hljs-string">&quot;cats&quot;</span> &#125;)));io.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">wrap</span>(passport.<span class="hljs-title function_">initialize</span>()));io.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">wrap</span>(passport.<span class="hljs-title function_">session</span>()));io.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">socket, next</span>) =&gt;</span> &#123;  <span class="hljs-keyword">if</span> (socket.<span class="hljs-property">request</span>.<span class="hljs-property">user</span>) &#123;    <span class="hljs-title function_">next</span>();  &#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-title function_">next</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;unauthorized&quot;</span>))  &#125;&#125;);</code></pre></div><p>å¯ä»¥åœ¨<a href="https://github.com/socketio/socket.io/tree/master/examples/passport-example">æ­¤å¤„</a>æ‰¾åˆ° Passport çš„å®Œæ•´ç¤ºä¾‹ã€‚</p><h1 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h1><p>æ‚¨å°†åœ¨ä¸‹é¢æ‰¾åˆ°åœ¨åå‘ä»£ç†è§£å†³æ–¹æ¡ˆåé¢éƒ¨ç½² Socket.IO æœåŠ¡å™¨æ‰€éœ€çš„é…ç½®ï¼Œä¾‹å¦‚ï¼š</p><ul><li><a href="https://socket.io/zh-CN/docs/v4/reverse-proxy/#nginx">NginX</a></li><li><a href="https://socket.io/zh-CN/docs/v4/reverse-proxy/#apache-httpd">Apache HTTPD</a></li><li><a href="https://socket.io/zh-CN/docs/v4/reverse-proxy/#nodejs-http-proxy">Node.js <code>http-proxy</code></a></li></ul><p>åœ¨å¤šæœåŠ¡å™¨è®¾ç½®ä¸­ï¼Œè¯·æŸ¥çœ‹<a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/">æ­¤å¤„</a>çš„æ–‡æ¡£ã€‚</p><h2 id="NginX"><a href="#NginX" class="headerlink" title="NginX"></a>NginX</h2><p><code>/etc/nginx/nginx.conf</code>å†…å®¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs nginx"><span class="hljs-section">http</span> &#123;  <span class="hljs-section">server</span> &#123;    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;    <span class="hljs-attribute">server_name</span> example.com;    <span class="hljs-section">location</span> / &#123;      <span class="hljs-attribute">proxy_set_header</span> X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;      <span class="hljs-attribute">proxy_set_header</span> Host <span class="hljs-variable">$host</span>;      <span class="hljs-attribute">proxy_pass</span> http://localhost:3000;      <span class="hljs-attribute">proxy_http_version</span> <span class="hljs-number">1</span>.<span class="hljs-number">1</span>;      <span class="hljs-attribute">proxy_set_header</span> Upgrade <span class="hljs-variable">$http_upgrade</span>;      <span class="hljs-attribute">proxy_set_header</span> Connection <span class="hljs-string">&quot;upgrade&quot;</span>;    &#125;  &#125;&#125;</code></pre></div><p>æœ‰å…³çš„ï¼š</p><ul><li><a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass">proxy_pass ç¨³å®š</a></li><li><a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#nginx-configuration">å¤šæœåŠ¡å™¨è®¾ç½®ä¸­çš„é…ç½®</a></li></ul><p>å¦‚æœæ‚¨åªæƒ³è½¬å‘ Socket.IO è¯·æ±‚ï¼ˆä¾‹å¦‚å½“ NginX å¤„ç†é™æ€å†…å®¹æ—¶ï¼‰ï¼š</p><div class="code-wrapper"><pre><code class="hljs text">http &#123;  server &#123;    listen 80;    root /var/www/html;    location /socket.io/ &#123;      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;      proxy_set_header Host $host;      proxy_pass http://localhost:3000;      proxy_http_version 1.1;      proxy_set_header Upgrade $http_upgrade;      proxy_set_header Connection &quot;upgrade&quot;;    &#125;  &#125;&#125;</code></pre></div><p>æˆ–ä½¿ç”¨è‡ªå®šä¹‰<a href="https://socket.io/zh-CN/docs/v4/server-options/#path">è·¯å¾„</a>:</p><div class="code-wrapper"><pre><code class="hljs text">http &#123;  server &#123;    listen 80;    root /var/www/html;    location /my-custom-path/ &#123;      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;      proxy_set_header Host $host;      proxy_pass http://localhost:3000;      proxy_http_version 1.1;      proxy_set_header Upgrade $http_upgrade;      proxy_set_header Connection &quot;upgrade&quot;;    &#125;  &#125;&#125;</code></pre></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¿…é¡»ç›¸åº”åœ°é…ç½®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ï¼š</p><p><em>æœåŠ¡å™¨</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(&#123;  <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/my-custom-path/&quot;</span>&#125;);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; io &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io-client&quot;</span>;<span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(&#123;  <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/my-custom-path/&quot;</span>&#125;);</code></pre></div><h2 id="Apache-HTTPD"><a href="#Apache-HTTPD" class="headerlink" title="Apache HTTPD"></a>Apache HTTPD</h2><p><code>/usr/local/apache2/conf/httpd.conf</code>å†…å®¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Listen</span> <span class="hljs-number">80</span><span class="hljs-attribute">ServerName</span> example.com<span class="hljs-attribute">LoadModule</span> mpm_event_module             modules/mod_mpm_event.so<span class="hljs-attribute">LoadModule</span> authn_file_module            modules/mod_authn_file.so<span class="hljs-attribute">LoadModule</span> authn_core_module            modules/mod_authn_core.so<span class="hljs-attribute">LoadModule</span> authz_host_module            modules/mod_authz_host.so<span class="hljs-attribute">LoadModule</span> authz_groupfile_module       modules/mod_authz_groupfile.so<span class="hljs-attribute">LoadModule</span> authz_user_module            modules/mod_authz_user.so<span class="hljs-attribute">LoadModule</span> authz_core_module            modules/mod_authz_core.so<span class="hljs-attribute">LoadModule</span> headers_module               modules/mod_headers.so<span class="hljs-attribute">LoadModule</span> lbmethod_byrequests_module   modules/mod_lbmethod_byrequests.so<span class="hljs-attribute">LoadModule</span> proxy_module                 modules/mod_proxy.so<span class="hljs-attribute">LoadModule</span> proxy_balancer_module        modules/mod_proxy_balancer.so<span class="hljs-attribute">LoadModule</span> proxy_http_module            modules/mod_proxy_http.so<span class="hljs-attribute">LoadModule</span> proxy_wstunnel_module        modules/mod_proxy_wstunnel.so<span class="hljs-attribute">LoadModule</span> rewrite_module               modules/mod_rewrite.so<span class="hljs-attribute">LoadModule</span> slotmem_shm_module           modules/mod_slotmem_shm.so<span class="hljs-attribute">LoadModule</span> unixd_module                 modules/mod_unixd.so<span class="hljs-attribute">User</span> daemon<span class="hljs-attribute">Group</span> daemon<span class="hljs-attribute">ProxyPass</span> / http://localhost:<span class="hljs-number">3000</span>/<span class="hljs-attribute">RewriteEngine</span> <span class="hljs-literal">on</span><span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%&#123;HTTP:Upgrade&#125;</span> websocket<span class="hljs-meta"> [NC]</span><span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%&#123;HTTP:Connection&#125;</span> upgrade<span class="hljs-meta"> [NC]</span><span class="hljs-attribute">RewriteRule</span> ^/?(.*) <span class="hljs-string">&quot;ws://localhost:3000/$1&quot;</span><span class="hljs-meta"> [P,L]</span><span class="hljs-attribute">ProxyTimeout</span> <span class="hljs-number">3</span></code></pre></div><p>æœ‰å…³çš„ï¼š</p><ul><li><a href="https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_wstunnel.html">mod_proxy_wstunnel æ–‡æ¡£</a></li><li><a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#apache-httpd-configuration">å¤šæœåŠ¡å™¨è®¾ç½®ä¸­çš„é…ç½®</a></li></ul><h2 id="Node-js-http-proxy"><a href="#Node-js-http-proxy" class="headerlink" title="Node.js http-proxy"></a>Node.js <code>http-proxy</code><a href="https://socket.io/zh-CN/docs/v4/reverse-proxy/#nodejs-http-proxy"></a></h2><p>å®‰è£…ï¼š <code>npm i http-proxy</code></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> httpProxy = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;http-proxy&quot;</span>);httpProxy  .<span class="hljs-title function_">createProxyServer</span>(&#123;    <span class="hljs-attr">target</span>: <span class="hljs-string">&quot;http://localhost:3000&quot;</span>,    <span class="hljs-attr">ws</span>: <span class="hljs-literal">true</span>,  &#125;)  .<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>);</code></pre></div><p>å¤åˆ¶</p><p><a href="https://github.com/http-party/node-http-proxy#readme">Documentation</a></p><h2 id="Caddy-2"><a href="#Caddy-2" class="headerlink" title="Caddy 2"></a>Caddy 2</h2><p><a href="https://caddyserver.com/v2">Caddy 2</a>ä¸­<code>Caddyfile</code>çš„å†…å®¹</p><div class="code-wrapper"><pre><code class="hljs text">example.com &#123;  rewrite /path /path/  handle /path/* &#123;    uri strip_prefix /path    rewrite * /socket.io&#123;path&#125;    reverse_proxy localhost:3000 &#123;      header_up Host &#123;host&#125;      header_up X-Real-IP &#123;remote&#125;    &#125;  &#125;&#125;</code></pre></div><p>æœ‰å…³çš„ï¼š</p><ul><li><a href="https://caddy.community/t/i-cant-get-socket-io-proxy-to-work-on-v2/8703/2">è§£å†³æ–¹æ¡ˆè®ºå›å¸–å­</a></li><li><a href="https://caddyserver.com/docs/caddyfile/directives">Caddyfile æŒ‡ä»¤</a></li></ul><h1 id="ä½¿ç”¨å¤šä¸ªèŠ‚ç‚¹"><a href="#ä½¿ç”¨å¤šä¸ªèŠ‚ç‚¹" class="headerlink" title="ä½¿ç”¨å¤šä¸ªèŠ‚ç‚¹"></a>ä½¿ç”¨å¤šä¸ªèŠ‚ç‚¹</h1><p>éƒ¨ç½²å¤šä¸ª Socket.IO æœåŠ¡å™¨æ—¶ï¼Œéœ€è¦æ³¨æ„ä¸¤ä»¶äº‹ï¼š</p><ul><li>å¦‚æœå¯ç”¨äº† HTTP é•¿è½®è¯¢ï¼ˆè¿™æ˜¯é»˜è®¤è®¾ç½®ï¼‰ï¼Œåˆ™å¯ç”¨ç²˜æ€§ä¼šè¯ï¼šè§<a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#enabling-sticky-session">ä¸‹æ–‡</a></li><li>ä½¿ç”¨å…¼å®¹çš„é€‚é…å™¨ï¼Œè¯·å‚è§<a href="https://socket.io/zh-CN/docs/v4/adapter/">æ­¤å¤„</a></li></ul><h2 id="ç²˜æ€§è´Ÿè½½å¹³è¡¡"><a href="#ç²˜æ€§è´Ÿè½½å¹³è¡¡" class="headerlink" title="ç²˜æ€§è´Ÿè½½å¹³è¡¡"></a>ç²˜æ€§è´Ÿè½½å¹³è¡¡</h2><p>å¦‚æœæ‚¨è®¡åˆ’åœ¨ä¸åŒçš„è¿›ç¨‹æˆ–æœºå™¨ä¹‹é—´åˆ†é…è¿æ¥è´Ÿè½½ï¼Œåˆ™å¿…é¡»ç¡®ä¿ä¸ç‰¹å®šä¼šè¯ ID å…³è”çš„æ‰€æœ‰è¯·æ±‚éƒ½åˆ°è¾¾å‘èµ·å®ƒä»¬çš„è¿›ç¨‹ã€‚</p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦ç²˜æ€§ä¼šè¯"><a href="#ä¸ºä»€ä¹ˆéœ€è¦ç²˜æ€§ä¼šè¯" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ç²˜æ€§ä¼šè¯"></a>ä¸ºä»€ä¹ˆéœ€è¦ç²˜æ€§ä¼šè¯</h3><p>è¿™æ˜¯å› ä¸º HTTP é•¿è½®è¯¢ä¼ è¾“åœ¨ Socket.IO ä¼šè¯çš„ç”Ÿå‘½å‘¨æœŸå†…å‘é€å¤šä¸ª HTTP è¯·æ±‚ã€‚</p><p>äº‹å®ä¸Šï¼ŒSocket.IO åœ¨æŠ€æœ¯ä¸Šå¯ä»¥åœ¨æ²¡æœ‰ç²˜æ€§ä¼šè¯çš„æƒ…å†µä¸‹å·¥ä½œï¼Œå…·æœ‰ä»¥ä¸‹åŒæ­¥ï¼ˆè™šçº¿ï¼‰ï¼š</p><p><img src="https://socket.io/zh-CN/assets/images/mutiple-nodes-no-sticky-babd7860f217e09eefc2db73e5012f91.png" alt="Using multiple nodes without sticky sessions"></p><p>è™½ç„¶æ˜¾ç„¶å¯ä»¥å®ç°ï¼Œä½†æˆ‘ä»¬è®¤ä¸º Socket.IO æœåŠ¡å™¨ä¹‹é—´çš„è¿™ç§åŒæ­¥è¿‡ç¨‹ä¼šå¯¹æ‚¨çš„åº”ç”¨ç¨‹åºé€ æˆå¾ˆå¤§çš„æ€§èƒ½å½±å“ã€‚</p><p>è¯„è®ºï¼š</p><ul><li>å¦‚æœä¸å¯ç”¨ç²˜æ€§ä¼šè¯ï¼Œç”±äºâ€œä¼šè¯ ID æœªçŸ¥â€ï¼Œæ‚¨å°†é‡åˆ° HTTP 400 é”™è¯¯</li><li>WebSocket ä¼ è¾“æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œå› ä¸ºå®ƒä¾èµ–äºæ•´ä¸ªä¼šè¯çš„å•ä¸ª TCP è¿æ¥ã€‚è¿™æ„å‘³ç€å¦‚æœæ‚¨ç¦ç”¨ HTTP é•¿è½®è¯¢ä¼ è¾“ï¼Œæ‚¨å°†ä¸éœ€è¦ç²˜æ€§ä¼šè¯ï¼š</li></ul><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;https://io.yourhost.com&quot;</span>, &#123;  <span class="hljs-comment">// WARNING: in that case, there is no fallback to long-polling</span>  <span class="hljs-attr">transports</span>: [ <span class="hljs-string">&quot;websocket&quot;</span> ] <span class="hljs-comment">// or [ &quot;websocket&quot;, &quot;polling&quot; ] (the order matters)</span>&#125;);</code></pre></div><p>æ–‡æ¡£ï¼š<a href="https://socket.io/zh-CN/docs/v4/client-options/#transports"><code>transports</code></a></p><h3 id="å¯ç”¨ç²˜æ€§ä¼šè¯çš„æ–¹å¼"><a href="#å¯ç”¨ç²˜æ€§ä¼šè¯çš„æ–¹å¼" class="headerlink" title="å¯ç”¨ç²˜æ€§ä¼šè¯çš„æ–¹å¼"></a>å¯ç”¨ç²˜æ€§ä¼šè¯çš„æ–¹å¼</h3><p>è¦å®ç°ç²˜æ€§ä¼šè¯ï¼Œä¸»è¦æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p><ul><li>åŸºäº cookie è·¯ç”±å®¢æˆ·ç«¯ï¼ˆæ¨èè§£å†³æ–¹æ¡ˆï¼‰</li><li>æ ¹æ®å®¢æˆ·ç«¯çš„åŸå§‹åœ°å€è·¯ç”±å®¢æˆ·ç«¯</li></ul><p>æ‚¨å°†åœ¨ä¸‹é¢æ‰¾åˆ°ä¸€äº›å¸¸è§è´Ÿè½½å¹³è¡¡è§£å†³æ–¹æ¡ˆçš„ç¤ºä¾‹ï¼š</p><ul><li><a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#nginx-configuration">NginX</a> (åŸºäºIP)</li><li><a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#apache-httpd-configuration">Apache HTTPD</a> (åŸºäºcookie)</li><li><a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#haproxy-configuration">HAProxy</a> (åŸºäºcookie)</li><li><a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#traefik">Traefik</a> (åŸºäºcookie)</li><li><a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#using-nodejs-cluster">Node.js <code>cluster</code> module</a></li></ul><p><strong>é‡è¦æç¤º</strong>ï¼šå¦‚æœæ‚¨å¤„äº CORS æƒ…å†µï¼ˆå‰ç«¯åŸŸä¸æœåŠ¡å™¨åŸŸä¸åŒï¼‰å¹¶ä¸”ä¼šè¯äº²å’Œæ€§æ˜¯é€šè¿‡ cookie å®ç°çš„ï¼Œåˆ™éœ€è¦å…è®¸å‡­æ®ï¼š</p><p><em>æœåŠ¡å™¨</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> io = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;socket.io&quot;</span>)(httpServer, &#123;  <span class="hljs-attr">cors</span>: &#123;    <span class="hljs-attr">origin</span>: <span class="hljs-string">&quot;https://front-domain.com&quot;</span>,    <span class="hljs-attr">methods</span>: [<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;POST&quot;</span>],    <span class="hljs-attr">credentials</span>: <span class="hljs-literal">true</span>  &#125;&#125;);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> io = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;socket.io-client&quot;</span>);<span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;https://server-domain.com&quot;</span>, &#123;  <span class="hljs-attr">withCredentials</span>: <span class="hljs-literal">true</span>&#125;);</code></pre></div><p>æ²¡æœ‰å®ƒï¼Œæµè§ˆå™¨å°†ä¸ä¼šå‘é€ cookieï¼Œæ‚¨å°†é‡åˆ° HTTP 400â€œä¼šè¯ ID æœªçŸ¥â€å“åº”ã€‚æ›´å¤šä¿¡æ¯<a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials">åœ¨è¿™é‡Œ</a>.</p><h3 id="NginX-é…ç½®"><a href="#NginX-é…ç½®" class="headerlink" title="NginX é…ç½®"></a>NginX é…ç½®</h3><p>åœ¨æ–‡ä»¶çš„<code>http &#123; &#125;</code>éƒ¨åˆ†ä¸­<code>nginx.conf</code>ï¼Œæ‚¨å¯ä»¥å£°æ˜ä¸€ä¸ª<code>upstream</code>åŒ…å«è¦å¹³è¡¡è´Ÿè½½çš„ Socket.IO è¿›ç¨‹åˆ—è¡¨çš„éƒ¨åˆ†ï¼š</p><div class="code-wrapper"><pre><code class="hljs nginx"><span class="hljs-section">http</span> &#123;  <span class="hljs-section">server</span> &#123;    <span class="hljs-attribute">listen</span> <span class="hljs-number">3000</span>;    <span class="hljs-attribute">server_name</span> io.yourhost.com;    <span class="hljs-section">location</span> / &#123;      <span class="hljs-attribute">proxy_set_header</span> X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;      <span class="hljs-attribute">proxy_set_header</span> Host <span class="hljs-variable">$host</span>;      <span class="hljs-attribute">proxy_pass</span> http://nodes;      <span class="hljs-comment"># enable WebSockets</span>      <span class="hljs-attribute">proxy_http_version</span> <span class="hljs-number">1</span>.<span class="hljs-number">1</span>;      <span class="hljs-attribute">proxy_set_header</span> Upgrade <span class="hljs-variable">$http_upgrade</span>;      <span class="hljs-attribute">proxy_set_header</span> Connection <span class="hljs-string">&quot;upgrade&quot;</span>;    &#125;  &#125;  <span class="hljs-section">upstream</span> nodes &#123;    <span class="hljs-comment"># enable sticky session with either &quot;hash&quot; (uses the complete IP address)</span>    <span class="hljs-attribute">hash</span> <span class="hljs-variable">$remote_addr</span> consistent;    <span class="hljs-comment"># or &quot;ip_hash&quot; (uses the first three octets of the client IPv4 address, or the entire IPv6 address)</span>    <span class="hljs-comment"># ip_hash;</span>    <span class="hljs-comment"># or &quot;sticky&quot; (needs commercial subscription)</span>    <span class="hljs-comment"># sticky cookie srv_id expires=1h domain=.example.com path=/;</span>    <span class="hljs-attribute">server</span> app01:<span class="hljs-number">3000</span>;    <span class="hljs-attribute">server</span> app02:<span class="hljs-number">3000</span>;    <span class="hljs-attribute">server</span> app03:<span class="hljs-number">3000</span>;  &#125;&#125;</code></pre></div><p>è¯·æ³¨æ„<code>hash</code>æŒ‡ç¤ºè¿æ¥å°†æ˜¯ç²˜æ€§çš„è¯´æ˜ã€‚</p><p>ç¡®ä¿æ‚¨è¿˜åœ¨<code>worker_processes</code>æœ€é¡¶å±‚é…ç½®ä»¥æŒ‡ç¤º NginX åº”è¯¥ä½¿ç”¨å¤šå°‘å·¥ä½œäººå‘˜ã€‚æ‚¨å¯èƒ½è¿˜æƒ³ç ”ç©¶è°ƒæ•´å—<code>worker_connections</code>å†…çš„è®¾ç½®<code>events &#123; &#125;</code>ã€‚</p><h3 id="Apache-HTTPD-é…ç½®"><a href="#Apache-HTTPD-é…ç½®" class="headerlink" title="Apache HTTPD é…ç½®"></a>Apache HTTPD é…ç½®<a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/#apache-httpd-configuration"></a></h3><div class="code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Header</span> add Set-Cookie <span class="hljs-string">&quot;SERVERID=sticky.%&#123;BALANCER_WORKER_ROUTE&#125;e; path=/&quot;</span> env=BALANCER_ROUTE_CHANGED<span class="hljs-section">&lt;Proxy <span class="hljs-string">&quot;balancer://nodes_polling&quot;</span>&gt;</span>    <span class="hljs-attribute">BalancerMember</span> <span class="hljs-string">&quot;http://app01:3000&quot;</span> route=app01    <span class="hljs-attribute">BalancerMember</span> <span class="hljs-string">&quot;http://app02:3000&quot;</span> route=app02    <span class="hljs-attribute">BalancerMember</span> <span class="hljs-string">&quot;http://app03:3000&quot;</span> route=app03    <span class="hljs-attribute">ProxySet</span> stickysession=SERVERID<span class="hljs-section">&lt;/Proxy&gt;</span><span class="hljs-section">&lt;Proxy <span class="hljs-string">&quot;balancer://nodes_ws&quot;</span>&gt;</span>    <span class="hljs-attribute">BalancerMember</span> <span class="hljs-string">&quot;ws://app01:3000&quot;</span> route=app01    <span class="hljs-attribute">BalancerMember</span> <span class="hljs-string">&quot;ws://app02:3000&quot;</span> route=app02    <span class="hljs-attribute">BalancerMember</span> <span class="hljs-string">&quot;ws://app03:3000&quot;</span> route=app03    <span class="hljs-attribute">ProxySet</span> stickysession=SERVERID<span class="hljs-section">&lt;/Proxy&gt;</span><span class="hljs-attribute">RewriteEngine</span> <span class="hljs-literal">On</span><span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%&#123;HTTP:Upgrade&#125;</span> =websocket<span class="hljs-meta"> [NC]</span><span class="hljs-attribute">RewriteRule</span> /(.*) balancer://nodes_ws/$<span class="hljs-number">1</span><span class="hljs-meta"> [P,L]</span><span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%&#123;HTTP:Upgrade&#125;</span> !=websocket<span class="hljs-meta"> [NC]</span><span class="hljs-attribute">RewriteRule</span> /(.*) balancer://nodes_polling/$<span class="hljs-number">1</span><span class="hljs-meta"> [P,L]</span><span class="hljs-attribute">ProxyTimeout</span> <span class="hljs-number">3</span></code></pre></div><p>é“¾æ¥ï¼š</p><ul><li><a href="https://github.com/socketio/socket.io/tree/master/examples/cluster-httpd">ä¾‹å­</a></li><li><a href="https://httpd.apache.org/docs/2.4/en/mod/mod_proxy.html#proxypass">æ–‡æ¡£</a></li></ul><h3 id="HAProxy-é…ç½®"><a href="#HAProxy-é…ç½®" class="headerlink" title="HAProxy é…ç½®"></a>HAProxy é…ç½®</h3><div class="code-wrapper"><pre><code class="hljs text"># Reference: http://blog.haproxy.com/2012/11/07/websockets-load-balancing-with-haproxy/listen chat  bind *:80  default_backend nodesbackend nodes  option httpchk HEAD /health  http-check expect status 200  cookie io prefix indirect nocache # using the `io` cookie set upon handshake  server app01 app01:3000 check cookie app01  server app02 app02:3000 check cookie app02  server app03 app03:3000 check cookie app03</code></pre></div><p>é“¾æ¥ï¼š</p><ul><li><a href="https://github.com/socketio/socket.io/tree/master/examples/cluster-haproxy">ä¾‹å­</a></li><li><a href="http://cbonte.github.io/haproxy-dconv/2.4/configuration.html#cookie">æ–‡æ¡£</a></li></ul><h3 id="Traefik"><a href="#Traefik" class="headerlink" title="Traefik"></a>Traefik</h3><p>ä½¿ç”¨å®¹å™¨æ ‡ç­¾ï¼š</p><div class="code-wrapper"><pre><code class="hljs yaml"><span class="hljs-comment"># docker-compose.yml</span><span class="hljs-attr">services:</span>  <span class="hljs-attr">traefik:</span>    <span class="hljs-attr">image:</span> <span class="hljs-string">traefik:2.4</span>    <span class="hljs-attr">volumes:</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/run/docker.sock:/var/run/docker.sock</span>    <span class="hljs-attr">links:</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">server</span>  <span class="hljs-attr">server:</span>    <span class="hljs-attr">image:</span> <span class="hljs-string">my-image:latest</span>    <span class="hljs-attr">labels:</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;traefik.http.routers.my-service.rule=PathPrefix(`/`)&quot;</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">traefik.http.services.my-service.loadBalancer.sticky.cookie.name=server_id</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">traefik.http.services.my-service.loadBalancer.sticky.cookie.httpOnly=true</span></code></pre></div><p>ä½¿ç”¨<a href="https://doc.traefik.io/traefik/v2.0/providers/file/">æ–‡ä»¶æä¾›ç¨‹åº</a>ï¼š</p><div class="code-wrapper"><pre><code class="hljs yaml"><span class="hljs-comment">## Dynamic configuration</span><span class="hljs-attr">http:</span>  <span class="hljs-attr">services:</span>    <span class="hljs-attr">my-service:</span>      <span class="hljs-attr">rule:</span> <span class="hljs-string">&quot;PathPrefix(`/`)&quot;</span>      <span class="hljs-attr">loadBalancer:</span>        <span class="hljs-attr">sticky:</span>          <span class="hljs-attr">cookie:</span>            <span class="hljs-attr">name:</span> <span class="hljs-string">server_id</span>            <span class="hljs-attr">httpOnly:</span> <span class="hljs-literal">true</span></code></pre></div><p>é“¾æ¥ï¼š</p><ul><li><a href="https://github.com/socketio/socket.io/tree/master/examples/cluster-traefik">ä¾‹å­</a></li><li><a href="https://doc.traefik.io/traefik/v2.0/routing/services/#sticky-sessions">æ–‡æ¡£</a></li></ul><h3 id="ä½¿ç”¨-Node-js-é›†ç¾¤"><a href="#ä½¿ç”¨-Node-js-é›†ç¾¤" class="headerlink" title="ä½¿ç”¨ Node.js é›†ç¾¤"></a>ä½¿ç”¨ Node.js é›†ç¾¤</h3><p>å°±åƒ NginX ä¸€æ ·ï¼ŒNode.js é€šè¿‡<code>cluster</code>æ¨¡å—æä¾›äº†å†…ç½®çš„é›†ç¾¤æ”¯æŒã€‚</p><p>æœ‰å‡ ç§è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“å–å†³äºæ‚¨çš„ç”¨ä¾‹ï¼š</p><table><thead><tr><th>NPM åŒ…</th><th>è¿™ä¸ªæ€ä¹ˆè¿ä½œ</th></tr></thead><tbody><tr><td><a href="https://github.com/darrachequesne/socket.io-sticky"><code>@socket.io/sticky</code></a></td><td>è·¯ç”±åŸºäº<code>sid</code>æŸ¥è¯¢å‚æ•°</td></tr><tr><td><a href="https://github.com/indutny/sticky-session"><code>sticky-session</code></a></td><td>è·¯ç”±æ˜¯åŸºäº<code>connection.remoteAddress</code></td></tr><tr><td><a href="https://github.com/wzrdtales/socket-io-sticky-session"><code>socketio-sticky-session</code></a></td><td>åŸºäº<code>x-forwarded-for</code>æŠ¥å¤´çš„è·¯ç”±ï¼‰</td></tr></tbody></table><p>ç¤ºä¾‹<code>@socket.io/sticky</code>:</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> cluster = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;cluster&quot;</span>);<span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;http&quot;</span>);<span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">Server</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;socket.io&quot;</span>);<span class="hljs-keyword">const</span> numCPUs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;os&quot;</span>).<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span>;<span class="hljs-keyword">const</span> &#123; setupMaster, setupWorker &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@socket.io/sticky&quot;</span>);<span class="hljs-keyword">const</span> &#123; createAdapter, setupPrimary &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@socket.io/cluster-adapter&quot;</span>);<span class="hljs-keyword">if</span> (cluster.<span class="hljs-property">isMaster</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Master <span class="hljs-subst">$&#123;process.pid&#125;</span> is running`</span>);  <span class="hljs-keyword">const</span> httpServer = http.<span class="hljs-title function_">createServer</span>();  <span class="hljs-comment">// setup sticky sessions</span>  <span class="hljs-title function_">setupMaster</span>(httpServer, &#123;    <span class="hljs-attr">loadBalancingMethod</span>: <span class="hljs-string">&quot;least-connection&quot;</span>,  &#125;);  <span class="hljs-comment">// setup connections between the workers</span>  <span class="hljs-title function_">setupPrimary</span>();  <span class="hljs-comment">// needed for packets containing buffers (you can ignore it if you only send plaintext objects)</span>  <span class="hljs-comment">// Node.js &lt; 16.0.0</span>  cluster.<span class="hljs-title function_">setupMaster</span>(&#123;    <span class="hljs-attr">serialization</span>: <span class="hljs-string">&quot;advanced&quot;</span>,  &#125;);  <span class="hljs-comment">// Node.js &gt; 16.0.0</span>  <span class="hljs-comment">// cluster.setupPrimary(&#123;</span>  <span class="hljs-comment">//   serialization: &quot;advanced&quot;,</span>  <span class="hljs-comment">// &#125;);</span>  httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numCPUs; i++) &#123;    cluster.<span class="hljs-title function_">fork</span>();  &#125;  cluster.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;exit&quot;</span>, <span class="hljs-function">(<span class="hljs-params">worker</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Worker <span class="hljs-subst">$&#123;worker.process.pid&#125;</span> died`</span>);    cluster.<span class="hljs-title function_">fork</span>();  &#125;);&#125; <span class="hljs-keyword">else</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Worker <span class="hljs-subst">$&#123;process.pid&#125;</span> started`</span>);  <span class="hljs-keyword">const</span> httpServer = http.<span class="hljs-title function_">createServer</span>();  <span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer);  <span class="hljs-comment">// use the cluster adapter</span>  io.<span class="hljs-title function_">adapter</span>(<span class="hljs-title function_">createAdapter</span>());  <span class="hljs-comment">// setup connection with the primary process</span>  <span class="hljs-title function_">setupWorker</span>(io);  io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;    <span class="hljs-comment">/* ... */</span>  &#125;);&#125;</code></pre></div><h2 id="åœ¨èŠ‚ç‚¹ä¹‹é—´ä¼ é€’äº‹ä»¶"><a href="#åœ¨èŠ‚ç‚¹ä¹‹é—´ä¼ é€’äº‹ä»¶" class="headerlink" title="åœ¨èŠ‚ç‚¹ä¹‹é—´ä¼ é€’äº‹ä»¶"></a>åœ¨èŠ‚ç‚¹ä¹‹é—´ä¼ é€’äº‹ä»¶</h2><p>æ—¢ç„¶æ‚¨æœ‰å¤šä¸ªæ¥å—è¿æ¥çš„Socket.IO èŠ‚ç‚¹ï¼Œå¦‚æœæ‚¨æƒ³å‘æ‰€æœ‰å®¢æˆ·ç«¯ï¼ˆæˆ–æŸä¸ª<a href="https://socket.io/zh-CN/docs/v4/rooms/">æˆ¿é—´</a>ä¸­çš„å®¢æˆ·ç«¯ï¼‰å¹¿æ’­äº‹ä»¶ï¼Œæ‚¨å°†éœ€è¦æŸç§æ–¹å¼åœ¨è¿›ç¨‹æˆ–è®¡ç®—æœºä¹‹é—´ä¼ é€’æ¶ˆæ¯ã€‚</p><p>è´Ÿè´£è·¯ç”±æ¶ˆæ¯çš„æ¥å£å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„<a href="https://socket.io/zh-CN/docs/v4/adapter/">Adapter</a>ã€‚</p><h1 id="å¤„ç†-CORS"><a href="#å¤„ç†-CORS" class="headerlink" title="å¤„ç† CORS"></a>å¤„ç† CORS</h1><p>ä» Socket.IO v3 å¼€å§‹ï¼Œæ‚¨éœ€è¦æ˜¾å¼å¯ç”¨<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">è·¨åŸŸèµ„æºå…±äº«</a>(CORS)ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>();<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123;  <span class="hljs-attr">cors</span>: &#123;    <span class="hljs-attr">origin</span>: <span class="hljs-string">&quot;https://example.com&quot;</span>  &#125;&#125;);</code></pre></div><p>æ‰€æœ‰é€‰é¡¹éƒ½å°†è½¬å‘åˆ°<a href="https://www.npmjs.com/package/cors">cors</a>åŒ…ã€‚å¯ä»¥åœ¨<a href="https://github.com/expressjs/cors#configuration-options">æ­¤å¤„</a>æ‰¾åˆ°å®Œæ•´çš„é€‰é¡¹åˆ—è¡¨ã€‚</p><p>å¸¦æœ‰ cookie ( <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials">withCredentials</a>) å’Œé™„åŠ æ ‡å¤´çš„ç¤ºä¾‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// server-side</span><span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123;  <span class="hljs-attr">cors</span>: &#123;    <span class="hljs-attr">origin</span>: <span class="hljs-string">&quot;https://example.com&quot;</span>,    <span class="hljs-attr">allowedHeaders</span>: [<span class="hljs-string">&quot;my-custom-header&quot;</span>],    <span class="hljs-attr">credentials</span>: <span class="hljs-literal">true</span>  &#125;&#125;);<span class="hljs-comment">// client-side</span><span class="hljs-keyword">import</span> &#123; io &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io-client&quot;</span>;<span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;https://api.example.com&quot;</span>, &#123;  <span class="hljs-attr">withCredentials</span>: <span class="hljs-literal">true</span>,  <span class="hljs-attr">extraHeaders</span>: &#123;    <span class="hljs-string">&quot;my-custom-header&quot;</span>: <span class="hljs-string">&quot;abcd&quot;</span>  &#125;&#125;);</code></pre></div><p>æ³¨æ„ï¼šå¦‚æœæ‚¨çš„ Web åº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨ä¸æ˜¯ä»åŒä¸€ä¸ªç«¯å£æä¾›æœåŠ¡ï¼Œè¿™ä¹Ÿé€‚ç”¨äº localhost</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123;  <span class="hljs-attr">cors</span>: &#123;    <span class="hljs-attr">origin</span>: <span class="hljs-string">&quot;http://localhost:8080&quot;</span>  &#125;&#125;);httpServer.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);</code></pre></div><p>æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹ç¦æ­¢æ‰€æœ‰è·¨åŸŸè¯·æ±‚<a href="https://socket.io/zh-CN/docs/v4/server-options/#allowrequest"><code>allowRequest</code></a> option:</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123;  <span class="hljs-attr">allowRequest</span>: <span class="hljs-function">(<span class="hljs-params">req, callback</span>) =&gt;</span> &#123;    <span class="hljs-keyword">const</span> noOriginHeader = req.<span class="hljs-property">headers</span>.<span class="hljs-property">origin</span> === <span class="hljs-literal">undefined</span>;    <span class="hljs-title function_">callback</span>(<span class="hljs-literal">null</span>, noOriginHeader);  &#125;&#125;);</code></pre></div><h2 id="æ•…éšœæ’é™¤"><a href="#æ•…éšœæ’é™¤" class="headerlink" title="æ•…éšœæ’é™¤"></a>æ•…éšœæ’é™¤<a href="https://socket.io/zh-CN/docs/v4/handling-cors/#troubleshooting"></a></h2><h3 id="ç¼ºå°‘-CORS-æ ‡å¤´â€œAccess-Control-Allow-Originâ€"><a href="#ç¼ºå°‘-CORS-æ ‡å¤´â€œAccess-Control-Allow-Originâ€" class="headerlink" title="ç¼ºå°‘ CORS æ ‡å¤´â€œAccess-Control-Allow-Originâ€"></a>ç¼ºå°‘ CORS æ ‡å¤´â€œAccess-Control-Allow-Originâ€<a href="https://socket.io/zh-CN/docs/v4/handling-cors/#cors-header-access-control-allow-origin-missing"></a></h3><p>å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ï¼š</p><blockquote><p><em>è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢ï¼šåŒæºç­–ç•¥ä¸å…è®¸è¯»å–ä½äº â€¦/socket.io/?EIO=4&amp;transport=polling&amp;t=NMnp2WI çš„è¿œç¨‹èµ„æºã€‚ï¼ˆåŸå› ï¼šç¼ºå°‘ CORS æ ‡å¤´â€œAccess-Control-Allow-Originâ€ï¼‰ã€‚</em></p></blockquote><p>å¦‚æœæ‚¨å·²æ­£ç¡®é…ç½®æ‚¨çš„æœåŠ¡å™¨ï¼ˆè§<a href="https://socket.io/zh-CN/docs/v4/handling-cors/#configuration">ä¸Šæ–‡</a>ï¼‰ï¼Œè¿™å¯èƒ½æ„å‘³ç€æ‚¨çš„æµè§ˆå™¨æ— æ³•è®¿é—® Socket.IO æœåŠ¡å™¨ã€‚</p><p>ä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="code-wrapper"><pre><code class="hljs text">curl &quot;https://api.example.com/socket.io/?EIO=4&amp;transport=polling&quot;</code></pre></div><p>åº”è¯¥è¿”å›ç±»ä¼¼ï¼š</p><div class="code-wrapper"><pre><code class="hljs text">0&#123;&quot;sid&quot;:&quot;Lbo5JLzTotvW3g2LAAAA&quot;,&quot;upgrades&quot;:[&quot;websocket&quot;],&quot;pingInterval&quot;:25000,&quot;pingTimeout&quot;:20000&#125;</code></pre></div><p>å¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µï¼Œè¯·æ£€æŸ¥æ‚¨çš„æœåŠ¡å™¨æ˜¯å¦æ­£åœ¨ä¾¦å¬å¹¶ä¸”å®é™…ä¸Šå¯ä»¥åœ¨ç»™å®šç«¯å£ä¸Šè®¿é—®ã€‚</p><h3 id="å¦‚æœ-CORS-æ ‡å¤´â€œAccess-Control-Allow-Originâ€ä¸ºâ€œ-â€ï¼Œåˆ™ä¸æ”¯æŒå‡­æ®"><a href="#å¦‚æœ-CORS-æ ‡å¤´â€œAccess-Control-Allow-Originâ€ä¸ºâ€œ-â€ï¼Œåˆ™ä¸æ”¯æŒå‡­æ®" class="headerlink" title="å¦‚æœ CORS æ ‡å¤´â€œAccess-Control-Allow-Originâ€ä¸ºâ€œ*â€ï¼Œåˆ™ä¸æ”¯æŒå‡­æ®"></a>å¦‚æœ CORS æ ‡å¤´â€œAccess-Control-Allow-Originâ€ä¸ºâ€œ*â€ï¼Œåˆ™ä¸æ”¯æŒå‡­æ®<a href="https://socket.io/zh-CN/docs/v4/handling-cors/#credential-is-not-supported-if-the-cors-header-access-control-allow-origin-is-"></a></h3><p>å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ï¼š</p><blockquote><p><em>è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢ï¼šåŒæºç­–ç•¥ä¸å…è®¸è¯»å–ä½äºâ€œâ€¦/socket.io/?EIO=4&amp;transport=polling&amp;t=NvQfU77â€çš„è¿œç¨‹èµ„æºã€‚ï¼ˆåŸå› ï¼šå¦‚æœ CORS æ ‡å¤´â€œAccess-Control-Allow-Originâ€ä¸ºâ€œ*â€ï¼Œåˆ™ä¸æ”¯æŒå‡­è¯ï¼‰</em></p></blockquote><p>æ‚¨ä¸èƒ½åŒæ—¶è®¾ç½®<a href="https://socket.io/zh-CN/docs/v4/client-options/#withcredentials"><code>withCredentials</code></a> ä¸º <code>true</code> å’Œ <code>origin: *</code>ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ç‰¹å®šçš„æ¥æºï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createServer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io&quot;</span>;<span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createServer</span>();<span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(httpServer, &#123;  <span class="hljs-attr">cors</span>: &#123;    <span class="hljs-attr">origin</span>: <span class="hljs-string">&quot;https://my-frontend.com&quot;</span>,    <span class="hljs-comment">// or with an array of origins</span>    <span class="hljs-comment">// origin: [&quot;https://my-frontend.com&quot;, &quot;https://my-other-frontend.com&quot;, &quot;http://localhost:3000&quot;],</span>    <span class="hljs-attr">credentials</span>: <span class="hljs-literal">true</span>  &#125;&#125;);</code></pre></div><h3 id="CORS-æ ‡å¤´â€œAccess-Control-Allow-Credentialsâ€ä¸­é¢„æœŸä¸ºâ€œtrueâ€"><a href="#CORS-æ ‡å¤´â€œAccess-Control-Allow-Credentialsâ€ä¸­é¢„æœŸä¸ºâ€œtrueâ€" class="headerlink" title="CORS æ ‡å¤´â€œAccess-Control-Allow-Credentialsâ€ä¸­é¢„æœŸä¸ºâ€œtrueâ€"></a>CORS æ ‡å¤´â€œAccess-Control-Allow-Credentialsâ€ä¸­é¢„æœŸä¸ºâ€œtrueâ€<a href="https://socket.io/zh-CN/docs/v4/handling-cors/#expected-true-in-cors-header-access-control-allow-credentials"></a></h3><p>å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ï¼š</p><blockquote><p><em>è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢ï¼šåŒæºç­–ç•¥ä¸å…è®¸è¯»å–ä½äº â€¦/socket.io/?EIO=4&amp;transport=polling&amp;t=NvQny19 çš„è¿œç¨‹èµ„æºã€‚ï¼ˆåŸå› ï¼šCORS æ ‡å¤´â€œAccess-Control-Allow-Credentialsâ€ä¸­é¢„æœŸä¸ºâ€œtrueâ€ï¼‰</em></p></blockquote><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨å®¢æˆ·ç«¯ä¸Š<a href="https://socket.io/zh-CN/docs/v4/client-options/#withcredentials"><code>withCredentials</code></a>è®¾ç½®ä¸º<code>true</code>ï¼Œä½†æœåŠ¡å™¨ç¼ºå°‘é€‰é¡¹<code>credentials</code>ä¸­çš„å±æ€§<a href="https://socket.io/zh-CN/docs/v4/server-options/#cors"><code>cors</code></a> ã€‚è¯·å‚è§ä¸Šé¢çš„ç¤ºä¾‹ã€‚</p><h1 id="å®¢æˆ·ç«¯åˆå§‹åŒ–"><a href="#å®¢æˆ·ç«¯åˆå§‹åŒ–" class="headerlink" title="å®¢æˆ·ç«¯åˆå§‹åŒ–"></a>å®¢æˆ·ç«¯åˆå§‹åŒ–</h1><p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ<code>io</code>å¯¹è±¡æ¥è‡ªï¼š</p><ul><li>ä½¿ç”¨ <code>&lt;script&gt;</code> å¼•å…¥</li></ul><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/socket.io/socket.io.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><p>å¤åˆ¶</p><ul><li>ä½¿ç”¨ ESM å¼•å…¥</li></ul><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">  <span class="hljs-keyword">import</span> &#123; io &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;https://cdn.socket.io/4.3.2/socket.io.esm.min.js&quot;</span>;</span><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><p>å¤åˆ¶</p><ul><li>NPM</li></ul><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; io &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;socket.io-client&quot;</span>;</code></pre></div><h2 id="æ¥è‡ªåŒä¸€åŸŸ"><a href="#æ¥è‡ªåŒä¸€åŸŸ" class="headerlink" title="æ¥è‡ªåŒä¸€åŸŸ"></a>æ¥è‡ªåŒä¸€åŸŸ<a href="https://socket.io/zh-CN/docs/v4/client-initialization/#from-the-same-domain"></a></h2><p>å¦‚æœæ‚¨çš„å‰ç«¯ä¸æ‚¨çš„æœåŠ¡å™¨åœ¨åŒä¸€ä¸ªåŸŸä¸Šæä¾›æœåŠ¡ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°ä½¿ç”¨ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>();</code></pre></div><p>æœåŠ¡å™¨ URL å°†ä» <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/location">window.location</a>å¯¹è±¡ä¸­æ¨å¯¼å‡ºæ¥</p><h2 id="æ¥è‡ªä¸åŒçš„åŸŸ"><a href="#æ¥è‡ªä¸åŒçš„åŸŸ" class="headerlink" title="æ¥è‡ªä¸åŒçš„åŸŸ"></a>æ¥è‡ªä¸åŒçš„åŸŸ<a href="https://socket.io/zh-CN/docs/v4/client-initialization/#from-a-different-domain"></a></h2><p>å¦‚æœæ‚¨çš„å‰ç«¯ä¸æ˜¯æ¥è‡ªä¸æœåŠ¡å™¨ç›¸åŒçš„åŸŸï¼Œåˆ™å¿…é¡»ä¼ é€’æœåŠ¡å™¨çš„ URLã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;https://server-domain.com&quot;</span>);</code></pre></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·ç¡®ä¿åœ¨æœåŠ¡å™¨ä¸Šå¯ç”¨ <a href="https://socket.io/zh-CN/docs/v4/handling-cors/">è·¨åŸŸèµ„æºå…±äº« (CORS)</a>ã€‚</p><h5 id="ä¿¡æ¯"><a href="#ä¿¡æ¯" class="headerlink" title="ä¿¡æ¯"></a>ä¿¡æ¯</h5><p>æ‚¨å¯ä»¥ä½¿ç”¨<code>https</code> æˆ– <code>wss</code> (åˆ†åˆ«ä¸º, <code>http</code> æˆ– <code>ws</code>).</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// the following forms are similar</span><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;https://server-domain.com&quot;</span>);<span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;wss://server-domain.com&quot;</span>);<span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;server-domain.com&quot;</span>); <span class="hljs-comment">// only in the browser when the page is served over https (will not work in Node.js)</span></code></pre></div><h2 id="è‡ªå®šä¹‰å‘½åç©ºé—´"><a href="#è‡ªå®šä¹‰å‘½åç©ºé—´" class="headerlink" title="è‡ªå®šä¹‰å‘½åç©ºé—´"></a>è‡ªå®šä¹‰å‘½åç©ºé—´<a href="https://socket.io/zh-CN/docs/v4/client-initialization/#custom-namespace"></a></h2><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå®¢æˆ·ç«¯å°†è¿æ¥åˆ°ä¸»å‘½åç©ºé—´ã€‚å¯¹äºå¤§å¤šæ•°ç”¨ä¾‹æ¥è¯´ï¼Œä»…ä½¿ç”¨ä¸»å‘½åç©ºé—´å°±è¶³å¤Ÿäº†ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‡å®šå‘½åç©ºé—´ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// same origin version</span><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;/admin&quot;</span>);<span class="hljs-comment">// cross origin version</span><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&quot;https://server-domain.com/admin&quot;</span>);</code></pre></div><p>æ‚¨å¯ä»¥<a href="https://socket.io/zh-CN/docs/v4/namespaces/">åœ¨æ­¤å¤„</a>æ‰¾åˆ°æœ‰å…³åç§°ç©ºé—´çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®<a href="https://socket.io/zh-CN/docs/v4/client-initialization/#options"></a></h2><p>å¯åœ¨<a href="https://socket.io/zh-CN/docs/v4/client-options/">æ­¤å¤„</a>æ‰¾åˆ°å¯ç”¨é…ç½®çš„å®Œæ•´åˆ—è¡¨</p><h1 id="Socket-å®ä¾‹ï¼ˆå®¢æˆ·ç«¯ï¼‰"><a href="#Socket-å®ä¾‹ï¼ˆå®¢æˆ·ç«¯ï¼‰" class="headerlink" title="Socket å®ä¾‹ï¼ˆå®¢æˆ·ç«¯ï¼‰"></a>Socket å®ä¾‹ï¼ˆå®¢æˆ·ç«¯ï¼‰</h1><p><code>Socket</code>æ˜¯ä¸æœåŠ¡å™¨äº¤äº’çš„åŸºç¡€ç±»ã€‚å®ƒç»§æ‰¿äº† Node.js<a href="https://nodejs.org/api/events.html#class-eventemitter">EventEmitter</a>çš„å¤§éƒ¨åˆ†æ–¹æ³•ï¼Œä¾‹å¦‚ <a href="https://socket.io/zh-CN/docs/v4/client-api/#socketemiteventname-args">emit</a>, <a href="https://socket.io/zh-CN/docs/v4/client-api/#socketoneventname-callback">on</a>, <a href="https://socket.io/zh-CN/docs/v4/client-api/#socketonceeventname-callback">once</a> æˆ– <a href="https://socket.io/zh-CN/docs/v4/client-api/#socketoffeventname">off</a>ã€‚</p><p><img src="https://socket.io/zh-CN/images/bidirectional-communication-socket.png" alt="Bidirectional communication between server and client"></p><p>é™¤äº†<a href="https://socket.io/zh-CN/docs/v4/emitting-events/">emitting</a> å’Œ <a href="https://socket.io/zh-CN/docs/v4/listening-to-events/">listening to</a>äº‹ä»¶ä¹‹å¤–ï¼ŒSocket å®ä¾‹è¿˜æœ‰ä¸€äº›å¯èƒ½åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å±æ€§ï¼š</p><h2 id="Socket-id-1"><a href="#Socket-id-1" class="headerlink" title="Socket#id"></a>Socket#id<a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#socketid"></a></h2><p>æ¯ä¸ªæ–°è¿æ¥éƒ½åˆ†é…æœ‰ä¸€ä¸ªéšæœºçš„ 20 ä¸ªå­—ç¬¦çš„æ ‡è¯†ç¬¦ã€‚</p><p>æ­¤æ ‡è¯†ç¬¦ä¸æœåŠ¡å™¨ç«¯çš„å€¼åŒæ­¥ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// server-side</span>io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">id</span>); <span class="hljs-comment">// x8WIv7-mJelg7on_ALbx</span>&#125;);<span class="hljs-comment">// client-side</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">id</span>); <span class="hljs-comment">// x8WIv7-mJelg7on_ALbx</span>&#125;);socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">id</span>); <span class="hljs-comment">// undefined</span>&#125;);</code></pre></div><h2 id="Socket-connected"><a href="#Socket-connected" class="headerlink" title="Socket#connected"></a>Socket#connected<a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#socketconnected"></a></h2><p>è¯¥å±æ€§æè¿°å¥—æ¥å­—å½“å‰æ˜¯å¦è¿æ¥åˆ°æœåŠ¡å™¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">connected</span>); <span class="hljs-comment">// true</span>&#125;);socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">connected</span>); <span class="hljs-comment">// false</span>&#125;);</code></pre></div><h2 id="Socket-io"><a href="#Socket-io" class="headerlink" title="Socket#io"></a>Socket#io<a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#socketio"></a></h2><p>å¯¹åŸºç¡€<a href="https://socket.io/zh-CN/docs/v4/client-api/#manager">Manager</a>çš„å¼•ç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> engine = socket.<span class="hljs-property">io</span>.<span class="hljs-property">engine</span>;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(engine.<span class="hljs-property">transport</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// in most cases, prints &quot;polling&quot;</span>  engine.<span class="hljs-title function_">once</span>(<span class="hljs-string">&quot;upgrade&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// called when the transport is upgraded (i.e. from HTTP long-polling to WebSocket)</span>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(engine.<span class="hljs-property">transport</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// in most cases, prints &quot;websocket&quot;</span>  &#125;);  engine.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;packet&quot;</span>, <span class="hljs-function">(<span class="hljs-params">&#123; type, data &#125;</span>) =&gt;</span> &#123;    <span class="hljs-comment">// called for each packet received</span>  &#125;);  engine.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;packetCreate&quot;</span>, <span class="hljs-function">(<span class="hljs-params">&#123; type, data &#125;</span>) =&gt;</span> &#123;    <span class="hljs-comment">// called for each packet sent</span>  &#125;);  engine.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;drain&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// called when the write buffer is drained</span>  &#125;);  engine.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;close&quot;</span>, <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;    <span class="hljs-comment">// called when the underlying connection is closed</span>  &#125;);&#125;);</code></pre></div><h2 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ<a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#lifecycle"></a></h2><p><img src="https://socket.io/images/client_socket_events.png" alt="Lifecycle diagram"></p><h2 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶<a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#events"></a></h2><p>Socket å®ä¾‹å‘å‡ºä¸‰ä¸ªç‰¹æ®Šäº‹ä»¶ï¼š</p><ul><li><a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#connect"><code>connect</code></a></li><li><a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#connect-error"><code>connect_error</code></a></li><li><a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#disconnect"><code>disconnect</code></a></li></ul><p>è¯·æ³¨æ„ï¼Œä» Socket.IO v3 å¼€å§‹ï¼ŒSocket å®ä¾‹ä¸å†å‘å‡ºä»»ä½•ä¸é‡æ–°è¿æ¥é€»è¾‘ç›¸å…³çš„äº‹ä»¶ã€‚æ‚¨å¯ä»¥ç›´æ¥ç›‘å¬ Manager å®ä¾‹ä¸Šçš„äº‹ä»¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-property">io</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;reconnect_attempt&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);socket.<span class="hljs-property">io</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;reconnect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><p>æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨<a href="https://socket.io/zh-CN/docs/v4/migrating-from-2-x-to-3-0/#the-socket-instance-will-no-longer-forward-the-events-emitted-by-its-manager">è¿ç§»æŒ‡å—</a>ä¸­æ‰¾åˆ°</p><h3 id="connect"><a href="#connect" class="headerlink" title="connect"></a><code>connect</code><a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#connect"></a></h3><p>æ­¤äº‹ä»¶ç”± Socket å®ä¾‹åœ¨è¿æ¥<strong>å’Œ</strong>é‡æ–°è¿æ¥æ—¶è§¦å‘ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><p>è¯·æ³¨æ„ï¼Œæ‚¨ä¸åº”åœ¨<code>connect</code>å¤„ç†ç¨‹åºæœ¬èº«ä¸­æ³¨å†Œäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå› ä¸ºæ¯æ¬¡ Socket é‡æ–°è¿æ¥æ—¶éƒ½ä¼šæ³¨å†Œä¸€ä¸ªæ–°çš„å¤„ç†ç¨‹åºï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// BAD</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123; <span class="hljs-comment">/* ... */</span> &#125;);&#125;);<span class="hljs-comment">// GOOD</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123; <span class="hljs-comment">/* ... */</span> &#125;);</code></pre></div><h3 id="connect-error"><a href="#connect-error" class="headerlink" title="connect_error"></a><code>connect_error</code><a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#connect_error"></a></h3><p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹è§¦å‘æ­¤äº‹ä»¶ï¼š</p><ul><li>ä½çº§è¿æ¥æ— æ³•å»ºç«‹</li><li>æœåŠ¡å™¨åœ¨<a href="https://socket.io/zh-CN/docs/v4/middlewares/">ä¸­é—´ä»¶åŠŸèƒ½</a>ä¸­æ‹’ç»è¿æ¥</li></ul><p>åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼ŒSocket ä¼šåœ¨ <a href="https://socket.io/zh-CN/docs/v4/client-options/#reconnectiondelay">ç»™å®šçš„å»¶è¿Ÿ</a>ä¹‹åè‡ªåŠ¨å°è¯•é‡æ–°è¿æ¥ã€‚</p><p>åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦æ‰‹åŠ¨é‡æ–°è¿æ¥ã€‚æ‚¨å¯èƒ½éœ€è¦æ›´æ–°å‡­æ®ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// either by directly modifying the `auth` attribute</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect_error&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  socket.<span class="hljs-property">auth</span>.<span class="hljs-property">token</span> = <span class="hljs-string">&quot;abcd&quot;</span>;  socket.<span class="hljs-title function_">connect</span>();&#125;);<span class="hljs-comment">// or if the `auth` attribute is a function</span><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(&#123;  <span class="hljs-attr">auth</span>: <span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> &#123;    <span class="hljs-title function_">cb</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&quot;token&quot;</span>));  &#125;&#125;);socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connect_error&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    socket.<span class="hljs-title function_">connect</span>();  &#125;, <span class="hljs-number">1000</span>);&#125;);</code></pre></div><h3 id="disconnect-1"><a href="#disconnect-1" class="headerlink" title="disconnect"></a><code>disconnect</code><a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#disconnect"></a></h3><p>æ­¤äº‹ä»¶åœ¨æ–­å¼€è¿æ¥æ—¶è§¦å‘ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnect&quot;</span>, <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><p>å¤åˆ¶</p><p>ä»¥ä¸‹æ˜¯å¯èƒ½çš„åŸå› åˆ—è¡¨ï¼š</p><table><thead><tr><th>Reason</th><th>Description</th></tr></thead><tbody><tr><td><code>io server disconnect</code></td><td>æœåŠ¡å™¨å·²ä½¿ç”¨<a href="https://socket.io/zh-CN/docs/v4/server-api/#socketdisconnectclose">socket.disconnect()</a>å¼ºåˆ¶æ–­å¼€socket</td></tr><tr><td><code>io client disconnect</code></td><td>ä½¿ç”¨<a href="https://socket.io/zh-CN/docs/v4/client-api/#socketdisconnect">socket.disconnect()</a>æ‰‹åŠ¨æ–­å¼€socket</td></tr><tr><td><code>ping timeout</code></td><td>æœåŠ¡å™¨æœªåœ¨è¯¥<code>pingInterval + pingTimeout</code>èŒƒå›´å†…å‘é€ PING</td></tr><tr><td><code>transport close</code></td><td>è¿æ¥å·²å…³é—­ï¼ˆä¾‹å¦‚ï¼šç”¨æˆ·å¤±å»è¿æ¥ï¼Œæˆ–ç½‘ç»œä» WiFi æ›´æ”¹ä¸º 4Gï¼‰</td></tr><tr><td><code>transport error</code></td><td>è¿æ¥é‡åˆ°é”™è¯¯ï¼ˆä¾‹å¦‚ï¼šæœåŠ¡å™¨åœ¨ HTTP é•¿è½®è¯¢å‘¨æœŸä¸­è¢«æ€æ­»ï¼‰</td></tr></tbody></table><p>å‰ä¸¤ç§æƒ…å†µï¼ˆæ˜¾å¼æ–­å¼€ï¼‰ï¼Œå®¢æˆ·ç«¯ä¸ä¼šå°è¯•é‡æ–°è¿æ¥ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨<code>socket.connect()</code>.</p><p>åœ¨æ‰€æœ‰å…¶ä»–æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å°†ç­‰å¾…ä¸€ä¸ªå°çš„<a href="https://socket.io/zh-CN/docs/v4/client-options/#reconnectiondelay">éšæœºå»¶è¿Ÿ</a>ï¼Œç„¶åå°è¯•é‡æ–°è¿æ¥ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnect&quot;</span>, <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;  <span class="hljs-keyword">if</span> (reason === <span class="hljs-string">&quot;io server disconnect&quot;</span>) &#123;    <span class="hljs-comment">// the disconnection was initiated by the server, you need to reconnect manually</span>    socket.<span class="hljs-title function_">connect</span>();<span class="hljs-comment">//æœåŠ¡å™¨æ–­å¼€çš„ï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œé‡è¿</span>  &#125;  <span class="hljs-comment">// else the socket will automatically try to reconnect</span>&#125;);</code></pre></div><p>æ³¨æ„ï¼šè¿™äº›äº‹ä»¶ä»¥åŠ<code>disconnecting</code>, <code>newListener</code> å’Œ <code>removeListener</code>æ˜¯ä¸åº”åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„ç‰¹æ®Šäº‹ä»¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// BAD, will throw an error</span>socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;disconnect&quot;</span>);</code></pre></div><h1 id="ç¦»çº¿è¡Œä¸º"><a href="#ç¦»çº¿è¡Œä¸º" class="headerlink" title="ç¦»çº¿è¡Œä¸º"></a>ç¦»çº¿è¡Œä¸º</h1><h2 id="ç¼“å†²äº‹ä»¶"><a href="#ç¼“å†²äº‹ä»¶" class="headerlink" title="ç¼“å†²äº‹ä»¶"></a>ç¼“å†²äº‹ä»¶<a href="https://socket.io/zh-CN/docs/v4/client-offline-behavior/#buffered-events"></a></h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ Socket æœªè¿æ¥æ—¶å‘å‡ºçš„ä»»ä½•äº‹ä»¶éƒ½å°†è¢«ç¼“å†²ï¼Œç›´åˆ°é‡æ–°è¿æ¥ã€‚</p><p>è™½ç„¶åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ï¼ˆå½“é‡æ–°è¿æ¥å»¶è¿Ÿå¾ˆçŸ­æ—¶ï¼‰ï¼Œä½†å®ƒå¯èƒ½ä¼šåœ¨è¿æ¥æ¢å¤æ—¶å¯¼è‡´å¤§é‡äº‹ä»¶ã€‚</p><p>æœ‰å‡ ç§è§£å†³æ–¹æ¡ˆå¯ä»¥é˜²æ­¢è¿™ç§è¡Œä¸ºï¼Œå…·ä½“å–å†³äºæ‚¨çš„ç”¨ä¾‹ï¼š</p><ul><li>ä½¿ç”¨Socket å®ä¾‹çš„<a href="https://socket.io/zh-CN/docs/v4/client-socket-instance/#socketconnected">connected å±æ€§</a> attribute of the Socket instance</li></ul><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (socket.<span class="hljs-property">connected</span>) &#123;  socket.<span class="hljs-title function_">emit</span>( <span class="hljs-comment">/* ... */</span> );&#125; <span class="hljs-keyword">else</span> &#123;  <span class="hljs-comment">// ...</span>&#125;</code></pre></div><ul><li>ä½¿ç”¨ <a href="https://socket.io/zh-CN/docs/v4/emitting-events/#volatile-events">volatile äº‹ä»¶</a></li></ul><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-property">volatile</span>.<span class="hljs-title function_">emit</span>( <span class="hljs-comment">/* ... */</span> );</code></pre></div><h1 id="å‘é€äº‹ä»¶"><a href="#å‘é€äº‹ä»¶" class="headerlink" title="å‘é€äº‹ä»¶"></a>å‘é€äº‹ä»¶</h1><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´å‘é€äº‹ä»¶ã€‚</p><h2 id="åŸºæœ¬çš„-emit"><a href="#åŸºæœ¬çš„-emit" class="headerlink" title="åŸºæœ¬çš„ emit"></a>åŸºæœ¬çš„ emit<a href="https://socket.io/zh-CN/docs/v4/emitting-events/#%E5%9F%BA%E6%9C%AC%E7%9A%84-emit"></a></h2><p>Socket.IO API çš„çµæ„Ÿæ¥è‡ª Node.js <a href="https://nodejs.org/docs/latest/api/events.html#events_events">EventEmitter</a>ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥åœ¨ä¸€ä¾§å‘å‡ºäº‹ä»¶å¹¶åœ¨å¦ä¸€ä¾§æ³¨å†Œä¾¦å¬å™¨ï¼š</p><p><em>æœåŠ¡å™¨</em></p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);&#125;);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-function">(<span class="hljs-params">arg</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg); <span class="hljs-comment">// world</span>&#125;);</code></pre></div><p>è¿™ä¹Ÿé€‚ç”¨äºå¦ä¸€ä¸ªæ–¹å‘ï¼š</p><p><em>æœåŠ¡å™¨</em></p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-function">(<span class="hljs-params">arg</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg); <span class="hljs-comment">// world</span>  &#125;);&#125;);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);</code></pre></div><p>æ‚¨å¯ä»¥å‘é€ä»»æ„æ•°é‡çš„å‚æ•°ï¼Œå¹¶ä¸”æ”¯æŒæ‰€æœ‰å¯åºåˆ—åŒ–çš„æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬åƒ<a href="https://nodejs.org/docs/latest/api/buffer.html#buffer_buffer">Buffer</a> æˆ– <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray">TypedArray</a>è¿™æ ·çš„äºŒè¿›åˆ¶å¯¹è±¡ã€‚</p><p><em>æœåŠ¡å™¨</em></p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;2&quot;</span>, &#123; <span class="hljs-number">3</span>: <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-number">5</span>: <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>([<span class="hljs-number">6</span>]) &#125;);&#125;);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// client-side</span>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-function">(<span class="hljs-params">arg1, arg2, arg3</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg1); <span class="hljs-comment">// 1</span>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg2); <span class="hljs-comment">// &quot;2&quot;</span>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg3); <span class="hljs-comment">// &#123; 3: &#x27;4&#x27;, 5: ArrayBuffer (1) [ 6 ] &#125;</span>&#125;);</code></pre></div><p>æ— éœ€<code>JSON.stringify()</code>ï¼Œå› ä¸ºå®ƒä¼šä¸ºæ‚¨å®Œæˆã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// BAD</span>socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;John&quot;</span> &#125;));<span class="hljs-comment">// GOOD</span>socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;John&quot;</span> &#125;);</code></pre></div><p>ç¬”è®°ï¼š</p><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date">Date</a>å¯¹è±¡å°†è¢«è½¬æ¢ä¸ºï¼ˆå¹¶ä½œä¸ºï¼‰å®ƒä»¬çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ï¼Œä¾‹å¦‚<code>1970-01-01T00:00:00.000Z</code></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> å’Œ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set">Set</a>å¿…é¡»æ‰‹åŠ¨åºåˆ—åŒ–ï¼š</li></ul><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> serializedMap = [...myMap.<span class="hljs-title function_">entries</span>()];<span class="hljs-keyword">const</span> serializedSet = [...mySet.<span class="hljs-title function_">keys</span>()];</code></pre></div><ul><li>æ‚¨å¯ä»¥ä½¿ç”¨è¯¥<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#tojson_behavior"><code>toJSON()</code></a>æ–¹æ³•è‡ªå®šä¹‰å¯¹è±¡çš„åºåˆ—åŒ–</li></ul><p>ä¸€ä¸ªç±»çš„ä¾‹å­ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span> &#123;  #hp;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.#hp = <span class="hljs-number">42</span>;  &#125;  <span class="hljs-title function_">toJSON</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">hp</span>: <span class="hljs-variable language_">this</span>.#hp &#125;;  &#125;&#125;socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;here&#x27;s a hero&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>());</code></pre></div><h2 id="å›è°ƒ"><a href="#å›è°ƒ" class="headerlink" title="å›è°ƒ"></a>å›è°ƒ<a href="https://socket.io/zh-CN/docs/v4/emitting-events/#%E5%9B%9E%E8%B0%83"></a></h2><p>äº‹ä»¶å¾ˆæ£’ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½éœ€è¦æ›´ç»å…¸çš„è¯·æ±‚-å“åº” APIã€‚åœ¨ Socket.IO ä¸­ï¼Œæ­¤åŠŸèƒ½ç§°ä¸ºç¡®è®¤ã€‚</p><p>æ‚¨å¯ä»¥æ·»åŠ ä¸€ä¸ªå›è°ƒä½œä¸º<code>emit()</code>çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œä¸€æ—¦å¯¹æ–¹ç¡®è®¤äº‹ä»¶ï¼Œå°±ä¼šè°ƒç”¨æ­¤å›è°ƒï¼š</p><p><em>æœåŠ¡å™¨</em></p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;update item&quot;</span>, <span class="hljs-function">(<span class="hljs-params">arg1, arg2, callback</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg1); <span class="hljs-comment">// 1</span>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg2); <span class="hljs-comment">// &#123; name: &quot;updated&quot; &#125;</span>    <span class="hljs-title function_">callback</span>(&#123;      <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;ok&quot;</span>    &#125;);  &#125;);&#125;);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;update item&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;updated&quot;</span> &#125;, <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">status</span>); <span class="hljs-comment">// ok</span>&#125;);</code></pre></div><h2 id="è¶…æ—¶"><a href="#è¶…æ—¶" class="headerlink" title="è¶…æ—¶"></a>è¶…æ—¶<a href="https://socket.io/zh-CN/docs/v4/emitting-events/#%E8%B6%85%E6%97%B6"></a></h2><p>ä» Socket.IO v4.4.0 å¼€å§‹ï¼Œæ‚¨ç°åœ¨å¯ä»¥ä¸ºæ¯ä¸ªå‘å°„åˆ†é…è¶…æ—¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">timeout</span>(<span class="hljs-number">5000</span>).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;my-event&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;  <span class="hljs-keyword">if</span> (err) &#123;    <span class="hljs-comment">// the other side did not acknowledge the event in the given delay</span>  &#125;&#125;);</code></pre></div><p>You can also use both a timeout and an <a href="https://socket.io/zh-CN/docs/v4/emitting-events/#acknowledgements">acknowledgement</a>:</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">timeout</span>(<span class="hljs-number">5000</span>).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;my-event&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err, response</span>) =&gt;</span> &#123;  <span class="hljs-keyword">if</span> (err) &#123;    <span class="hljs-comment">// the other side did not acknowledge the event in the given delay</span>  &#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);  &#125;&#125;);</code></pre></div><h2 id="æ˜“å¤±æ€§äº‹ä»¶"><a href="#æ˜“å¤±æ€§äº‹ä»¶" class="headerlink" title="æ˜“å¤±æ€§äº‹ä»¶"></a>æ˜“å¤±æ€§äº‹ä»¶<a href="https://socket.io/zh-CN/docs/v4/emitting-events/#%E6%98%93%E5%A4%B1%E6%80%A7%E4%BA%8B%E4%BB%B6"></a></h2><p>æ˜“å¤±æ€§äº‹ä»¶æ˜¯åœ¨åº•å±‚è¿æ¥æœªå‡†å¤‡å¥½æ—¶ä¸ä¼šå‘é€çš„äº‹ä»¶ï¼ˆæœ‰ç‚¹åƒ<a href="https://fr.wikipedia.org/wiki/User_Datagram_Protocol">UDP</a>ï¼Œåœ¨å¯é æ€§æ–¹é¢ï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨éœ€è¦å‘é€åœ¨çº¿æ¸¸æˆä¸­è§’è‰²çš„ä½ç½®ï¼ˆå› ä¸ºåªæœ‰æœ€æ–°çš„å€¼æ‰æœ‰ç”¨ï¼‰ï¼Œè¿™å¯èƒ½ä¼šå¾ˆæœ‰è¶£ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-property">volatile</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;might or might not be received&quot;</span>);</code></pre></div><p>å¦ä¸€ä¸ªç”¨ä¾‹æ˜¯åœ¨å®¢æˆ·ç«¯æœªè¿æ¥æ—¶ä¸¢å¼ƒäº‹ä»¶ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œäº‹ä»¶ä¼šè¢«ç¼“å†²ç›´åˆ°é‡æ–°è¿æ¥ï¼‰ã€‚</p><p>ä¾‹å­ï¼š</p><p><em>æœåŠ¡å™¨</em></p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;connect&quot;</span>);  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;ping&quot;</span>, <span class="hljs-function">(<span class="hljs-params">count</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count);  &#125;);&#125;);</code></pre></div><p><em>å®¢æˆ·ç«¯</em></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;  socket.<span class="hljs-property">volatile</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;ping&quot;</span>, ++count);&#125;, <span class="hljs-number">1000</span>);</code></pre></div><p>å¦‚æœé‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œæ‚¨å°†åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°ï¼š</p><div class="code-wrapper"><pre><code class="hljs text">connect1234# the server is restarted, the client automatically reconnectsconnect91011</code></pre></div><p>å¦‚æœæ²¡æœ‰<code>volatile</code>æ ‡å¿—ï¼Œæ‚¨å°†çœ‹åˆ°ï¼š</p><div class="code-wrapper"><pre><code class="hljs text">connect1234# the server is restarted, the client automatically reconnects and sends its buffered eventsconnect567891011</code></pre></div><h1 id="ç›‘å¬äº‹ä»¶"><a href="#ç›‘å¬äº‹ä»¶" class="headerlink" title="ç›‘å¬äº‹ä»¶"></a>ç›‘å¬äº‹ä»¶</h1><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å¤„ç†åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´ä¼ è¾“çš„äº‹ä»¶ã€‚</p><h2 id="EventEmitter-æ–¹æ³•"><a href="#EventEmitter-æ–¹æ³•" class="headerlink" title="EventEmitter æ–¹æ³•"></a>EventEmitter æ–¹æ³•<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#eventemitter-methods"></a></h2><p>åœ¨æœåŠ¡å™¨ç«¯ï¼ŒSocket å®ä¾‹æ‰©å±•äº† Node.js <a href="https://nodejs.org/docs/latest/api/events.html#events_events">EventEmitter</a>ç±»ã€‚</p><p>åœ¨å®¢æˆ·ç«¯ï¼ŒSocket å®ä¾‹ä½¿ç”¨<a href="https://github.com/component/emitter">component-emitter</a>åº“æä¾›çš„äº‹ä»¶å‘å°„å™¨ï¼Œå®ƒå…¬å¼€äº† EventEmitter æ–¹æ³•çš„å­é›†ã€‚</p><h3 id="socket-on-eventName-listener"><a href="#socket-on-eventName-listener" class="headerlink" title="socket.on(eventName, listener)"></a>socket.on(eventName, listener)<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#socketoneventname-listener"></a></h3><p>å°†<em>ä¾¦å¬å™¨</em>å‡½æ•°æ·»åŠ åˆ°åä¸º<em>eventName</em>çš„äº‹ä»¶çš„ä¾¦å¬å™¨æ•°ç»„çš„æœ«å°¾ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;details&quot;</span>, <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><h3 id="socket-once-eventName-listener"><a href="#socket-once-eventName-listener" class="headerlink" title="socket.once(eventName, listener)"></a>socket.once(eventName, listener)<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#socketonceeventname-listener"></a></h3><p>ä¸ºåä¸º<em>eventName</em>çš„äº‹ä»¶æ·»åŠ <strong>ä¸€æ¬¡æ€§</strong>ç›‘å¬å‡½æ•°</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">once</span>(<span class="hljs-string">&quot;details&quot;</span>, <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><h3 id="socket-off-eventName-listener"><a href="#socket-off-eventName-listener" class="headerlink" title="socket.off(eventName, listener)"></a>socket.off(eventName, listener)<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#socketoffeventname-listener"></a></h3><p>ä»åä¸º<em>eventName</em>çš„äº‹ä»¶çš„ä¾¦å¬å™¨æ•°ç»„ä¸­ç§»é™¤æŒ‡å®šçš„<em>ä¾¦å¬å™¨</em>ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">listener</span> = (<span class="hljs-params">...args</span>) =&gt; &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);&#125;socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;details&quot;</span>, listener);<span class="hljs-comment">// and then later...</span>socket.<span class="hljs-title function_">off</span>(<span class="hljs-string">&quot;details&quot;</span>, listener);</code></pre></div><h3 id="socket-removeAllListeners-eventName"><a href="#socket-removeAllListeners-eventName" class="headerlink" title="socket.removeAllListeners([eventName])"></a>socket.removeAllListeners([eventName])<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#socketremovealllistenerseventname"></a></h3><p>åˆ é™¤æ‰€æœ‰ä¾¦å¬å™¨ï¼Œæˆ–æŒ‡å®š<em>eventName</em>çš„ä¾¦å¬å™¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// for a specific event</span>socket.<span class="hljs-title function_">removeAllListeners</span>(<span class="hljs-string">&quot;details&quot;</span>);<span class="hljs-comment">// for all events</span>socket.<span class="hljs-title function_">removeAllListeners</span>();</code></pre></div><h2 id="Catch-all-ä¾¦å¬å™¨"><a href="#Catch-all-ä¾¦å¬å™¨" class="headerlink" title="Catch-all ä¾¦å¬å™¨"></a>Catch-all ä¾¦å¬å™¨<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#catch-all-listeners"></a></h2><p>ä» Socket.IO v3 å¼€å§‹ï¼Œå—<a href="https://github.com/EventEmitter2/EventEmitter2">EventEmitter2</a>åº“å¯å‘çš„æ–° API å…è®¸å£°æ˜ Catch-all ä¾¦å¬å™¨ã€‚</p><p>æ­¤åŠŸèƒ½åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸Šå‡å¯ç”¨ã€‚</p><h3 id="socket-onAny-listener"><a href="#socket-onAny-listener" class="headerlink" title="socket.onAny(listener)"></a>socket.onAny(listener)<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#socketonanylistener"></a></h3><p>æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨ï¼Œå½“ä»»ä½•äº‹ä»¶å‘å‡ºæ—¶å°†è¢«è§¦å‘ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">onAny</span>(<span class="hljs-function">(<span class="hljs-params">eventName, ...args</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><h3 id="socket-prependAny-listener"><a href="#socket-prependAny-listener" class="headerlink" title="socket.prependAny(listener)"></a>socket.prependAny(listener)<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#socketprependanylistener"></a></h3><p>æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨ï¼Œå½“ä»»ä½•äº‹ä»¶å‘å‡ºæ—¶å°†è¢«è§¦å‘ã€‚ä¾¦å¬å™¨è¢«æ·»åŠ åˆ°ä¾¦å¬å™¨æ•°ç»„çš„å¼€å¤´ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">socket.<span class="hljs-title function_">prependAny</span>(<span class="hljs-function">(<span class="hljs-params">eventName, ...args</span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>&#125;);</code></pre></div><h3 id="socket-offAny-listener"><a href="#socket-offAny-listener" class="headerlink" title="socket.offAny([listener])"></a>socket.offAny([listener])<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#socketoffanylistener"></a></h3><p>åˆ é™¤æ‰€æœ‰catch-allä¾¦å¬å™¨æˆ–ç»™å®šçš„ä¾¦å¬å™¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">listener</span> = (<span class="hljs-params">eventName, ...args</span>) =&gt; &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(eventName, args);&#125;socket.<span class="hljs-title function_">onAny</span>(listener);<span class="hljs-comment">// and then later...</span>socket.<span class="hljs-title function_">offAny</span>(listener);<span class="hljs-comment">// or all listeners</span>socket.<span class="hljs-title function_">offAny</span>();</code></pre></div><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#validation"></a></h2><p>äº‹ä»¶å‚æ•°çš„éªŒè¯è¶…å‡ºäº† Socket.IO åº“çš„èŒƒå›´ã€‚</p><p>JS ç”Ÿæ€ç³»ç»Ÿä¸­æœ‰è®¸å¤šåŒ…æ¶µç›–äº†è¿™ä¸ªç”¨ä¾‹ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š</p><ul><li><a href="https://www.npmjs.com/package/joi">joi</a></li><li><a href="https://www.npmjs.com/package/ajv">ajv</a></li><li><a href="https://www.npmjs.com/package/validatorjs">validatorjs</a></li></ul><p>å¸¦æœ‰<a href="https://joi.dev/api/">joi</a>å’Œ<a href="https://socket.io/zh-CN/docs/v4/emitting-events/#acknowledgements">acknowledgements</a>çš„ç¤ºä¾‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Joi</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;joi&quot;</span>);<span class="hljs-keyword">const</span> userSchema = <span class="hljs-title class_">Joi</span>.<span class="hljs-title function_">object</span>(&#123;  <span class="hljs-attr">username</span>: <span class="hljs-title class_">Joi</span>.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">max</span>(<span class="hljs-number">30</span>).required(),  <span class="hljs-attr">email</span>: <span class="hljs-title class_">Joi</span>.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">email</span>().required()&#125;);io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;create user&quot;</span>, <span class="hljs-function">(<span class="hljs-params">payload, callback</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;      <span class="hljs-comment">// not an acknowledgement</span>      <span class="hljs-keyword">return</span> socket.<span class="hljs-title function_">disconnect</span>();    &#125;    <span class="hljs-keyword">const</span> &#123; error, value &#125; = userSchema.<span class="hljs-title function_">validate</span>(payload);    <span class="hljs-keyword">if</span> (error) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-title function_">callback</span>(&#123;        <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;KO&quot;</span>,        error      &#125;);    &#125;    <span class="hljs-comment">// do something with the value, and then</span>    <span class="hljs-title function_">callback</span>(&#123;      <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;OK&quot;</span>    &#125;);  &#125;);&#125;);</code></pre></div><h2 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†<a href="https://socket.io/zh-CN/docs/v4/listening-to-events/#error-handling"></a></h2><p>Socket.IO åº“ä¸­ç›®å‰æ²¡æœ‰å†…ç½®çš„é”™è¯¯å¤„ç†ï¼Œè¿™æ„å‘³ç€æ‚¨å¿…é¡»æ•è·ä»»ä½•å¯èƒ½åœ¨ä¾¦å¬å™¨ä¸­å¼•å‘çš„é”™è¯¯ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;list items&quot;</span>, <span class="hljs-keyword">async</span> (callback) =&gt; &#123;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-keyword">const</span> items = <span class="hljs-keyword">await</span> <span class="hljs-title function_">findItems</span>();      <span class="hljs-title function_">callback</span>(&#123;        <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;OK&quot;</span>,        items      &#125;);    &#125; <span class="hljs-keyword">catch</span> (e) &#123;      <span class="hljs-title function_">callback</span>(&#123;        <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;NOK&quot;</span>      &#125;);    &#125;  &#125;);&#125;);</code></pre></div><p>åœ¨æœåŠ¡å™¨ç«¯ï¼Œä½¿ç”¨<code>EventEmitter.captureRejections = true</code>ï¼ˆå®éªŒæ€§ï¼Œè¯·å‚è§<a href="https://nodejs.org/api/events.html#events_capture_rejections_of_promises">æ­¤å¤„</a>ï¼‰ä¹Ÿå¯èƒ½å¾ˆæœ‰è¶£ï¼Œå…·ä½“å–å†³äºæ‚¨çš„ç”¨ä¾‹ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;events&quot;</span>).<span class="hljs-property">captureRejections</span> = <span class="hljs-literal">true</span>;io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;list products&quot;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;    <span class="hljs-keyword">const</span> products = <span class="hljs-keyword">await</span> <span class="hljs-title function_">findProducts</span>();    socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;products&quot;</span>, products);  &#125;);  socket[<span class="hljs-title class_">Symbol</span>.<span class="hljs-title function_">for</span>(<span class="hljs-string">&#x27;nodejs.rejection&#x27;</span>)] = <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;error&quot;</span>, err);  &#125;;&#125;);</code></pre></div><h1 id="å¹¿æ’­äº‹ä»¶"><a href="#å¹¿æ’­äº‹ä»¶" class="headerlink" title="å¹¿æ’­äº‹ä»¶"></a>å¹¿æ’­äº‹ä»¶</h1><p>Socket.IO ä½¿å‘æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯å‘é€äº‹ä»¶å˜å¾—å®¹æ˜“ã€‚</p><h5 id="INFO"><a href="#INFO" class="headerlink" title="INFO"></a>INFO</h5><p>è¯·æ³¨æ„ï¼Œå¹¿æ’­æ˜¯<strong>ä»…æœåŠ¡å™¨</strong>åŠŸèƒ½ã€‚</p><h2 id="ç»™æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯"><a href="#ç»™æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯" class="headerlink" title="ç»™æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯"></a>ç»™æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯<a href="https://socket.io/zh-CN/docs/v4/broadcasting-events/#to-all-connected-clients"></a></h2><p><img src="https://socket.io/zh-CN/images/broadcasting.png" alt="Broadcasting to all connected clients"></p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);</code></pre></div><h5 id="CAUTION"><a href="#CAUTION" class="headerlink" title="CAUTION"></a>CAUTION</h5><p>å½“å‰æ–­å¼€è¿æ¥ï¼ˆæˆ–æ­£åœ¨é‡æ–°è¿æ¥ï¼‰çš„å®¢æˆ·ç«¯å°†ä¸ä¼šæ”¶åˆ°è¯¥äº‹ä»¶ã€‚å°†æ­¤äº‹ä»¶å­˜å‚¨åœ¨æŸå¤„ï¼ˆä¾‹å¦‚åœ¨æ•°æ®åº“ä¸­ï¼‰å–å†³äºæ‚¨çš„ç”¨ä¾‹ã€‚</p><h2 id="é™¤å‘é€è€…å¤–çš„æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯"><a href="#é™¤å‘é€è€…å¤–çš„æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯" class="headerlink" title="é™¤å‘é€è€…å¤–çš„æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯"></a>é™¤å‘é€è€…å¤–çš„æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯<a href="https://socket.io/zh-CN/docs/v4/broadcasting-events/#to-all-connected-clients-except-the-sender"></a></h2><p><img src="https://socket.io/zh-CN/images/broadcasting2.png" alt="Broadcasting to all connected clients excepting the sender"></p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-property">broadcast</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);&#125;);</code></pre></div><h5 id="NOTE"><a href="#NOTE" class="headerlink" title="NOTE"></a>NOTE</h5><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨<code>socket.emit(&quot;hello&quot;, &quot;world&quot;)</code>ï¼ˆä¸å¸¦<code>broadcast</code>æ ‡å¿—ï¼‰ä¼šå°†äº‹ä»¶å‘é€åˆ°â€œå®¢æˆ·ç«¯ Aâ€ã€‚æ‚¨å¯ä»¥åœ¨<a href="https://socket.io/zh-CN/docs/v4/emit-cheatsheet/">å¤‡å¿˜å•</a>ä¸­æ‰¾åˆ°å‘é€äº‹ä»¶çš„æ‰€æœ‰æ–¹å¼çš„åˆ—è¡¨ã€‚</p><h2 id="ä½¿ç”¨å¤šä¸ª-Socket-IO-æœåŠ¡å™¨"><a href="#ä½¿ç”¨å¤šä¸ª-Socket-IO-æœåŠ¡å™¨" class="headerlink" title="ä½¿ç”¨å¤šä¸ª Socket.IO æœåŠ¡å™¨"></a>ä½¿ç”¨å¤šä¸ª Socket.IO æœåŠ¡å™¨<a href="https://socket.io/zh-CN/docs/v4/broadcasting-events/#with-multiple-socketio-servers"></a></h2><p>å¹¿æ’­ä¹Ÿé€‚ç”¨äºå¤šä¸ª Socket.IO æœåŠ¡å™¨ã€‚</p><p>æ‚¨åªéœ€å°†é»˜è®¤é€‚é…å™¨æ›¿æ¢ä¸º<a href="https://socket.io/zh-CN/docs/v4/adapter/">Redis é€‚é…å™¨</a>æˆ–å…¶ä»–<a href="https://socket.io/zh-CN/docs/v4/redis-adapter/">å…¼å®¹çš„é€‚é…å™¨</a>ã€‚</p><p><img src="https://socket.io/zh-CN/images/broadcasting-redis.png" alt="Broadcasting with Redis"></p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½åªæƒ³å‘è¿æ¥åˆ°å½“å‰æœåŠ¡å™¨çš„å®¢æˆ·ç«¯å¹¿æ’­ã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code>local</code>æ ‡å¿—å®ç°æ­¤ç›®çš„ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-property">local</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);</code></pre></div><p>å¤åˆ¶</p><p><img src="https://socket.io/zh-CN/images/broadcasting-redis-local.png" alt="Broadcasting with Redis but local"></p><p>ä¸ºäº†åœ¨å¹¿æ’­æ—¶é’ˆå¯¹ç‰¹å®šå®¢æˆ·ï¼Œè¯·å‚é˜…æœ‰å…³<a href="https://socket.io/zh-CN/docs/v4/rooms/">Rooms</a>çš„æ–‡æ¡£ã€‚</p><h1 id="æˆ¿é—´"><a href="#æˆ¿é—´" class="headerlink" title="æˆ¿é—´"></a>æˆ¿é—´</h1><p>socketså¯ä»¥<code>join</code> å’Œ <code>leave</code><em>æˆ¿é—´</em>ã€‚å®ƒå¯ç”¨äºå‘ä¸€éƒ¨åˆ†å®¢æˆ·ç«¯å¹¿æ’­äº‹ä»¶ï¼š</p><p><img src="https://socket.io/zh-CN/images/rooms.png" alt="Broadcasting to all clients in a room"></p><h5 id="ä¿¡æ¯-1"><a href="#ä¿¡æ¯-1" class="headerlink" title="ä¿¡æ¯"></a>ä¿¡æ¯</h5><p>è¯·æ³¨æ„ï¼Œæˆ¿é—´æ˜¯ä¸€ä¸ª<strong>ä»…é™æœåŠ¡å™¨</strong>çš„æ¦‚å¿µï¼ˆå³å®¢æˆ·ç«¯æ— æƒè®¿é—®å®ƒå·²åŠ å…¥çš„æˆ¿é—´åˆ—è¡¨ï¼‰ã€‚</p><h2 id="åŠ å…¥å’Œç¦»å¼€"><a href="#åŠ å…¥å’Œç¦»å¼€" class="headerlink" title="åŠ å…¥å’Œç¦»å¼€"></a>åŠ å…¥å’Œç¦»å¼€<a href="https://socket.io/zh-CN/docs/v4/rooms/#joining-and-leaving"></a></h2><p>æ‚¨å¯ä»¥è°ƒç”¨<code>join</code>ä»¥å°†socketè®¢é˜…åˆ°ç»™å®šçš„é¢‘é“ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;some room&quot;</span>);&#125;);</code></pre></div><p>ç„¶ååœ¨å¹¿æ’­æˆ–å‘å°„æ—¶ç®€å•åœ°ä½¿ç”¨<code>to</code> æˆ– <code>in</code>ï¼ˆå®ƒä»¬æ˜¯ç›¸åŒçš„ï¼‰ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;some room&quot;</span>).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;some event&quot;</span>);</code></pre></div><p>æ‚¨å¯ä»¥åŒæ—¶å‘å°„åˆ°å¤šä¸ªæˆ¿é—´ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;room1&quot;</span>).<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;room2&quot;</span>).<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;room3&quot;</span>).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;some event&quot;</span>);</code></pre></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†æ‰§è¡Œ<a href="https://en.wikipedia.org/wiki/Union_(set_theory)">è”åˆ</a>ï¼šè‡³å°‘åœ¨å…¶ä¸­ä¸€ä¸ªæˆ¿é—´ä¸­çš„æ¯ä¸ªsocketéƒ½å°†è·å¾—<strong>ä¸€æ¬¡</strong>äº‹ä»¶ï¼ˆå³ä½¿socketåœ¨ä¸¤ä¸ªæˆ–æ›´å¤šæˆ¿é—´ä¸­ï¼‰ã€‚</p><p>æ‚¨è¿˜å¯ä»¥ä»ç»™å®šçš„socketå¹¿æ’­åˆ°æˆ¿é—´ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;some room&quot;</span>).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;some event&quot;</span>);&#125;);</code></pre></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ¿é—´ä¸­<strong>é™¤</strong>å‘é€è€…ä¹‹å¤–çš„æ¯ä¸ªsocketéƒ½ä¼šæ”¶åˆ°è¯¥äº‹ä»¶ã€‚</p><p><img src="https://socket.io/zh-CN/images/rooms2.png" alt="Broadcasting to all clients in a room excepting the sender"></p><p>è¦ç¦»å¼€é¢‘é“ï¼Œæ‚¨è°ƒç”¨<code>leave</code>çš„æ–¹å¼ä¸<code>join</code>ç›¸åŒã€‚</p><h2 id="é»˜è®¤æˆ¿é—´"><a href="#é»˜è®¤æˆ¿é—´" class="headerlink" title="é»˜è®¤æˆ¿é—´"></a>é»˜è®¤æˆ¿é—´<a href="https://socket.io/zh-CN/docs/v4/rooms/#default-room"></a></h2><p>Socket.IO ä¸­çš„æ¯ä¸€ä¸ª<code>socket</code>éƒ½ç”±ä¸€ä¸ªéšæœºçš„ã€ä¸å¯çŒœæµ‹çš„ã€å”¯ä¸€çš„æ ‡è¯†ç¬¦<a href="https://socket.io/zh-CN/docs/v4/server-socket-instance/#socketid">Socket#id</a>ã€‚ä¸ºäº†æ‚¨çš„æ–¹ä¾¿ï¼Œæ¯ä¸ªsocketéƒ½ä¼šè‡ªåŠ¨åŠ å…¥ä¸€ä¸ªç”±å…¶è‡ªå·±çš„ id æ ‡è¯†çš„æˆ¿é—´ã€‚</p><p>è¿™ä½¿å¾—å®ç°ç§äººæ¶ˆæ¯å˜å¾—å®¹æ˜“ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;private message&quot;</span>, <span class="hljs-function">(<span class="hljs-params">anotherSocketId, msg</span>) =&gt;</span> &#123;    socket.<span class="hljs-title function_">to</span>(anotherSocketId).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;private message&quot;</span>, socket.<span class="hljs-property">id</span>, msg);  &#125;);&#125;);</code></pre></div><h2 id="ç¤ºä¾‹ç”¨ä¾‹"><a href="#ç¤ºä¾‹ç”¨ä¾‹" class="headerlink" title="ç¤ºä¾‹ç”¨ä¾‹"></a>ç¤ºä¾‹ç”¨ä¾‹<a href="https://socket.io/zh-CN/docs/v4/rooms/#sample-use-cases"></a></h2><ul><li>å‘ç»™å®šç”¨æˆ·çš„æ¯ä¸ªè®¾å¤‡/é€‰é¡¹å¡å¹¿æ’­æ•°æ®</li></ul><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-keyword">async</span> (socket) =&gt; &#123;  <span class="hljs-keyword">const</span> userId = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUserId</span>(socket);  socket.<span class="hljs-title function_">join</span>(userId);  <span class="hljs-comment">// and then later</span>  io.<span class="hljs-title function_">to</span>(userId).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;hi&quot;</span>);&#125;);</code></pre></div><p>å¤åˆ¶</p><ul><li>å‘é€æœ‰å…³ç»™å®šå®ä½“çš„é€šçŸ¥</li></ul><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-keyword">async</span> (socket) =&gt; &#123;  <span class="hljs-keyword">const</span> projects = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchProjects</span>(socket);  projects.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">project</span> =&gt;</span> socket.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;project:&quot;</span> + project.<span class="hljs-property">id</span>));  <span class="hljs-comment">// and then later</span>  io.<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;project:4321&quot;</span>).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;project updated&quot;</span>);&#125;);</code></pre></div><h2 id="æ–­å¼€"><a href="#æ–­å¼€" class="headerlink" title="æ–­å¼€"></a>æ–­å¼€<a href="https://socket.io/zh-CN/docs/v4/rooms/#disconnection"></a></h2><p>æ–­å¼€è¿æ¥åï¼Œ<code>leave</code>ä¼šè‡ªåŠ¨å°†å®ƒä»¬æ‰€å±çš„æ‰€æœ‰é€šé“è¿æ¥èµ·æ¥ï¼Œæ‚¨ä¸éœ€è¦è¿›è¡Œç‰¹æ®Šçš„æ‹†å¸ã€‚</p><p>æ‚¨å¯ä»¥é€šè¿‡ç›‘å¬<code>disconnecting</code>äº‹ä»¶æ¥è·å– Socket æ‰€åœ¨çš„æˆ¿é—´ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;connection&quot;</span>, <span class="hljs-function"><span class="hljs-params">socket</span> =&gt;</span> &#123;  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnecting&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(socket.<span class="hljs-property">rooms</span>); <span class="hljs-comment">// the Set contains at least the socket ID</span>  &#125;);  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;disconnect&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// socket.rooms.size === 0</span>  &#125;);&#125;);</code></pre></div><h2 id="ä½¿ç”¨å¤šä¸ª-Socket-IO-æœåŠ¡å™¨-1"><a href="#ä½¿ç”¨å¤šä¸ª-Socket-IO-æœåŠ¡å™¨-1" class="headerlink" title="ä½¿ç”¨å¤šä¸ª Socket.IO æœåŠ¡å™¨"></a>ä½¿ç”¨å¤šä¸ª Socket.IO æœåŠ¡å™¨<a href="https://socket.io/zh-CN/docs/v4/rooms/#with-multiple-socketio-servers"></a></h2><p>ä¸<a href="https://socket.io/zh-CN/docs/v4/broadcasting-events/#with-multiple-socketio-servers">å…¨å±€å¹¿æ’­</a>ä¸€æ ·ï¼Œå‘æˆ¿é—´å¹¿æ’­ä¹Ÿé€‚ç”¨äºå¤šä¸ª Socket.IO æœåŠ¡å™¨ã€‚</p><p>æ‚¨åªéœ€è¦å°†é»˜è®¤çš„<a href="https://socket.io/zh-CN/docs/v4/glossary/#adapter">Adapter</a>æ›¿æ¢ä¸º Redis Adapterã€‚æ›´å¤šå…³äºå®ƒçš„ä¿¡æ¯åœ¨<a href="https://socket.io/zh-CN/docs/v4/redis-adapter/">è¿™é‡Œ</a>ã€‚</p><p><img src="https://socket.io/zh-CN/images/rooms-redis.png" alt="Broadcasting to all clients in a room with Redis"></p><h2 id="å®æ–½ç»†èŠ‚"><a href="#å®æ–½ç»†èŠ‚" class="headerlink" title="å®æ–½ç»†èŠ‚"></a>å®æ–½ç»†èŠ‚<a href="https://socket.io/zh-CN/docs/v4/rooms/#implementation-details"></a></h2><p>â€œæˆ¿é—´â€åŠŸèƒ½ç”±æˆ‘ä»¬ç§°ä¸ºé€‚é…å™¨çš„ä¸œè¥¿å®ç°ã€‚è¯¥é€‚é…å™¨æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ç«¯ç»„ä»¶ï¼Œè´Ÿè´£ï¼š</p><ul><li>å­˜å‚¨ Socket å®ä¾‹å’Œæˆ¿é—´ä¹‹é—´çš„å…³ç³»</li><li>å‘æ‰€æœ‰ï¼ˆæˆ–éƒ¨åˆ†ï¼‰å®¢æˆ·ç«¯å¹¿æ’­äº‹ä»¶</li></ul><p>æ‚¨å¯ä»¥åœ¨<a href="https://github.com/socketio/socket.io-adapter">æ­¤å¤„</a>æ‰¾åˆ°é»˜è®¤å†…å­˜é€‚é…å™¨çš„ä»£ç ã€‚</p><p>åŸºæœ¬ä¸Šï¼Œå®ƒåŒ…å«ä¸¤ä¸ª<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">ES6 Maps</a>:</p><ul><li><code>sids</code>: <code>Map&lt;SocketId, Set&lt;Room&gt;&gt;</code></li><li><code>rooms</code>: <code>Map&lt;Room, Set&lt;SocketId&gt;&gt;</code></li></ul><p>è°ƒç”¨<code>socket.join(&quot;the-room&quot;)</code>å°†å¯¼è‡´ï¼š</p><ul><li>åœ¨<code>sids</code> Mapä¸­ï¼Œå°†â€œthe-roomâ€æ·»åŠ åˆ°ç”±Socket ID æ ‡è¯†çš„ Set</li><li>åœ¨<code>rooms</code> Map ä¸­ï¼Œå°†Socket ID æ·»åŠ åˆ°ç”±å­—ç¬¦ä¸²â€œthe-roomâ€æ ‡è¯†çš„ Set ä¸­</li></ul><p>ç„¶ååœ¨å¹¿æ’­æ—¶ä½¿ç”¨è¿™ä¸¤ä¸ªåœ°å›¾ï¼š</p><ul><li>å¯¹æ‰€æœ‰å¥—æ¥å­—çš„å¹¿æ’­ï¼ˆ<code>io.emit()</code>ï¼‰å¾ªç¯é€šè¿‡<code>sids</code>Mapï¼Œå¹¶å°†æ•°æ®åŒ…å‘é€åˆ°æ‰€æœ‰sockets</li><li>å¯¹ç»™å®šæˆ¿é—´çš„å¹¿æ’­ ( <code>io.to(&quot;room21&quot;).emit()</code>ï¼‰å¾ªç¯é€šè¿‡<code>rooms</code>Map ä¸­çš„ Setï¼Œå¹¶å°†æ•°æ®åŒ…å‘é€åˆ°æ‰€æœ‰åŒ¹é…çš„sockets</li></ul><p>æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®è¿™äº›å¯¹è±¡ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// main namespace</span><span class="hljs-keyword">const</span> rooms = io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/&quot;</span>).<span class="hljs-property">adapter</span>.<span class="hljs-property">rooms</span>;<span class="hljs-keyword">const</span> sids = io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/&quot;</span>).<span class="hljs-property">adapter</span>.<span class="hljs-property">sids</span>;<span class="hljs-comment">// custom namespace</span><span class="hljs-keyword">const</span> rooms = io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/my-namespace&quot;</span>).<span class="hljs-property">adapter</span>.<span class="hljs-property">rooms</span>;<span class="hljs-keyword">const</span> sids = io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/my-namespace&quot;</span>).<span class="hljs-property">adapter</span>.<span class="hljs-property">sids</span>;</code></pre></div><p>ç¬”è®°ï¼š</p><ul><li>è¿™äº›å¯¹è±¡å¹¶ä¸æ„å‘³ç€ç›´æ¥ä¿®æ”¹ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆä½¿ç”¨<a href="https://socket.io/zh-CN/docs/v4/server-api/#socketjoinroom"><code>socket.join(...)</code></a> å’Œ <a href="https://socket.io/zh-CN/docs/v4/server-api/#socketleaveroom"><code>socket.leave(...)</code></a>æ¥ä»£æ›¿ã€‚</li><li>åœ¨<a href="https://socket.io/zh-CN/docs/v4/using-multiple-nodes/">å¤šæœåŠ¡å™¨</a>è®¾ç½®ä¸­ï¼Œ<code>rooms</code> å’Œ <code>sids</code>å¯¹è±¡ä¸ä¼šåœ¨ Socket.IO æœåŠ¡å™¨ä¹‹é—´å…±äº«ï¼ˆæˆ¿é—´å¯èƒ½åªâ€œå­˜åœ¨â€åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šè€Œä¸æ˜¯å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼‰ã€‚</li></ul><h2 id="æˆ¿é—´äº‹ä»¶"><a href="#æˆ¿é—´äº‹ä»¶" class="headerlink" title="æˆ¿é—´äº‹ä»¶"></a>æˆ¿é—´äº‹ä»¶<a href="https://socket.io/zh-CN/docs/v4/rooms/#room-events"></a></h2><p>ä»<code>socket.io@3.1.0</code>å¼€å§‹ï¼Œåº•å±‚é€‚é…å™¨å°†å‘å‡ºä»¥ä¸‹äº‹ä»¶ï¼š</p><ul><li><code>create-room</code> (argument: room)</li><li><code>delete-room</code> (argument: room)</li><li><code>join-room</code> (argument: room, id)</li><li><code>leave-room</code> (argument: room, id)</li></ul><p>ä¾‹å­ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/&quot;</span>).<span class="hljs-property">adapter</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;create-room&quot;</span>, <span class="hljs-function">(<span class="hljs-params">room</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`room <span class="hljs-subst">$&#123;room&#125;</span> was created`</span>);&#125;);io.<span class="hljs-title function_">of</span>(<span class="hljs-string">&quot;/&quot;</span>).<span class="hljs-property">adapter</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;join-room&quot;</span>, <span class="hljs-function">(<span class="hljs-params">room, id</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`socket <span class="hljs-subst">$&#123;id&#125;</span> has joined room <span class="hljs-subst">$&#123;room&#125;</span>`</span>);&#125;);</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>socket.io</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»€ä¹ˆæ˜¯websocket</title>
    <link href="/2022/09/24/%E4%BB%80%E4%B9%88%E6%98%AFwebsocket/"/>
    <url>/2022/09/24/%E4%BB%80%E4%B9%88%E6%98%AFwebsocket/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>webSocketæ˜¯ä¸€ç§ç½‘ç»œä¼ è¾“åè®®ï¼Œå¯ä»¥åœ¨å•ä¸ªTCPè¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šä¿¡ï¼Œä½äºOSIæ¨¡å‹çš„åº”ç”¨å±‚ï¼ŒwebSocketåè®®åœ¨2011å¹´ç”±IETFæ ‡å‡†åŒ–ä¸ºRFC6455,ç”±RFC7936è¡¥å……è§„èŒƒï¼ŒWEB IDLä¸­çš„webSocket apiç”±W3Cæ ‡å‡†åŒ–ï¼Œwebsocketæ˜¯ä¸€ç§å’Œhttpä¸åŒçš„åè®®ï¼Œä½†æ˜¯éƒ½æ˜¯å±äºOSIæ¨¡å‹çš„åº”ç”¨å±‚ï¼Œå¯ä»¥é€šè¿‡HTTPçš„80ç«¯å£å’Œ443ç«¯å£è¿›è¡Œé€šä¿¡ï¼Œæ”¯æŒHTTPä»£ç†å’Œä¸­ä»‹ï¼Œå’Œhttpåè®®å…¼å®¹ï¼Œä¸ºäº†å®ç°å…¼å®¹æ€§ï¼ŒwebSocketè¿›è¡Œæ¡æ‰‹ä½¿ç”¨HTTP Upgradeå¤´ä»httpåè®®æ”¹æˆwebSocketåè®®ï¼Œwebsocketæ”¯æŒæµè§ˆå™¨å’ŒæœåŠ¡å™¨è¿›è¡ŒåŒå‘é€šä¿¡ï¼Œå¯ä»¥è¿›è¡Œå®æ—¶é€šä¿¡ï¼Œä¸éœ€è¦å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨éƒ½æ”¯æŒwebsocket,å’ŒHTTPä¸åŒï¼Œwebsocketæ”¯æŒå…¨åŒå·¥é€šä¿¡ï¼Œwebsocketè¿˜å¯ä»¥TCPä¹‹ä¸Šå®ç°æ¶ˆæ¯æµ</p><p>websocketåè®®æœ‰ä¸¤ç§æ ‡è¯†ç¬¦åˆ†åˆ«æ˜¯wså’Œwssï¼Œåˆ†åˆ«æ˜¯æ˜æ–‡ä¼ è¾“å’ŒåŠ å¯†ä¼ è¾“ã€‚websocketä¸æ”¯æŒ#ï¼Œé™¤äº†è¿™äº›ï¼Œå…¶ä»–éƒ½å’Œhttpç›¸åŒ</p><div class="code-wrapper"><pre><code class="hljs awk">ws:<span class="hljs-regexp">//</span>example.com/wsapiwss:<span class="hljs-regexp">//</span>secure.example.com/wsapi</code></pre></div><h4 id="websocketçš„ä¼˜ç‚¹"><a href="#websocketçš„ä¼˜ç‚¹" class="headerlink" title="websocketçš„ä¼˜ç‚¹"></a>websocketçš„ä¼˜ç‚¹</h4><ul><li><p>æ¯”è¾ƒå°‘çš„æ§åˆ¶å¼€é”€ï¼Œåœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é€šä¿¡çš„æ—¶å€™ï¼Œç”¨äºåè®®æ§åˆ¶çš„æ•°æ®åŒ…å¤´éƒ¨ç›¸å¯¹è¾ƒå°ï¼Œåœ¨ä¸åŒ…å«æ‰©å±•çš„æƒ…å†µä¸‹ï¼Œå¯¹äºæœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯çš„å†…å®¹ï¼Œæ­¤å¤´éƒ¨å¤§å°åªæœ‰2åˆ°10å­—èŠ‚ï¼Œå¯¹äºå®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„å†…å®¹ï¼Œæ­¤å¤´éƒ¨è¿˜éœ€è¦åŠ é¢å¤–çš„4å­—èŠ‚çš„æ©ç ï¼Œç›¸å¯¹äºhttpæ¯æ¬¡éƒ½è¦æºå¸¦å®Œæ•´çš„å¤´éƒ¨ï¼Œæ˜æ˜¾å‡å°‘äº†å¼€é”€</p></li><li><p>æ›´å¼ºçš„å®æ—¶æ€§ï¼Œç”±äºåè®®æ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥æœåŠ¡å™¨å¯ä»¥éšæ—¶ä¸»åŠ¨çš„ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œç›¸å¯¹äºHTTPè¯·æ±‚éœ€è¦å®¢æˆ·ç«¯å‘é€è¯·æ±‚å¹¶ä¸”ç­‰å¾…æœåŠ¡å™¨å“åº”ï¼Œå‡å°‘äº†ç­‰å¾…æ—¶é—´ï¼Œå³ä½¿å’ŒCometç­‰ç±»ä¼¼çš„é•¿è½®è¯¢æ¯”è¾ƒï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨çŸ­æ—¶é—´ä¼ é€’æ›´å¤šçš„æ•°æ®</p></li><li><p>ä¿æŒè¿æ¥çŠ¶æ€ï¼Œä¸HTTPä¸åŒçš„æ˜¯ï¼ŒwebSocketéœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼Œè¿™å°±ä½¿å¾—å…¶æˆä¸ºä¸€ç§æœ‰çŠ¶æ€çš„åè®®ï¼Œä¹‹åé€šä¿¡æ—¶å¯ä»¥çœç•¥éƒ¨åˆ†çŠ¶æ€ä¿¡æ¯ï¼Œè€Œhttpæ¯æ¬¡è¯·æ±‚å¯èƒ½éœ€è¦æºå¸¦éªŒè¯ä¿¡æ¯</p></li><li><p>æ›´å¥½çš„äºŒè¿›åˆ¶æ”¯æŒï¼ŒwebSocketå®šä¹‰äº†äºŒè¿›åˆ¶å¸§ï¼Œä»–ä¼šæ¯”HTTPæ›´iè½»æ¾çš„å¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶</p></li><li><p>æ›´å¥½çš„å‹ç¼©æ•ˆæœï¼Œç›¸å¯¹äºHTTPå‹ç¼©ï¼Œwebsocketåœ¨é€‚å½“çš„æ‰©å±•çš„æ”¯æŒä¸‹ï¼Œå¯ä»¥æ²¿ç”¨ä¹‹å‰çš„å†…å®¹çš„ä¸Šä¸‹æ–‡ï¼Œåœ¨ä¼ é€’ç±»ä¼¼çš„æ•°æ®çš„æ—¶å€™å¯ä»¥æ˜¾è‘—çš„æé«˜å‹ç¼©ç‡</p></li></ul><p>webSocketæ˜¯ç‹¬ç«‹çš„ï¼Œå»ºç«‹åœ¨TCPä¸Šçš„åè®®ï¼Œwebsocketé€šè¿‡HTTP/1.1çš„101çŠ¶æ€å—ç»§ç»­æ¡æ‰‹ï¼Œä¸ºäº†å»ºç«‹Websocketè¿æ¥ï¼Œéœ€è¦é€šè¿‡æµè§ˆå™¨å‘å‡ºè¯·æ±‚ï¼Œä¹‹åæœåŠ¡å™¨è¿›è¡Œå›åº”ï¼Œè¿™ä¸ªè¿‡ç¨‹é€šå¸¸ç§°ä¸ºâ€œ<a href="https://zh.m.wikipedia.org/wiki/%E6%8F%A1%E6%89%8B_(%E6%8A%80%E6%9C%AF)">æ¡æ‰‹</a>â€ï¼ˆHandshakingï¼‰</p><h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><p>å®¢æˆ·ç«¯è¯·æ±‚ï¼š</p><div class="code-wrapper"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/chat</span> <span class="hljs-meta">HTTP/1.1</span><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>server.example.com<span class="hljs-attribute">Upgrade</span><span class="hljs-punctuation">: </span>websocket<span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>Upgrade<span class="hljs-attribute">Sec-WebSocket-Key</span><span class="hljs-punctuation">: </span>dGhlIHNhbXBsZSBub25jZQ==<span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://example.com<span class="hljs-attribute">Sec-WebSocket-Protocol</span><span class="hljs-punctuation">: </span>chat, superchat<span class="hljs-attribute">Sec-WebSocket-Version</span><span class="hljs-punctuation">: </span>13</code></pre></div><p>æœåŠ¡å™¨çš„å›åº”</p><div class="code-wrapper"><pre><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">101</span> Switching Protocols<span class="hljs-attribute">Upgrade</span><span class="hljs-punctuation">: </span>websocket<span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>Upgrade<span class="hljs-attribute">Sec-WebSocket-Accept</span><span class="hljs-punctuation">: </span>s3pPLMBiTxaQ9kYGzzhZRbK+xOo=<span class="hljs-attribute">Sec-WebSocket-Protocol</span><span class="hljs-punctuation">: </span>chat</code></pre></div><ul><li>Connectionå¿…é¡»è®¾ç½®Upgradeï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯å¸Œæœ›è¿æ¥å‡çº§ã€‚</li><li>Upgradeå­—æ®µå¿…é¡»è®¾ç½®Websocketï¼Œè¡¨ç¤ºå¸Œæœ›å‡çº§åˆ°Websocketåè®®ã€‚</li><li>Sec-WebSocket-Keyæ˜¯éšæœºçš„å­—ç¬¦ä¸²ï¼ŒæœåŠ¡å™¨ç«¯ä¼šç”¨è¿™äº›æ•°æ®æ¥æ„é€ å‡ºä¸€ä¸ªSHA-1çš„ä¿¡æ¯æ‘˜è¦ã€‚æŠŠâ€œSec-WebSocket-Keyâ€åŠ ä¸Šä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ä¸²â€œ258EAFA5-E914-47DA-95CA-C5AB0DC85B11â€ï¼Œç„¶åè®¡ç®—<a href="https://zh.m.wikipedia.org/wiki/SHA-1">SHA-1</a>æ‘˜è¦ï¼Œä¹‹åè¿›è¡Œ<a href="https://zh.m.wikipedia.org/wiki/Base64">Base64</a>ç¼–ç ï¼Œå°†ç»“æœåšä¸ºâ€œSec-WebSocket-Acceptâ€å¤´çš„å€¼ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¦‚æ­¤æ“ä½œï¼Œå¯ä»¥å°½é‡é¿å…æ™®é€šHTTPè¯·æ±‚è¢«è¯¯è®¤ä¸ºWebsocketåè®®ã€‚</li><li>Sec-WebSocket-Version è¡¨ç¤ºæ”¯æŒçš„Websocketç‰ˆæœ¬ã€‚RFC6455è¦æ±‚ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯13ï¼Œä¹‹å‰è‰æ¡ˆçš„ç‰ˆæœ¬å‡åº”å½“å¼ƒç”¨ã€‚</li><li>Originå­—æ®µæ˜¯å¿…é¡»çš„ã€‚å¦‚æœç¼ºå°‘originå­—æ®µï¼ŒWebSocketæœåŠ¡å™¨éœ€è¦å›å¤HTTP 403 çŠ¶æ€ç ï¼ˆç¦æ­¢è®¿é—®ï¼‰ã€‚[<a href="https://zh.m.wikipedia.org/zh-hans/WebSocket#cite_note-16">16]</a></li><li>å…¶ä»–ä¸€äº›å®šä¹‰åœ¨HTTPåè®®ä¸­çš„å­—æ®µï¼Œå¦‚<a href="https://zh.m.wikipedia.org/wiki/Cookie">Cookie</a>ç­‰ï¼Œä¹Ÿå¯ä»¥åœ¨Websocketä¸­ä½¿ç”¨ã€‚</li></ul><h4 id="websocketçš„åŸºæœ¬ä½¿ç”¨"><a href="#websocketçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="websocketçš„åŸºæœ¬ä½¿ç”¨"></a>websocketçš„åŸºæœ¬ä½¿ç”¨</h4><h5 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h5><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&quot;wss://echo.websocket.org&quot;</span>);ws.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) &#123;   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Connection open ...&quot;</span>);   ws.<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;Hello WebSockets!&quot;</span>);&#125;;ws.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&quot;Received Message: &quot;</span> + evt.<span class="hljs-property">data</span>);  ws.<span class="hljs-title function_">close</span>();&#125;;ws.<span class="hljs-property">onclose</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Connection closed.&quot;</span>);&#125;;</code></pre></div><blockquote><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&#x27;ws://localhost:8080&#x27;</span>);</code></pre></div></blockquote><p>wenSocketä½œä¸ºæ„é€ å‡½æ•°ï¼Œç”¨äºæ–°å»ºWebSocketå®ä¾‹ï¼Œæ‰§è¡Œå®Œä¸Šé¢çš„ä¾‹å­ä¹‹åï¼Œå®¢æˆ·ç«¯å°±ä¼šå’ŒæœåŠ¡å™¨è¿›è¡Œè¿æ¥</p><h5 id="webSocket-readyState"><a href="#webSocket-readyState" class="headerlink" title="webSocket.readyState"></a>webSocket.readyState</h5><p>readyStateå±æ€§æ˜¯è¿”å›å½“å‰çŠ¶æ€ï¼Œå…±æœ‰å››ç§çŠ¶æ€</p><ul><li>CONNECTINGï¼šå€¼ä¸º0ï¼Œè¡¨ç¤ºæ­£åœ¨è¿æ¥ã€‚</li><li>OPENï¼šå€¼ä¸º1ï¼Œè¡¨ç¤ºè¿æ¥æˆåŠŸï¼Œå¯ä»¥é€šä¿¡äº†ã€‚</li><li>CLOSINGï¼šå€¼ä¸º2ï¼Œè¡¨ç¤ºè¿æ¥æ­£åœ¨å…³é—­ã€‚</li><li>CLOSEDï¼šå€¼ä¸º3ï¼Œè¡¨ç¤ºè¿æ¥å·²ç»å…³é—­ï¼Œæˆ–è€…æ‰“å¼€è¿æ¥å¤±è´¥ã€‚</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">switch</span> (ws.<span class="hljs-property">readyState</span>) &#123;  <span class="hljs-keyword">case</span> <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">CONNECTING</span>:    <span class="hljs-comment">// do something</span>    <span class="hljs-keyword">break</span>;  <span class="hljs-keyword">case</span> <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>:    <span class="hljs-comment">// do something</span>    <span class="hljs-keyword">break</span>;  <span class="hljs-keyword">case</span> <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">CLOSING</span>:    <span class="hljs-comment">// do something</span>    <span class="hljs-keyword">break</span>;  <span class="hljs-keyword">case</span> <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">CLOSED</span>:    <span class="hljs-comment">// do something</span>    <span class="hljs-keyword">break</span>;  <span class="hljs-attr">default</span>:    <span class="hljs-comment">// this never happens</span>    <span class="hljs-keyword">break</span>;&#125;</code></pre></div><h5 id="openå±æ€§ç›‘å¬è¿æ¥ä¹‹åçš„å›è°ƒå‡½æ•°"><a href="#openå±æ€§ç›‘å¬è¿æ¥ä¹‹åçš„å›è°ƒå‡½æ•°" class="headerlink" title="openå±æ€§ç›‘å¬è¿æ¥ä¹‹åçš„å›è°ƒå‡½æ•°"></a>openå±æ€§ç›‘å¬è¿æ¥ä¹‹åçš„å›è°ƒå‡½æ•°</h5><div class="code-wrapper"><pre><code class="hljs javascript">ws.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  ws.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Hello Server!&#x27;</span>);&#125;<span class="hljs-comment">//æ‰§è¡Œå¤šä¸ªå›è°ƒå‡½æ•°å¯ä»¥ä½¿ç”¨addEventListener</span>ws.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123;  ws.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Hello Server!&#x27;</span>);&#125;);</code></pre></div><h5 id="å®ä¾‹å¯¹è±¡çš„oncloseå±æ€§ï¼Œç”¨äºæŒ‡å®šè¿æ¥å…³é—­åçš„å›è°ƒå‡½æ•°"><a href="#å®ä¾‹å¯¹è±¡çš„oncloseå±æ€§ï¼Œç”¨äºæŒ‡å®šè¿æ¥å…³é—­åçš„å›è°ƒå‡½æ•°" class="headerlink" title="å®ä¾‹å¯¹è±¡çš„oncloseå±æ€§ï¼Œç”¨äºæŒ‡å®šè¿æ¥å…³é—­åçš„å›è°ƒå‡½æ•°"></a>å®ä¾‹å¯¹è±¡çš„<code>onclose</code>å±æ€§ï¼Œç”¨äºæŒ‡å®šè¿æ¥å…³é—­åçš„å›è°ƒå‡½æ•°</h5><div class="code-wrapper"><pre><code class="hljs js">ws.<span class="hljs-property">onclose</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;  <span class="hljs-keyword">var</span> code = event.<span class="hljs-property">code</span>;  <span class="hljs-keyword">var</span> reason = event.<span class="hljs-property">reason</span>;  <span class="hljs-keyword">var</span> wasClean = event.<span class="hljs-property">wasClean</span>;  <span class="hljs-comment">// handle close event</span>&#125;;ws.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;close&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;  <span class="hljs-keyword">var</span> code = event.<span class="hljs-property">code</span>;  <span class="hljs-keyword">var</span> reason = event.<span class="hljs-property">reason</span>;  <span class="hljs-keyword">var</span> wasClean = event.<span class="hljs-property">wasClean</span>;  <span class="hljs-comment">// handle close event</span>&#125;);</code></pre></div><p>å®ä¾‹å¯¹è±¡çš„<code>onmessage</code>å±æ€§ï¼Œç”¨äºæŒ‡å®šæ”¶åˆ°æœåŠ¡å™¨æ•°æ®åçš„å›è°ƒå‡½æ•°</p><div class="code-wrapper"><pre><code class="hljs javascript">ws.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;  <span class="hljs-keyword">var</span> data = event.<span class="hljs-property">data</span>;  <span class="hljs-comment">// å¤„ç†æ•°æ®</span>&#125;;ws.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;  <span class="hljs-keyword">var</span> data = event.<span class="hljs-property">data</span>;  <span class="hljs-comment">// å¤„ç†æ•°æ®</span>&#125;);</code></pre></div><p>æ³¨æ„ï¼ŒæœåŠ¡å™¨æ•°æ®å¯èƒ½æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯èƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼ˆ<code>blob</code>å¯¹è±¡æˆ–<code>Arraybuffer</code>å¯¹è±¡</p><div class="code-wrapper"><pre><code class="hljs javascript">ws.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)&#123;  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> event.<span class="hljs-property">data</span> === <span class="hljs-title class_">String</span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Received data string&quot;</span>);  &#125;  <span class="hljs-keyword">if</span>(event.<span class="hljs-property">data</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">ArrayBuffer</span>)&#123;    <span class="hljs-keyword">var</span> buffer = event.<span class="hljs-property">data</span>;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Received arraybuffer&quot;</span>);  &#125;&#125;</code></pre></div><p>é™¤äº†åŠ¨æ€åˆ¤æ–­æ”¶åˆ°çš„æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>binaryType</code>å±æ€§ï¼Œæ˜¾å¼æŒ‡å®šæ”¶åˆ°çš„äºŒè¿›åˆ¶æ•°æ®ç±»å‹ã€‚</p><blockquote><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// æ”¶åˆ°çš„æ˜¯ blob æ•°æ®</span>ws.<span class="hljs-property">binaryType</span> = <span class="hljs-string">&quot;blob&quot;</span>;ws.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">data</span>.<span class="hljs-property">size</span>);&#125;;<span class="hljs-comment">// æ”¶åˆ°çš„æ˜¯ ArrayBuffer æ•°æ®</span>ws.<span class="hljs-property">binaryType</span> = <span class="hljs-string">&quot;arraybuffer&quot;</span>;ws.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">data</span>.<span class="hljs-property">byteLength</span>);&#125;;</code></pre></div></blockquote><p>å®ä¾‹å¯¹è±¡çš„<code>send()</code>æ–¹æ³•ç”¨äºå‘æœåŠ¡å™¨å‘é€æ•°æ®ã€‚</p><blockquote><div class="code-wrapper"><pre><code class="hljs javascript">ws.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;your message&#x27;</span>);</code></pre></div></blockquote><p>å‘é€blobå¯¹è±¡çš„ä¾‹å­</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> file = <span class="hljs-variable language_">document</span>  .<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;input[type=&quot;file&quot;]&#x27;</span>)  .<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];ws.<span class="hljs-title function_">send</span>(file);</code></pre></div><p>å‘é€ArrayBufferå¯¹è±¡çš„ä¾‹å­</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Sending canvas ImageData as ArrayBuffer</span><span class="hljs-keyword">var</span> img = canvas_context.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">400</span>, <span class="hljs-number">320</span>);<span class="hljs-keyword">var</span> binary = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(img.<span class="hljs-property">data</span>.<span class="hljs-property">length</span>);<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; img.<span class="hljs-property">data</span>.<span class="hljs-property">length</span>; i++) &#123;  binary[i] = img.<span class="hljs-property">data</span>[i];&#125;ws.<span class="hljs-title function_">send</span>(binary.<span class="hljs-property">buffer</span>);</code></pre></div><p>å®ä¾‹å¯¹è±¡çš„<code>bufferedAmount</code>å±æ€§ï¼Œè¡¨ç¤ºè¿˜æœ‰å¤šå°‘å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®æ²¡æœ‰å‘é€å‡ºå»ã€‚å®ƒå¯ä»¥ç”¨æ¥åˆ¤æ–­å‘é€æ˜¯å¦ç»“æŸ</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> data = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">10000000</span>);socket.<span class="hljs-title function_">send</span>(data);<span class="hljs-keyword">if</span> (socket.<span class="hljs-property">bufferedAmount</span> === <span class="hljs-number">0</span>) &#123;  <span class="hljs-comment">// å‘é€å®Œæ¯•</span>&#125; <span class="hljs-keyword">else</span> &#123;  <span class="hljs-comment">// å‘é€è¿˜æ²¡ç»“æŸ</span>&#125;</code></pre></div><p>å®ä¾‹å¯¹è±¡çš„<code>onerror</code>å±æ€§ï¼Œç”¨äºæŒ‡å®šæŠ¥é”™æ—¶çš„å›è°ƒå‡½æ•°ã€‚</p><blockquote><div class="code-wrapper"><pre><code class="hljs javascript">socket.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;  <span class="hljs-comment">// handle error event</span>&#125;;socket.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;error&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;  <span class="hljs-comment">// handle error event</span>&#125;)</code></pre></div></blockquote><h4 id="æœåŠ¡ç«¯çš„å®ç°"><a href="#æœåŠ¡ç«¯çš„å®ç°" class="headerlink" title="æœåŠ¡ç«¯çš„å®ç°"></a>æœåŠ¡ç«¯çš„å®ç°</h4><p>å¦‚æœç”¨nodeå®ç°websocket</p><ul><li><a href="https://github.com/uWebSockets/uWebSockets">ÂµWebSockets</a></li><li><a href="http://socket.io/">Socket.IO</a></li><li><a href="https://github.com/theturtle32/WebSocket-Node">WebSocket-Node</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
      <category>websocket</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>mobxçš„ä½¿ç”¨</title>
    <link href="/2022/09/20/mobx%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/09/20/mobx%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="å…¥é—¨"><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h2><p><em>ä»»ä½•å¯ä»¥ä»åº”ç”¨çŠ¶æ€ä¸­æ´¾ç”Ÿå‡ºæ¥çš„å€¼éƒ½åº”è¯¥è¢«è‡ªåŠ¨æ´¾ç”Ÿå‡ºæ¥ã€‚</em></p><p>MobX æ˜¯ä¸€ä¸ªèº«ç»ç™¾æˆ˜çš„åº“ï¼Œå®ƒé€šè¿‡è¿ç”¨é€æ˜çš„å‡½æ•°å¼å“åº”ç¼–ç¨‹ï¼ˆTransparent Functional Reactive Programmingï¼ŒTFRPï¼‰ä½¿çŠ¶æ€ç®¡ç†å˜å¾—ç®€å•å’Œå¯æ‰©å±•ã€‚</p><p>ğŸ˜™</p><h5 id="ç®€å•ç›´æ¥"><a href="#ç®€å•ç›´æ¥" class="headerlink" title="ç®€å•ç›´æ¥"></a>ç®€å•ç›´æ¥</h5><p>ç¼–å†™æ— æ¨¡æ¿çš„æç®€ä»£ç æ¥ç²¾å‡†æè¿°å‡ºä½ çš„æ„å›¾ã€‚è¦æ›´æ–°ä¸€ä¸ªè®°å½•å­—æ®µï¼Ÿä½¿ç”¨ç†Ÿæ‚‰çš„ JavaScript èµ‹å€¼å°±è¡Œã€‚è¦åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°æ•°æ®ï¼Ÿä¸éœ€è¦ç‰¹æ®Šçš„å·¥å…·ï¼Œå“åº”æ€§ç³»ç»Ÿä¼šä¾¦æµ‹åˆ°ä½ æ‰€æœ‰çš„å˜æ›´å¹¶æŠŠå®ƒä»¬ä¼ é€åˆ°å…¶ç”¨æ­¦ä¹‹åœ°ã€‚</p><p>ğŸš…</p><h5 id="è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“"><a href="#è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“" class="headerlink" title="è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“"></a>è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“</h5><p>æ‰€æœ‰å¯¹æ•°æ®çš„å˜æ›´å’Œä½¿ç”¨éƒ½ä¼šåœ¨è¿è¡Œæ—¶è¢«è¿½è¸ªåˆ°ï¼Œå¹¶æ„æˆä¸€ä¸ªæˆªå–æ‰€æœ‰çŠ¶æ€å’Œè¾“å‡ºä¹‹é—´å…³ç³»çš„ä¾èµ–æ ‘ã€‚è¿™æ ·ä¿è¯äº†é‚£äº›ä¾èµ–äºçŠ¶æ€çš„è®¡ç®—åªæœ‰åœ¨çœŸæ­£éœ€è¦æ—¶æ‰ä¼šè¿è¡Œï¼Œå°±åƒ React ç»„ä»¶ä¸€æ ·ã€‚æ— éœ€ä½¿ç”¨è®°å¿†åŒ–æˆ–é€‰æ‹©å™¨ä¹‹ç±»å®¹æ˜“å‡ºé”™çš„æ¬¡ä¼˜æŠ€å·§æ¥å¯¹ç»„ä»¶è¿›è¡Œæ‰‹åŠ¨ä¼˜åŒ–ã€‚</p><p>ğŸ¤¹ğŸ»â€â™‚ï¸</p><h5 id="æ¶æ„è‡ªç”±"><a href="#æ¶æ„è‡ªç”±" class="headerlink" title="æ¶æ„è‡ªç”±"></a>æ¶æ„è‡ªç”±</h5><p>MobX ä¸ä¼šç”¨å®ƒè‡ªå·±çš„è§„åˆ™æ¥é™åˆ¶ä½ ï¼Œå®ƒå¯ä»¥è®©ä½ åœ¨ä»»æ„ UI æ¡†æ¶ä¹‹å¤–ç®¡ç†ä½ çš„åº”ç”¨çŠ¶æ€ã€‚è¿™æ ·ä¼šä½¿ä½ çš„ä»£ç ä½è€¦åˆã€å¯ç§»æ¤å’Œæœ€é‡è¦çš„â€”â€”å®¹æ˜“æµ‹è¯•ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react&quot;</span><span class="hljs-comment">// å¯¹åº”ç”¨çŠ¶æ€è¿›è¡Œå»ºæ¨¡ã€‚</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Timer</span> &#123;    secondsPassed = <span class="hljs-number">0</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-title function_">increase</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span> += <span class="hljs-number">1</span>    &#125;    <span class="hljs-title function_">reset</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span> = <span class="hljs-number">0</span>    &#125;&#125;<span class="hljs-keyword">const</span> myTimer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Timer</span>()<span class="hljs-comment">// æ„å»ºä¸€ä¸ªä½¿ç”¨ observable çŠ¶æ€çš„â€œç”¨æˆ·ç•Œé¢â€ã€‚</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">(<span class="hljs-params">&#123; timer &#125;</span>) =&gt;</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> timer.reset()&#125;&gt;å·²è¿‡ç§’æ•°ï¼š&#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>))<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> <span class="hljs-attr">timer</span>=<span class="hljs-string">&#123;myTimer&#125;</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)<span class="hljs-comment">// æ¯ç§’æ›´æ–°ä¸€æ¬¡â€˜å·²è¿‡ç§’æ•°ï¼šXâ€™ä¸­çš„æ–‡æœ¬ã€‚</span><span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;    myTimer.<span class="hljs-title function_">increase</span>()&#125;, <span class="hljs-number">1000</span>)</code></pre></div><p>å›´ç»• React ç»„ä»¶ <code>TimerView</code> çš„ <code>observer</code> åŒ…è£…ä¼šè‡ªåŠ¨ä¾¦æµ‹åˆ°ä¾èµ–äº observable <code>timer.secondsPassed</code> çš„æ¸²æŸ“â€”â€”å³ä½¿è¿™ç§ä¾èµ–å…³ç³»æ²¡æœ‰è¢«æ˜ç¡®å®šä¹‰å‡ºæ¥ã€‚ å“åº”æ€§ç³»ç»Ÿä¼šè´Ÿè´£åœ¨æœªæ¥<em>æ°å¥½é‚£ä¸ª</em>å­—æ®µè¢«æ›´æ–°çš„æ—¶å€™å°†ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p><p>æ¯ä¸ªäº‹ä»¶ï¼ˆ<code>onClick</code> æˆ– <code>setInterval</code>ï¼‰éƒ½ä¼šè°ƒç”¨ä¸€ä¸ªç”¨æ¥æ›´æ–° <em>observable çŠ¶æ€</em> <code>myTimer.secondsPassed</code> çš„ <em>action</em>ï¼ˆ<code>myTimer.increase</code> æˆ– <code>myTimer.reset</code>ï¼‰ã€‚Observable çŠ¶æ€çš„å˜æ›´ä¼šè¢«ç²¾ç¡®åœ°ä¼ é€åˆ° <code>TimerView</code> ä¸­æ‰€æœ‰ä¾èµ–äºå®ƒä»¬çš„<em>è®¡ç®—</em>å’Œ<em>å‰¯ä½œç”¨</em>é‡Œã€‚</p><p><img src="https://zh.mobx.js.org/assets/zh.flow.png" alt="MobX å•å‘æµ"></p><h1 id="MobX-ä¸»æ—¨"><a href="#MobX-ä¸»æ—¨" class="headerlink" title="MobX ä¸»æ—¨"></a>MobX ä¸»æ—¨</h1><p>MobxåŒºåˆ†äº†åº”ç”¨ç¨‹åºçš„ä¸‰ä¸ªæ¦‚å¿µ</p><ul><li>State</li><li>Actions</li><li>Derivations</li></ul><h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><p><em>State(çŠ¶æ€)</em> æ˜¯é©±åŠ¨ä½ çš„åº”ç”¨ç¨‹åºçš„æ•°æ®ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Todo</span> &#123;    id = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()    title = <span class="hljs-string">&quot;&quot;</span>    finished = <span class="hljs-literal">false</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">title</span>) &#123;        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">title</span>: observable,            <span class="hljs-attr">finished</span>: observable,            <span class="hljs-attr">toggle</span>: action        &#125;)        <span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span> = title    &#125;    <span class="hljs-title function_">toggle</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">finished</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">finished</span>    &#125;&#125;</code></pre></div><p>å°† State å­˜å‚¨åœ¨ä»»ä½•æ‚¨å–œæ¬¢çš„æ•°æ®ç»“æ„ä¸­ï¼šæ™®é€šå¯¹è±¡ã€æ•°ç»„ã€ç±»ã€å¾ªç¯æ•°æ®ç»“æ„æˆ–å¼•ç”¨ã€‚è¿™ä¸MobXçš„å·¥ä½œæ–¹å¼æ— å…³ã€‚</p><p>åªè¦ç¡®ä¿æ‰€æœ‰å“åº”å¼çš„å±æ€§éƒ½è¢«æ ‡è®°ä¸º<code>observable</code></p><h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p>actionæ˜¯ç”¨æ¥æ”¹å˜stateä¸­çš„æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·äº‹ä»¶å¤„ç†ã€åç«¯æ¨é€æ•°æ®å¤„ç†ã€è°ƒåº¦å™¨äº‹ä»¶å¤„ç†ç­‰ç­‰ã€‚</p><h3 id="åˆ›å»º-Derivations-ä»¥ä¾¿è‡ªåŠ¨å¯¹-State-å˜åŒ–è¿›è¡Œå“åº”"><a href="#åˆ›å»º-Derivations-ä»¥ä¾¿è‡ªåŠ¨å¯¹-State-å˜åŒ–è¿›è¡Œå“åº”" class="headerlink" title="åˆ›å»º Derivations ä»¥ä¾¿è‡ªåŠ¨å¯¹ State å˜åŒ–è¿›è¡Œå“åº”"></a>åˆ›å»º Derivations ä»¥ä¾¿è‡ªåŠ¨å¯¹ State å˜åŒ–è¿›è¡Œå“åº”</h3><p><em>ä»»ä½•</em> æ¥æºæ˜¯<em>State(çŠ¶æ€)</em> å¹¶ä¸”ä¸éœ€è¦è¿›ä¸€æ­¥äº¤äº’çš„ä¸œè¥¿éƒ½æ˜¯ Derivation(æ´¾ç”Ÿ)</p><p>Derivations åŒ…æ‹¬è®¸å¤šæ–¹å¼:</p><ul><li><em>ç”¨æˆ·ç•Œé¢</em></li><li><em>æ´¾ç”Ÿæ•°æ®</em> , æ¯”å¦‚å‰©ä½™æœªå®Œæˆ<code>todos</code>çš„æ•°é‡</li><li><em>åç«¯é›†æˆ</em> , æ¯”å¦‚å‘é€æ”¹å˜åˆ°æœåŠ¡å™¨ç«¯</li></ul><p>Mobx åŒºåˆ†äº†ä¸¤ç§ Derivation :</p><ul><li><em>Computed values</em>,æ€»æ˜¯å¯ä»¥é€šè¿‡çº¯å‡½æ•°ä»å½“å‰çš„å¯è§‚æµ‹ State ä¸­æ´¾ç”Ÿã€‚</li><li><em>Reactions</em>, å½“ State æ”¹å˜æ—¶éœ€è¦è‡ªåŠ¨è¿è¡Œçš„å‰¯ä½œç”¨ (å‘½ä»¤å¼ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹ä¹‹é—´çš„æ¡¥æ¢)</li></ul><p>å½“æœ€å¼€å§‹ä½¿ç”¨MobXæ—¶ï¼Œäººä»¬å®¹æ˜“è¿‡åº¦ä½¿ç”¨ <em>Reaction</em>ã€‚</p><p>é»„é‡‘æ³•åˆ™æ˜¯ï¼Œå¦‚æœè¦åŸºäºå½“å‰ State åˆ›å»ºå€¼ï¼Œè¯·å§‹ç»ˆä½¿ç”¨ <em>computed</em></p><h4 id="é€šè¿‡-computed-å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡"><a href="#é€šè¿‡-computed-å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡" class="headerlink" title="é€šè¿‡ computed å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡"></a>é€šè¿‡ computed å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡</h4><p>ä½ å¯ä»¥é€šè¿‡å®šä¹‰ getter æ–¹æ³•å¹¶ä½¿ç”¨ <code>makeObservable</code> å°†å…¶æ ‡è®°ä¸º <code>computed</code> çš„æ–¹å¼åˆ›å»ºä¸€ä¸ª <em>computed</em> å€¼ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">TodoList</span> &#123;    todos = []    <span class="hljs-keyword">get</span> <span class="hljs-title function_">unfinishedTodoCount</span>() &#123;        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">finished</span>).<span class="hljs-property">length</span>    &#125;    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">todos</span>) &#123;        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">todos</span>: observable,            <span class="hljs-attr">unfinishedTodoCount</span>: computed        &#125;)        <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span> = todos    &#125;&#125;</code></pre></div><p>Mobx ä¼šç¡®ä¿ <code>unfinishedTodoCount</code> ä¼šåœ¨todosæ•°ç»„å‘ç”Ÿå˜åŒ–ä¸­æˆ–è€… todosä¸­çš„ä¸€ä¸ªå¯¹è±¡ä¸­çš„ <code>finished</code>å±æ€§è¢«ä¿®æ”¹æ—¶è‡ªåŠ¨æ›´æ–°</p><h4 id="Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨"><a href="#Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨" class="headerlink" title="Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨"></a>Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨</h4><p>ä½œä¸ºç”¨æˆ·ï¼Œè¦æƒ³åœ¨å±å¹•ä¸Šçœ‹åˆ°çŠ¶æ€æˆ–è®¡ç®—å€¼çš„å˜åŒ–ï¼Œå°±éœ€è¦ä¸€ä¸ªé‡æ–°ç»˜åˆ¶éƒ¨åˆ†GUIçš„ <em>reactions</em> ã€‚</p><p>Reaction å’Œ computed ç±»ä¼¼ï¼Œä½†å¹¶ä¸äº§ç”Ÿä¿¡æ¯ï¼Œè€Œæ˜¯äº§ç”Ÿå‰¯ä½œç”¨ï¼Œå¦‚æ‰“å°åˆ°æ§åˆ¶å°ã€å‘å‡ºç½‘ç»œè¯·æ±‚ã€å¢é‡æ›´æ–° React ç»„ä»¶æ ‘ä»¥ä¾¿æ›´æ–°DOMç­‰ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œ<em>reaction</em> æ˜¯ <a href="https://en.wikipedia.org/wiki/Reactive_programming">å“åº”å¼ç¼–ç¨‹</a>å’Œ<a href="https://en.wikipedia.org/wiki/Imperative_programming">æŒ‡ä»¤å¼ç¼–ç¨‹</a>ä¹‹é—´çš„æ¡¥æ¢ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ€å¸¸ç”¨çš„ reaction å½¢å¼æ˜¯UIç»„ä»¶ã€‚ æ³¨æ„ï¼Œaction å’Œ reaction éƒ½å¯èƒ½å¼•èµ·å‰¯ä½œç”¨ã€‚ å‰¯ä½œç”¨åº”æœ‰ä¸€ä¸ªæ¸…æ™°çš„ã€æ˜¾å¼çš„èµ·æºï¼Œä¾‹å¦‚åœ¨æäº¤è¡¨å•æ—¶å‘å‡ºç½‘ç»œè¯·æ±‚ï¼Œåº”è¯¥ä»ç›¸å…³çš„äº‹ä»¶å¤„ç†ç¨‹åºæ˜¾å¼è§¦å‘ã€‚</p><h2 id="åŸåˆ™"><a href="#åŸåˆ™" class="headerlink" title="åŸåˆ™"></a>åŸåˆ™</h2><p>Mobx ä½¿ç”¨å•å‘æ•°æ®æµï¼Œåˆ©ç”¨ <em>action</em> æ”¹å˜ <em>state</em> ï¼Œè¿›è€Œæ›´æ–°æ‰€æœ‰å—å½±å“çš„ <em>view</em></p><p><img src="https://zh.mobx.js.org/assets/action-state-view.png" alt="Action, State, View"></p><ol><li>æ‰€æœ‰çš„ <em>derivations</em> å°†åœ¨ <em>state</em> æ”¹å˜æ—¶<strong>è‡ªåŠ¨ä¸”åŸå­åŒ–åœ°æ›´æ–°</strong>ã€‚å› æ­¤ä¸å¯èƒ½è§‚å¯Ÿä¸­é—´å€¼ã€‚</li><li>æ‰€æœ‰çš„ <em>derivations</em> é»˜è®¤å°†ä¼š<strong>åŒæ­¥</strong>æ›´æ–°ï¼Œè¿™æ„å‘³ç€ <em>action</em> å¯ä»¥åœ¨ <em>state</em> æ”¹å˜ ä¹‹åå®‰å…¨çš„ç›´æ¥è·å¾— computed å€¼ã€‚</li><li><em>computed value</em> çš„æ›´æ–°æ˜¯<strong>æƒ°æ€§</strong>çš„ï¼Œä»»ä½• computed value åœ¨éœ€è¦ä»–ä»¬çš„å‰¯ä½œç”¨å‘ç”Ÿä¹‹å‰éƒ½æ˜¯ä¸æ¿€æ´»çš„ã€‚</li><li>æ‰€æœ‰çš„ <em>computed value</em> éƒ½åº”æ˜¯<strong>çº¯å‡½æ•°</strong>,ä»–ä»¬ä¸åº”è¯¥ä¿®æ”¹ <em>state</em>ã€‚</li></ol><h2 id="Observable-state"><a href="#Observable-state" class="headerlink" title="Observable state"></a>Observable state</h2><p>å±æ€§ï¼Œå®Œæ•´çš„å¯¹è±¡ï¼Œæ•°ç»„ï¼ŒMaps å’Œ Sets éƒ½å¯ä»¥è¢«è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ã€‚ ä½¿å¾—å¯¹è±¡å¯è§‚å¯Ÿçš„åŸºæœ¬æ–¹æ³•æ˜¯ä½¿ç”¨ <code>makeObservable</code> ä¸ºæ¯ä¸ªå±æ€§æŒ‡å®šä¸€ä¸ªæ³¨è§£ã€‚ æœ€é‡è¦çš„æ³¨è§£å¦‚ä¸‹ï¼š</p><ul><li><code>observable</code> å®šä¹‰ä¸€ä¸ªå­˜å‚¨ state çš„å¯è¿½è¸ªå­—æ®µã€‚</li><li><code>action</code> å°†ä¸€ä¸ªæ–¹æ³•æ ‡è®°ä¸ºå¯ä»¥ä¿®æ”¹ state çš„ actionã€‚</li><li><code>computed</code> æ ‡è®°ä¸€ä¸ªå¯ä»¥ç”± state æ´¾ç”Ÿå‡ºæ–°çš„å€¼å¹¶ä¸”ç¼“å­˜å…¶è¾“å‡ºçš„ getterã€‚</li></ul><p>åƒæ•°ç»„ï¼ŒMaps å’Œ Sets è¿™æ ·çš„é›†åˆéƒ½å°†è¢«è‡ªåŠ¨è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡</p><h4 id="makeObservable"><a href="#makeObservable" class="headerlink" title="makeObservable"></a><code>makeObservable</code></h4><p>ç”¨æ³•ï¼š</p><ul><li><code>makeObservable(target, annotations?, options?)</code></li></ul><p>è¿™ä¸ªå‡½æ•°ä¼šå°†å·²å­˜åœ¨çš„å¯¹è±¡å±æ€§è½¬æ¢æˆå¯è§‚å¯Ÿåœ°å¯¹è±¡ï¼Œä»»ä½•targetå¯¹è±¡åŒ…æ‹¬classéƒ½å¯ä»¥ä½œä¸ºtargetä¼ é€’ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<code>makeObservable</code> æ˜¯åœ¨ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨çš„ï¼Œå¹¶ä¸”å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>this</code> ã€‚ <code>annotations</code> å‚æ•°å°†ä¼šä¸ºæ¯ä¸€ä¸ªæˆå‘˜æ˜ å°„ <a href="https://zh.mobx.js.org/observable-state.html#%E5%8F%AF%E7%94%A8%E7%9A%84%E6%B3%A8%E8%A7%A3">æ³¨è§£</a>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½¿ç”¨ <a href="https://zh.mobx.js.org/enabling-decorators.html">è£…é¥°å™¨</a> æ—¶ï¼Œ<code>annotations</code> å‚æ•°å°†ä¼šè¢«å¿½ç•¥ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, computed, action, flow &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;    value    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">value</span>: observable,            <span class="hljs-attr">double</span>: computed,            <span class="hljs-attr">increment</span>: action,            <span class="hljs-attr">fetch</span>: flow        &#125;)        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value    &#125;    <span class="hljs-keyword">get</span> <span class="hljs-title function_">double</span>() &#123;        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>    &#125;    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++    &#125;    *<span class="hljs-title function_">fetch</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/api/value&quot;</span>)        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = response.<span class="hljs-title function_">json</span>()    &#125;&#125;æ‰€æœ‰å¸¦æ³¨è§£ çš„å­—æ®µéƒ½æ˜¯ ä¸å¯é…ç½®çš„ã€‚æ‰€æœ‰çš„ä¸å¯è§‚å¯Ÿï¼ˆæ— çŠ¶æ€ï¼‰çš„å­—æ®µï¼ˆaction, flowï¼‰éƒ½æ˜¯ ä¸å¯å†™çš„ã€‚</code></pre></div><h4 id="makeAutoObservable"><a href="#makeAutoObservable" class="headerlink" title="makeAutoObservable"></a><code>makeAutoObservable</code></h4><p>ä½¿ç”¨ï¼š</p><ul><li><code>makeAutoObservable(target, overrides?, options?)</code></li></ul><p>ç›¸å½“äºæ˜¯åŠ å¼ºç‰ˆçš„makeObservableå‡½æ•°ï¼Œä»–ä¼šè‡ªåŠ¨æ ¹æ®ä¼ å…¥çš„å¯¹è±¡å±æ€§è‡ªåŠ¨è½¬æˆå¯è§‚å¯Ÿå±æ€§ï¼Œ</p><p>ä¸ä½¿ç”¨ <code>makeObservable</code> ç›¸æ¯”ï¼Œ<code>makeAutoObservable</code> å‡½æ•°æ›´ç´§å‡‘ï¼Œä¹Ÿæ›´å®¹æ˜“ç»´æŠ¤ï¼Œå› ä¸ºæ–°æˆå‘˜ä¸éœ€è¦æ˜¾å¼åœ°æåŠã€‚ ç„¶è€Œï¼Œ<code>makeAutoObservable</code> ä¸èƒ½è¢«ç”¨äºå¸¦æœ‰ super çš„ç±»æˆ– <a href="https://zh.mobx.js.org/subclassing.html">å­ç±»</a></p><p>æ¨æ–­è§„åˆ™ï¼š</p><ul><li>æ‰€æœ‰ <em>è‡ªæœ‰</em> å±æ€§éƒ½æˆä¸º <code>observable</code>ã€‚</li><li>æ‰€æœ‰ <code>get</code>ters éƒ½æˆä¸º <code>computed</code>ã€‚</li><li>æ‰€æœ‰ <code>set</code>ters éƒ½æˆä¸º <code>action</code>ã€‚</li><li>æ‰€æœ‰ <em>prototype ä¸­çš„ functions</em> éƒ½æˆä¸º <code>autoAction</code>ã€‚</li><li>æ‰€æœ‰ <em>prototype ä¸­çš„ generator functions</em> éƒ½æˆä¸º <code>flow</code>ã€‚ï¼ˆéœ€è¦æ³¨æ„ï¼Œgenerators å‡½æ•°åœ¨æŸäº›ç¼–è¯‘å™¨é…ç½®ä¸­æ— æ³•è¢«æ£€æµ‹åˆ°ï¼Œå¦‚æœ flow æ²¡æœ‰æ­£å¸¸è¿è¡Œï¼Œè¯·åŠ¡å¿…æ˜ç¡®åœ°æŒ‡å®š <code>flow</code> æ³¨è§£ã€‚ï¼‰</li><li>åœ¨ <code>overrides</code> å‚æ•°ä¸­æ ‡è®°ä¸º <code>false</code> çš„æˆå‘˜å°†ä¸ä¼šè¢«æ·»åŠ æ³¨è§£ã€‚ä¾‹å¦‚ï¼Œå°†å…¶ç”¨äºåƒæ ‡è¯†ç¬¦è¿™æ ·çš„åªè¯»å­—æ®µã€‚</li></ul><h4 id="observable"><a href="#observable" class="headerlink" title="observable"></a><code>observable</code></h4><p>ç”¨æ³•ï¼š</p><ul><li><code>observable(source, overrides?, options?)</code></li></ul><p><code>observable</code> æ³¨è§£å¯ä»¥ä½œä¸ºä¸€ä¸ªå‡½æ•°è¿›è¡Œè°ƒç”¨ï¼Œä»è€Œä¸€æ¬¡æ€§å°†æ•´ä¸ªå¯¹è±¡å˜æˆå¯è§‚å¯Ÿçš„ã€‚ <code>source</code> å¯¹è±¡å°†ä¼šè¢«å…‹éš†å¹¶ä¸”æ‰€æœ‰çš„æˆå‘˜éƒ½å°†ä¼šæˆä¸ºå¯è§‚å¯Ÿçš„ï¼Œç±»ä¼¼äº <code>makeAutoObservable</code> åšçš„é‚£æ ·ã€‚ åŒæ ·ï¼Œä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ª <code>overrides</code> å¯¹è±¡æ¥ä¸ºç‰¹å®šçš„æˆå‘˜æä¾›ç‰¹å®šçš„æ³¨è§£ã€‚ </p><p>ç”± <code>observable</code> è¿”å›çš„å¯¹è±¡å°†ä¼šä½¿ç”¨ Proxy åŒ…è£…ï¼Œè¿™æ„å‘³ç€ä¹‹åè¢«æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸­çš„å±æ€§ä¹Ÿå°†è¢«ä¾¦æµ‹å¹¶ä½¿å…¶è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ï¼ˆé™¤éç¦ç”¨ <a href="https://zh.mobx.js.org/configuration.html#proxy-%E9%80%89%E9%A1%B9">proxy</a>ï¼‰ã€‚</p><p><code>observable</code> æ–¹æ³•ä¹Ÿå¯ä»¥è¢«åƒ <a href="https://zh.mobx.js.org/api.html#observablearray">arrays</a>ï¼Œ<a href="https://zh.mobx.js.org/api.html#observablemap">Maps</a> å’Œ <a href="https://zh.mobx.js.org/api.html#observableset">Sets</a> è¿™æ ·çš„é›†åˆè°ƒç”¨ã€‚è¿™äº›é›†åˆä¹Ÿå°†è¢«å…‹éš†å¹¶è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; observable, autorun &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">const</span> todos = <span class="hljs-title function_">observable</span>([    &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Spoil tea&quot;</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span> &#125;,    &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Make coffee&quot;</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> &#125;])<span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(        <span class="hljs-string">&quot;Remaining:&quot;</span>,        todos            .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">completed</span>)            .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">title</span>)            .<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;, &quot;</span>)    )&#125;)<span class="hljs-comment">// æ‰“å°: &#x27;Remaining: Make coffee&#x27;</span>todos[<span class="hljs-number">0</span>].<span class="hljs-property">completed</span> = <span class="hljs-literal">false</span><span class="hljs-comment">// æ‰“å°: &#x27;Remaining: Spoil tea, Make coffee&#x27;</span>todos[<span class="hljs-number">2</span>] = &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Take a nap&quot;</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> &#125;<span class="hljs-comment">// æ‰“å°: &#x27;Remaining: Spoil tea, Make coffee, Take a nap&#x27;</span>todos.<span class="hljs-title function_">shift</span>()<span class="hljs-comment">// æ‰“å°: &#x27;Remaining: Make coffee, Take a nap&#x27;</span></code></pre></div><p>ä½¿ç”¨autorunå¯ä»¥åœ¨å“åº”å¼çš„æ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œè‡ªåŠ¨æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°</p><p>å¯è§‚å¯Ÿçš„æ•°ç»„è¿˜æœ‰ä¸€äº›ç‰¹åˆ«å¥½ç”¨çš„å®ç”¨å‡½æ•°ï¼š</p><ul><li><code>clear()</code> ä»æ•°ç»„ä¸­æ¸…é™¤æ‰€æœ‰å…ƒç´ ã€‚</li><li><code>replace(newItems)</code> å°†æ•°ç»„ä¸­ç°æœ‰çš„å…ƒç´ å…¨éƒ¨æ›¿æ¢æˆ newItemsã€‚</li><li><code>remove(value)</code> æ ¹æ® value ä»æ•°ç»„ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ‰¾åˆ°å¹¶åˆ é™¤äº†å…ƒç´ ï¼Œè¿”å› <code>true</code>ã€‚</li></ul><p><strong>æ³¨æ„ï¼šåŸºæœ¬æ•°æ®ç±»å‹å’Œç±»çš„å®ä¾‹ä¸èƒ½è½¬æ¢æˆå¯è§‚å¯Ÿçš„å¯¹è±¡</strong></p><p><strong><code>make(Auto)Observable</code> å’Œ <code>observable</code> ä¹‹é—´æœ€ä¸»è¦çš„åŒºåˆ«</strong>åœ¨äºï¼Œ<code>make(Auto)Observable</code> ä¼šä¿®æ”¹ä½ ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„å¯¹è±¡ï¼Œè€Œ <code>observable</code> ä¼šåˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„ <em>å‰¯æœ¬</em> å¯¹è±¡</p><p>ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ï¼Œ<code>observable</code> ä¼šåˆ›å»ºä¸€ä¸ª <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy"><code>Proxy</code></a> å¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨ä½ å°†è¯¥å¯¹è±¡å½“ä½œåŠ¨æ€æŸ¥è¯¢æ˜ å°„ä½¿ç”¨æ—¶æ•è·å°†è¦æ·»åŠ çš„å±æ€§ã€‚ å¦‚æœä½ æƒ³æŠŠä¸€ä¸ªå¯¹è±¡è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ï¼Œè€Œè¿™ä¸ªå¯¹è±¡å…·æœ‰ä¸€ä¸ªå¸¸è§„ç»“æ„ï¼Œå…¶ä¸­æ‰€æœ‰çš„æˆå‘˜éƒ½æ˜¯äº‹å…ˆå·²çŸ¥çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å»ºè®®ä½¿ç”¨ <code>makeObservable</code>ï¼Œå› ä¸ºéä»£ç†å¯¹è±¡çš„é€Ÿåº¦ç¨å¿«ä¸€äº›ï¼Œè€Œä¸”å®ƒä»¬åœ¨è°ƒè¯•å™¨å’Œ <code>console.log</code> ä¸­æ›´å®¹æ˜“æ£€æŸ¥ã€‚</p><p>å› æ­¤ï¼Œ<code>make(Auto)Observable</code> æ¨èåœ¨å·¥å‚å‡½æ•°ä¸­ä½¿ç”¨ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¯ä»¥å°† <code>&#123; proxy: false &#125;</code> ä½œä¸º option ä¼ å…¥ <code>observable</code> è·å–éä»£ç†å‰¯æœ¬</p><h2 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h2><h3 id="ä½¿ç”¨-actions-æ›´æ–°-state"><a href="#ä½¿ç”¨-actions-æ›´æ–°-state" class="headerlink" title="ä½¿ç”¨ actions æ›´æ–° state"></a>ä½¿ç”¨ actions æ›´æ–° state</h3><p>ç”¨æ³•ï¼š</p><ul><li><code>action</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li><li><code>action(fn)</code></li><li><code>action(name, fn)</code></li></ul><p>actionså°±æ˜¯ç”¨æ¥ä¿®æ”¹stateä¸­çš„æ•°æ®çš„ï¼Œ</p><p>å°½ç®¡ <a href="https://zh.mobx.js.org/observable-state.html#makeautoobservable"><code>makeAutoObservable</code></a> å¯ä»¥è‡ªåŠ¨å¸®ä½ å£°æ˜ä¸€éƒ¨åˆ† actionsï¼Œä½†æ˜¯ MobX è¿˜æ˜¯è¦æ±‚ä½ å£°æ˜ä½ çš„ actionsã€‚Actions å¯ä»¥å¸®åŠ©ä½ æ›´å¥½çš„ç»„ç»‡ä½ çš„ä»£ç å¹¶æä¾›ä»¥ä¸‹æ€§èƒ½ä¼˜åŠ¿ï¼š</p><ol><li>å®ƒä»¬åœ¨ <a href="https://zh.mobx.js.org/api.html#transaction">transactions</a> å†…éƒ¨è¿è¡Œã€‚ä»»ä½•å¯è§‚å¯Ÿå¯¹è±¡åœ¨æœ€å¤–å±‚çš„ action å®Œæˆä¹‹å‰éƒ½ä¸ä¼šè¢«æ›´æ–°ï¼Œè¿™ä¸€ç‚¹ä¿è¯äº†åœ¨ action å®Œæˆä¹‹å‰ï¼Œaction æ‰§è¡ŒæœŸé—´ç”Ÿæˆçš„ä¸­é—´å€¼æˆ–ä¸å®Œæ•´çš„å€¼å¯¹åº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†éƒ½æ˜¯ä¸å¯è§çš„ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å…è®¸åœ¨ actions ä¹‹å¤–æ”¹å˜ stateã€‚è¿™æœ‰åŠ©äºåœ¨ä»£ç ä¸­æ¸…æ¥šåœ°å¯¹çŠ¶æ€æ›´æ–°å‘ç”Ÿçš„ä½ç½®è¿›è¡Œå®šä½ã€‚</li></ol><p><code>action</code> æ³¨è§£åº”è¯¥ä»…ç”¨äºä¼š<em>ä¿®æ”¹</em> state çš„å‡½æ•°ã€‚æ´¾ç”Ÿå…¶ä»–ä¿¡æ¯ï¼ˆæ‰§è¡ŒæŸ¥è¯¢æˆ–è€…è¿‡æ»¤æ•°æ®ï¼‰çš„å‡½æ•°<em>ä¸åº”è¯¥</em>è¢«æ ‡è®°ä¸º actionsï¼Œä»¥ä¾¿ MobX å¯ä»¥å¯¹å®ƒä»¬çš„è°ƒç”¨è¿›è¡Œè·Ÿè¸ªã€‚ å¸¦æœ‰ <code>action</code> æ³¨è§£çš„æˆå‘˜æ˜¯ä¸å¯æšä¸¾çš„ã€‚</p><p>makeObservable</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;    value = <span class="hljs-number">0</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">value</span>: observable,            <span class="hljs-attr">increment</span>: action        &#125;)    &#125;    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-comment">// è§‚å¯Ÿè€…ä¸ä¼šçœ‹åˆ°ä¸­é—´çŠ¶æ€.</span>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++    &#125;&#125;</code></pre></div><p>makeAutoObservable</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;    value = <span class="hljs-number">0</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++    &#125;&#125;</code></pre></div><p>action.bound</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;    value = <span class="hljs-number">0</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">value</span>: observable,            <span class="hljs-attr">increment</span>: action.<span class="hljs-property">bound</span>        &#125;)    &#125;    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++    &#125;&#125;<span class="hljs-keyword">const</span> doubler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Doubler</span>()<span class="hljs-comment">// è¿™æ ·è°ƒç”¨ increment æ˜¯å®‰å…¨çš„, å› ä¸ºå®ƒå·²ç»è¢«ç»‘å®šäº†ã€‚</span><span class="hljs-built_in">setInterval</span>(doubler.<span class="hljs-property">increment</span>, <span class="hljs-number">1000</span>)</code></pre></div><p>Action(fn)</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; observable, action &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">observable</span>(&#123; <span class="hljs-attr">value</span>: <span class="hljs-number">0</span> &#125;)<span class="hljs-keyword">const</span> increment = <span class="hljs-title function_">action</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> &#123;    state.<span class="hljs-property">value</span>++    state.<span class="hljs-property">value</span>++&#125;)<span class="hljs-title function_">increment</span>(state)</code></pre></div><p>runInAction</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; observable, runInAction &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">observable</span>(&#123; <span class="hljs-attr">value</span>: <span class="hljs-number">0</span> &#125;)<span class="hljs-title function_">runInAction</span>(<span class="hljs-function">() =&gt;</span> &#123;    state.<span class="hljs-property">value</span>++    state.<span class="hljs-property">value</span>++&#125;)</code></pre></div><h3 id="ä½¿ç”¨-action-åŒ…è£…å‡½æ•°"><a href="#ä½¿ç”¨-action-åŒ…è£…å‡½æ•°" class="headerlink" title="ä½¿ç”¨ action åŒ…è£…å‡½æ•°"></a>ä½¿ç”¨ <code>action</code> åŒ…è£…å‡½æ•°</h3><p>ä¸ºäº†å°½å¯èƒ½åœ°åˆ©ç”¨ MobX çš„äº‹åŠ¡æ€§ï¼Œactions åº”è¯¥å°½å¯èƒ½è¢«ä¼ åˆ°å¤–å›´ã€‚å¦‚æœä¸€ä¸ªç±»æ–¹æ³•ä¼šä¿®æ”¹ stateï¼Œå¯ä»¥å°†å…¶æ ‡è®°ä¸º actionã€‚æŠŠäº‹ä»¶å¤„ç†å‡½æ•°æ ‡è®°ä¸º actions å°±æ›´å¥½äº†ï¼Œå› ä¸ºæœ€å¤–å±‚çš„äº‹åŠ¡èµ·ç€å†³å®šæ€§ä½œç”¨ã€‚ä¸€ä¸ªæœªè¢«æ ‡è®°çš„ã€ä¼šæ¥ç€è°ƒç”¨ä¸¤ä¸ª actions çš„äº‹ä»¶å¤„ç†å‡½æ•°ä»ç„¶å°†ä¼šç”Ÿæˆä¸¤ä¸ªäº‹åŠ¡ã€‚</p><p>ä¸ºäº†å¸®åŠ©åˆ›å»ºåŸºäº action çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œ<code>action</code> ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ³¨è§£ï¼Œæ›´æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ã€‚å¯ä»¥ä½¿ç”¨å‡½æ•°å°†å®ƒä½œä¸ºä¸€ä¸ªå‚æ•°æ¥è°ƒç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å®ƒå°†ä¼šè¿”å›ä¸€ä¸ªæœ‰ç€ç›¸åŒç­¾åçš„ä½¿ç”¨ <code>action</code> åŒ…è£…è¿‡çš„å‡½æ•°ã€‚</p><p>ä¾‹å¦‚åœ¨ React ä¸­ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼åŒ…è£… <code>onClick</code> äº‹ä»¶å¤„ç†å‡½æ•°</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">ResetButton</span> = (<span class="hljs-params">&#123; formState &#125;</span>) =&gt; (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;action(e</span> =&gt;</span> &#123;</span><span class="language-xml">            formState.resetPendingUploads()</span><span class="language-xml">            formState.resetValues()</span><span class="language-xml">            e.stopPropagation()</span><span class="language-xml">        &#125;)&#125;</span><span class="language-xml">    &gt;</span><span class="language-xml">        Reset form</span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>)</code></pre></div><p>ä¸ºäº†æ›´å¥½çš„è°ƒè¯•ä½“éªŒï¼Œæˆ‘ä»¬æ¨èä¸ºè¢«åŒ…è£…çš„å‡½æ•°å‘½åï¼Œæˆ–è€…å°†åç§°ä½œä¸º <code>action</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œä¼ é€’    </p><p><strong>æ³¨æ„ï¼šactionsä¸ä¼šè¢«è·Ÿè¸ª</strong>ï¼Œå°±æ˜¯ä¸èƒ½è§¦å‘autorun</p><p>actions çš„å¦ä¸€ä¸ªç‰¹å¾æ˜¯å®ƒä»¬æ˜¯ <a href="https://zh.mobx.js.org/api.html#untracked">ä¸å¯è¿½è¸ª</a> çš„ã€‚å½“ä»å‰¯ä½œç”¨æˆ–è€…è®¡ç®—å€¼ï¼ˆéå¸¸ç½•è§ï¼‰ä¸­è°ƒç”¨ action æ—¶ï¼Œè¯¥ action è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡å°†ä¸ä¼šç®—ä½œè¯¥ derivation çš„ä¾èµ–é¡¹ã€‚</p><p><code>makeAutoObservable</code>ï¼Œ<code>extendObservable</code> å’Œ <code>observable</code> ä½¿ç”¨ä¸€ç§ç‰¹æ®Šçš„ <code>action</code>ï¼Œ å«åš <code>autoAction</code>ï¼Œ å®ƒä¼šåœ¨è¿è¡Œæ—¶ç¡®å®šå‡½æ•°æ˜¯ derivation è¿˜æ˜¯ actionã€‚</p><h3 id="action-bound"><a href="#action-bound" class="headerlink" title="action.bound"></a><code>action.bound</code></h3><p>ç”¨æ³•ï¼š</p><ul><li><code>action.bound</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li></ul><p><code>action.bound</code> æ³¨è§£å¯ç”¨äºå°†æ–¹æ³•è‡ªåŠ¨ç»‘å®šåˆ°æ­£ç¡®çš„å®ä¾‹ï¼Œè¿™æ · <code>this</code> ä¼šå§‹ç»ˆè¢«æ­£ç¡®ç»‘å®šåœ¨å‡½æ•°å†…éƒ¨</p><p>ä½¿ç”¨makeAutoObservable(o,{},{autoBind:true}) è‡ªåŠ¨ç»‘å®šæ‰€æœ‰çš„actionså’Œflow</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;    value = <span class="hljs-number">0</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>, &#123;&#125;, &#123; <span class="hljs-attr">autoBind</span>: <span class="hljs-literal">true</span> &#125;)    &#125;    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++    &#125;        *<span class="hljs-title function_">flow</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://example.com/value&quot;</span>)        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-keyword">yield</span> response.<span class="hljs-title function_">json</span>()    &#125;&#125;</code></pre></div><h3 id="runInAction"><a href="#runInAction" class="headerlink" title="runInAction"></a><code>runInAction</code></h3><p>ç”¨æ³•ï¼š</p><ul><li><code>runInAction(fn)</code></li></ul><p>ä½¿ç”¨è¿™ä¸ªå·¥å…·å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªä¼šè¢«ç«‹å³è°ƒç”¨çš„ä¸´æ—¶ actionã€‚åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­éå¸¸æœ‰ç”¨ã€‚ </p><h3 id="Actions-å’Œç»§æ‰¿"><a href="#Actions-å’Œç»§æ‰¿" class="headerlink" title="Actions å’Œç»§æ‰¿"></a>Actions å’Œç»§æ‰¿</h3><p>åªæœ‰å®šä¹‰åœ¨<strong>åŸå‹</strong>ä¸Šçš„å‡½æ•°å¯ä»¥è¢«å­ç±»<strong>è¦†ç›–</strong>ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> &#123;    <span class="hljs-comment">// on instance class filed</span>    arrowAction = <span class="hljs-function">() =&gt;</span> &#123;&#125;    <span class="hljs-comment">// on prototype</span>    <span class="hljs-title function_">action</span>(<span class="hljs-params"></span>) &#123;&#125;    <span class="hljs-title function_">boundAction</span>(<span class="hljs-params"></span>) &#123;&#125;    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">arrowAction</span>: action            <span class="hljs-attr">action</span>: action,            <span class="hljs-attr">boundAction</span>: action.<span class="hljs-property">bound</span>,        &#125;)    &#125;&#125;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Parent</span> &#123;    <span class="hljs-comment">// THROWS: TypeError: Cannot redefine property: arrowAction</span>    arrowAction = <span class="hljs-function">() =&gt;</span> &#123;&#125;    <span class="hljs-comment">// OK</span>    <span class="hljs-title function_">action</span>(<span class="hljs-params"></span>) &#123;&#125;    <span class="hljs-title function_">boundAction</span>(<span class="hljs-params"></span>) &#123;&#125;    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">super</span>()        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">arrowAction</span>: override,            <span class="hljs-attr">action</span>: override,            <span class="hljs-attr">boundAction</span>: override,        &#125;)    &#125;&#125;</code></pre></div><p>æƒ³è¦å°†å•ä¸ªçš„ <em>action</em> <strong>ç»‘å®š</strong> åˆ° <code>this</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>action.bound</code> ä»£æ›¿ç®­å¤´å‡½æ•°</p><h3 id="å¼‚æ­¥-actions"><a href="#å¼‚æ­¥-actions" class="headerlink" title="å¼‚æ­¥ actions"></a>å¼‚æ­¥ actions</h3><p>ä»æœ¬è´¨ä¸Šè®²ï¼Œå¼‚æ­¥è¿›ç¨‹åœ¨ MobX ä¸­ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šå¤„ç†ï¼Œå› ä¸ºä¸è®ºæ˜¯ä½•æ—¶å¼•å‘çš„æ‰€æœ‰ reactions éƒ½å°†ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ è€Œä¸”å› ä¸ºå¯è§‚å¯Ÿå¯¹è±¡æ˜¯å¯å˜çš„ï¼Œå› æ­¤åœ¨ action æ‰§è¡Œè¿‡ç¨‹ä¸­ä¿æŒå¯¹å®ƒä»¬çš„å¼•ç”¨ä¸€èˆ¬æ˜¯å®‰å…¨çš„ã€‚ ç„¶è€Œï¼Œåœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°å¯è§‚å¯Ÿå¯¹è±¡çš„æ¯ä¸ªæ­¥éª¤ï¼ˆtickï¼‰éƒ½åº”è¯¥è¢«æ ‡è¯†ä¸º <code>action</code>ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨ä¸Šè¿°çš„ API ä»¥å¤šç§æ–¹å¼å®ç°è¿™ä¸€ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨å¤„ç† Promise æ—¶ï¼Œæ›´æ–° state çš„å¤„ç†ç¨‹åºåº”è¯¥è¢« <code>action</code> åŒ…è£…èµ·æ¥ï¼Œæˆ–è€…è¢«æ ‡è®°ä¸º actionsï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title class_">Promise</span> çš„å†³è®®å¤„ç†ç¨‹åºæ˜¯æˆ‘ä»¬ä»¥å†…è”çš„æ–¹å¼å¤„ç†çš„ï¼Œä½†æ˜¯ä¼šåœ¨ä¸€å¼€å§‹çš„ action æ‰§è¡Œå®Œæˆä¹‹åè¿è¡Œï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ action å¯¹å®ƒä»¬è¿›è¡ŒåŒ…è£…ï¼š<span class="hljs-keyword">import</span> &#123; action, makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Store</span> &#123;    githubProjects = []    state = <span class="hljs-string">&quot;pending&quot;</span> <span class="hljs-comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-title function_">fetchProjects</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = []        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;pending&quot;</span>        <span class="hljs-title function_">fetchGithubProjectsSomehow</span>().<span class="hljs-title function_">then</span>(            <span class="hljs-title function_">action</span>(<span class="hljs-string">&quot;fetchSuccess&quot;</span>, <span class="hljs-function"><span class="hljs-params">projects</span> =&gt;</span> &#123;                <span class="hljs-keyword">const</span> filteredProjects = <span class="hljs-title function_">somePreprocessing</span>(projects)                <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = filteredProjects                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;done&quot;</span>            &#125;),            <span class="hljs-title function_">action</span>(<span class="hljs-string">&quot;fetchError&quot;</span>, <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;error&quot;</span>            &#125;)        )    &#125;&#125;</code></pre></div><p>å¦‚æœ Promise çš„å¤„ç†å‡½æ•°æ˜¯ç±»çš„å­—æ®µï¼Œå®ƒä»¬å°†ç”± <code>makeAutoObservable</code> è‡ªåŠ¨åŒ…è£…ä¸º <code>action</code>ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Store</span> &#123;    githubProjects = []    state = <span class="hljs-string">&quot;pending&quot;</span> <span class="hljs-comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-title function_">fetchProjects</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = []        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;pending&quot;</span>        <span class="hljs-title function_">fetchGithubProjectsSomehow</span>().<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">projectsFetchSuccess</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">projectsFetchFailure</span>)    &#125;    projectsFetchSuccess = <span class="hljs-function"><span class="hljs-params">projects</span> =&gt;</span> &#123;        <span class="hljs-keyword">const</span> filteredProjects = <span class="hljs-title function_">somePreprocessing</span>(projects)        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = filteredProjects        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;done&quot;</span>    &#125;    projectsFetchFailure = <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;error&quot;</span>    &#125;&#125;</code></pre></div><p><code>await</code> ä¹‹åçš„ä»»ä½•æ“ä½œéƒ½ä¸ä¸å…¶åŒåœ¨ä¸€ä¸ª tick ä¸­ï¼Œå› æ­¤å®ƒä»¬éœ€è¦ä½¿ç”¨ action åŒ…è£…ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>runInAction</code>ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; runInAction, makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Store</span> &#123;    githubProjects = []    state = <span class="hljs-string">&quot;pending&quot;</span> <span class="hljs-comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchProjects</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = []        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;pending&quot;</span>        <span class="hljs-keyword">try</span> &#123;            <span class="hljs-keyword">const</span> projects = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchGithubProjectsSomehow</span>()            <span class="hljs-keyword">const</span> filteredProjects = <span class="hljs-title function_">somePreprocessing</span>(projects)            <span class="hljs-title function_">runInAction</span>(<span class="hljs-function">() =&gt;</span> &#123;                <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = filteredProjects                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;done&quot;</span>            &#125;)        &#125; <span class="hljs-keyword">catch</span> (e) &#123;            <span class="hljs-title function_">runInAction</span>(<span class="hljs-function">() =&gt;</span> &#123;                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;error&quot;</span>            &#125;)        &#125;    &#125;&#125;</code></pre></div><p>ä½¿ç”¨flow+generator</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; flow, makeAutoObservable, flowResult &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Store</span> &#123;    githubProjects = []    state = <span class="hljs-string">&quot;pending&quot;</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">fetchProjects</span>: flow        &#125;)    &#125;    <span class="hljs-comment">// æ³¨æ„æ˜Ÿå·, è¿™æ˜¯ä¸€ä¸ª generator å‡½æ•°!</span>    *<span class="hljs-title function_">fetchProjects</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = []        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;pending&quot;</span>        <span class="hljs-keyword">try</span> &#123;            <span class="hljs-comment">// Yield ä»£æ›¿ await.</span>            <span class="hljs-keyword">const</span> projects = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">fetchGithubProjectsSomehow</span>()            <span class="hljs-keyword">const</span> filteredProjects = <span class="hljs-title function_">somePreprocessing</span>(projects)            <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;done&quot;</span>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = filteredProjects        &#125; <span class="hljs-keyword">catch</span> (error) &#123;            <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;error&quot;</span>        &#125;    &#125;&#125;<span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Store</span>()<span class="hljs-keyword">const</span> projects = <span class="hljs-keyword">await</span> <span class="hljs-title function_">flowResult</span>(store.<span class="hljs-title function_">fetchProjects</span>())</code></pre></div><h2 id="Computers"><a href="#Computers" class="headerlink" title="Computers"></a>Computers</h2><p>ä½¿ç”¨ï¼š</p><ul><li><code>computed</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li><li><code>computed(options)</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li><li><code>computed(fn, options?)</code></li></ul><p>è®¡ç®—å€¼å¯ä»¥ç”¨æ¥ä»å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ä¸­æ´¾ç”Ÿä¿¡æ¯ã€‚ è®¡ç®—å€¼é‡‡ç”¨æƒ°æ€§æ±‚å€¼ï¼Œä¼šç¼“å­˜å…¶è¾“å‡ºï¼Œå¹¶ä¸”åªæœ‰å½“å…¶ä¾èµ–çš„å¯è§‚å¯Ÿå¯¹è±¡è¢«æ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®—ã€‚ å®ƒä»¬åœ¨ä¸è¢«ä»»ä½•å€¼è§‚å¯Ÿæ—¶ä¼šè¢«æš‚æ—¶åœç”¨ã€‚</p><p>è®¡ç®—å€¼å¯ä»¥é€šè¿‡åœ¨ JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get">getters</a> ä¸Šæ·»åŠ  <code>computed</code> æ³¨è§£æ¥åˆ›å»ºã€‚ ä½¿ç”¨ <code>makeObservable</code> å°† getter å£°æ˜ä¸º computedã€‚æˆ–è€…å¦‚æœä½ å¸Œæœ›æ‰€æœ‰çš„ getters è¢«è‡ªåŠ¨å£°æ˜ä¸º <code>computed</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>makeAutoObservable</code>ï¼Œ<code>observable</code> æˆ–è€… <code>extendObservable</code></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, computed, autorun &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderLine</span> &#123;    price = <span class="hljs-number">0</span>    amount = <span class="hljs-number">1</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">price</span>) &#123;        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;            <span class="hljs-attr">price</span>: observable,            <span class="hljs-attr">amount</span>: observable,            <span class="hljs-attr">total</span>: computed        &#125;)        <span class="hljs-variable language_">this</span>.<span class="hljs-property">price</span> = price    &#125;    <span class="hljs-keyword">get</span> <span class="hljs-title function_">total</span>() &#123;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Computing...&quot;</span>)        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">price</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span>    &#125;&#125;<span class="hljs-keyword">const</span> order = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderLine</span>(<span class="hljs-number">0</span>)<span class="hljs-keyword">const</span> stop = <span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Total: &quot;</span> + order.<span class="hljs-property">total</span>)&#125;)<span class="hljs-comment">// Computing...</span><span class="hljs-comment">// Total: 0</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(order.<span class="hljs-property">total</span>)<span class="hljs-comment">// (ä¸ä¼šé‡æ–°è®¡ç®—!)</span><span class="hljs-comment">// 0</span>order.<span class="hljs-property">amount</span> = <span class="hljs-number">5</span><span class="hljs-comment">// Computing...</span><span class="hljs-comment">// (æ— éœ€ autorun)</span>order.<span class="hljs-property">price</span> = <span class="hljs-number">2</span><span class="hljs-comment">// Computing...</span><span class="hljs-comment">// Total: 10</span><span class="hljs-title function_">stop</span>()order.<span class="hljs-property">price</span> = <span class="hljs-number">3</span><span class="hljs-comment">// è®¡ç®—å€¼å’Œ autorun éƒ½ä¸ä¼šè¢«é‡æ–°è®¡ç®—.</span></code></pre></div><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœ <code>total</code> æ²¡æœ‰è¢«æ³¨è§£ï¼Œé‚£ä¹ˆ <code>autorun</code> ä¼šæŠŠå‰¯ä½œç”¨è¿è¡Œ 3 æ¬¡ï¼Œ å› ä¸ºå®ƒå°†ç›´æ¥ä¾èµ–äº <code>total</code> å’Œ <code>amount</code></p><p><img src="https://zh.mobx.js.org/assets/computed-example.png" alt="computed graph"></p><p>ä¸Šå›¾æ˜¯ä¸ºä»¥ä¸Šç¤ºä¾‹åˆ›å»ºçš„ä¾èµ–å›¾ã€‚</p><h3 id="è§„åˆ™"><a href="#è§„åˆ™" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h3><p>ä½¿ç”¨è®¡ç®—å€¼æ—¶ï¼Œè¯·éµå¾ªä¸‹é¢çš„æœ€ä½³å®è·µï¼š</p><ol><li>å®ƒä»¬ä¸åº”è¯¥æœ‰å‰¯ä½œç”¨æˆ–è€…æ›´æ–°å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ã€‚</li><li>é¿å…åˆ›å»ºå’Œè¿”å›æ–°çš„å¯è§‚å¯Ÿå¯¹è±¡ã€‚</li><li>å®ƒä»¬ä¸åº”è¯¥ä¾èµ–éå¯è§‚å¯Ÿå¯¹è±¡çš„å€¼</li></ol><h2 id="ä½¿ç”¨-reactions-å¤„ç†å‰¯ä½œç”¨-ğŸš€"><a href="#ä½¿ç”¨-reactions-å¤„ç†å‰¯ä½œç”¨-ğŸš€" class="headerlink" title="ä½¿ç”¨ reactions å¤„ç†å‰¯ä½œç”¨ {ğŸš€}"></a>ä½¿ç”¨ reactions å¤„ç†å‰¯ä½œç”¨ {ğŸš€}</h2><p>ä¸ºäº†ç†è§£ MobXï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•åˆ›å»º reactionsã€‚ æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨ <a href="https://zh.mobx.js.org/reactions.html#autorun"><code>autorun</code></a> å·¥å…·å‡½æ•°ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ <a href="https://zh.mobx.js.org/reactions.html#reaction"><code>reaction</code></a> å’Œ <a href="https://zh.mobx.js.org/reactions.html#when"><code>when</code></a></p><h3 id="Autorun"><a href="#Autorun" class="headerlink" title="Autorun"></a>Autorun</h3><p>ç”¨æ³•ï¼š</p><ul><li><code>autorun(effect: (reaction) =&gt; void)</code></li></ul><p><code>autorun</code> å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ¯å½“è¯¥å‡½æ•°æ‰€è§‚å¯Ÿçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒéƒ½åº”è¯¥è¿è¡Œã€‚ å½“ä½ è‡ªå·±åˆ›å»º <code>autorun</code> æ—¶ï¼Œå®ƒä¹Ÿä¼šè¿è¡Œä¸€æ¬¡ã€‚å®ƒä»…ä»…å¯¹å¯è§‚å¯ŸçŠ¶æ€çš„å˜åŒ–åšå‡ºå“åº”ï¼Œæ¯”å¦‚é‚£äº›ä½ ç”¨ <code>observable</code> æˆ–è€… <code>computed</code> æ³¨é‡Šçš„ã€‚</p><h3 id="tracking-å¦‚ä½•å·¥ä½œ"><a href="#tracking-å¦‚ä½•å·¥ä½œ" class="headerlink" title="tracking å¦‚ä½•å·¥ä½œ"></a>tracking å¦‚ä½•å·¥ä½œ</h3><p>Autorun é€šè¿‡åœ¨<em>å“åº”å¼ä¸Šä¸‹æ–‡</em>è¿è¡Œ <code>effect</code> æ¥å·¥ä½œã€‚åœ¨ç»™å®šçš„å‡½æ•°æ‰§è¡ŒæœŸé—´ï¼ŒMobX ä¼šæŒç»­è·Ÿè¸ªè¢« effect ç›´æ¥æˆ–é—´æ¥<em>è¯»å–</em>è¿‡çš„æ‰€æœ‰å¯è§‚å¯Ÿå¯¹è±¡å’Œè®¡ç®—å€¼ã€‚ ä¸€æ—¦å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼ŒMobX å°†æ”¶é›†å¹¶è®¢é˜…æ‰€æœ‰è¢«è¯»å–è¿‡çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå¹¶ç­‰å¾…å…¶ä¸­ä»»æ„ä¸€ä¸ªå†æ¬¡å‘ç”Ÿæ”¹å˜ã€‚ ä¸€æ—¦æœ‰æ”¹å˜å‘ç”Ÿï¼Œ<code>autorun</code> å°†ä¼šå†æ¬¡è§¦å‘ï¼Œé‡å¤æ•´ä¸ªè¿‡ç¨‹ã€‚</p><p><img src="https://zh.mobx.js.org/assets/autorun.png" alt="autorun"></p><p>è¿™å°±æ˜¯ä¸‹é¢çš„ç¤ºä¾‹çš„å·¥ä½œæ–¹å¼ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeAutoObservable, autorun &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;    name    energyLevel    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name        <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> = <span class="hljs-number">100</span>        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-title function_">reduceEnergy</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> -= <span class="hljs-number">10</span>    &#125;    <span class="hljs-keyword">get</span> <span class="hljs-title function_">isHungry</span>() &#123;        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> &lt; <span class="hljs-number">50</span>    &#125;&#125;<span class="hljs-keyword">const</span> giraffe = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">&quot;Gary&quot;</span>)<span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Energy level:&quot;</span>, giraffe.<span class="hljs-property">energyLevel</span>)&#125;)<span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (giraffe.<span class="hljs-property">isHungry</span>) &#123;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Now I&#x27;m hungry!&quot;</span>)    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;I&#x27;m not hungry!&quot;</span>)    &#125;&#125;)<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Now let&#x27;s change state!&quot;</span>)<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;    giraffe.<span class="hljs-title function_">reduceEnergy</span>()&#125;</code></pre></div><p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºï¼š</p><div class="code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">100</span><span class="hljs-attribute">I</span>&#x27;m not hungry!<span class="hljs-attribute">Now</span> let&#x27;s change state!<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">90</span><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">80</span><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">70</span><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">60</span><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">50</span><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">40</span><span class="hljs-attribute">Now</span> I&#x27;m hungry!<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">30</span><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">20</span><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">10</span><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">0</span></code></pre></div><p>autorunä¼šæ¯”è¾ƒå‰åå€¼æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¸ä¼šæ‰§è¡Œï¼Œå½“å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ‰ä¼šé‡æ–°æ‰§è¡Œ</p><h3 id="Reaction"><a href="#Reaction" class="headerlink" title="Reaction"></a>Reaction</h3><p>ç”¨æ³•ï¼š</p><ul><li><code>reaction(() =&gt; value, (value, previousValue, reaction) =&gt; &#123; sideEffect &#125;, options?)</code>.</li></ul><p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯æŒ‡éœ€è¦ç›‘å¬é‚£ä¸ªstateçš„å˜åŒ–ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“æ•°æ®å˜åŒ–çš„æ—¶å€™éœ€è¦æ‰§è¡Œçš„å‡½æ•°ï¼Œreaction</p><p>å’Œautorunæ¯”è¾ƒï¼Œautorunæ˜¯é’ˆå¯¹æ‰€æœ‰çš„stateï¼Œreactionæ˜¯é’ˆå¯¹ç‰¹å®šçš„stateï¼Œè€Œä¸”reactionåœ¨åˆå§‹åŒ–ï¼Œä¸ä¼šæ‰§è¡Œï¼Œåªæœ‰åœ¨state</p><p>å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šæ‰§è¡Œ</p><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œreaction åªä¼šåœ¨ <code>isHungry</code> å‘ç”Ÿæ”¹å˜æ—¶è¢«è§¦å‘ä¸€æ¬¡ã€‚ åœ¨ <em>effect</em> å‡½æ•°ä¸­ä½¿ç”¨çš„ <code>giraffe.energyLevel</code> çš„æ›´æ”¹ï¼Œå¹¶ä¸ä¼šè§¦å‘ <em>effect</em> å‡½æ•°ã€‚å¦‚æœä½ æƒ³è¦ <code>reaction</code> ä¹Ÿå¯¹è¿™ä¸ªå€¼çš„å˜åŒ–åšå‡ºååº”ï¼Œ ä½ éœ€è¦åœ¨ <em>data</em> å‡½æ•°ä¸­è®¿é—®å¹¶è¿”å›å®ƒã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; makeAutoObservable, reaction &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;    name    energyLevel    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name        <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> = <span class="hljs-number">100</span>        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-title function_">reduceEnergy</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> -= <span class="hljs-number">10</span>    &#125;    <span class="hljs-keyword">get</span> <span class="hljs-title function_">isHungry</span>() &#123;        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> &lt; <span class="hljs-number">50</span>    &#125;&#125;<span class="hljs-keyword">const</span> giraffe = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">&quot;Gary&quot;</span>)<span class="hljs-title function_">reaction</span>(    <span class="hljs-function">() =&gt;</span> giraffe.<span class="hljs-property">isHungry</span>,    <span class="hljs-function"><span class="hljs-params">isHungry</span> =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (isHungry) &#123;            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Now I&#x27;m hungry!&quot;</span>)        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;I&#x27;m not hungry!&quot;</span>)        &#125;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Energy level:&quot;</span>, giraffe.<span class="hljs-property">energyLevel</span>)    &#125;)<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Now let&#x27;s change state!&quot;</span>)<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;    giraffe.<span class="hljs-title function_">reduceEnergy</span>()&#125;</code></pre></div><p>è¾“å‡ºï¼š</p><div class="code-wrapper"><pre><code class="hljs pf">Now let&#x27;s change <span class="hljs-keyword">state</span>!Now I&#x27;m hungry!Energy level: <span class="hljs-number">40</span></code></pre></div><h3 id="When"><a href="#When" class="headerlink" title="When"></a>When</h3><p>ä½¿ç”¨ï¼š</p><ul><li><code>when(predicate: () =&gt; boolean, effect?: () =&gt; void, options?)</code></li><li><code>when(predicate: () =&gt; boolean, options?): Promise</code></li></ul><p><code>when</code> ä¼šè§‚å¯Ÿå¹¶è¿è¡Œç»™å®šçš„ <em>predicate</em> å‡½æ•°ï¼Œç›´åˆ°å…¶è¿”å› <code>true</code>ã€‚ ä¸€æ—¦ predicate è¿”å›äº† trueï¼Œç»™å®šçš„ <em>effect</em> å‡½æ•°å°±ä¼šæ‰§è¡Œå¹¶ä¸”è‡ªåŠ¨æ‰§è¡Œå™¨å‡½æ•°å°†ä¼šè¢«æ¸…ç†æ‰ã€‚</p><p>å¦‚æœä½ æ²¡æœ‰ä¼ å…¥ <code>effect</code> å‡½æ•°ï¼Œ<code>when</code> å‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code> ç±»å‹çš„ disposerï¼Œå¹¶å…è®¸ä½ æ‰‹åŠ¨å–æ¶ˆ</p><p><code>when</code> å¯¹äºä»¥å“åº”å¼çš„æ–¹å¼å°†å€¼æ¸…ç†æˆ–å–æ¶ˆæ‰ååˆ†æœ‰ç”¨ã€‚ ä¾‹å¦‚ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; when, makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyResource</span> &#123;    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>, &#123; <span class="hljs-attr">dispose</span>: <span class="hljs-literal">false</span> &#125;)        <span class="hljs-title function_">when</span>(            <span class="hljs-comment">// Once...</span>            <span class="hljs-function">() =&gt;</span> !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVisible</span>,            <span class="hljs-comment">// ... then.</span>            <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">dispose</span>()        )    &#125;    <span class="hljs-keyword">get</span> <span class="hljs-title function_">isVisible</span>() &#123;        <span class="hljs-comment">// è¡¨ç¤ºæ­¤é¡¹ç›®æ˜¯å¦å¯è§.</span>    &#125;    <span class="hljs-title function_">dispose</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-comment">// æ¸…ç†ä¸€äº›èµ„æº.</span>    &#125;&#125;</code></pre></div><p>ä¸€æ—¦ <code>isVisible</code> å˜æˆ <code>false</code>ï¼Œ<code>dispose</code> æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼Œ å¹¶å¯¹ <code>MyResource</code> åšä¸€äº›æ¸…ç†æ“ä½œ</p><h3 id="await-when"><a href="#await-when" class="headerlink" title="await when(...)"></a><code>await when(...)</code></h3><p>å¦‚æœä½ æ²¡æœ‰æä¾› <code>effect</code> å‡½æ•°ï¼Œ<code>when</code> å°†ä¼šè¿”å›ä¸€ä¸ª <code>Promise</code>ã€‚è¿™æ ·ä¼šè·Ÿ <code>async / await</code> å¾ˆå¥½åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œè®©ä½ å¯ä»¥ç­‰å¾…å¯è§‚å¯Ÿå¯¹è±¡ä¸­çš„å˜åŒ–ã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">await</span> <span class="hljs-title function_">when</span>(<span class="hljs-function">() =&gt;</span> that.<span class="hljs-property">isVisible</span>)    <span class="hljs-comment">// etc...</span>&#125;</code></pre></div><p>å¦‚æœè¦æå‰å–æ¶ˆ <code>when</code>ï¼Œå¯ä»¥å¯¹å®ƒè¿”å›çš„ Promise è°ƒç”¨ <code>.cancel()</code> å‡½æ•°ã€‚</p><h4 id="è§„åˆ™-1"><a href="#è§„åˆ™-1" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h4><p>è¿™é‡Œæ˜¯ä¸€äº› reactive context éœ€è¦éµå®ˆçš„è§„åˆ™ï¼š</p><ol><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå¯è§‚å¯Ÿå¯¹è±¡å‘ç”Ÿäº†æ”¹å˜ï¼Œå—å…¶å½±å“çš„ reactions ä¼šç«‹å³ï¼ˆåŒæ­¥ï¼‰è¿è¡Œã€‚ç„¶è€Œï¼Œå®ƒä»¬ç›´åˆ°å½“å‰æœ€å¤–å±‚çš„ (trans)action æ‰§è¡Œç»“æŸåæ‰ä¼šè¿è¡Œã€‚</li><li>autorun åªä¼šè·Ÿè¸ªç»™å®šå‡½æ•°åœ¨åŒæ­¥æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œä¸ä¼šè·Ÿè¸ªå¼‚æ­¥å‘ç”Ÿçš„å˜åŒ–ã€‚</li><li>autorun ä¸ä¼šè·Ÿè¸ªè¢«å…¶è°ƒç”¨çš„ action æ‰€è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå› ä¸º action å§‹ç»ˆ<em>ä¸ä¼šè¢«è¿½è¸ª</em>ã€‚</li></ol><h3 id="Always-dispose-of-reactions"><a href="#Always-dispose-of-reactions" class="headerlink" title="Always dispose of reactions"></a>Always dispose of reactions</h3><p>ä¼ é€’ç»™ <code>autorun</code>ï¼Œ<code>reaction</code> å’Œ <code>when</code> çš„å‡½æ•°åªæœ‰åœ¨å®ƒä»¬è§‚å¯Ÿçš„æ‰€æœ‰å¯¹è±¡éƒ½è¢« GC ä¹‹åæ‰ä¼šè¢« GCã€‚åŸåˆ™ä¸Šï¼Œå®ƒä»¬ä¸€ç›´ç­‰å¾…å¯è§‚å¯Ÿå¯¹è±¡å‘ç”Ÿæ–°çš„å˜åŒ–ã€‚ ä¸ºäº†é˜»æ­¢ reactions æ°¸è¿œåœ°ç­‰å¾…ä¸‹å»ï¼Œå®ƒä»¬æ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ª disposer å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥ç”¨æ¥åœæ­¢æ‰§è¡Œå¹¶ä¸”å–æ¶ˆè®¢é˜…æ‰€ä½¿ç”¨çš„ä»»ä½•å¯è§‚å¯Ÿå¯¹è±¡</p><div class="code-wrapper"><pre><code class="hljs arcade">const counter = observable(&#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;)<span class="hljs-comment">// åˆå§‹åŒ–ä¸€ä¸ª autorun å¹¶ä¸”æ‰“å° 0.</span>const disposer = autorun(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(counter.<span class="hljs-built_in">count</span>)&#125;)<span class="hljs-comment">// æ‰“å°: 1</span>counter.<span class="hljs-built_in">count</span>++<span class="hljs-comment">// åœæ­¢ autorun.</span>disposer()<span class="hljs-comment">// ä¸ä¼šæ‰“å°æ¶ˆæ¯.</span>counter.<span class="hljs-built_in">count</span>++</code></pre></div><p>æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ï¼Œä¸€æ—¦ä¸å†éœ€è¦è¿™äº›æ–¹æ³•ä¸­çš„å‰¯ä½œç”¨æ—¶ï¼Œè¯·åŠ¡å¿…è°ƒç”¨å®ƒä»¬æ‰€è¿”å›çš„ disposer å‡½æ•°ã€‚ å¦åˆ™å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p><p><code>reaction</code> å’Œ <code>autorun</code> ä¸­ effect å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° <code>reaction</code> ä¹Ÿå¯ä»¥è¢«ç”¨æ¥æå‰æŠŠ reaction æ¸…ç†æ‰ï¼ˆé€šè¿‡è°ƒç”¨ <code>reaction.dispose()</code>ï¼‰ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vat</span> &#123;    value = <span class="hljs-number">1.2</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)    &#125;&#125;<span class="hljs-keyword">const</span> vat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vat</span>()<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderLine</span> &#123;    price = <span class="hljs-number">10</span>    amount = <span class="hljs-number">1</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)        <span class="hljs-comment">// è¿™ä¸ª autorun å°†ä¼šå’Œæœ¬ OrderLine å®ä¾‹ä¸€èµ·è¿›è¡Œ GC,</span>        <span class="hljs-comment">// å› ä¸ºå®ƒåªä½¿ç”¨äº†æ¥è‡ª `this` çš„å¯è§‚å¯Ÿå¯¹è±¡.</span>        <span class="hljs-comment">// æ‰€ä»¥ä¸ä¸€å®šéè¦åœ¨åˆ é™¤ OrderLine å®ä¾‹åç«‹åˆ»æŠŠå®ƒæ¸…ç†æ‰ã€‚</span>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">disposer1</span> = <span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">price</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span>)        &#125;)        <span class="hljs-comment">// è¿™ä¸ª autorun å°†ä¸ä¼šå’Œæœ¬ OrderLine å®ä¾‹ä¸€èµ·è¿›è¡Œ GC,</span>        <span class="hljs-comment">// å› ä¸º vat ä¿å­˜äº†å¯¹è¿™ä¸ª autorun çš„å¼•ç”¨ç”¨äºé€šçŸ¥æ”¹å˜,</span>        <span class="hljs-comment">// è¿™æ ·åè¿‡æ¥åˆä¼šæŠŠ &#x27;this&#x27; ä¿å­˜åœ¨ä½œç”¨åŸŸä¸­ã€‚</span>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">disposer2</span> = <span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">price</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span> * vat.<span class="hljs-property">value</span>)        &#125;)    &#125;    <span class="hljs-title function_">dispose</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-comment">// æ‰€ä»¥, ä¸ºäº†é¿å…å†…å­˜é—®é¢˜, å½“ä¸å†éœ€è¦ reactions ä¹‹å</span>        <span class="hljs-comment">// åŠ¡å¿…è¦è°ƒç”¨ disposers.</span>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">disposer1</span>()        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">disposer2</span>()    &#125;&#125;</code></pre></div><h2 id="è°¨æ…åœ°ä½¿ç”¨-reactionsï¼"><a href="#è°¨æ…åœ°ä½¿ç”¨-reactionsï¼" class="headerlink" title="è°¨æ…åœ°ä½¿ç”¨ reactionsï¼"></a>è°¨æ…åœ°ä½¿ç”¨ reactionsï¼</h2><p>å°±åƒä¸Šé¢å·²ç»è¯´è¿‡çš„é‚£æ ·ï¼Œä½ ä¸ä¼šç»å¸¸åˆ›å»º reactionsã€‚ å¾ˆæœ‰å¯èƒ½ä½ çš„åº”ç”¨ç¨‹åºä¸ä¼šç›´æ¥ä½¿ç”¨è¿™äº› API ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œè€Œåªä¼šé€šè¿‡æ¯”å¦‚ä½¿ç”¨ mobx-react ç»‘å®šä¸­çš„ <code>observer</code> è¿™æ ·é—´æ¥çš„æ–¹å¼åˆ›å»ºå‡º reactionã€‚</p><p>åœ¨ä½ åˆ›å»º reaction ä¹‹å‰ï¼Œæœ€å¥½æ£€æŸ¥ä¸€ä¸‹å®ƒæ˜¯å¦ç¬¦åˆä¸‹é¢å‡ æ¡åŸåˆ™ï¼š</p><ol><li><strong>åªæœ‰åœ¨å¼•èµ·å‰¯ä½œç”¨çš„ä¸€æ–¹ä¸å‰¯ä½œç”¨ä¹‹é—´æ²¡æœ‰ç›´æ¥å…³ç³»çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨ reaction</strong>ï¼š å¦‚æœä¸€ä¸ªå‰¯ä½œç”¨ä¼šä¸ºäº†å“åº”å¾ˆå°çš„ä¸€ç»„ events æˆ– actions è€Œæ‰§è¡Œï¼Œé‚£ä¹ˆç›´æ¥ä»é‚£äº›ç‰¹å®šçš„ action ä¸­è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨é€šå¸¸ä¼šæ›´å®¹æ˜“ç†è§£ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŒ‰ä¸‹è¡¨å•æäº¤æŒ‰é’®ä¼šå¯¼è‡´ä¸€ä¸ª POST ç½‘ç»œè¯·æ±‚çš„å‘é€ï¼Œé‚£ä¹ˆä¸ºäº†å“åº” <code>onclick</code> äº‹ä»¶ï¼Œç›´æ¥è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨å°±ä¼šæ¯”é€šè¿‡ reaction é—´æ¥è§¦å‘æ›´å®¹æ˜“ç†è§£ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœä½ å¯¹è¡¨å•çŠ¶æ€çš„ä¸€åˆ‡ä¿®æ”¹æœ€åéƒ½ä¼šè¢«è‡ªåŠ¨å­˜å‚¨åˆ° localStorageï¼Œé‚£ä¹ˆä½¿ç”¨ä¸€ä¸ª reaction å¯èƒ½å°±ä¼šå¾ˆæœ‰å¸®åŠ©ï¼Œè¿™æ ·ä½ å°±ä¸ç”¨åœ¨æ¯ä¸ªç‹¬ç«‹çš„ <code>onChange</code> äº‹ä»¶ä¸­è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨äº†ã€‚</li><li><strong>reactions ä¸åº”è¯¥æ›´æ–°å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡</strong>ï¼šè¿™ä¸ª reaction æ˜¯å¦ä¼šä¿®æ”¹å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ï¼Ÿå¦‚æœç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œé‚£ä¹ˆä½ ä¸€èˆ¬åº”è¯¥æŠŠä½ æƒ³è¦æ›´æ–°çš„å¯è§‚å¯Ÿå¯¹è±¡æ³¨è§£ä¸º <a href="https://zh.mobx.js.org/computeds.html"><code>computed</code></a> å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå¾…åŠäº‹é¡¹çš„é›†åˆ <code>todos</code> å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆè¯·ä¸è¦ä½¿ç”¨ reaction æ¥è®¡ç®—å‰©ä½™å¾…åŠ <code>remainingTodos</code> çš„æ•°é‡ï¼Œè€Œè¦æŠŠ <code>remainingTodos</code> æ³¨è§£ä¸ºè®¡ç®—å€¼ã€‚è¿™å°†ä½¿å¾—ä»£ç æ›´å®¹æ˜“ç†è§£å’Œè°ƒè¯•ã€‚reaction ä¸åº”è¯¥è®¡ç®—ç”Ÿæˆæ–°çš„æ•°æ®ï¼Œè€Œåªåº”è¯¥è§¦å‘å‰¯ä½œç”¨ã€‚</li><li><strong>reactions åº”è¯¥æ˜¯ç‹¬ç«‹çš„</strong>ï¼šä½ çš„ä»£ç æ˜¯å¦ä¾èµ–å…¶ä»–å¿…é¡»é¦–å…ˆè¿è¡Œçš„ reactionï¼Ÿå¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œä½ å¯èƒ½è¿åäº†ç¬¬ä¸€æ¡è§„åˆ™ï¼Œ ä½ å¯ä»¥é€‰æ‹©å°†ä½ éœ€è¦åˆ›å»ºçš„æ–° reaction åˆå¹¶åˆ°å®ƒæ‰€ä¾èµ– reaction ä¸­ã€‚MobX å¹¶ä¸èƒ½ä¿è¯ reaction çš„æ‰§è¡Œé¡ºåºã€‚</li></ol><p>æœ‰äº›å®è·µå¹¶ä¸ç¬¦åˆä¸Šè¿°åŸåˆ™ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä»¬æ˜¯<em>åŸåˆ™</em>ï¼Œè€Œä¸æ˜¯<em>æ³•åˆ™</em>ã€‚ ä½†æ˜¯ï¼Œä¾‹å¤–æƒ…å†µå¾ˆå°‘è§ï¼Œåªæœ‰åœ¨ä¸‡ä¸å¾—å·²çš„æƒ…å†µä¸‹æ‰è¿åå®ƒä»¬ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>react</category>
      
      <category>mobx</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>jestå¸¸è§é—®é¢˜è§£æ</title>
    <link href="/2022/09/19/jest%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90/"/>
    <url>/2022/09/19/jest%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h4 id="jest-â€˜beforeEachâ€™-is-not-defined-eslint-no-undef"><a href="#jest-â€˜beforeEachâ€™-is-not-defined-eslint-no-undef" class="headerlink" title="##jest â€˜beforeEachâ€™ is not defined .eslint no-undef"></a>##jest â€˜beforeEachâ€™ is not defined .eslint no-undef</h4><p><img src="https://img1.imgtp.com/2022/09/19/mkE2sSaP.png" alt="QQæˆªå›¾20220919211238.png"></p><p>éœ€è¦åœ¨.eslintrcæ–‡ä»¶åŠ ä¸Šè¿™ä¸€æ®µ</p><div class="code-wrapper"><pre><code class="hljs prolog">&#123;  <span class="hljs-string">&quot;overrides&quot;</span>: [    &#123;      <span class="hljs-string">&quot;files&quot;</span>: [        <span class="hljs-string">&quot;**/*.spec.js&quot;</span>,        <span class="hljs-string">&quot;**/*.spec.jsx&quot;</span>      ],      <span class="hljs-string">&quot;env&quot;</span>: &#123;        <span class="hljs-string">&quot;jest&quot;</span>: true      &#125;    &#125;  ]&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å•å…ƒæµ‹è¯•</category>
      
      <category>jest</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰ç¬¬å…­ç« é“¾è¡¨</title>
    <link href="/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E5%85%AD%E7%AB%A0%E9%93%BE%E8%A1%A8/"/>
    <url>/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E5%85%AD%E7%AB%A0%E9%93%BE%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰ç¬¬äº”ç«  é˜Ÿåˆ—ä¸åŒç«¯é˜Ÿåˆ—</title>
    <link href="/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E4%BA%94%E7%AB%A0-%E9%98%9F%E5%88%97%E4%B8%8E%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/"/>
    <url>/2022/09/17/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E7%AC%AC%E4%BA%94%E7%AB%A0-%E9%98%9F%E5%88%97%E4%B8%8E%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/</url>
    
    <content type="html"><![CDATA[<h4 id="é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—" class="headerlink" title="##é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—"></a>##é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Queue</span> &#123;  <span class="hljs-comment">/**</span><span class="hljs-comment">   * é¦–å…ˆéœ€è¦ä¸€ä¸ªç”¨äºå­˜å‚¨é˜Ÿåˆ—ä¸­å…ƒç´ çš„æ•°æ®ç»“æ„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„ï¼Œå°±åƒä¸Šä¸€ç« çš„ Stack</span><span class="hljs-comment">ç±»é‚£æ ·ã€‚ä½†æ˜¯ï¼Œä¸ºäº†å†™å‡ºä¸€ä¸ªåœ¨è·å–å…ƒç´ æ—¶æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡æ¥å­˜å‚¨æˆ‘ä»¬</span><span class="hljs-comment">çš„å…ƒç´ ï¼ˆè¡Œ&#123;3&#125;ï¼‰ã€‚ä½ ä¼šå‘ç° Queue ç±»å’Œ Stack ç±»éå¸¸ç±»ä¼¼ï¼Œåªæ˜¯æ·»åŠ å’Œç§»é™¤å…ƒç´ çš„åŸåˆ™ä¸åŒ</span><span class="hljs-comment">ä¹Ÿå¯ä»¥å£°æ˜ä¸€ä¸ª count å±æ€§æ¥å¸®åŠ©æˆ‘ä»¬æ§åˆ¶é˜Ÿåˆ—çš„å¤§å°ï¼ˆè¡Œ&#123;1&#125;ï¼‰ã€‚æ­¤å¤–ï¼Œç”±äºæˆ‘ä»¬å°†è¦ä»é˜Ÿ</span><span class="hljs-comment">åˆ—å‰ç«¯ç§»é™¤å…ƒç´ ï¼ŒåŒæ ·éœ€è¦ä¸€ä¸ªå˜é‡æ¥å¸®åŠ©æˆ‘ä»¬è¿½è¸ªç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å› æ­¤ï¼Œå£°æ˜ä¸€ä¸ª lowestCount</span><span class="hljs-comment">å˜é‡ï¼ˆè¡Œ&#123;2&#125;ï¼‰</span><span class="hljs-comment">   */</span>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> = <span class="hljs-number">0</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = &#123;&#125;;  &#125;  <span class="hljs-comment">// å‘é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰æ–°çš„é¡¹</span>  <span class="hljs-title function_">enqueue</span>(<span class="hljs-params">...elements</span>) &#123;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; elements.<span class="hljs-property">length</span>; i++) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>] = elements[i];      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;    &#125;  &#125;  <span class="hljs-comment">// ç§»é™¤é˜Ÿåˆ—çš„ç¬¬ä¸€é¡¹ï¼ˆå³æ’åœ¨é˜Ÿåˆ—æœ€å‰é¢çš„é¡¹ï¼‰å¹¶è¿”å›è¢«ç§»é™¤çš„å…ƒç´ </span>  <span class="hljs-title function_">dequeue</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;    &#125;    <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>];    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>++;    <span class="hljs-keyword">return</span> result;  &#125;  <span class="hljs-comment">// è¿”å›é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ â€”â€”æœ€å…ˆè¢«æ·»åŠ ï¼Œä¹Ÿå°†æ˜¯æœ€å…ˆè¢«ç§»é™¤çš„å…ƒç´ ã€‚é˜Ÿåˆ—ä¸åš</span>  <span class="hljs-comment">// ä»»ä½•å˜åŠ¨ï¼ˆä¸ç§»é™¤å…ƒç´ ï¼Œåªè¿”å›å…ƒç´ ä¿¡æ¯â€”â€”ä¸ Stack ç±»çš„ peek æ–¹æ³•éå¸¸ç±»ä¼¼ï¼‰ã€‚è¯¥æ–¹</span>  <span class="hljs-comment">// æ³•åœ¨å…¶ä»–è¯­è¨€ä¸­ä¹Ÿå¯ä»¥å«ä½œ front æ–¹æ³•</span>  <span class="hljs-title function_">peek</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>];  &#125;  <span class="hljs-comment">// å¦‚æœé˜Ÿåˆ—ä¸­ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› false</span>  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> === <span class="hljs-number">0</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;  &#125;  <span class="hljs-comment">// è¿”å›é˜Ÿåˆ—åŒ…å«çš„å…ƒç´ ä¸ªæ•°ï¼Œä¸æ•°ç»„çš„ length å±æ€§ç±»ä¼¼</span>  <span class="hljs-title function_">size</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>;  &#125;  <span class="hljs-title function_">clear</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> = <span class="hljs-number">0</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = &#123;&#125;;  &#125;  <span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;&quot;</span>;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> str;    &#125;    str = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> + <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>; i++) &#123;      str += <span class="hljs-string">`,<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.items[i]&#125;</span>`</span>;    &#125;    <span class="hljs-keyword">return</span> str;  &#125;&#125;<span class="hljs-comment">// const queue = new Queue();</span><span class="hljs-comment">// console.log(queue.isEmpty()); // è¾“å‡º true</span><span class="hljs-comment">// queue.enqueue(&quot;John&quot;);</span><span class="hljs-comment">// queue.enqueue(&quot;Jack&quot;);</span><span class="hljs-comment">// console.log(queue.toString()); // John,Jack</span><span class="hljs-comment">// queue.enqueue(&quot;Camila&quot;);</span><span class="hljs-comment">// console.log(queue.toString()); // John, Jack, Camila</span><span class="hljs-comment">// console.log(queue.size()); // è¾“å‡º 3</span><span class="hljs-comment">// console.log(queue.isEmpty()); // è¾“å‡º false</span><span class="hljs-comment">// queue.dequeue(); // ç§»é™¤ John</span><span class="hljs-comment">// queue.dequeue(); // ç§»é™¤ Jack</span><span class="hljs-comment">// console.log(queue.toString()); // Camila</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Queue</span>;</code></pre></div><h4 id="åŒç«¯é˜Ÿåˆ—æ•°æ®ç»“æ„"><a href="#åŒç«¯é˜Ÿåˆ—æ•°æ®ç»“æ„" class="headerlink" title="åŒç«¯é˜Ÿåˆ—æ•°æ®ç»“æ„"></a>åŒç«¯é˜Ÿåˆ—æ•°æ®ç»“æ„</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Deque</span> &#123;  <span class="hljs-comment">// åŒç«¯é˜Ÿåˆ—ï¼Œéµå¾ªå…ˆè¿›å…ˆå‡ºå’Œåè¿›å…ˆå‡º</span>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = &#123;&#125;;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> = <span class="hljs-number">0</span>;  &#125;  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> === <span class="hljs-number">0</span>;  &#125;  <span class="hljs-title function_">clear</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = &#123;&#125;;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> = <span class="hljs-number">0</span>;  &#125;  <span class="hljs-title function_">size</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>;  &#125;  <span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;&quot;</span>;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> str;    &#125;    str = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> + <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>; i++) &#123;      str += <span class="hljs-string">`,<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.items[i]&#125;</span>`</span>;    &#125;    <span class="hljs-keyword">return</span> str;  &#125;  <span class="hljs-comment">// è¯¥æ–¹æ³•åœ¨åŒç«¯é˜Ÿåˆ—å‰ç«¯æ·»åŠ æ–°çš„å…ƒç´ </span>  <span class="hljs-title function_">addFront</span>(<span class="hljs-params">element</span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addBack</span>(element);    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> &gt; <span class="hljs-number">0</span>) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>--;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>] = element;    &#125; <span class="hljs-keyword">else</span> &#123;      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>; i &gt; <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[i] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[i - <span class="hljs-number">1</span>];      &#125;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-number">0</span>] = element;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span> = <span class="hljs-number">0</span>;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;    &#125;  &#125;  <span class="hljs-comment">// è¯¥æ–¹æ³•åœ¨åŒç«¯é˜Ÿåˆ—åç«¯æ·»åŠ æ–°çš„å…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Queue ç±»ä¸­çš„enqueue æ–¹æ³•ç›¸åŒï¼‰</span>  <span class="hljs-title function_">addBack</span>(<span class="hljs-params">element</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>] = element;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;  &#125;  <span class="hljs-comment">// è¯¥æ–¹æ³•ä¼šä»åŒç«¯é˜Ÿåˆ—å‰ç«¯ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Queue ç±»ä¸­çš„dequeue æ–¹æ³•ç›¸åŒï¼‰</span>  <span class="hljs-title function_">removeFront</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;    &#125;    <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>];    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>++;    <span class="hljs-keyword">return</span> result;  &#125;  <span class="hljs-comment">//è¯¥æ–¹æ³•ä¼šä»åŒç«¯é˜Ÿåˆ—åç«¯ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Stack ç±»ä¸­çš„pop æ–¹æ³•ä¸€æ ·ï¼‰ã€‚</span>  <span class="hljs-title function_">removeBack</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;    &#125;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;    <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>];    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>];    <span class="hljs-keyword">return</span> result;  &#125;  <span class="hljs-comment">// è¯¥æ–¹æ³•è¿”å›åŒç«¯é˜Ÿåˆ—å‰ç«¯çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Queue ç±»ä¸­çš„ peekæ–¹æ³•ä¸€æ ·ï¼‰ã€‚</span>  <span class="hljs-title function_">peekFront</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">lowestCount</span>];  &#125;  <span class="hljs-comment">// è¯¥æ–¹æ³•è¿”å›åŒç«¯é˜Ÿåˆ—åç«¯çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå®ç°æ–¹æ³•å’Œ Stack ç±»ä¸­çš„ peekæ–¹æ³•ä¸€æ ·ï¼‰</span>  <span class="hljs-title function_">peekBack</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>];  &#125;&#125;<span class="hljs-comment">// const deque = new Deque();</span><span class="hljs-comment">// console.log(deque.isEmpty()); // è¾“å‡º true</span><span class="hljs-comment">// deque.addBack(&quot;John&quot;);</span><span class="hljs-comment">// deque.addBack(&quot;Jack&quot;);</span><span class="hljs-comment">// console.log(deque.toString()); // John, Jack</span><span class="hljs-comment">// deque.addBack(&quot;Camila&quot;);</span><span class="hljs-comment">// console.log(deque.toString()); // John, Jack, Camila</span><span class="hljs-comment">// console.log(deque.size()); // è¾“å‡º 3</span><span class="hljs-comment">// console.log(deque.isEmpty()); // è¾“å‡º false</span><span class="hljs-comment">// deque.removeFront(); // ç§»é™¤ John</span><span class="hljs-comment">// console.log(deque.toString()); // Jack, Camila</span><span class="hljs-comment">// deque.removeBack(); // Camila å†³å®šç¦»å¼€</span><span class="hljs-comment">// console.log(deque.toString()); // Jack</span><span class="hljs-comment">// deque.addFront(&quot;John&quot;); // John å›æ¥è¯¢é—®ä¸€äº›ä¿¡æ¯</span><span class="hljs-comment">// console.log(deque.toString()); // John, Jack</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Deque</span>;</code></pre></div><h4 id="ä½¿ç”¨é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—æ¥è§£å†³é—®é¢˜"><a href="#ä½¿ç”¨é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—æ¥è§£å†³é—®é¢˜" class="headerlink" title="ä½¿ç”¨é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—æ¥è§£å†³é—®é¢˜"></a>ä½¿ç”¨é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—æ¥è§£å†³é—®é¢˜</h4><h5 id="å¾ªç¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±æ¸¸æˆ"><a href="#å¾ªç¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±æ¸¸æˆ" class="headerlink" title="å¾ªç¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±æ¸¸æˆ"></a>å¾ªç¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±æ¸¸æˆ</h5><p>è¿™å…¶ä¸­çš„ä¸€ç§å«ä½œå¾ªç¯é˜Ÿåˆ—ã€‚å¾ªç¯é˜Ÿåˆ—çš„ä¸€ä¸ªä¾‹å­å°±æ˜¯å‡»é¼“ä¼ èŠ±æ¸¸æˆï¼ˆhot  potatoï¼‰ã€‚åœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œå­©å­ä»¬å›´æˆä¸€ä¸ªåœ†åœˆï¼ŒæŠŠèŠ±å°½å¿«åœ°ä¼ é€’ç»™æ—è¾¹çš„äººã€‚æŸä¸€æ—¶åˆ»ä¼ èŠ±åœæ­¢ï¼Œ è¿™ä¸ªæ—¶å€™èŠ±åœ¨è°æ‰‹é‡Œï¼Œè°å°±é€€å‡ºåœ†åœˆã€ç»“æŸæ¸¸æˆã€‚é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°åªå‰©ä¸€ä¸ªå­©å­ï¼ˆèƒœè€…ï¼‰ã€‚</p><p>å®ç°ä¸€ä¸ªæ¨¡æ‹Ÿçš„å‡»é¼“ä¼ èŠ±æ¸¸æˆï¼Œè¦ç”¨åˆ°æœ¬ç« å¼€å¤´å®ç°çš„ Queue ç±»ï¼ˆè¡Œ{1}ï¼‰ã€‚æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ ä»½åå•ï¼ŒæŠŠé‡Œé¢çš„åå­—å…¨éƒ½åŠ å…¥é˜Ÿåˆ—ï¼ˆè¡Œ{2}ï¼‰ã€‚ç»™å®šä¸€ä¸ªæ•°å­—ï¼Œç„¶åè¿­ä»£é˜Ÿåˆ—ã€‚ä»é˜Ÿåˆ—å¼€å¤´ç§» é™¤ä¸€é¡¹ï¼Œå†å°†å…¶æ·»åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ï¼ˆè¡Œ{3}ï¼‰ï¼Œæ¨¡æ‹Ÿå‡»é¼“ä¼ èŠ±ï¼ˆå¦‚æœä½ æŠŠèŠ±ä¼ ç»™äº†æ—è¾¹çš„äººï¼Œä½ è¢« æ·˜æ±°çš„å¨èƒå°±ç«‹åˆ»è§£é™¤äº†ï¼‰ã€‚ä¸€æ—¦è¾¾åˆ°ç»™å®šçš„ä¼ é€’æ¬¡æ•°ï¼Œæ‹¿ç€èŠ±çš„é‚£ä¸ªäººå°±è¢«æ·˜æ±°äº†ï¼ˆä»é˜Ÿåˆ—ä¸­ ç§»é™¤â€”â€”è¡Œ{4}ï¼‰ã€‚æœ€ååªå‰©ä¸‹ä¸€ä¸ªäººçš„æ—¶å€™ï¼Œè¿™ä¸ªäººå°±æ˜¯èƒœè€…ï¼ˆè¡Œ{5}ï¼‰</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Queue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./Queue.js&quot;</span>;<span class="hljs-keyword">function</span> <span class="hljs-title function_">hotPotato</span>(<span class="hljs-params">elementsList, num</span>) &#123;  <span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>();  <span class="hljs-keyword">const</span> elimitatedList = [];  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; elementsList.<span class="hljs-property">length</span>; i++) &#123;    queue.<span class="hljs-title function_">enqueue</span>(elementsList[i]);  &#125;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(queue.<span class="hljs-title function_">toString</span>(), <span class="hljs-string">&quot;----&quot;</span>);  <span class="hljs-keyword">while</span> (queue.<span class="hljs-title function_">size</span>() &gt; <span class="hljs-number">1</span>) &#123;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; num; i++) &#123;      queue.<span class="hljs-title function_">enqueue</span>(queue.<span class="hljs-title function_">dequeue</span>());    &#125;    elimitatedList.<span class="hljs-title function_">push</span>(queue.<span class="hljs-title function_">dequeue</span>());  &#125;  <span class="hljs-keyword">return</span> &#123;    <span class="hljs-attr">winner</span>: queue.<span class="hljs-title function_">dequeue</span>(),    <span class="hljs-attr">eliminated</span>: elimitatedList,  &#125;;&#125;<span class="hljs-keyword">const</span> names = [<span class="hljs-string">&quot;John&quot;</span>, <span class="hljs-string">&quot;Jack&quot;</span>, <span class="hljs-string">&quot;Camila&quot;</span>, <span class="hljs-string">&quot;Ingrid&quot;</span>, <span class="hljs-string">&quot;Carl&quot;</span>];<span class="hljs-keyword">const</span> result = <span class="hljs-title function_">hotPotato</span>(names, <span class="hljs-number">7</span>);result.<span class="hljs-property">eliminated</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;name&#125;</span>åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚`</span>);&#125;);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`èƒœåˆ©è€…ï¼š <span class="hljs-subst">$&#123;result.winner&#125;</span>`</span>);</code></pre></div><p>ä»¥ä¸Šç®—æ³•çš„è¾“å‡ºå¦‚ä¸‹ã€‚</p><p> Camila åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚</p><p> Jack åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚</p><p> Carl åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚</p><p> Ingrid åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°ã€‚ </p><p> èƒœåˆ©è€…ï¼šJohn</p><h5 id="å›æ–‡æ£€æŸ¥å™¨"><a href="#å›æ–‡æ£€æŸ¥å™¨" class="headerlink" title="å›æ–‡æ£€æŸ¥å™¨"></a>å›æ–‡æ£€æŸ¥å™¨</h5><p>ä¸‹é¢æ˜¯ç»´åŸºç™¾ç§‘å¯¹å›æ–‡çš„è§£é‡Šã€‚ å›æ–‡æ˜¯æ­£åéƒ½èƒ½è¯»é€šçš„å•è¯ã€è¯ç»„ã€æ•°æˆ–ä¸€ç³»åˆ—å­—ç¬¦çš„åºåˆ—ï¼Œä¾‹å¦‚ madamæˆ– racecarã€‚ æœ‰ä¸åŒçš„ç®—æ³•å¯ä»¥æ£€æŸ¥ä¸€ä¸ªè¯ç»„æˆ–å­—ç¬¦ä¸²æ˜¯å¦ä¸ºå›æ–‡ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯å°†å­—ç¬¦ä¸²åå‘æ’åˆ—å¹¶ æ£€æŸ¥å®ƒå’ŒåŸå­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªå›æ–‡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ ˆæ¥å®Œæˆï¼Œä½† æ˜¯åˆ©ç”¨æ•°æ®ç»“æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨åŒç«¯é˜Ÿåˆ—</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Deque</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./Deque.js&quot;</span>;<span class="hljs-comment">// å›æ–‡å­—ç¬¦ä¸²æ£€æµ‹</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">palindromeChecker</span>(<span class="hljs-params">aString</span>) &#123;  <span class="hljs-keyword">if</span> (aString == <span class="hljs-literal">null</span> || (aString != <span class="hljs-literal">null</span> &amp;&amp; aString.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>)) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰å°±è¿”å›</span>  <span class="hljs-keyword">let</span> isEqual = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// è·å¾—ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå­—ç¬¦</span>  <span class="hljs-keyword">let</span> firstChar, lastChar;  <span class="hljs-keyword">const</span> deque = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Deque</span>();  <span class="hljs-comment">// å…ˆå°†å­—ç¬¦ä¸²è½¬æˆå°å†™ç„¶åå†å»æ‰ç©ºæ ¼é‡æ–°æ‹¼æ¥</span>  aString = aString.<span class="hljs-title function_">toLocaleLowerCase</span>().<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot; &quot;</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(aString);  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; aString.<span class="hljs-property">length</span>; i++) &#123;    deque.<span class="hljs-title function_">addBack</span>(aString.<span class="hljs-title function_">charAt</span>(i));  &#125;  <span class="hljs-comment">// whileå¾ªç¯æ‹¿åˆ°ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªè¿›è¡Œæ¯”è¾ƒï¼Œåªæœ‰åœ¨isEqualä¸ºtrueæ‰ç»§ç»­æ¯”å¥¥,åªæœ‰ä¸€ä¸ªçš„æ—¶å€™è·³å‡º</span>  <span class="hljs-keyword">while</span> (deque.<span class="hljs-title function_">size</span>() &gt; <span class="hljs-number">1</span> &amp;&amp; isEqual) &#123;    firstChar = deque.<span class="hljs-title function_">removeFront</span>();    lastChar = deque.<span class="hljs-title function_">removeBack</span>();    <span class="hljs-keyword">if</span> (lastChar !== firstChar) &#123;      isEqual = <span class="hljs-literal">false</span>;    &#125;  &#125;  <span class="hljs-keyword">return</span> isEqual;&#125;<span class="hljs-comment">// å…¨æ˜¯true</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-title function_">palindromeChecker</span>(<span class="hljs-string">&quot;a&quot;</span>));<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;aa&quot;</span>, <span class="hljs-title function_">palindromeChecker</span>(<span class="hljs-string">&quot;aa&quot;</span>));<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;kayak&quot;</span>, <span class="hljs-title function_">palindromeChecker</span>(<span class="hljs-string">&quot;kayak&quot;</span>));<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;level&quot;</span>, <span class="hljs-title function_">palindromeChecker</span>(<span class="hljs-string">&quot;level&quot;</span>));<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(  <span class="hljs-string">&quot;Was it a car or a cat I saw&quot;</span>,  <span class="hljs-title function_">palindromeChecker</span>(<span class="hljs-string">&quot;Was it a car or a cat I saw&quot;</span>));<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Step on no pets&quot;</span>, <span class="hljs-title function_">palindromeChecker</span>(<span class="hljs-string">&quot;Step on no pets&quot;</span>));</code></pre></div><p>åœ¨æˆ‘ä»¬å¼€å§‹è§£é‡Šç®—æ³•é€»è¾‘ä¹‹å‰ï¼Œéœ€è¦æ£€æŸ¥ä¼ å…¥çš„å­—ç¬¦ä¸²å‚æ•°æ˜¯å¦åˆæ³•ï¼ˆè¡Œ{1}ï¼‰ã€‚å¦‚æœä¸åˆ æ³•ï¼Œæˆ‘ä»¬è¿”å› falseã€‚ å¯¹äºè¿™ä¸ªç®—æ³•ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åœ¨æœ¬ç« å®ç°çš„ Deque ç±»ï¼ˆè¡Œ{2}ï¼‰ã€‚ç”±äºå¯èƒ½æ¥æ”¶åˆ°åŒæ—¶åŒ…å«å¤§ å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬ä¼šå°†æ‰€æœ‰å­—æ¯è½¬åŒ–ä¸ºå°å†™ï¼ŒåŒæ—¶ç§»é™¤æ‰€æœ‰çš„ç©ºæ ¼ï¼ˆè¡Œ{3}ï¼‰ã€‚å¦‚æœä½ æ„¿æ„ï¼Œ ä¹Ÿå¯ä»¥ç§»é™¤æ‰€æœ‰çš„ç‰¹æ®Šå­—ç¬¦ï¼Œä¾‹å¦‚!ã€?ã€-ã€(å’Œ)ç­‰ã€‚ä¸ºäº†ä¿è¯ç®—æ³•ç®€æ´ï¼Œæˆ‘ä»¬ä¼šè·³è¿‡è¿™éƒ¨åˆ†ã€‚ ç„¶åï¼Œæˆ‘ä»¬ä¼šå¯¹å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦æ‰§è¡Œ enqueue æ“ä½œï¼ˆè¡Œ{4}ï¼‰ã€‚å¦‚æœæ‰€æœ‰å…ƒç´ éƒ½åœ¨åŒç«¯ é˜Ÿåˆ—ä¸­ï¼ˆå¦‚æœåªæœ‰ä¸€ä¸ªå­—ç¬¦çš„è¯ï¼Œé‚£å®ƒè‚¯å®šæ˜¯å›æ–‡ï¼‰å¹¶ä¸”é¦–å°¾å­—ç¬¦ç›¸åŒçš„è¯ï¼ˆè¡Œ{5}ï¼‰ï¼Œæˆ‘ä»¬å°† ä»å‰ç«¯ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼ˆè¡Œ{6}ï¼‰ï¼Œå†ä»åç«¯ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼ˆè¡Œ{7}ï¼‰ã€‚è¦ä½¿å­—ç¬¦ä¸²ä¸ºå›æ–‡ï¼Œç§»é™¤çš„ ä¸¤ä¸ªå­—ç¬¦å¿…é¡»ç›¸åŒã€‚å¦‚æœå­—ç¬¦ä¸åŒçš„è¯ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±ä¸æ˜¯ä¸€ä¸ªå›æ–‡ï¼ˆè¡Œ{8}ï¼‰</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>jestå­¦ä¹ ç¬”è®°</title>
    <link href="/2022/09/16/jest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/09/16/jest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="Jestå®‰è£…"><a href="#Jestå®‰è£…" class="headerlink" title="##Jestå®‰è£…"></a>##Jestå®‰è£…</h4><div class="code-wrapper"><pre><code class="hljs q">npm install --<span class="hljs-built_in">save</span>-<span class="hljs-built_in">dev</span> jest</code></pre></div><h4 id="å¸¸è§çš„åŒ¹é…å™¨"><a href="#å¸¸è§çš„åŒ¹é…å™¨" class="headerlink" title="å¸¸è§çš„åŒ¹é…å™¨"></a>å¸¸è§çš„åŒ¹é…å™¨</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;two plus two is four&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-title function_">expect</span>(<span class="hljs-number">2</span> + <span class="hljs-number">2</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">4</span>);&#125;);</code></pre></div><p><code>toBe</code>ä½¿ç”¨ <code>Object.is</code>æ¥è¿›è¡Œç²¾å‡†åŒ¹é…çš„æµ‹è¯•ã€‚ å¦‚æœæ‚¨æƒ³è¦æ£€æŸ¥å¯¹è±¡çš„å€¼ï¼Œè¯·ä½¿ç”¨ <code>toEqual</code> ä»£æ›¿ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;å¯¹è±¡èµ‹å€¼&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> data = &#123;<span class="hljs-attr">one</span>: <span class="hljs-number">1</span>&#125;;  data[<span class="hljs-string">&#x27;two&#x27;</span>] = <span class="hljs-number">2</span>;  <span class="hljs-title function_">expect</span>(data).<span class="hljs-title function_">toEqual</span>(&#123;<span class="hljs-attr">one</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">two</span>: <span class="hljs-number">2</span>&#125;);&#125;);</code></pre></div><p><code>toEqual</code> é€’å½’æ£€æŸ¥å¯¹è±¡æˆ–æ•°ç»„çš„æ¯ä¸ªå­—æ®µ</p><h5 id="çœŸå€¼"><a href="#çœŸå€¼" class="headerlink" title="çœŸå€¼"></a>çœŸå€¼</h5><p>ä»£ç ä¸­çš„<code>undefined</code>, <code>null</code>, and <code>false</code>æœ‰ä¸åŒå«ä¹‰ï¼Œè‹¥ä½ åœ¨æµ‹è¯•æ—¶ä¸æƒ³åŒºåˆ†ä»–ä»¬ï¼Œå¯ä»¥ç”¨çœŸå€¼åˆ¤æ–­ã€‚ Jestæä¾›helpersä¾›ä½ ä½¿ç”¨ã€‚</p><ul><li><code>toBeNull</code> åªåŒ¹é… <code>null</code></li><li><code>toBeUndefined</code> åªåŒ¹é… <code>undefined</code></li><li><code>toBeDefined</code> ä¸ <code>toBeUndefined</code> ç›¸å</li><li><code>toBeTruthy</code> åŒ¹é…ä»»ä½• <code>if</code> è¯­å¥ä¸ºçœŸ</li><li><code>toBeFalsy</code> åŒ¹é…ä»»ä½• <code>if</code> è¯­å¥ä¸ºå‡</li></ul><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;null&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> n = <span class="hljs-literal">null</span>;  <span class="hljs-title function_">expect</span>(n).<span class="hljs-title function_">toBeNull</span>();  <span class="hljs-title function_">expect</span>(n).<span class="hljs-title function_">toBeDefined</span>();  <span class="hljs-title function_">expect</span>(n).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBeUndefined</span>();  <span class="hljs-title function_">expect</span>(n).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBeTruthy</span>();  <span class="hljs-title function_">expect</span>(n).<span class="hljs-title function_">toBeFalsy</span>();&#125;);<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;zero&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> z = <span class="hljs-number">0</span>;  <span class="hljs-title function_">expect</span>(z).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBeNull</span>();  <span class="hljs-title function_">expect</span>(z).<span class="hljs-title function_">toBeDefined</span>();  <span class="hljs-title function_">expect</span>(z).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBeUndefined</span>();  <span class="hljs-title function_">expect</span>(z).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBeTruthy</span>();  <span class="hljs-title function_">expect</span>(z).<span class="hljs-title function_">toBeFalsy</span>();&#125;);</code></pre></div><h5 id="æ•°å­—"><a href="#æ•°å­—" class="headerlink" title="æ•°å­—"></a>æ•°å­—</h5><p>å¤§å¤šæ•°çš„æ¯”è¾ƒæ•°å­—æœ‰ç­‰ä»·çš„åŒ¹é…å™¨</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;two plus two&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> value = <span class="hljs-number">2</span> + <span class="hljs-number">2</span>;  <span class="hljs-title function_">expect</span>(value).<span class="hljs-title function_">toBeGreaterThan</span>(<span class="hljs-number">3</span>);<span class="hljs-comment">//å¤§äº</span>  <span class="hljs-title function_">expect</span>(value).<span class="hljs-title function_">toBeGreaterThanOrEqual</span>(<span class="hljs-number">3.5</span>);<span class="hljs-comment">//å¤§äºç­‰äº</span>  <span class="hljs-title function_">expect</span>(value).<span class="hljs-title function_">toBeLessThan</span>(<span class="hljs-number">5</span>);<span class="hljs-comment">//å°äº</span>  <span class="hljs-title function_">expect</span>(value).<span class="hljs-title function_">toBeLessThanOrEqual</span>(<span class="hljs-number">4.5</span>);<span class="hljs-comment">//å°äºç­‰äº</span>  <span class="hljs-comment">// toBe and toEqual are equivalent for numbers</span>  <span class="hljs-title function_">expect</span>(value).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">4</span>);  <span class="hljs-title function_">expect</span>(value).<span class="hljs-title function_">toEqual</span>(<span class="hljs-number">4</span>);&#125;);</code></pre></div><p>å¯¹äºæ¯”è¾ƒæµ®ç‚¹æ•°ç›¸ç­‰ï¼Œä½¿ç”¨ <code>toBeCloseTo</code> è€Œä¸æ˜¯ <code>toEqual</code>ï¼Œå› ä¸ºä½ ä¸å¸Œæœ›æµ‹è¯•å–å†³äºä¸€ä¸ªå°å°çš„èˆå…¥è¯¯å·®ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;ä¸¤ä¸ªæµ®ç‚¹æ•°å­—ç›¸åŠ &#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> value = <span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>;  <span class="hljs-comment">//expect(value).toBe(0.3);           è¿™å¥ä¼šæŠ¥é”™ï¼Œå› ä¸ºæµ®ç‚¹æ•°æœ‰èˆå…¥è¯¯å·®</span>  <span class="hljs-title function_">expect</span>(value).<span class="hljs-title function_">toBeCloseTo</span>(<span class="hljs-number">0.3</span>); <span class="hljs-comment">// è¿™å¥å¯ä»¥è¿è¡Œ</span>&#125;);&#125;);</code></pre></div><h5 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h5><p>æ‚¨å¯ä»¥æ£€æŸ¥å¯¹å…·æœ‰ <code>toMatch</code> æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ï¸°</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;there is no I in team&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-title function_">expect</span>(<span class="hljs-string">&#x27;team&#x27;</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toMatch</span>(<span class="hljs-regexp">/I/</span>);&#125;);<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;but there is a &quot;stop&quot; in Christoph&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-title function_">expect</span>(<span class="hljs-string">&#x27;Christoph&#x27;</span>).<span class="hljs-title function_">toMatch</span>(<span class="hljs-regexp">/stop/</span>);&#125;);</code></pre></div><h5 id="æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡"><a href="#æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡" class="headerlink" title="æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡"></a>æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡</h5><p> <code>toContain</code>æ¥æ£€æŸ¥ä¸€ä¸ªæ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡æ˜¯å¦åŒ…å«æŸä¸ªç‰¹å®šé¡¹</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> shoppingList = [  <span class="hljs-string">&#x27;diapers&#x27;</span>,  <span class="hljs-string">&#x27;kleenex&#x27;</span>,  <span class="hljs-string">&#x27;trash bags&#x27;</span>,  <span class="hljs-string">&#x27;paper towels&#x27;</span>,  <span class="hljs-string">&#x27;milk&#x27;</span>,];<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;shoppingListæ•°ç»„ä¸­åŒ…å«milk&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-title function_">expect</span>(shoppingList).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">&#x27;milk&#x27;</span>);  <span class="hljs-title function_">expect</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(shoppingList)).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">&#x27;milk&#x27;</span>);&#125;);</code></pre></div><h5 id="thorw"><a href="#thorw" class="headerlink" title="thorw"></a>thorw</h5><p>ä½ æƒ³æµ‹è¯•æŸå‡½æ•°åœ¨è°ƒç”¨æ—¶æ˜¯å¦æŠ›å‡ºäº†é”™è¯¯ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>toThrow</code></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">compileAndroidCode</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;you are using the wrong JDK&#x27;</span>);&#125;<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;compiling android goes as expected&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-title function_">expect</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">compileAndroidCode</span>()).<span class="hljs-title function_">toThrow</span>();  <span class="hljs-title function_">expect</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">compileAndroidCode</span>()).<span class="hljs-title function_">toThrow</span>(<span class="hljs-title class_">Error</span>);  <span class="hljs-comment">// ä½ å¯ä»¥è‡ªå·±å®šä¹‰ç¡®åˆ‡çš„é”™è¯¯æ¶ˆæ¯å†…å®¹æˆ–è€…ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</span>  <span class="hljs-title function_">expect</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">compileAndroidCode</span>()).<span class="hljs-title function_">toThrow</span>(<span class="hljs-string">&#x27;you are using the wrong JDK&#x27;</span>);  <span class="hljs-title function_">expect</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">compileAndroidCode</span>()).<span class="hljs-title function_">toThrow</span>(<span class="hljs-regexp">/JDK/</span>);&#125;);</code></pre></div><h4 id="æµ‹è¯•å¼‚æ­¥ä»£ç "><a href="#æµ‹è¯•å¼‚æ­¥ä»£ç " class="headerlink" title="æµ‹è¯•å¼‚æ­¥ä»£ç "></a>æµ‹è¯•å¼‚æ­¥ä»£ç </h4><h5 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h5><p>ä¸ºä½ çš„æµ‹è¯•è¿”å›ä¸€ä¸ªPromiseï¼Œåˆ™Jestä¼šç­‰å¾…Promiseçš„resoveçŠ¶æ€ å¦‚æœ Promise çš„çŠ¶æ€å˜ä¸º rejected, æµ‹è¯•å°†ä¼šå¤±è´¥</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;the data is peanut butter&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetchData</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;    <span class="hljs-title function_">expect</span>(data).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;peanut butter&#x27;</span>);  &#125;);&#125;);</code></pre></div><h5 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async/Await"></a>Async/Await</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;the data is peanut butter&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>();  <span class="hljs-title function_">expect</span>(data).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;peanut butter&#x27;</span>);&#125;);<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;the fetch fails with an error&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;  expect.<span class="hljs-title function_">assertions</span>(<span class="hljs-number">1</span>);  <span class="hljs-keyword">try</span> &#123;    <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>();  &#125; <span class="hljs-keyword">catch</span> (e) &#123;    <span class="hljs-title function_">expect</span>(e).<span class="hljs-title function_">toMatch</span>(<span class="hljs-string">&#x27;error&#x27;</span>);  &#125;&#125;);</code></pre></div><p>ä½ ä¹Ÿå¯ä»¥å°† <code>async</code> and <code>await</code>å’Œ <code>.resolves</code> or <code>.rejects</code>ä¸€èµ·ä½¿ç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;the data is peanut butter&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;  <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">fetchData</span>()).<span class="hljs-property">resolves</span>.<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;peanut butter&#x27;</span>);&#125;);<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;the fetch fails with an error&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;  <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">fetchData</span>()).<span class="hljs-property">rejects</span>.<span class="hljs-title function_">toMatch</span>(<span class="hljs-string">&#x27;error&#x27;</span>);&#125;);</code></pre></div><p>å¦‚æœæœŸæœ›Promiseè¢«Rejectï¼Œåˆ™éœ€è¦ä½¿ç”¨ <code>.catch</code> æ–¹æ³•ã€‚ è¯·ç¡®ä¿æ·»åŠ  <code>expect.assertions</code> æ¥éªŒè¯ä¸€å®šæ•°é‡çš„æ–­è¨€è¢«è°ƒç”¨ã€‚ å¦åˆ™ï¼Œä¸€ä¸ªfulfilledçŠ¶æ€çš„Promiseä¸ä¼šè®©æµ‹è¯•ç”¨ä¾‹å¤±è´¥ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;the fetch fails with an error&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  expect.<span class="hljs-title function_">assertions</span>(<span class="hljs-number">1</span>);  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetchData</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-title function_">expect</span>(e).<span class="hljs-title function_">toMatch</span>(<span class="hljs-string">&#x27;error&#x27;</span>));&#125;);</code></pre></div><h5 id="æµ‹è¯•å›è°ƒå‡½æ•°"><a href="#æµ‹è¯•å›è°ƒå‡½æ•°" class="headerlink" title="æµ‹è¯•å›è°ƒå‡½æ•°"></a>æµ‹è¯•å›è°ƒå‡½æ•°</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;the data is peanut butter&#x27;</span>, <span class="hljs-function"><span class="hljs-params">done</span> =&gt;</span> &#123;  <span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">error, data</span>) &#123;    <span class="hljs-keyword">if</span> (error) &#123;      <span class="hljs-title function_">done</span>(error);      <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">expect</span>(data).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;peanut butter&#x27;</span>);      <span class="hljs-title function_">done</span>();    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">done</span>(error);    &#125;  &#125;  <span class="hljs-title function_">fetchData</span>(callback);&#125;);</code></pre></div><p>æµ‹è¯•å›è°ƒå‡½æ•°æ—¶ï¼Œéœ€è¦ä½¿ç”¨doneæ–¹æ³•ï¼Œä¸èƒ½ç›´æ¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå¦åˆ™æ²¡åŠæ³•æµ‹è¯•ï¼Œéœ€è¦ä½¿ç”¨ä¸Šä¸Šé¢çš„æ ¼å¼</p><h5 id="resolves-rejects"><a href="#resolves-rejects" class="headerlink" title=".resolves / .rejects"></a><code>.resolves</code> / <code>.rejects</code></h5><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ <code>.resolves</code> åŒ¹é…å™¨åœ¨æ‚¨æœŸæœ›çš„å£°æ˜ï¼ŒJest ä¼šç­‰å¾…è¿™ä¸€ Promise æ¥è§£å†³ã€‚ å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™æµ‹è¯•å°†è‡ªåŠ¨å¤±è´¥ã€‚</p><div class="code-wrapper"><pre><code class="hljs lisp">test(&#x27;the data is peanut butter&#x27;, () =&gt; &#123;  return expect(<span class="hljs-name">fetchData</span>()).resolves.toBe(&#x27;peanut butter&#x27;)<span class="hljs-comment">;</span>&#125;)<span class="hljs-comment">;</span></code></pre></div><p>å¿…é¡»è¦ä½¿ç”¨returnï¼Œåœ¨ <code>fetchData</code> è¿”å›çš„è¿™ä¸ª promise å˜æ›´ä¸º resolved çŠ¶æ€ã€then() æœ‰æœºä¼šæ‰§è¡Œä¹‹å‰ï¼Œæµ‹è¯•å°±å·²ç»è¢«è§†ä¸ºå·²ç»å®Œæˆäº†ã€‚</p><p>å¦‚æœä½ å¸Œæœ›Promiseè¿”å›rejectedï¼Œä½ éœ€è¦ä½¿ç”¨ <code>.rejects</code> åŒ¹é…å™¨ã€‚ å®ƒå’Œ <code>.resolves</code> åŒ¹é…å™¨æ˜¯ä¸€æ ·çš„ä½¿ç”¨æ–¹å¼ã€‚ å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™æµ‹è¯•å°†è‡ªåŠ¨å¤±è´¥ã€‚</p><div class="code-wrapper"><pre><code class="hljs lisp">test(&#x27;the fetch fails with an error&#x27;, () =&gt; &#123;  return expect(<span class="hljs-name">fetchData</span>()).rejects.toMatch(&#x27;error&#x27;)<span class="hljs-comment">;</span>&#125;)<span class="hljs-comment">;</span></code></pre></div><h4 id="Jestçš„é’©å­å‡½æ•°"><a href="#Jestçš„é’©å­å‡½æ•°" class="headerlink" title="Jestçš„é’©å­å‡½æ•°"></a>Jestçš„é’©å­å‡½æ•°</h4><p>jestæœ‰4ä¸ªé’©å­å‡½æ•°</p><ul><li>beforeAll()é’©å­å‡½æ•°ä¼šåœ¨æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ä¹‹å‰æ‰§è¡Œ  åªä¼šæ‰§è¡Œä¸€æ¬¡</li><li>beforeEach()é’©å­å‡½æ•° ä¼šåœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œä¹‹å‰æ‰§è¡Œä¸€æ¬¡ï¼Œæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œå‰éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡</li><li>afterEach() é’©å­å‡½æ•°ä¼šåœ¨æ¯ä¸ªæµ‹è¯•ç”¨é‡Œæ‰§è¡Œå®Œä¹‹åæ‰§è¡Œæ‰§è¡Œä¸€æ¬¡</li><li>alfterAll() é’©å­å‡½æ•°ä¼šåœ¨æ‰€æœ‰ç”¨åŠ›æ‰§è¡Œå®Œåæ‰§è¡Œ</li></ul><h4 id="ç”Ÿæˆjesté…ç½®æ–‡ä»¶jest-config-js"><a href="#ç”Ÿæˆjesté…ç½®æ–‡ä»¶jest-config-js" class="headerlink" title="ç”Ÿæˆjesté…ç½®æ–‡ä»¶jest.config.js"></a>ç”Ÿæˆjesté…ç½®æ–‡ä»¶jest.config.js</h4><div class="code-wrapper"><pre><code class="hljs ada">npx jest <span class="hljs-comment">--init</span></code></pre></div><h4 id="mockå‡½æ•°"><a href="#mockå‡½æ•°" class="headerlink" title="mockå‡½æ•°"></a>mockå‡½æ•°</h4><p>Mock å‡½æ•°å…è®¸ä½ æµ‹è¯•ä»£ç ä¹‹é—´çš„è¿æ¥â€”â€”å®ç°æ–¹å¼åŒ…æ‹¬ï¼šæ“¦é™¤å‡½æ•°çš„å®é™…å®ç°ã€æ•è·å¯¹å‡½æ•°çš„è°ƒç”¨ ( ä»¥åŠåœ¨è¿™äº›è°ƒç”¨ä¸­ä¼ é€’çš„å‚æ•°) ã€åœ¨ä½¿ç”¨ <code>new</code> å®ä¾‹åŒ–æ—¶æ•è·æ„é€ å‡½æ•°çš„å®ä¾‹ã€å…è®¸æµ‹è¯•æ—¶é…ç½®è¿”å›å€¼ã€‚</p><p>æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ¨¡æ‹Ÿå‡½æ•°ï¼šè¦ä¹ˆåœ¨æµ‹è¯•ä»£ç ä¸­åˆ›å»ºä¸€ä¸ª mock å‡½æ•°ï¼Œè¦ä¹ˆç¼–å†™ä¸€ä¸ª<a href="https://jestjs.io/zh-Hans/docs/manual-mocks"><code>æ‰‹åŠ¨ mock</code></a>æ¥è¦†ç›–æ¨¡å—ä¾èµ–ã€‚</p><h5 id="ä½¿ç”¨-mock-å‡½æ•°"><a href="#ä½¿ç”¨-mock-å‡½æ•°" class="headerlink" title="ä½¿ç”¨ mock å‡½æ•°"></a>ä½¿ç”¨ mock å‡½æ•°<a href="https://jestjs.io/zh-Hans/docs/mock-functions#%E4%BD%BF%E7%94%A8-mock-%E5%87%BD%E6%95%B0"></a></h5><p>å‡è®¾æˆ‘ä»¬è¦æµ‹è¯•å‡½æ•° <code>forEach</code> çš„å†…éƒ¨å®ç°ï¼Œè¿™ä¸ªå‡½æ•°ä¸ºä¼ å…¥çš„æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡å›è°ƒå‡½æ•°ã€‚</p><div class="code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-keyword">function</span> <span class="hljs-keyword">forEach</span>(items, callback) &#123;  <span class="hljs-keyword">for</span> (let <span class="hljs-keyword">index</span> = <span class="hljs-number">0</span>; <span class="hljs-keyword">index</span> &lt; items.length; <span class="hljs-keyword">index</span>++) &#123;    callback(items[<span class="hljs-keyword">index</span>]);  &#125;&#125;</code></pre></div><p>ä¸ºäº†æµ‹è¯•æ­¤å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª mock å‡½æ•°ï¼Œç„¶åæ£€æŸ¥ mock å‡½æ•°çš„çŠ¶æ€æ¥ç¡®ä¿å›è°ƒå‡½æ•°å¦‚æœŸè°ƒç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> mockCallback = jest.<span class="hljs-title function_">fn</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> <span class="hljs-number">42</span> + x);<span class="hljs-title function_">forEach</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], mockCallback);<span class="hljs-comment">// æ­¤ mock å‡½æ•°è¢«è°ƒç”¨äº†ä¸¤æ¬¡</span><span class="hljs-title function_">expect</span>(mockCallback.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>.<span class="hljs-property">length</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">2</span>);<span class="hljs-comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨å‡½æ•°æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ 0</span><span class="hljs-title function_">expect</span>(mockCallback.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">0</span>);<span class="hljs-comment">// ç¬¬äºŒæ¬¡è°ƒç”¨å‡½æ•°æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ 1</span><span class="hljs-title function_">expect</span>(mockCallback.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">1</span>);<span class="hljs-comment">// ç¬¬ä¸€æ¬¡å‡½æ•°è°ƒç”¨çš„è¿”å›å€¼æ˜¯ 42</span><span class="hljs-title function_">expect</span>(mockCallback.<span class="hljs-property">mock</span>.<span class="hljs-property">results</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">42</span>);</code></pre></div><h5 id="mock-å±æ€§"><a href="#mock-å±æ€§" class="headerlink" title=".mock å±æ€§"></a><code>.mock</code> å±æ€§</h5><p>æ‰€æœ‰çš„ mock å‡½æ•°éƒ½æœ‰è¿™ä¸ªç‰¹æ®Šçš„ <code>.mock</code>å±æ€§ï¼Œå®ƒä¿å­˜äº†å…³äºæ­¤å‡½æ•°å¦‚ä½•è¢«è°ƒç”¨ã€è°ƒç”¨æ—¶çš„è¿”å›å€¼çš„ä¿¡æ¯ã€‚ <code>.mock</code> å±æ€§è¿˜è¿½è¸ªæ¯æ¬¡è°ƒç”¨æ—¶ <code>this</code>çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åŒæ ·å¯ä»¥ä¹Ÿæ£€è§†ï¼ˆinspectï¼‰ <code>this</code></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> myMock1 = jest.<span class="hljs-title function_">fn</span>();<span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myMock1</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myMock1.<span class="hljs-property">mock</span>.<span class="hljs-property">instances</span>);<span class="hljs-comment">// &gt; [ &lt;a&gt; ]</span><span class="hljs-keyword">const</span> myMock2 = jest.<span class="hljs-title function_">fn</span>();<span class="hljs-keyword">const</span> b = &#123;&#125;;<span class="hljs-keyword">const</span> bound = myMock2.<span class="hljs-title function_">bind</span>(b);<span class="hljs-title function_">bound</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myMock2.<span class="hljs-property">mock</span>.<span class="hljs-property">contexts</span>);<span class="hljs-comment">// &gt; [ &lt;b&gt; ]</span></code></pre></div><p>è¿™äº› mock æˆå‘˜å˜é‡åœ¨æµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ï¼Œç”¨äºè¯´æ˜è¿™äº› function æ˜¯å¦‚ä½•è¢«è°ƒç”¨ã€å®ä¾‹åŒ–æˆ–è¿”å›çš„ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// The function was called exactly once</span><span class="hljs-title function_">expect</span>(someMockFunction.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>.<span class="hljs-property">length</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">1</span>);<span class="hljs-comment">// The first arg of the first call to the function was &#x27;first arg&#x27;</span><span class="hljs-title function_">expect</span>(someMockFunction.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;first arg&#x27;</span>);<span class="hljs-comment">// The second arg of the first call to the function was &#x27;second arg&#x27;</span><span class="hljs-title function_">expect</span>(someMockFunction.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;second arg&#x27;</span>);<span class="hljs-comment">// The return value of the first call to the function was &#x27;return value&#x27;</span><span class="hljs-title function_">expect</span>(someMockFunction.<span class="hljs-property">mock</span>.<span class="hljs-property">results</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;return value&#x27;</span>);<span class="hljs-comment">// The function was called with a certain `this` context: the `element` object.</span><span class="hljs-title function_">expect</span>(someMockFunction.<span class="hljs-property">mock</span>.<span class="hljs-property">contexts</span>[<span class="hljs-number">0</span>]).<span class="hljs-title function_">toBe</span>(element);<span class="hljs-comment">// This function was instantiated exactly twice</span><span class="hljs-title function_">expect</span>(someMockFunction.<span class="hljs-property">mock</span>.<span class="hljs-property">instances</span>.<span class="hljs-property">length</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">2</span>);<span class="hljs-comment">// The object returned by the first instantiation of this function</span><span class="hljs-comment">// had a `name` property whose value was set to &#x27;test&#x27;</span><span class="hljs-title function_">expect</span>(someMockFunction.<span class="hljs-property">mock</span>.<span class="hljs-property">instances</span>[<span class="hljs-number">0</span>].<span class="hljs-property">name</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;test&#x27;</span>);<span class="hljs-comment">// The first argument of the last call to the function was &#x27;test&#x27;</span><span class="hljs-title function_">expect</span>(someMockFunction.<span class="hljs-property">mock</span>.<span class="hljs-property">lastCall</span>[<span class="hljs-number">0</span>]).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;test&#x27;</span>);</code></pre></div><h5 id="Mock-çš„è¿”å›å€¼"><a href="#Mock-çš„è¿”å›å€¼" class="headerlink" title="Mock çš„è¿”å›å€¼"></a>Mock çš„è¿”å›å€¼<a href="https://jestjs.io/zh-Hans/docs/mock-functions#mock-%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"></a></h5><p>Mock å‡½æ•°ä¹Ÿå¯ä»¥ç”¨äºåœ¨æµ‹è¯•æœŸé—´å°†æµ‹è¯•å€¼æ³¨å…¥ä»£ç ï¸°</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> myMock = jest.<span class="hljs-title function_">fn</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myMock</span>());<span class="hljs-comment">// &gt; undefined</span>myMock.<span class="hljs-title function_">mockReturnValueOnce</span>(<span class="hljs-number">10</span>).<span class="hljs-title function_">mockReturnValueOnce</span>(<span class="hljs-string">&#x27;x&#x27;</span>).<span class="hljs-title function_">mockReturnValue</span>(<span class="hljs-literal">true</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myMock</span>(), <span class="hljs-title function_">myMock</span>(), <span class="hljs-title function_">myMock</span>(), <span class="hljs-title function_">myMock</span>());<span class="hljs-comment">// &gt; 10, &#x27;x&#x27;, true, true</span></code></pre></div><p>åœ¨å‡½æ•°è¿ç»­ä¼ é€’é£æ ¼ï¼ˆfunctional continuation-passing styleï¼‰çš„ä»£ç ä¸­æ—¶ï¼ŒMock å‡½æ•°ä¹Ÿéå¸¸æœ‰æ•ˆã€‚ ä»¥è¿™ç§ä»£ç é£æ ¼æœ‰åŠ©äºé¿å…å¤æ‚çš„ä¸­é—´æ“ä½œï¼Œä¾¿äºç›´è§‚è¡¨ç°ç»„ä»¶çš„çœŸå®æ„å›¾ï¼Œè¿™æœ‰åˆ©äºåœ¨å®ƒä»¬è¢«è°ƒç”¨ä¹‹å‰ï¼Œå°†å€¼ç›´æ¥æ³¨å…¥åˆ°æµ‹è¯•ä¸­ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> filterTestFn = jest.<span class="hljs-title function_">fn</span>();<span class="hljs-comment">// Make the mock return `true` for the first call,</span><span class="hljs-comment">// and `false` for the second call</span>filterTestFn.<span class="hljs-title function_">mockReturnValueOnce</span>(<span class="hljs-literal">true</span>).<span class="hljs-title function_">mockReturnValueOnce</span>(<span class="hljs-literal">false</span>);<span class="hljs-keyword">const</span> result = [<span class="hljs-number">11</span>, <span class="hljs-number">12</span>].<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> <span class="hljs-title function_">filterTestFn</span>(num));<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<span class="hljs-comment">// &gt; [11]</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(filterTestFn.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]); <span class="hljs-comment">// 11</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(filterTestFn.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]); <span class="hljs-comment">// 12</span></code></pre></div><p>å¤§å¤šæ•°ç°å®ä¸–ç•Œä¾‹å­ä¸­ï¼Œå®é™…æ˜¯åœ¨ä¾èµ–çš„ç»„ä»¶ä¸Šé…ä¸€ä¸ªæ¨¡æ‹Ÿå‡½æ•°å¹¶é…ç½®å®ƒï¼Œä½†æ‰‹æ³•æ˜¯ç›¸åŒçš„ã€‚ åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå°½é‡é¿å…åœ¨éçœŸæ­£æƒ³è¦è¿›è¡Œæµ‹è¯•çš„ä»»ä½•å‡½æ•°å†…å®ç°é€»è¾‘ã€‚</p><h5 id="æ¨¡æ‹Ÿæ¨¡å—"><a href="#æ¨¡æ‹Ÿæ¨¡å—" class="headerlink" title="æ¨¡æ‹Ÿæ¨¡å—"></a>æ¨¡æ‹Ÿæ¨¡å—<a href="https://jestjs.io/zh-Hans/docs/mock-functions#%E6%A8%A1%E6%8B%9F%E6%A8%A1%E5%9D%97"></a></h5><p>å‡å®šæœ‰ä¸ªä» API è·å–ç”¨æˆ·çš„ç±»ã€‚ è¯¥ç±»ç”¨ <a href="https://github.com/axios/axios">axios</a> è°ƒç”¨ API ç„¶åè¿”å› <code>data</code>ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰ç”¨æˆ·çš„å±æ€§ï¼š</p><p>users.js</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Users</span> &#123;  <span class="hljs-keyword">static</span> <span class="hljs-title function_">all</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/users.json&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> resp.<span class="hljs-property">data</span>);  &#125;&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Users</span>;</code></pre></div><p>ç°åœ¨ï¼Œä¸ºæµ‹è¯•è¯¥æ–¹æ³•è€Œä¸å®é™…è°ƒç”¨ API (ä½¿æµ‹è¯•ç¼“æ…¢ä¸è„†å¼±)ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>jest.mock(...)</code> å‡½æ•°è‡ªåŠ¨æ¨¡æ‹Ÿ axios æ¨¡å—ã€‚</p><p>ä¸€æ—¦æ¨¡æ‹Ÿæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä¸º <code>.get</code> æä¾›ä¸€ä¸ª <code>mockResolvedValue</code> ï¼Œå®ƒä¼šè¿”å›å‡æ•°æ®ç”¨äºæµ‹è¯•ã€‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬æƒ³è¯´çš„æ˜¯æˆ‘ä»¬æƒ³è®©<code>axios.get(&#39;/users.json&#39;)</code> æœ‰ä¸ªä¼ªé€ çš„å“åº”ç»“æœã€‚</p><p>users.test.js</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>;<span class="hljs-keyword">import</span> <span class="hljs-title class_">Users</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./users&#x27;</span>;jest.<span class="hljs-title function_">mock</span>(<span class="hljs-string">&#x27;axios&#x27;</span>);<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;should fetch users&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> users = [&#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Bob&#x27;</span>&#125;];  <span class="hljs-keyword">const</span> resp = &#123;<span class="hljs-attr">data</span>: users&#125;;  axios.<span class="hljs-property">get</span>.<span class="hljs-title function_">mockResolvedValue</span>(resp);  <span class="hljs-comment">// or you could use the following depending on your use case:</span>  <span class="hljs-comment">// axios.get.mockImplementation(() =&gt; Promise.resolve(resp))</span>  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Users</span>.<span class="hljs-title function_">all</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-title function_">expect</span>(data).<span class="hljs-title function_">toEqual</span>(users));&#125;);</code></pre></div><h5 id="æ¨¡æ‹Ÿ-éƒ¨åˆ†æ¨¡å—"><a href="#æ¨¡æ‹Ÿ-éƒ¨åˆ†æ¨¡å—" class="headerlink" title="æ¨¡æ‹Ÿ éƒ¨åˆ†æ¨¡å—"></a>æ¨¡æ‹Ÿ éƒ¨åˆ†æ¨¡å—</h5><p>æ¨¡å—çš„å­é›†å¯ä»¥è¢«æ¨¡æ‹Ÿï¼Œæ¨¡å—çš„å…¶ä»–éƒ¨åˆ†å¯ä»¥ç»´æŒå½“å‰å®ç°ï¼š</p><p>foo-bar-baz.js</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> foo = <span class="hljs-string">&#x27;foo&#x27;</span>;<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">bar</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-string">&#x27;bar&#x27;</span>;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> () =&gt; <span class="hljs-string">&#x27;baz&#x27;</span>;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//test.js</span><span class="hljs-keyword">import</span> defaultExport, &#123;bar, foo&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../foo-bar-baz&#x27;</span>;jest.<span class="hljs-title function_">mock</span>(<span class="hljs-string">&#x27;../foo-bar-baz&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> originalModule = jest.requireActual(<span class="hljs-string">&#x27;../foo-bar-baz&#x27;</span>);  <span class="hljs-comment">//Mock the default export and named export &#x27;foo&#x27;</span>  <span class="hljs-keyword">return</span> &#123;    <span class="hljs-attr">__esModule</span>: <span class="hljs-literal">true</span>,    ...originalModule,    <span class="hljs-attr">default</span>: jest.<span class="hljs-title function_">fn</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-string">&#x27;mocked baz&#x27;</span>),    <span class="hljs-attr">foo</span>: <span class="hljs-string">&#x27;mocked foo&#x27;</span>,  &#125;;&#125;);<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;should do a partial mock&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> defaultExportResult = <span class="hljs-title function_">defaultExport</span>();  <span class="hljs-title function_">expect</span>(defaultExportResult).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;mocked baz&#x27;</span>);  <span class="hljs-title function_">expect</span>(defaultExport).<span class="hljs-title function_">toHaveBeenCalled</span>();  <span class="hljs-title function_">expect</span>(foo).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;mocked foo&#x27;</span>);  <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">bar</span>()).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;bar&#x27;</span>);&#125;);</code></pre></div><h5 id="Mock-å®ç°"><a href="#Mock-å®ç°" class="headerlink" title="Mock å®ç°"></a>Mock å®ç°<a href="https://jestjs.io/zh-Hans/docs/mock-functions#mock-%E5%AE%9E%E7%8E%B0"></a></h5><p>è¿˜æœ‰ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ç”¨Mockå‡½æ•°æ›¿æ¢æŒ‡å®šè¿”å›å€¼æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ å¯ä»¥ç”¨ <code>jest.fn</code> æˆ– <code>mockImplementationOnce</code>æ–¹æ³•æ¥å®ç°Mockå‡½æ•°ã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myMockFn = jest.<span class="hljs-title function_">fn</span>(<span class="hljs-function"><span class="hljs-params">cb</span> =&gt;</span> <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>));<span class="hljs-title function_">myMockFn</span>(<span class="hljs-function">(<span class="hljs-params">err, val</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(val));<span class="hljs-comment">// &gt; true</span></code></pre></div><p>å½“ä½ éœ€è¦æ ¹æ®åˆ«çš„æ¨¡å—å®šä¹‰é»˜è®¤çš„Mockå‡½æ•°å®ç°æ—¶ï¼Œ<code>mockImplementation</code> æ–¹æ³•æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><p>foo.js</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-comment">// some implementation;</span>&#125;;</code></pre></div><p>test.js</p><div class="code-wrapper"><pre><code class="hljs js">jest.<span class="hljs-title function_">mock</span>(<span class="hljs-string">&#x27;../foo&#x27;</span>); <span class="hljs-comment">// this happens automatically with automocking</span><span class="hljs-keyword">const</span> foo = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../foo&#x27;</span>);<span class="hljs-comment">// foo is a mock function</span>foo.<span class="hljs-title function_">mockImplementation</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">42</span>);<span class="hljs-title function_">foo</span>();<span class="hljs-comment">// &gt; 42</span></code></pre></div><p>å½“ä½ éœ€è¦æ¨¡æ‹ŸæŸä¸ªå‡½æ•°è°ƒç”¨è¿”å›ä¸åŒç»“æœæ—¶ï¼Œè¯·ä½¿ç”¨ <code>mockImplementationOnce</code> æ–¹æ³•ï¸°</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myMockFn = jest  .<span class="hljs-title function_">fn</span>()  .<span class="hljs-title function_">mockImplementationOnce</span>(<span class="hljs-function"><span class="hljs-params">cb</span> =&gt;</span> <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>))  .<span class="hljs-title function_">mockImplementationOnce</span>(<span class="hljs-function"><span class="hljs-params">cb</span> =&gt;</span> <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>));<span class="hljs-title function_">myMockFn</span>(<span class="hljs-function">(<span class="hljs-params">err, val</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(val));<span class="hljs-comment">// &gt; true</span><span class="hljs-title function_">myMockFn</span>(<span class="hljs-function">(<span class="hljs-params">err, val</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(val));<span class="hljs-comment">// &gt; false</span></code></pre></div><p>å½“ <code>mockImplementationOne</code>å®šä¹‰çš„å®ç°é€ä¸ªè°ƒç”¨å®Œæ¯•æ—¶ï¼Œ å¦‚æœå®šä¹‰äº†<code>jest.fn </code>ï¼Œå®ƒå°†ä½¿ç”¨ <code>jest.fn </code>ã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myMockFn = jest  .<span class="hljs-title function_">fn</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-string">&#x27;default&#x27;</span>)  .<span class="hljs-title function_">mockImplementationOnce</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-string">&#x27;first call&#x27;</span>)  .<span class="hljs-title function_">mockImplementationOnce</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-string">&#x27;second call&#x27;</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myMockFn</span>(), <span class="hljs-title function_">myMockFn</span>(), <span class="hljs-title function_">myMockFn</span>(), <span class="hljs-title function_">myMockFn</span>());<span class="hljs-comment">// &gt; &#x27;first call&#x27;, &#x27;second call&#x27;, &#x27;default&#x27;, &#x27;default&#x27;</span></code></pre></div><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å‡½æ•°è°ƒç”¨éƒ½æ˜¯é“¾å¼çš„ï¼Œå¦‚æœä½ å¸Œæœ›åˆ›å»ºçš„å‡½æ•°æ”¯æŒé“¾å¼è°ƒç”¨ï¼ˆå› ä¸ºè¿”å›äº†thisï¼‰ï¼Œå¯ä»¥ä½¿ç”¨<code>.mockReturnThis()</code> å‡½æ•°æ¥æ”¯æŒã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myObj = &#123;  <span class="hljs-attr">myMethod</span>: jest.<span class="hljs-title function_">fn</span>().<span class="hljs-title function_">mockReturnThis</span>(),&#125;;<span class="hljs-comment">// is the same as</span><span class="hljs-keyword">const</span> otherObj = &#123;  <span class="hljs-attr">myMethod</span>: jest.<span class="hljs-title function_">fn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;  &#125;),&#125;;</code></pre></div><h5 id="è‡ªå®šä¹‰åŒ¹é…å™¨"><a href="#è‡ªå®šä¹‰åŒ¹é…å™¨" class="headerlink" title="è‡ªå®šä¹‰åŒ¹é…å™¨"></a>è‡ªå®šä¹‰åŒ¹é…å™¨<a href="https://jestjs.io/zh-Hans/docs/mock-functions#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%B9%E9%85%8D%E5%99%A8"></a></h5><p>æœ€åï¼Œæµ‹è¯•Mockå‡½æ•°éœ€è¦å†™å¤§é‡çš„æ–­è¨€ï¼Œä¸ºäº†å‡å°‘ä»£ç é‡ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€äº›è‡ªå®šä¹‰åŒ¹é…å™¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// The mock function was called at least once</span><span class="hljs-title function_">expect</span>(mockFunc).<span class="hljs-title function_">toHaveBeenCalled</span>();<span class="hljs-comment">// The mock function was called at least once with the specified args</span><span class="hljs-title function_">expect</span>(mockFunc).<span class="hljs-title function_">toHaveBeenCalledWith</span>(arg1, arg2);<span class="hljs-comment">// The last call to the mock function was called with the specified args</span><span class="hljs-title function_">expect</span>(mockFunc).<span class="hljs-title function_">toHaveBeenLastCalledWith</span>(arg1, arg2);<span class="hljs-comment">// All calls and the name of the mock is written as a snapshot</span><span class="hljs-title function_">expect</span>(mockFunc).<span class="hljs-title function_">toMatchSnapshot</span>();</code></pre></div><p>è¿™äº›åŒ¹é…å™¨æ˜¯æ–­è¨€Mockå‡½æ•°çš„è¯­æ³•ç³–ã€‚ ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è‡ªè¡Œé€‰æ‹©åŒ¹é…å™¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// The mock function was called at least once</span><span class="hljs-title function_">expect</span>(mockFunc.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>.<span class="hljs-property">length</span>).<span class="hljs-title function_">toBeGreaterThan</span>(<span class="hljs-number">0</span>);<span class="hljs-comment">// The mock function was called at least once with the specified args</span><span class="hljs-title function_">expect</span>(mockFunc.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>).<span class="hljs-title function_">toContainEqual</span>([arg1, arg2]);<span class="hljs-comment">// The last call to the mock function was called with the specified args</span><span class="hljs-title function_">expect</span>(mockFunc.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[mockFunc.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]).<span class="hljs-title function_">toEqual</span>([  arg1,  arg2,]);<span class="hljs-comment">// The first arg of the last call to the mock function was `42`</span><span class="hljs-comment">// (note that there is no sugar helper for this specific of an assertion)</span><span class="hljs-title function_">expect</span>(mockFunc.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[mockFunc.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>]).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">42</span>);<span class="hljs-comment">// A snapshot will check that a mock was invoked the same number of times,</span><span class="hljs-comment">// in the same order, with the same arguments. å®ƒè¿˜ä¼šåœ¨åç§°ä¸Šæ–­è¨€ã€‚ å®ƒè¿˜ä¼šåœ¨åç§°ä¸Šæ–­è¨€ã€‚</span><span class="hljs-title function_">expect</span>(mockFunc.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>).<span class="hljs-title function_">toEqual</span>([[arg1, arg2]]);<span class="hljs-title function_">expect</span>(mockFunc.<span class="hljs-title function_">getMockName</span>()).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;a mock name&#x27;</span>);</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å•å…ƒæµ‹è¯•</category>
      
      <category>jest</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å­¦ä¹ JavaScriptæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆç¬¬3ç‰ˆï¼‰è¯»ä¹¦ç¬”è®°</title>
    <link href="/2022/09/14/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/09/14/%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="ç¬¬å››ç« æ ˆ"><a href="#ç¬¬å››ç« æ ˆ" class="headerlink" title="##ç¬¬å››ç« æ ˆ"></a>##ç¬¬å››ç« æ ˆ</h4><p>ä½¿ç”¨æ•°ç»„æ¥å®šä¹‰æ•°æ®ç»“æ„</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = [];  &#125;  <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªï¼ˆæˆ–å‡ ä¸ªï¼‰æ–°å…ƒç´ åˆ°æ ˆé¡¶,è¿”å›å€¼æ˜¯æ•°ç»„çš„é•¿åº¦</span>  <span class="hljs-title function_">push</span>(<span class="hljs-params">element</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">push</span>(element);  &#125;  <span class="hljs-comment">//ç§»é™¤æ ˆé¡¶çš„å…ƒç´ ï¼ŒåŒæ—¶è¿”å›è¢«ç§»é™¤çš„å…ƒç´ </span>  <span class="hljs-title function_">pop</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">pop</span>();  &#125;  <span class="hljs-comment">//è¿”å›æ ˆé¡¶çš„å…ƒç´ ï¼Œä¸å¯¹æ ˆåšä»»ä½•ä¿®æ”¹ï¼ˆè¯¥æ–¹æ³•ä¸ä¼šç§»é™¤æ ˆé¡¶çš„å…ƒç´ ï¼Œä»…ä»…è¿”å›å®ƒï¼‰</span>  <span class="hljs-title function_">peek</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];  &#125;  <span class="hljs-comment">// å¦‚æœæ ˆé‡Œæ²¡æœ‰ä»»ä½•å…ƒç´ å°±è¿”å› trueï¼Œå¦åˆ™è¿”å› false</span>  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> ? <span class="hljs-literal">false</span> : <span class="hljs-literal">true</span>;  &#125;  <span class="hljs-comment">// ç§»é™¤æ ˆé‡Œçš„æ‰€æœ‰å…ƒç´ </span>  <span class="hljs-title function_">clear</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = [];  &#125;  <span class="hljs-comment">//è¿”å›æ ˆé‡Œçš„å…ƒç´ ä¸ªæ•°ã€‚è¯¥æ–¹æ³•å’Œæ•°ç»„çš„ length å±æ€§å¾ˆç±»ä¼¼</span>  <span class="hljs-title function_">size</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>;  &#125;&#125;</code></pre></div><p>ä½¿ç”¨å¯¹è±¡æ¥å®šä¹‰æ ˆ</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = &#123;&#125;;  &#125;  <span class="hljs-title function_">push</span>(<span class="hljs-params">element</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>] = element;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;  &#125;  <span class="hljs-title function_">size</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>;  &#125;  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>;  &#125;  <span class="hljs-title function_">pop</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;    &#125;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;    <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>];    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>];    <span class="hljs-keyword">return</span> result;  &#125;  <span class="hljs-title function_">clear</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = &#123;&#125;;    <span class="hljs-comment">// while(!this.isEmpty())&#123;</span>    <span class="hljs-comment">//   this.pop()</span>    <span class="hljs-comment">// &#125;</span>  &#125;  <span class="hljs-title function_">peek</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-number">1</span>];  &#125;  <span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;    &#125;    <span class="hljs-keyword">let</span> str = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>; i++) &#123;      str = str + <span class="hljs-string">`,<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.items[i]&#125;</span>`</span>;    &#125;    <span class="hljs-keyword">return</span> str;  &#125;&#125;</code></pre></div><p>ä¿æŠ¤æ•°æ®ç»“æ„å†…éƒ¨å…ƒç´ </p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(stack)); <span class="hljs-comment">// &#123;1&#125;</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(stack)); <span class="hljs-comment">// &#123;2&#125;</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stack.<span class="hljs-property">items</span>);</code></pre></div><p>å¤–éƒ¨å¯ä»¥ç›´æ¥æ‹¿åˆ°å†…éƒ¨çš„æ•°æ®ï¼Œå› ä¸ºjsä¸­æ²¡æœ‰ç§æœ‰å±æ€§</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">_count</span> = <span class="hljs-number">0</span>;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">_items</span> = &#123;&#125;;  &#125; &#125;</code></pre></div><p>ä¸€éƒ¨åˆ†å¼€å‘è€…èƒ¡ä½¿ç”¨ä¸‹åˆ’çº¿ä½œä¸ºç§æœ‰å±æ€§çš„è§„èŒƒï¼Œä½†æ˜¯è¿™æ ·ä¾ç„¶å¯ä»¥è¢«è®¿é—®ï¼Œæ²¡æœ‰å®è´¨æ€§çš„ä½œç”¨</p><h5 id="ç”¨-ES2015-çš„é™å®šä½œç”¨åŸŸ-Symbol-å®ç°ç±»"><a href="#ç”¨-ES2015-çš„é™å®šä½œç”¨åŸŸ-Symbol-å®ç°ç±»" class="headerlink" title="ç”¨ ES2015 çš„é™å®šä½œç”¨åŸŸ Symbol å®ç°ç±»"></a>ç”¨ ES2015 çš„é™å®šä½œç”¨åŸŸ Symbol å®ç°ç±»</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> _items = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&quot;stackItem&quot;</span>);<span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">//ä½¿ç”¨è®¡ç®—å±æ€§å’Œsymbolçš„å½¢å¼</span>    <span class="hljs-variable language_">this</span>[_items] = &#123;&#125;;  &#125;&#125;</code></pre></div><p>è™½ç„¶è¿™ç§æ–¹å¼å¯ä»¥è®©ä¸Šè¿°æ–¹æ³•æ²¡åŠæ³•è®¿é—®å†…éƒ¨å±æ€§ä½†æ˜¯å¯ä»¥é€šè¿‡<code>Object.getOwnPropertySymbol(stack)</code>å¯ä»¥è®¿é—®åˆ°ä»¥Symbolä¸ºkeyçš„å±æ€§</p><h5 id="ç”¨-ES2015-çš„-WeakMap-å®ç°ç±»"><a href="#ç”¨-ES2015-çš„-WeakMap-å®ç°ç±»" class="headerlink" title="ç”¨ ES2015 çš„ WeakMap å®ç°ç±»"></a>ç”¨ ES2015 çš„ WeakMap å®ç°ç±»</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> items=<span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>()<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeakMapStack</span>&#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;    items.<span class="hljs-title function_">set</span>(<span class="hljs-variable language_">this</span>,[])  &#125;  <span class="hljs-title function_">push</span>(<span class="hljs-params">element</span>)&#123;    items.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">push</span>(element)  &#125;  <span class="hljs-title function_">pop</span>(<span class="hljs-params"></span>)&#123;    <span class="hljs-keyword">return</span> items.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">pop</span>()  &#125;  <span class="hljs-comment">//...</span>&#125;</code></pre></div><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ï¼Œitems åœ¨ Stack ç±»é‡Œæ˜¯çœŸæ­£çš„ç§æœ‰å±æ€§ã€‚é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œä»£ç çš„å¯è¯»æ€§ ä¸å¼ºï¼Œè€Œä¸”åœ¨æ‰©å±•è¯¥ç±»æ—¶æ— æ³•ç»§æ‰¿ç§æœ‰å±æ€§ã€‚é±¼å’Œç†ŠæŒä¸å¯å…¼å¾—ï¼</p><h5 id="ä½¿ç”¨æ ˆçš„å®ä¾‹"><a href="#ä½¿ç”¨æ ˆçš„å®ä¾‹" class="headerlink" title="ä½¿ç”¨æ ˆçš„å®ä¾‹"></a>ä½¿ç”¨æ ˆçš„å®ä¾‹</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å°†åè¿›åˆ¶è½¬æˆäºŒè¿›åˆ¶</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">Stack</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./Stack.js&quot;</span>;<span class="hljs-keyword">function</span> <span class="hljs-title function_">decimalToBinary</span>(<span class="hljs-params">decNumber</span>) &#123;  decNumber = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Number</span>(decNumber));  <span class="hljs-keyword">const</span> stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>();  <span class="hljs-keyword">let</span> dec = decNumber;  <span class="hljs-keyword">while</span> (dec &gt; <span class="hljs-number">0</span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(dec % <span class="hljs-number">2</span>));    stack.<span class="hljs-title function_">push</span>(dec % <span class="hljs-number">2</span>);    dec = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(dec / <span class="hljs-number">2</span>);  &#125;  <span class="hljs-keyword">let</span> binaryString = <span class="hljs-string">&quot;&quot;</span>;  <span class="hljs-keyword">while</span> (!stack.<span class="hljs-title function_">isEmpty</span>()) &#123;    binaryString += stack.<span class="hljs-title function_">pop</span>().<span class="hljs-title function_">toString</span>();  &#125;  <span class="hljs-keyword">return</span> binaryString;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// æŠŠåè¿›åˆ¶è½¬æ¢æˆåŸºæ•°ä¸º 2ï½36 çš„ä»»æ„è¿›åˆ¶</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">Stack</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./Stack.js&quot;</span>;<span class="hljs-keyword">function</span> <span class="hljs-title function_">baseConverter</span>(<span class="hljs-params">decNumber, base</span>) &#123;  <span class="hljs-keyword">let</span> dec = decNumber;  <span class="hljs-keyword">let</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>();  <span class="hljs-keyword">const</span> digits = <span class="hljs-string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;  <span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;&quot;</span>;  <span class="hljs-keyword">if</span> (!(base &gt;= <span class="hljs-number">2</span> &amp;&amp; base &lt;= <span class="hljs-number">36</span>)) &#123;    <span class="hljs-keyword">return</span> str;  &#125;  <span class="hljs-keyword">while</span> (dec &gt; <span class="hljs-number">0</span>) &#123;    arr.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(dec % base));    dec = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(dec / base);  &#125;  <span class="hljs-keyword">while</span> (!arr.<span class="hljs-title function_">isEmpty</span>()) &#123;    str += digits[arr.<span class="hljs-title function_">pop</span>()];  &#125;  <span class="hljs-keyword">return</span> str;&#125;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">baseConverter</span>(<span class="hljs-number">100345</span>, <span class="hljs-number">2</span>)); <span class="hljs-comment">// 11000011111111001</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">baseConverter</span>(<span class="hljs-number">100345</span>, <span class="hljs-number">8</span>)); <span class="hljs-comment">// 303771</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">baseConverter</span>(<span class="hljs-number">100345</span>, <span class="hljs-number">16</span>)); <span class="hljs-comment">// 187F9</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">baseConverter</span>(<span class="hljs-number">100345</span>, <span class="hljs-number">35</span>)); <span class="hljs-comment">// 2BW0</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œ</title>
    <link href="/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    <url>/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»Ÿ</title>
    <link href="/2022/09/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    <url>/2022/09/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æœºç»„æˆåŸç†</title>
    <link href="/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"/>
    <url>/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç»„æˆåŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„</title>
    <link href="/2022/09/14/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    <url>/2022/09/14/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æœºç½‘è·¯ç¬”è®°(ä¸€)</title>
    <link href="/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E8%B7%AF%E7%AC%94%E8%AE%B0-%E4%B8%80/"/>
    <url>/2022/09/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E8%B7%AF%E7%AC%94%E8%AE%B0-%E4%B8%80/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>vue3é¡¹ç›®æ­å»º</title>
    <link href="/2022/09/13/%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/"/>
    <url>/2022/09/13/%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="é¡¹ç›®æ­å»ºè§„èŒƒ"><a href="#é¡¹ç›®æ­å»ºè§„èŒƒ" class="headerlink" title="é¡¹ç›®æ­å»ºè§„èŒƒ"></a>é¡¹ç›®æ­å»ºè§„èŒƒ</h1><h2 id="ä¸€-ä»£ç è§„èŒƒ"><a href="#ä¸€-ä»£ç è§„èŒƒ" class="headerlink" title="ä¸€. ä»£ç è§„èŒƒ"></a>ä¸€. ä»£ç è§„èŒƒ</h2><h3 id="1-1-é›†æˆeditorconfigé…ç½®"><a href="#1-1-é›†æˆeditorconfigé…ç½®" class="headerlink" title="1.1. é›†æˆeditorconfigé…ç½®"></a>1.1. é›†æˆeditorconfigé…ç½®</h3><p>EditorConfig æœ‰åŠ©äºä¸ºä¸åŒ IDE ç¼–è¾‘å™¨ä¸Šå¤„ç†åŒä¸€é¡¹ç›®çš„å¤šä¸ªå¼€å‘äººå‘˜ç»´æŠ¤ä¸€è‡´çš„ç¼–ç é£æ ¼ã€‚</p><div class="code-wrapper"><pre><code class="hljs yaml"><span class="hljs-comment"># http://editorconfig.org</span><span class="hljs-string">root</span> <span class="hljs-string">=</span> <span class="hljs-literal">true</span>[<span class="hljs-string">*</span>] <span class="hljs-comment"># è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶é€‚ç”¨</span><span class="hljs-string">charset</span> <span class="hljs-string">=</span> <span class="hljs-string">utf-8</span> <span class="hljs-comment"># è®¾ç½®æ–‡ä»¶å­—ç¬¦é›†ä¸º utf-8</span><span class="hljs-string">indent_style</span> <span class="hljs-string">=</span> <span class="hljs-string">space</span> <span class="hljs-comment"># ç¼©è¿›é£æ ¼ï¼ˆtab | spaceï¼‰</span><span class="hljs-string">indent_size</span> <span class="hljs-string">=</span> <span class="hljs-number">2</span> <span class="hljs-comment"># ç¼©è¿›å¤§å°</span><span class="hljs-string">end_of_line</span> <span class="hljs-string">=</span> <span class="hljs-string">lf</span> <span class="hljs-comment"># æ§åˆ¶æ¢è¡Œç±»å‹(lf | cr | crlf)</span><span class="hljs-string">trim_trailing_whitespace</span> <span class="hljs-string">=</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># å»é™¤è¡Œé¦–çš„ä»»æ„ç©ºç™½å­—ç¬¦</span><span class="hljs-string">insert_final_newline</span> <span class="hljs-string">=</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># å§‹ç»ˆåœ¨æ–‡ä»¶æœ«å°¾æ’å…¥ä¸€ä¸ªæ–°è¡Œ</span>[<span class="hljs-string">*.md</span>] <span class="hljs-comment"># è¡¨ç¤ºä»… md æ–‡ä»¶é€‚ç”¨ä»¥ä¸‹è§„åˆ™</span><span class="hljs-string">max_line_length</span> <span class="hljs-string">=</span> <span class="hljs-string">off</span><span class="hljs-string">trim_trailing_whitespace</span> <span class="hljs-string">=</span> <span class="hljs-literal">false</span></code></pre></div><p>VSCodeéœ€è¦å®‰è£…ä¸€ä¸ªæ’ä»¶ï¼šEditorConfig for VS Code</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsq2gh989yj30pj05ggmb.jpg" alt="image-20210722215138665"></p><h3 id="1-2-ä½¿ç”¨prettierå·¥å…·"><a href="#1-2-ä½¿ç”¨prettierå·¥å…·" class="headerlink" title="1.2. ä½¿ç”¨prettierå·¥å…·"></a>1.2. ä½¿ç”¨prettierå·¥å…·</h3><p>Prettier æ˜¯ä¸€æ¬¾å¼ºå¤§çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æŒ JavaScriptã€TypeScriptã€CSSã€SCSSã€Lessã€JSXã€Angularã€Vueã€GraphQLã€JSONã€Markdown ç­‰è¯­è¨€ï¼ŒåŸºæœ¬ä¸Šå‰ç«¯èƒ½ç”¨åˆ°çš„æ–‡ä»¶æ ¼å¼å®ƒéƒ½å¯ä»¥æå®šï¼Œæ˜¯å½“ä¸‹æœ€æµè¡Œçš„ä»£ç æ ¼å¼åŒ–å·¥å…·ã€‚</p><p>1.å®‰è£…prettier</p><div class="code-wrapper"><pre><code class="hljs shell">npm install prettier -D</code></pre></div><p>2.é…ç½®.prettierrcæ–‡ä»¶ï¼š</p><ul><li>useTabsï¼šä½¿ç”¨tabç¼©è¿›è¿˜æ˜¯ç©ºæ ¼ç¼©è¿›ï¼Œé€‰æ‹©falseï¼›</li><li>tabWidthï¼štabæ˜¯ç©ºæ ¼çš„æƒ…å†µä¸‹ï¼Œæ˜¯å‡ ä¸ªç©ºæ ¼ï¼Œé€‰æ‹©2ä¸ªï¼›</li><li>printWidthï¼šå½“è¡Œå­—ç¬¦çš„é•¿åº¦ï¼Œæ¨è80ï¼Œä¹Ÿæœ‰äººå–œæ¬¢100æˆ–è€…120ï¼›</li><li>singleQuoteï¼šä½¿ç”¨å•å¼•å·è¿˜æ˜¯åŒå¼•å·ï¼Œé€‰æ‹©trueï¼Œä½¿ç”¨å•å¼•å·ï¼›</li><li>trailingCommaï¼šåœ¨å¤šè¡Œè¾“å…¥çš„å°¾é€—å·æ˜¯å¦æ·»åŠ ï¼Œè®¾ç½®ä¸º <code>none</code>ï¼›</li><li>semiï¼šè¯­å¥æœ«å°¾æ˜¯å¦è¦åŠ åˆ†å·ï¼Œé»˜è®¤å€¼trueï¼Œé€‰æ‹©falseè¡¨ç¤ºä¸åŠ ï¼›</li></ul><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>  <span class="hljs-attr">&quot;useTabs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;tabWidth&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;printWidth&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">80</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;singleQuote&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;trailingComma&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;none&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;semi&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">&#125;</span></code></pre></div><p>3.åˆ›å»º.prettierignoreå¿½ç•¥æ–‡ä»¶</p><div class="code-wrapper"><pre><code class="hljs gradle"><span class="hljs-regexp">/dist/</span>*.local.output.js<span class="hljs-regexp">/node_modules/</span>****<span class="hljs-comment">/*.svg</span><span class="hljs-comment">**/</span>*.sh<span class="hljs-regexp">/public/</span>*</code></pre></div><p>4.VSCodeéœ€è¦å®‰è£…prettierçš„æ’ä»¶</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsq2acx21rj30ow057mxp.jpg" alt="image-20210722214543454"></p><p>5.æµ‹è¯•prettieræ˜¯å¦ç”Ÿæ•ˆ</p><ul><li>æµ‹è¯•ä¸€ï¼šåœ¨ä»£ç ä¸­ä¿å­˜ä»£ç ï¼›</li><li>æµ‹è¯•äºŒï¼šé…ç½®ä¸€æ¬¡æ€§ä¿®æ”¹çš„å‘½ä»¤,æ‰¹é‡ä¿®æ”¹ï¼›</li></ul><p>åœ¨package.jsonä¸­é…ç½®ä¸€ä¸ªscriptsï¼š</p><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-attr">&quot;prettier&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;prettier --write .&quot;</span></code></pre></div><h3 id="1-3-ä½¿ç”¨ESLintæ£€æµ‹"><a href="#1-3-ä½¿ç”¨ESLintæ£€æµ‹" class="headerlink" title="1.3. ä½¿ç”¨ESLintæ£€æµ‹"></a>1.3. ä½¿ç”¨ESLintæ£€æµ‹</h3><p>1.åœ¨å‰é¢åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±é€‰æ‹©äº†ESLintï¼Œæ‰€ä»¥Vueä¼šé»˜è®¤å¸®åŠ©æˆ‘ä»¬é…ç½®éœ€è¦çš„ESLintç¯å¢ƒã€‚</p><p>2.VSCodeéœ€è¦å®‰è£…ESLintæ’ä»¶ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsq2oq26odj30pw05faaq.jpg" alt="image-20210722215933360"></p><p>3.è§£å†³eslintå’Œprettierå†²çªçš„é—®é¢˜ï¼š</p><p>å®‰è£…æ’ä»¶ï¼šï¼ˆvueåœ¨åˆ›å»ºé¡¹ç›®æ—¶ï¼Œå¦‚æœé€‰æ‹©prettierï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ’ä»¶ä¼šè‡ªåŠ¨å®‰è£…ï¼‰</p><div class="code-wrapper"><pre><code class="hljs shell">npm i eslint-plugin-prettier eslint-config-prettier -D</code></pre></div><p>æ·»åŠ åœ¨eslintrcä¸­æ·»åŠ prettieræ’ä»¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs json">extends<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>  <span class="hljs-string">&quot;plugin:vue/vue3-essential&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;eslint:recommended&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;@vue/typescript/recommended&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;@vue/prettier&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;@vue/prettier/@typescript-eslint&quot;</span><span class="hljs-punctuation">,</span>  &#x27;plugin<span class="hljs-punctuation">:</span>prettier/recommended&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></code></pre></div><h3 id="1-4-git-Huskyå’Œeslint"><a href="#1-4-git-Huskyå’Œeslint" class="headerlink" title="1.4. git Huskyå’Œeslint"></a>1.4. git Huskyå’Œeslint</h3><p>è™½ç„¶æˆ‘ä»¬å·²ç»è¦æ±‚é¡¹ç›®ä½¿ç”¨eslintäº†ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯ç»„å‘˜æäº¤ä»£ç ä¹‹å‰éƒ½å°†eslintä¸­çš„é—®é¢˜è§£å†³æ‰äº†ï¼š</p><ul><li><p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸Œæœ›ä¿è¯ä»£ç ä»“åº“ä¸­çš„ä»£ç éƒ½æ˜¯ç¬¦åˆeslintè§„èŒƒçš„ï¼›</p></li><li><p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ç»„å‘˜æ‰§è¡Œ <code>git commit </code> å‘½ä»¤çš„æ—¶å€™å¯¹å…¶è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœä¸ç¬¦åˆeslintè§„èŒƒï¼Œé‚£ä¹ˆè‡ªåŠ¨é€šè¿‡è§„èŒƒè¿›è¡Œä¿®å¤ï¼›</p></li></ul><p>é‚£ä¹ˆå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿå¯ä»¥é€šè¿‡Huskyå·¥å…·ï¼š</p><ul><li>huskyæ˜¯ä¸€ä¸ªgit hookå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§¦å‘gitæäº¤çš„å„ä¸ªé˜¶æ®µï¼špre-commitã€commit-msgã€pre-push</li></ul><p>å¦‚ä½•ä½¿ç”¨huskyå‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªåŠ¨é…ç½®å‘½ä»¤ï¼š</p><div class="code-wrapper"><pre><code class="hljs shell">npx husky-init &amp;&amp; npm install</code></pre></div><p>è¿™é‡Œä¼šåšä¸‰ä»¶äº‹ï¼š</p><p>1.å®‰è£…huskyç›¸å…³çš„ä¾èµ–ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqq0o5jxmj30bb04qwen.jpg" alt="image-20210723112648927"></p><p>2.åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º <code>.husky</code> æ–‡ä»¶å¤¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs cmake">npx huksy <span class="hljs-keyword">install</span></code></pre></div><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqq16zo75j307703mt8m.jpg" alt="image-20210723112719634"></p><p>3.åœ¨package.jsonä¸­æ·»åŠ ä¸€ä¸ªè„šæœ¬ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqq26phpxj30dj06fgm3.jpg" alt="image-20210723112817691"></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å»å®Œæˆä¸€ä¸ªæ“ä½œï¼šåœ¨è¿›è¡Œcommitæ—¶ï¼Œæ‰§è¡Œlintè„šæœ¬ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqq3hn229j30nf04z74q.jpg" alt="image-20210723112932943"></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰§è¡Œgit commitçš„æ—¶å€™ä¼šè‡ªåŠ¨å¯¹ä»£ç è¿›è¡Œlintæ ¡éªŒã€‚</p><h3 id="1-5-git-commitè§„èŒƒ"><a href="#1-5-git-commitè§„èŒƒ" class="headerlink" title="1.5. git commitè§„èŒƒ"></a>1.5. git commitè§„èŒƒ</h3><h4 id="1-5-1-ä»£ç æäº¤é£æ ¼"><a href="#1-5-1-ä»£ç æäº¤é£æ ¼" class="headerlink" title="1.5.1. ä»£ç æäº¤é£æ ¼"></a>1.5.1. ä»£ç æäº¤é£æ ¼</h4><p>é€šå¸¸æˆ‘ä»¬çš„git commitä¼šæŒ‰ç…§ç»Ÿä¸€çš„é£æ ¼æ¥æäº¤ï¼Œè¿™æ ·å¯ä»¥å¿«é€Ÿå®šä½æ¯æ¬¡æäº¤çš„å†…å®¹ï¼Œæ–¹ä¾¿ä¹‹åå¯¹ç‰ˆæœ¬è¿›è¡Œæ§åˆ¶ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqw17gaqjj30to0cj3zp.jpg"></p><p>ä½†æ˜¯å¦‚æœæ¯æ¬¡æ‰‹åŠ¨æ¥ç¼–å†™è¿™äº›æ˜¯æ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå·¥å…·ï¼šCommitizen</p><ul><li>Commitizen æ˜¯ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬ç¼–å†™è§„èŒƒ commit message çš„å·¥å…·ï¼›</li></ul><p>1.å®‰è£…Commitizen</p><div class="code-wrapper"><pre><code class="hljs shell">npm install commitizen -D</code></pre></div><p>2.å®‰è£…cz-conventional-changelogï¼Œå¹¶ä¸”åˆå§‹åŒ–cz-conventional-changelogï¼š</p><div class="code-wrapper"><pre><code class="hljs shell">npx commitizen init cz-conventional-changelog --save-dev --save-exact</code></pre></div><p>è¿™ä¸ªå‘½ä»¤ä¼šå¸®åŠ©æˆ‘ä»¬å®‰è£…cz-conventional-changelogï¼š</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqvz2odi4j30ek00zmx2.jpg" alt="image-20210723145249096"></p><p>å¹¶ä¸”åœ¨package.jsonä¸­è¿›è¡Œé…ç½®ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqvzftay5j30iu04k74d.jpg"></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æäº¤ä»£ç éœ€è¦ä½¿ç”¨ <code>npx cz</code>ï¼š</p><ul><li>ç¬¬ä¸€æ­¥æ˜¯é€‰æ‹©typeï¼Œæœ¬æ¬¡æ›´æ–°çš„ç±»å‹</li></ul><table><thead><tr><th>Type</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>feat</td><td>æ–°å¢ç‰¹æ€§ (feature)</td></tr><tr><td>fix</td><td>ä¿®å¤ Bug(bug fix)</td></tr><tr><td>docs</td><td>ä¿®æ”¹æ–‡æ¡£ (documentation)</td></tr><tr><td>style</td><td>ä»£ç æ ¼å¼ä¿®æ”¹(white-space, formatting, missing semi colons, etc)</td></tr><tr><td>refactor</td><td>ä»£ç é‡æ„(refactor)</td></tr><tr><td>perf</td><td>æ”¹å–„æ€§èƒ½(A code change that improves performance)</td></tr><tr><td>test</td><td>æµ‹è¯•(when adding missing tests)</td></tr><tr><td>build</td><td>å˜æ›´é¡¹ç›®æ„å»ºæˆ–å¤–éƒ¨ä¾èµ–ï¼ˆä¾‹å¦‚ scopes: webpackã€gulpã€npm ç­‰ï¼‰</td></tr><tr><td>ci</td><td>æ›´æ”¹æŒç»­é›†æˆè½¯ä»¶çš„é…ç½®æ–‡ä»¶å’Œ package ä¸­çš„ scripts å‘½ä»¤ï¼Œä¾‹å¦‚ scopes: Travis, Circle ç­‰</td></tr><tr><td>chore</td><td>å˜æ›´æ„å»ºæµç¨‹æˆ–è¾…åŠ©å·¥å…·(æ¯”å¦‚æ›´æ”¹æµ‹è¯•ç¯å¢ƒ)</td></tr><tr><td>revert</td><td>ä»£ç å›é€€</td></tr></tbody></table><ul><li>ç¬¬äºŒæ­¥é€‰æ‹©æœ¬æ¬¡ä¿®æ”¹çš„èŒƒå›´ï¼ˆä½œç”¨åŸŸï¼‰</li></ul><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqw8ca15oj30r600wmx4.jpg" alt="image-20210723150147510"></p><ul><li>ç¬¬ä¸‰æ­¥é€‰æ‹©æäº¤çš„ä¿¡æ¯</li></ul><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqw8mq3zlj60ni01hmx402.jpg" alt="image-20210723150204780"></p><ul><li>ç¬¬å››æ­¥æäº¤è¯¦ç»†çš„æè¿°ä¿¡æ¯</li></ul><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqw8y05bjj30kt01fjrb.jpg" alt="image-20210723150223287"></p><ul><li>ç¬¬äº”æ­¥æ˜¯å¦æ˜¯ä¸€æ¬¡é‡å¤§çš„æ›´æ”¹</li></ul><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqw9z5vbij30bm00q744.jpg" alt="image-20210723150322122"></p><ul><li>ç¬¬å…­æ­¥æ˜¯å¦å½±å“æŸä¸ªopen issue</li></ul><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqwar8xp1j30fq00ya9x.jpg" alt="image-20210723150407822"></p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨scriptsä¸­æ„å»ºä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œ czï¼š</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gsqwc4gtkxj30e207174t.jpg" alt="image-20210723150526211"></p><h4 id="1-5-2-ä»£ç æäº¤éªŒè¯"><a href="#1-5-2-ä»£ç æäº¤éªŒè¯" class="headerlink" title="1.5.2. ä»£ç æäº¤éªŒè¯"></a>1.5.2. ä»£ç æäº¤éªŒè¯</h4><p>å¦‚æœæˆ‘ä»¬æŒ‰ç…§czæ¥è§„èŒƒäº†æäº¤é£æ ¼ï¼Œä½†æ˜¯ä¾ç„¶æœ‰åŒäº‹é€šè¿‡ <code>git commit</code> æŒ‰ç…§ä¸è§„èŒƒçš„æ ¼å¼æäº¤åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><ul><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡commitlintæ¥é™åˆ¶æäº¤ï¼›</li></ul><p>1.å®‰è£… @commitlint/config-conventional å’Œ @commitlint/cli</p><div class="code-wrapper"><pre><code class="hljs shell">npm i @commitlint/config-conventional @commitlint/cli -D</code></pre></div><p>2.åœ¨æ ¹ç›®å½•åˆ›å»ºcommitlint.config.jsæ–‡ä»¶ï¼Œé…ç½®commitlint</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;  <span class="hljs-attr">extends</span>: [<span class="hljs-string">&#x27;@commitlint/config-conventional&#x27;</span>]&#125;</code></pre></div><p>3.ä½¿ç”¨huskyç”Ÿæˆcommit-msgæ–‡ä»¶ï¼ŒéªŒè¯æäº¤ä¿¡æ¯ï¼š</p><div class="code-wrapper"><pre><code class="hljs shell">npx husky add .husky/commit-msg &quot;npx --no-install commitlint --edit $1&quot;</code></pre></div><h2 id="äºŒ-ç¬¬ä¸‰æ–¹åº“é›†æˆ"><a href="#äºŒ-ç¬¬ä¸‰æ–¹åº“é›†æˆ" class="headerlink" title="äºŒ. ç¬¬ä¸‰æ–¹åº“é›†æˆ"></a>äºŒ. ç¬¬ä¸‰æ–¹åº“é›†æˆ</h2><h3 id="2-1-vue-config-jsé…ç½®"><a href="#2-1-vue-config-jsé…ç½®" class="headerlink" title="2.1. vue.config.jsé…ç½®"></a>2.1. vue.config.jsé…ç½®</h3><p>vue.config.jsæœ‰ä¸‰ç§é…ç½®æ–¹å¼ï¼š</p><ul><li>æ–¹å¼ä¸€ï¼šç›´æ¥é€šè¿‡CLIæä¾›ç»™æˆ‘ä»¬çš„é€‰é¡¹æ¥é…ç½®ï¼š<ul><li>æ¯”å¦‚publicPathï¼šé…ç½®åº”ç”¨ç¨‹åºéƒ¨ç½²çš„å­ç›®å½•ï¼ˆé»˜è®¤æ˜¯ <code>/</code>ï¼Œç›¸å½“äºéƒ¨ç½²åœ¨ <code>https://www.my-app.com/</code>ï¼‰ï¼›</li><li>æ¯”å¦‚outputDirï¼šä¿®æ”¹è¾“å‡ºçš„æ–‡ä»¶å¤¹ï¼›</li></ul></li><li>æ–¹å¼äºŒï¼šé€šè¿‡configureWebpackä¿®æ”¹webpackçš„é…ç½®ï¼š<ul><li>å¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç›´æ¥ä¼šè¢«åˆå¹¶ï¼›</li><li>å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šæ¥æ”¶ä¸€ä¸ªconfigï¼Œå¯ä»¥é€šè¿‡configæ¥ä¿®æ”¹é…ç½®ï¼›</li></ul></li><li>æ–¹å¼ä¸‰ï¼šé€šè¿‡chainWebpackä¿®æ”¹webpackçš„é…ç½®ï¼š<ul><li>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šæ¥æ”¶ä¸€ä¸ªåŸºäº  <a href="https://github.com/mozilla-neutrino/webpack-chain">webpack-chain</a> çš„configå¯¹è±¡ï¼Œå¯ä»¥å¯¹é…ç½®è¿›è¡Œä¿®æ”¹ï¼›</li></ul></li></ul><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;  <span class="hljs-attr">outputDir</span>: <span class="hljs-string">&#x27;./build&#x27;</span>,  <span class="hljs-comment">// configureWebpack: &#123;</span>  <span class="hljs-comment">//   resolve: &#123;</span>  <span class="hljs-comment">//     alias: &#123;</span>  <span class="hljs-comment">//       views: &#x27;@/views&#x27;</span>  <span class="hljs-comment">//     &#125;</span>  <span class="hljs-comment">//   &#125;</span>  <span class="hljs-comment">// &#125;</span>  <span class="hljs-comment">// configureWebpack: (config) =&gt; &#123;</span>  <span class="hljs-comment">//   config.resolve.alias = &#123;</span>  <span class="hljs-comment">//     &#x27;@&#x27;: path.resolve(__dirname, &#x27;src&#x27;),</span>  <span class="hljs-comment">//     views: &#x27;@/views&#x27;</span>  <span class="hljs-comment">//   &#125;</span>  <span class="hljs-comment">// &#125;,</span>  <span class="hljs-attr">chainWebpack</span>: <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> &#123;    config.<span class="hljs-property">resolve</span>.<span class="hljs-property">alias</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;@&#x27;</span>, path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;src&#x27;</span>)).<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;views&#x27;</span>, <span class="hljs-string">&#x27;@/views&#x27;</span>)  &#125;&#125;</code></pre></div><h3 id="2-2-vue-routeré›†æˆ"><a href="#2-2-vue-routeré›†æˆ" class="headerlink" title="2.2. vue-routeré›†æˆ"></a>2.2. vue-routeré›†æˆ</h3><p>å®‰è£…vue-routerçš„æœ€æ–°ç‰ˆæœ¬ï¼š</p><div class="code-wrapper"><pre><code class="hljs shell">npm install vue-router@next</code></pre></div><p>åˆ›å»ºrouterå¯¹è±¡ï¼š</p><div class="code-wrapper"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; createRouter, createWebHashHistory &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">RouteRecordRaw</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><span class="hljs-keyword">const</span> <span class="hljs-attr">routes</span>: <span class="hljs-title class_">RouteRecordRaw</span>[] = [  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span>,    <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/main&#x27;</span>  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/main&#x27;</span>,    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;../views/main/main.vue&#x27;</span>)  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/login&#x27;</span>,    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;../views/login/login.vue&#x27;</span>)  &#125;]<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>(&#123;  routes,  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHashHistory</span>()&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router</code></pre></div><p>å®‰è£…routerï¼š</p><div class="code-wrapper"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router&#x27;</span><span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">use</span>(router).<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)</code></pre></div><p>åœ¨App.vueä¸­é…ç½®è·³è½¬ï¼š</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/login&quot;</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/main&quot;</span>&gt;</span>é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><h3 id="2-3-vuexé›†æˆ"><a href="#2-3-vuexé›†æˆ" class="headerlink" title="2.3. vuexé›†æˆ"></a>2.3. vuexé›†æˆ</h3><p>å®‰è£…vuexï¼š</p><div class="code-wrapper"><pre><code class="hljs shell">npm install vuex@next</code></pre></div><p>åˆ›å»ºstoreå¯¹è±¡ï¼š</p><div class="code-wrapper"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; createStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(&#123;  <span class="hljs-title function_">state</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> &#123;      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;coderwhy&#x27;</span>    &#125;  &#125;&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store</code></pre></div><p>å®‰è£…storeï¼š</p><div class="code-wrapper"><pre><code class="hljs ts"><span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">use</span>(router).<span class="hljs-title function_">use</span>(store).<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)</code></pre></div><p>åœ¨App.vueä¸­ä½¿ç”¨ï¼š</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>&#123;&#123; $store.state.name &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></code></pre></div><h3 id="2-4-element-plusé›†æˆ"><a href="#2-4-element-plusé›†æˆ" class="headerlink" title="2.4. element-plusé›†æˆ"></a>2.4. element-plusé›†æˆ</h3><p>Element Plusï¼Œä¸€å¥—ä¸ºå¼€å‘è€…ã€è®¾è®¡å¸ˆå’Œäº§å“ç»ç†å‡†å¤‡çš„åŸºäº Vue 3.0 çš„æ¡Œé¢ç«¯ç»„ä»¶åº“ï¼š</p><ul><li>ç›¸ä¿¡å¾ˆå¤šåŒå­¦åœ¨Vue2ä¸­éƒ½ä½¿ç”¨è¿‡element-uiï¼Œè€Œelement-plusæ­£æ˜¯element-uié’ˆå¯¹äºvue3å¼€å‘çš„ä¸€ä¸ªUIç»„ä»¶åº“ï¼›</li><li>å®ƒçš„ä½¿ç”¨æ–¹å¼å’Œå¾ˆå¤šå…¶ä»–çš„ç»„ä»¶åº“æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å­¦ä¼šelement-plusï¼Œå…¶ä»–ç±»ä¼¼äºant-design-vueã€NaiveUIã€VantUIéƒ½æ˜¯å·®ä¸å¤šçš„ï¼›</li></ul><p>å®‰è£…element-plus</p><div class="code-wrapper"><pre><code class="hljs shell">npm install element-plus</code></pre></div><h4 id="2-4-1-å…¨å±€å¼•å…¥"><a href="#2-4-1-å…¨å±€å¼•å…¥" class="headerlink" title="2.4.1. å…¨å±€å¼•å…¥"></a>2.4.1. å…¨å±€å¼•å…¥</h4><p>ä¸€ç§å¼•å…¥element-plusçš„æ–¹å¼æ˜¯å…¨å±€å¼•å…¥ï¼Œä»£è¡¨çš„å«ä¹‰æ˜¯æ‰€æœ‰çš„ç»„ä»¶å’Œæ’ä»¶éƒ½ä¼šè¢«è‡ªåŠ¨æ³¨å†Œï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">ElementPlus</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;element-plus&#x27;</span><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;element-plus/lib/theme-chalk/index.css&#x27;</span><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router&#x27;</span><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">use</span>(router).<span class="hljs-title function_">use</span>(store).<span class="hljs-title function_">use</span>(<span class="hljs-title class_">ElementPlus</span>).<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)</code></pre></div><h4 id="2-4-2-å±€éƒ¨å¼•å…¥"><a href="#2-4-2-å±€éƒ¨å¼•å…¥" class="headerlink" title="2.4.2. å±€éƒ¨å¼•å…¥"></a>2.4.2. å±€éƒ¨å¼•å…¥</h4><p>ä¹Ÿå°±æ˜¯åœ¨å¼€å‘ä¸­ç”¨åˆ°æŸä¸ªç»„ä»¶å¯¹æŸä¸ªç»„ä»¶è¿›è¡Œå¼•å…¥ï¼š</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;template&gt;  &lt;div id=&quot;app&quot;&gt;    &lt;router-link to=&quot;/login&quot;&gt;ç™»å½•&lt;/router-link&gt;    &lt;router-link to=&quot;/main&quot;&gt;é¦–é¡µ&lt;/router-link&gt;    &lt;router-view&gt;&lt;/router-view&gt;    &lt;h2&gt;&#123;&#123; $store.state.name &#125;&#125;&lt;/h2&gt;    &lt;el-button&gt;é»˜è®¤æŒ‰é’®&lt;/el-button&gt;    &lt;el-button type=&quot;primary&quot;&gt;ä¸»è¦æŒ‰é’®&lt;/el-button&gt;    &lt;el-button type=&quot;success&quot;&gt;æˆåŠŸæŒ‰é’®&lt;/el-button&gt;    &lt;el-button type=&quot;info&quot;&gt;ä¿¡æ¯æŒ‰é’®&lt;/el-button&gt;    &lt;el-button type=&quot;warning&quot;&gt;è­¦å‘ŠæŒ‰é’®&lt;/el-button&gt;    &lt;el-button type=&quot;danger&quot;&gt;å±é™©æŒ‰é’®&lt;/el-button&gt;  &lt;/div&gt;&lt;/template&gt;&lt;script lang=&quot;ts&quot;&gt;import &#123; defineComponent &#125; from &#x27;vue&#x27;import &#123; ElButton &#125; from &#x27;element-plus&#x27;export default defineComponent(&#123;  name: &#x27;App&#x27;,  components: &#123;    ElButton  &#125;&#125;)&lt;/script&gt;&lt;style lang=&quot;less&quot;&gt;&lt;/style&gt;</code></pre></div><p>ä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°æ˜¯æ²¡æœ‰å¯¹åº”çš„æ ·å¼çš„ï¼Œå¼•å…¥æ ·å¼æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>å…¨å±€å¼•ç”¨æ ·å¼ï¼ˆåƒä¹‹å‰åšçš„é‚£æ ·ï¼‰ï¼›</li><li>å±€éƒ¨å¼•ç”¨æ ·å¼ï¼ˆé€šè¿‡babelçš„æ’ä»¶ï¼‰ï¼›</li></ul><p>1.å®‰è£…babelçš„æ’ä»¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs shell">npm install babel-plugin-import -D</code></pre></div><p>2.é…ç½®babel.config.js</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;  <span class="hljs-attr">plugins</span>: [    [      <span class="hljs-string">&#x27;import&#x27;</span>,      &#123;        <span class="hljs-attr">libraryName</span>: <span class="hljs-string">&#x27;element-plus&#x27;</span>,        <span class="hljs-attr">customStyleName</span>: <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> &#123;          <span class="hljs-keyword">return</span> <span class="hljs-string">`element-plus/lib/theme-chalk/<span class="hljs-subst">$&#123;name&#125;</span>.css`</span>        &#125;      &#125;    ]  ],  <span class="hljs-attr">presets</span>: [<span class="hljs-string">&#x27;@vue/cli-plugin-babel/preset&#x27;</span>]&#125;</code></pre></div><p>ä½†æ˜¯è¿™é‡Œä¾ç„¶æœ‰ä¸ªå¼Šç«¯ï¼š</p><ul><li>è¿™äº›ç»„ä»¶æˆ‘ä»¬åœ¨å¤šä¸ªé¡µé¢æˆ–è€…ç»„ä»¶ä¸­ä½¿ç”¨çš„æ—¶å€™ï¼Œéƒ½éœ€è¦å¯¼å…¥å¹¶ä¸”åœ¨componentsä¸­è¿›è¡Œæ³¨å†Œï¼›</li><li>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬åœ¨å…¨å±€æ³¨å†Œä¸€æ¬¡ï¼›</li></ul><div class="code-wrapper"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123;  <span class="hljs-title class_">ElButton</span>,  <span class="hljs-title class_">ElTable</span>,  <span class="hljs-title class_">ElAlert</span>,  <span class="hljs-title class_">ElAside</span>,  <span class="hljs-title class_">ElAutocomplete</span>,  <span class="hljs-title class_">ElAvatar</span>,  <span class="hljs-title class_">ElBacktop</span>,  <span class="hljs-title class_">ElBadge</span>,&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;element-plus/lib/components&#x27;</span><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<span class="hljs-keyword">const</span> components = [  <span class="hljs-title class_">ElButton</span>,  <span class="hljs-title class_">ElTable</span>,  <span class="hljs-title class_">ElAlert</span>,  <span class="hljs-title class_">ElAside</span>,  <span class="hljs-title class_">ElAutocomplete</span>,  <span class="hljs-title class_">ElAvatar</span>,  <span class="hljs-title class_">ElBacktop</span>,  <span class="hljs-title class_">ElBadge</span>]<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> cpn <span class="hljs-keyword">of</span> components) &#123;  app.<span class="hljs-title function_">component</span>(cpn.<span class="hljs-property">name</span>, cpn)&#125;</code></pre></div><p>20211212 æ–°ç‰ˆæœ¬æŒ‰éœ€è‡ªåŠ¨å¯¼å…¥elementplus</p><div class="code-wrapper"><pre><code class="hljs php"><span class="hljs-comment">// webpack.config.js</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">AutoImport</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;unplugin-auto-import/webpack&#x27;</span>)<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">Components</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;unplugin-vue-components/webpack&#x27;</span>)<span class="hljs-keyword">const</span> &#123; ElementPlusResolver &#125; = <span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;unplugin-vue-components/resolvers&#x27;</span>)module.exports = &#123;  <span class="hljs-comment">// ...</span>  plugins: [    <span class="hljs-title function_ invoke__">AutoImport</span>(&#123;      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title function_ invoke__">ElementPlusResolver</span>()],    &#125;),    <span class="hljs-title function_ invoke__">Components</span>(&#123;      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title function_ invoke__">ElementPlusResolver</span>()],    &#125;),  ],&#125;</code></pre></div><h3 id="2-5-axiosé›†æˆ"><a href="#2-5-axiosé›†æˆ" class="headerlink" title="2.5. axiosé›†æˆ"></a>2.5. axiosé›†æˆ</h3><p>å®‰è£…axiosï¼š</p><div class="code-wrapper"><pre><code class="hljs shell">npm install axios</code></pre></div><p>å°è£…axiosï¼š</p><div class="code-wrapper"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> axios, &#123; <span class="hljs-title class_">AxiosInstance</span>, <span class="hljs-title class_">AxiosRequestConfig</span>, <span class="hljs-title class_">AxiosResponse</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Result</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./types&#x27;</span><span class="hljs-keyword">import</span> &#123; useUserStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;/@/store/modules/user&#x27;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">HYRequest</span> &#123;  <span class="hljs-keyword">private</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">AxiosInstance</span>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">AxiosRequestConfig</span>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options: AxiosRequestConfig</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = options    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span> = axios.<span class="hljs-title function_">create</span>(options)    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(      <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> &#123;        <span class="hljs-keyword">const</span> token = <span class="hljs-title function_">useUserStore</span>().<span class="hljs-property">getToken</span>        <span class="hljs-keyword">if</span> (token) &#123;          config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">$&#123;token&#125;</span>`</span>        &#125;        <span class="hljs-keyword">return</span> config      &#125;,      <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;        <span class="hljs-keyword">return</span> err      &#125;    )    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(      <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;        <span class="hljs-comment">// æ‹¦æˆªå“åº”çš„æ•°æ®</span>        <span class="hljs-keyword">if</span> (res.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">0</span>) &#123;          <span class="hljs-keyword">return</span> res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>        &#125;        <span class="hljs-keyword">return</span> res.<span class="hljs-property">data</span>      &#125;,      <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;        <span class="hljs-keyword">return</span> err      &#125;    )  &#125;  request&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">AxiosRequestConfig</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>        .<span class="hljs-property">request</span>&lt;<span class="hljs-built_in">any</span>, <span class="hljs-title class_">AxiosResponse</span>&lt;<span class="hljs-title class_">Result</span>&lt;T&gt;&gt;&gt;(config)        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;          <span class="hljs-title function_">resolve</span>((res <span class="hljs-keyword">as</span> <span class="hljs-built_in">unknown</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Promise</span>&lt;T&gt;)        &#125;)        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;          <span class="hljs-title function_">reject</span>(err)        &#125;)    &#125;)  &#125;  get&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">AxiosRequestConfig</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(&#123; ...config, <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span> &#125;)  &#125;  post&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">AxiosRequestConfig</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(&#123; ...config, <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span> &#125;)  &#125;  patch&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">AxiosRequestConfig</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(&#123; ...config, <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;PATCH&#x27;</span> &#125;)  &#125;  <span class="hljs-keyword">delete</span>&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">AxiosRequestConfig</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(&#123; ...config, <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;DELETE&#x27;</span> &#125;)  &#125;&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">HYRequest</span></code></pre></div><h3 id="2-6-VSCodeé…ç½®"><a href="#2-6-VSCodeé…ç½®" class="headerlink" title="2.6. VSCodeé…ç½®"></a>2.6. VSCodeé…ç½®</h3><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>  <span class="hljs-attr">&quot;workbench.iconTheme&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vscode-great-icons&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.fontSize&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">17</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;eslint.migration.2_x&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;off&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;[javascript]&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;editor.defaultFormatter&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dbaeumer.vscode-eslint&quot;</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;files.autoSave&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;afterDelay&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.tabSize&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;terminal.integrated.fontSize&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">16</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.renderWhitespace&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;all&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.quickSuggestions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;strings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;debug.console.fontSize&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;window.zoomLevel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;emmet.includeLanguages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;javascript&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;javascriptreact&quot;</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;explorer.confirmDragAndDrop&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;workbench.tree.indent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">16</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;javascript.updateImportsOnFileMove.enabled&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;always&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.wordWrap&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;on&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;path-intellisense.mappings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;@&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;$&#123;workspaceRoot&#125;/src&quot;</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;hediet.vscode-drawio.local-storage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;eyIuZHJhd2lvLWNvbmZpZyI6IntcImxhbmd1YWdlXCI6XCJcIixcImN1c3RvbUZvbnRzXCI6W10sXCJsaWJyYXJpZXNcIjpcImdlbmVyYWw7YmFzaWM7YXJyb3dzMjtmbG93Y2hhcnQ7ZXI7c2l0ZW1hcDt1bWw7YnBtbjt3ZWJpY29uc1wiLFwiY3VzdG9tTGlicmFyaWVzXCI6W1wiTC5zY3JhdGNocGFkXCJdLFwicGx1Z2luc1wiOltdLFwicmVjZW50Q29sb3JzXCI6W1wiRkYwMDAwXCIsXCIwMENDNjZcIixcIm5vbmVcIixcIkNDRTVGRlwiLFwiNTI1MjUyXCIsXCJGRjMzMzNcIixcIjMzMzMzM1wiLFwiMzMwMDAwXCIsXCIwMENDQ0NcIixcIkZGNjZCM1wiLFwiRkZGRkZGMDBcIl0sXCJmb3JtYXRXaWR0aFwiOjI0MCxcImNyZWF0ZVRhcmdldFwiOmZhbHNlLFwicGFnZUZvcm1hdFwiOntcInhcIjowLFwieVwiOjAsXCJ3aWR0aFwiOjExNjksXCJoZWlnaHRcIjoxNjU0fSxcInNlYXJjaFwiOnRydWUsXCJzaG93U3RhcnRTY3JlZW5cIjp0cnVlLFwiZ3JpZENvbG9yXCI6XCIjZDBkMGQwXCIsXCJkYXJrR3JpZENvbG9yXCI6XCIjNmU2ZTZlXCIsXCJhdXRvc2F2ZVwiOnRydWUsXCJyZXNpemVJbWFnZXNcIjpudWxsLFwib3BlbkNvdW50ZXJcIjowLFwidmVyc2lvblwiOjE4LFwidW5pdFwiOjEsXCJpc1J1bGVyT25cIjpmYWxzZSxcInVpXCI6XCJcIn0ifQ==&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;hediet.vscode-drawio.theme&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Kennedy&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.fontFamily&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Source Code Pro, &#x27;Courier New&#x27;, monospace&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.smoothScrolling&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.formatOnSave&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.defaultFormatter&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;esbenp.prettier-vscode&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;workbench.colorTheme&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Atom One Dark&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;vetur.completion.autoImport&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;security.workspace.trust.untrustedFiles&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;open&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;eslint.lintTask.enable&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;eslint.alwaysShowStatus&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">&quot;editor.codeActionsOnSave&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;source.fixAll.eslint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span></code></pre></div><h2 id="ä¸‰-æ¥å£æ–‡æ¡£"><a href="#ä¸‰-æ¥å£æ–‡æ¡£" class="headerlink" title="ä¸‰. æ¥å£æ–‡æ¡£"></a>ä¸‰. æ¥å£æ–‡æ¡£</h2><p><a href="https://documenter.getpostman.com/view/12387168/TzsfmQvw">https://documenter.getpostman.com/view/12387168/TzsfmQvw</a></p><p>baseURLçš„å€¼ï¼š</p><div class="code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">152.136</span>.<span class="hljs-number">185.210</span>:<span class="hljs-number">5000</span></code></pre></div><p>è®¾ç½®å…¨å±€tokençš„æ–¹æ³•ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> res = pm.<span class="hljs-property">response</span>.<span class="hljs-title function_">json</span>();pm.<span class="hljs-property">globals</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">&quot;token&quot;</span>, res.<span class="hljs-property">data</span>.<span class="hljs-property">token</span>);</code></pre></div><p>æ¥å£æ–‡æ¡£v2ç‰ˆæœ¬ï¼šï¼ˆæœ‰éƒ¨åˆ†æ›´æ–°ï¼‰</p><p><a href="https://documenter.getpostman.com/view/12387168/TzzDKb12">https://documenter.getpostman.com/view/12387168/TzzDKb12</a></p>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è™šæ‹Ÿåˆ—è¡¨çš„å®ç°</title>
    <link href="/2022/09/11/%E8%99%9A%E6%8B%9F%E5%88%97%E8%A1%A8%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/09/11/%E8%99%9A%E6%8B%9F%E5%88%97%E8%A1%A8%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>å·¥å…·</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°ä¸€ä¸ªæ—¶é—´æ ¼å¼åŒ–å·¥å…·</title>
    <link href="/2022/09/11/%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7/"/>
    <url>/2022/09/11/%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å¦‚ä½•å°è£…ä¸€ä¸ªæ—¶é—´æ ¼å¼åŒ–å·¥å…·</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">formatTime</span>(<span class="hljs-params">timeStamp, fmtString</span>) &#123;  <span class="hljs-comment">// 1.å…ˆå°†æ—¶é—´æˆ³è½¬æˆDateçš„å½¢å¼</span>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(timeStamp);  <span class="hljs-comment">// 2.å»ºç«‹æ­£åˆ™è¡¨è¾¾å¼å’Œå€¼åŒ¹é…çš„æ˜ å°„</span>  <span class="hljs-keyword">const</span> dateObject = &#123;    <span class="hljs-string">&quot;y+&quot;</span>: date.<span class="hljs-title function_">getFullYear</span>(),    <span class="hljs-string">&quot;M+&quot;</span>: date.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>,    <span class="hljs-string">&quot;d+&quot;</span>: date.<span class="hljs-title function_">getDate</span>(),    <span class="hljs-string">&quot;h+&quot;</span>: date.<span class="hljs-title function_">getHours</span>(),    <span class="hljs-string">&quot;m+&quot;</span>: date.<span class="hljs-title function_">getMinutes</span>(),    <span class="hljs-string">&quot;s+&quot;</span>: date.<span class="hljs-title function_">getSeconds</span>(),  &#125;;  <span class="hljs-comment">// éå†dateObjectåŒ¹é…</span>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> dateObject) &#123;    <span class="hljs-keyword">const</span> reg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(key);    <span class="hljs-keyword">if</span> (reg.<span class="hljs-title function_">test</span>(fmtString)) &#123;      fmtString = fmtString.<span class="hljs-title function_">replace</span>(reg, (dateObject[key] + <span class="hljs-string">&quot;&quot;</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>));    &#125;  &#125;  <span class="hljs-keyword">return</span> fmtString;&#125;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">formatTime</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>(), <span class="hljs-string">&quot;yyyy-MM-dd:hh:mm:ss&quot;</span>)); <span class="hljs-comment">//2022-09-11:17:05:48</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>å·¥å…·</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>electron å®‰è£…é—®é¢˜</title>
    <link href="/2022/09/11/electron-%E5%AE%89%E8%A3%85%E9%97%AE%E9%A2%98/"/>
    <url>/2022/09/11/electron-%E5%AE%89%E8%A3%85%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs crmsh">$ npm install electron --save-devnpm ERR! code <span class="hljs-number">1</span>npm ERR! path C:\Users\<span class="hljs-number">10152</span>\Desktop\study\ä»£ç ç¢å±‘\electronç»ƒä¹ \my-electron-app\node_modules\electronnpm ERR! command failednpm ERR! command C:\WINDOWS\system32\cmd.exe /d /s /c <span class="hljs-keyword">node</span> <span class="hljs-title">install</span>.jsnpm ERR! RequestError: <span class="hljs-keyword">read</span> ECONNRESETnpm ERR!     at ClientRequest.<span class="hljs-tag">&lt;anonymous&gt;</span> (C:\Users\<span class="hljs-number">10152</span>\Desktop\study\ä»£ç ç¢å±‘\electronç»ƒä¹ \my-electron-app\node_modules\got\source\request-as-event-emitter.js:<span class="hljs-number">178</span>:<span class="hljs-number">14</span>)npm ERR!     at Object.onceWrapper (<span class="hljs-keyword">node</span><span class="hljs-title">:events</span>:<span class="hljs-number">642</span>:<span class="hljs-number">26</span>)npm ERR!     at ClientRequest.emit (<span class="hljs-keyword">node</span><span class="hljs-title">:events</span>:<span class="hljs-number">539</span>:<span class="hljs-number">35</span>)npm ERR!     at ClientRequest.origin.emit (C:\Users\<span class="hljs-number">10152</span>\Desktop\study\ä»£ç ç¢å±‘\electronç»ƒä¹ \my-electron-app\node_modules\@szmarczak\http-timer\source\index.js:<span class="hljs-number">37</span>:<span class="hljs-number">11</span>)npm ERR!     at TLSSocket.socketErrorListener (<span class="hljs-keyword">node</span><span class="hljs-title">:_http_client</span>:<span class="hljs-number">454</span>:<span class="hljs-number">9</span>)npm ERR!     at TLSSocket.emit (<span class="hljs-keyword">node</span><span class="hljs-title">:events</span>:<span class="hljs-number">527</span>:<span class="hljs-number">28</span>)npm ERR!     at emitErrorNT (<span class="hljs-keyword">node</span><span class="hljs-title">:internal</span>/streams/destroy:<span class="hljs-number">157</span>:<span class="hljs-number">8</span>)npm ERR!     at emitErrorCloseNT (<span class="hljs-keyword">node</span><span class="hljs-title">:internal</span>/streams/destroy:<span class="hljs-number">122</span>:<span class="hljs-number">3</span>)npm ERR!     at processTicksAndRejections (<span class="hljs-keyword">node</span><span class="hljs-title">:internal</span>/process/task_queues:<span class="hljs-number">83</span>:<span class="hljs-number">21</span>)npm ERR! A complete log of this run can be found <span class="hljs-keyword">in</span>:npm ERR!     D:\nodejs\node_cache\_logs\<span class="hljs-number">2022</span>-<span class="hljs-number">09</span>-<span class="hljs-number">10</span>T16_55_35_246Z-debug-<span class="hljs-number">0</span>.log</code></pre></div><p>eletronå®‰è£…ä¸æˆåŠŸå¯ä»¥è®¾ç½®ä¸‹æº</p><div class="code-wrapper"><pre><code class="hljs awk">npm config set ELECTRON_MIRROR https:<span class="hljs-regexp">//</span>npmmirror.com<span class="hljs-regexp">/mirrors/</span>electron/</code></pre></div><h4 id="electron-æ§åˆ¶å°ä¸­æ–‡ä¹±ç é—®é¢˜"><a href="#electron-æ§åˆ¶å°ä¸­æ–‡ä¹±ç é—®é¢˜" class="headerlink" title="electron æ§åˆ¶å°ä¸­æ–‡ä¹±ç é—®é¢˜"></a>electron æ§åˆ¶å°ä¸­æ–‡ä¹±ç é—®é¢˜</h4><div class="code-wrapper"><pre><code class="hljs stata"><span class="hljs-string">&quot;scripts&quot;</span>: &#123;   <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;echo \&quot;</span><span class="hljs-keyword">Error</span>: <span class="hljs-keyword">no</span> <span class="hljs-keyword">test</span> specified\<span class="hljs-string">&quot; &amp;&amp; exit 1&quot;</span>,   <span class="hljs-string">&quot;start&quot;</span>: <span class="hljs-string">&quot;chcp 65001 &amp;&amp; electron .&quot;</span> &#125;,</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Electron</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Electronå­¦ä¹ </title>
    <link href="/2022/09/10/Electron%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/09/10/Electron%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>Electron</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>httpsäº†è§£</title>
    <link href="/2022/09/09/https%E4%BA%86%E8%A7%A3/"/>
    <url>/2022/09/09/https%E4%BA%86%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>http3äº†è§£</title>
    <link href="/2022/09/09/http3%E4%BA%86%E8%A7%A3/"/>
    <url>/2022/09/09/http3%E4%BA%86%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
      <category>HTTP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>nodeå­¦ä¹ ç¬”è®°</title>
    <link href="/2022/09/09/node%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/09/09/node%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-number">1.</span>nodeçš„è¾“å‡º<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>()<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">clear</span>()<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">trace</span>()<span class="hljs-number">2.</span>å¸¸è§çš„å…¨å±€å¯¹è±¡ç‰¹æ®Šçš„å…¨å±€å¯¹è±¡ï¼Œæ˜¯å„ä¸ªæ¨¡å—éƒ½æœ‰çš„ï¼Œä½†ä¸æ˜¯å±äºå…¨å±€çš„__dirname<span class="hljs-comment">//è·å–å½“å‰æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„ï¼Œä¸åŒ…æ‹¬åé¢çš„æ–‡ä»¶å</span>__filename<span class="hljs-comment">//è·å–å½“å‰æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„åç§°åŒ…æ‹¬æ–‡ä»¶å</span><span class="hljs-built_in">exports</span><span class="hljs-variable language_">module</span><span class="hljs-built_in">require</span>å¸¸è§çš„å…¨å±€å¯¹è±¡processå¯¹è±¡<span class="hljs-variable language_">console</span>å¯¹è±¡å®šæ—¶å™¨å¯¹è±¡<span class="hljs-number">3.</span><span class="hljs-variable language_">global</span>å’Œ<span class="hljs-variable language_">window</span>çš„åŒºåˆ«nodeä¸­æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—<span class="hljs-number">4.</span>æ¨¡å—åŒ–ç«‹å³è°ƒç”¨å‡½æ•°(<span class="hljs-variable constant_">IIFE</span>)æ˜¯è§£å†³æ¨¡å—åŒ–çš„ä¸€ç§æ–¹å¼<span class="hljs-title class_">CommonJS</span>(<span class="hljs-variable constant_">CJS</span>)<span class="hljs-title class_">ESmodule</span>æ¯ä¸ªæ¨¡å—éƒ½æœ‰<span class="hljs-built_in">exports</span>,ä»–ä¼šé»˜è®¤æŒ‡å‘ç©ºå¯¹è±¡,<span class="hljs-built_in">exports</span>æŒ‡å‘çš„ä¸€ä¸ªå¯¹è±¡å¹¶åœ¨å¦å¤–ä¸€ä¸ªæ¨¡å—ä¸­è¢«å¼•ç”¨æ—¶ï¼Œä»–ä»¬æ˜¯æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡<span class="hljs-built_in">require</span>æ˜¯å¯¹<span class="hljs-built_in">exports</span>çš„æµ…æ‹·è´æµ…æ‹·è´çš„æœ¬è´¨å°±æ˜¯å¼•ç”¨èµ‹å€¼<span class="hljs-built_in">exports</span>ä¸­ä¿®æ”¹å˜é‡ä¼šä½¿<span class="hljs-built_in">require</span>å‘ç”Ÿå˜åŒ–<span class="hljs-built_in">require</span>ä¸­çš„ä¿®æ”¹ä¸ä¼šå¯¹<span class="hljs-built_in">exports</span>é€ æˆå½±å“ï¼Œå› ä¸º<span class="hljs-built_in">require</span>æ˜¯å¯¹<span class="hljs-built_in">exports</span>çš„æ‹·è´<span class="hljs-number">5.</span><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>æ¯ä¸€ä¸ªæ¨¡å—éƒ½æœ‰ä¸€ä¸ª<span class="hljs-variable language_">module</span>å®ä¾‹commomjsä¸­æ²¡æœ‰<span class="hljs-variable language_">module</span>.<span class="hljs-property">export</span>çš„æ¦‚å¿µï¼Œnodeä¸­ä½¿ç”¨çš„æ˜¯<span class="hljs-title class_">Moudle</span>ç±»ï¼Œæ¯ä¸€ä¸ªæ¨¡å—éƒ½æ˜¯<span class="hljs-title class_">Modlue</span>çš„å®ä¾‹ï¼Œä¹Ÿæ˜¯<span class="hljs-variable language_">module</span>æ‰€ä»¥åœ¨<span class="hljs-title class_">Node</span>ä¸­çœŸæ­£å¯¼å‡ºçš„å…¶å®ä¸æ˜¯<span class="hljs-keyword">export</span>,è€Œæ˜¯<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>ä¸ºä»€ä¹ˆ<span class="hljs-built_in">exports</span>ä¹Ÿå¯ä»¥å¯¼å‡ºå› ä¸º<span class="hljs-variable language_">module</span>å¯¹è±¡çš„<span class="hljs-built_in">exports</span>å±æ€§æ˜¯<span class="hljs-keyword">export</span>å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>=<span class="hljs-built_in">exports</span><span class="hljs-variable language_">module</span>.<span class="hljs-property">export</span>å¯¼å‡ºçš„å€¼æ‰æ˜¯<span class="hljs-built_in">require</span>çš„å€¼ï¼Œé»˜è®¤<span class="hljs-variable language_">module</span>.<span class="hljs-property">export</span>==<span class="hljs-keyword">export</span>,å¦‚æœ<span class="hljs-variable language_">module</span>.<span class="hljs-property">export</span>æŒ‡å‘å¦å¤–ä¸€ä¸ªå€¼ï¼Œåˆ™<span class="hljs-built_in">require</span>ä¼šå¼•ç”¨è¿™ä¸ªå€¼ï¼Œè€Œä¸æ˜¯<span class="hljs-keyword">export</span>çš„å€¼<span class="hljs-variable language_">module</span>.<span class="hljs-property">export</span>çš„èµ‹å€¼æ˜¯åœ¨é¡¶å±‚çš„<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>=<span class="hljs-built_in">exports</span><span class="hljs-built_in">exports</span>=<span class="hljs-number">123</span><span class="hljs-comment">//module.exportsåœ¨é¡¶å±‚å¼•ç”¨çš„ï¼Œå¦‚æœåé¢å†æ¬¡ä¿®æ”¹exportsçš„æŒ‡å‘ï¼Œåˆ™ä¼šæ— æ•ˆ</span><span class="hljs-number">6.</span><span class="hljs-built_in">require</span>()çš„æŸ¥æ‰¾è§„åˆ™<span class="hljs-number">1.</span>å¦‚æœxæ˜¯æ ¸å¿ƒæ¨¡å—ï¼Œç›´æ¥ä¼šè¿”å›æ ¸å¿ƒæ¨¡å—ï¼Œ<span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;x&quot;</span>)<span class="hljs-comment">//ä¼šç›´æ¥è¿”å›ï¼Œåœæ­¢æŸ¥æ‰¾</span><span class="hljs-number">2.</span>xæ˜¯ä»¥./æˆ–è€…../æˆ–è€…/å¼€å¤´çš„ä¼šå…ˆå°†xå½“ä½œä¸€ä¸ªæ–‡ä»¶å…ˆæŸ¥æ‰¾ï¼Œå¦‚æœæœ‰åç¼€åï¼Œåˆ™æŒ‰åç¼€åæ ¼å¼æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰åç¼€ååˆ™<span class="hljs-number">1.</span>ç›´æ¥æŸ¥æ‰¾æ–‡ä»¶x<span class="hljs-number">2.</span>æŸ¥æ‰¾x.<span class="hljs-property">js</span><span class="hljs-number">3.</span>æŸ¥æ‰¾x.<span class="hljs-property">json</span><span class="hljs-number">4.</span>æŸ¥æ‰¾x.<span class="hljs-property">node</span>å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶ï¼Œåˆ™ä¼šæŠŠä»–å½“æˆä¸€ä¸ªç›®å½•ï¼ŒæŸ¥æ‰¾é‡Œé¢çš„indexæ–‡ä»¶<span class="hljs-number">1.</span>x/index.<span class="hljs-property">js</span><span class="hljs-number">2.</span>x/index.<span class="hljs-property">json</span><span class="hljs-number">3.</span>x/index.<span class="hljs-property">node</span>å¦åˆ™æŠ¥é”™ not found<span class="hljs-number">3.</span>å¦‚æœç›´æ¥æ˜¯ä¸€ä¸ª<span class="hljs-title function_">X</span>(æ²¡æœ‰è·¯å¾„) å¹¶ä¸”Xä¸æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—åˆ™ä»æœ€é‡Œé¢çš„node_module-&gt;æœ€å¤–é¢çš„node_moduleä¸­å»å¯»æ‰¾<span class="hljs-number">7.</span><span class="hljs-built_in">require</span>çš„åŠ è½½è¿‡ç¨‹æ˜¯åŒæ­¥çš„ <span class="hljs-number">8.</span><span class="hljs-variable language_">module</span>.<span class="hljs-property">export</span>=&#123;&#125; <span class="hljs-built_in">exports</span>=<span class="hljs-variable language_">module</span>.<span class="hljs-property">export</span>===<span class="hljs-keyword">export</span>=&#123;&#125; <span class="hljs-variable language_">module</span>.<span class="hljs-property">export</span>=<span class="hljs-built_in">exports</span><span class="hljs-number">9.</span>åœ¨æºç ä¸­<span class="hljs-built_in">exports</span>=<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span><span class="hljs-number">10.</span>æ¨¡å—çš„åŠ è½½è¿‡ç¨‹æ¨¡å—åœ¨è¢«ç¬¬ä¸€æ¬¡å¼•å…¥æ—¶ï¼Œæ¨¡å—ä¸­çš„jsä»£ç ä¼šè¢«è¿è¡Œä¸€æ¬¡æ¨¡å—è¢«å¯¹æ­¤å¼•å…¥æ—¶ï¼Œä¼šè¢«ç¼“å­˜ï¼Œæœ€ç»ˆåªä¼šè¢«åŠ è½½ä¸€æ¬¡å¦‚æœæœ‰å¾ªç¯å¼•å…¥ï¼Œä»–ä¼šæŒ‰æ·±åº¦ä¼˜å…ˆæœç´¢éå†çš„æ–¹å¼è¿›è¡ŒåŠ è½½<span class="hljs-number">11.</span><span class="hljs-variable constant_">ES</span> modulesä¸­<span class="hljs-keyword">export</span> &#123;&#125;<span class="hljs-comment">//ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢æ”¾ç½®è¦åˆ°å¤„çš„å˜é‡çš„åˆ—è¡¨</span><span class="hljs-keyword">import</span>é»˜è®¤å¿…é¡»æ”¾åˆ°é¡¶éƒ¨ï¼Œ<span class="hljs-keyword">import</span>æ˜¯å¼‚æ­¥åŠ è½½ï¼Œ<span class="hljs-keyword">import</span>åŠ è½½æ¨¡å—ä¸å¯ä»¥æ”¾åˆ°é€»è¾‘ä»£ç ä¸­<span class="hljs-title function_">import</span>().<span class="hljs-title function_">then</span>()<span class="hljs-comment">//è¿›è¡ŒåŠ¨æ€åŠ è½½</span><span class="hljs-number">12.</span>commonJSåŠ è½½è¿‡ç¨‹commonjsåŠ è½½jsæ–‡ä»¶çš„è¿‡ç¨‹æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼Œå¹¶ä¸”æ˜¯åŒæ­¥çš„ï¼Œå°±æ˜¯jså¼•æ“åœ¨æ‰§è¡Œä»£ç çš„è¿‡ç¨‹ä¸­åŠ è½½æ¨¡å—åŒæ­¥æ„å‘³ç€ä¸€ä¸ªæ–‡ä»¶åœ¨æ²¡æœ‰åŠ è½½ç»“æŸä¹‹å‰ï¼Œåé¢çš„ä»£ç éƒ½ä¸åŠ åœ¨commonjsé€šè¿‡<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>çš„å¯¼å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¼å‡ºçš„æ˜¯ä¸€ä¸ªå¯¹è±¡æ„å‘³è€…å¯ä»¥å°†è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨åœ¨å…¶ä»–æ¨¡å—ä¸­èµ‹å€¼ç»™å…¶ä»–å˜é‡ï¼Œä½†æ˜¯æœ€ç»ˆä»–ä»¬ä¼šæŒ‡å‘åŒä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆä¸€ä¸ªå˜é‡ä¿®æ”¹äº†å¯¹è±¡çš„å±æ€§ï¼Œæ‰€æœ‰åœ°æ–¹éƒ½ä¼šä¿®æ”¹æ³¨æ„ï¼š<span class="hljs-built_in">require</span>è¿›è¡Œè§£æ„çš„æ—¶å€™ä¸ä¼šä¿®æ”¹ï¼Œå› ä¸ºè§£æ„ä¼šå›ºå®šä¸‹å½“å‰çš„å€¼<span class="hljs-number">13.</span><span class="hljs-variable constant_">ES</span> <span class="hljs-variable language_">module</span>çš„åŠ è½½è¿‡ç¨‹   <span class="hljs-variable constant_">ES</span> <span class="hljs-variable constant_">MODULE</span>åŠ è½½jsæ˜¯ç¼–è¯‘çš„æ—¶å€™åŠ è½½çš„ï¼Œå¹¶ä¸”æ˜¯å¼‚æ­¥çš„   ç¼–è¯‘æ—¶åŠ è½½æ„å‘³ç€<span class="hljs-keyword">import</span>ä¸èƒ½å’Œè¿è¡Œç›¸å…³çš„å†…å®¹æ”¾åœ¨ä¸€èµ·ä½¿ç”¨   æ¯”å¦‚<span class="hljs-keyword">from</span>åé¢çš„è·¯å¾„è¦åŠ¨æ€è·å–   æ¯”å¦‚ä¸èƒ½å°†<span class="hljs-keyword">import</span>æ”¾åˆ°<span class="hljs-keyword">if</span>è¯­å¥çš„ä»£ç å—é‡Œé¢ï¼Œæ‰€ä»¥es <span class="hljs-variable language_">module</span>æ—¶é™æ€è§£æ   å¼‚æ­¥æ„å‘³ç€jså¼•æ“é‡åˆ°<span class="hljs-keyword">import</span>æ—¶ä¼šè·å–åˆ°è¿™ä¸ªjsæ–‡ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªè·å–çš„è¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸ä¼šé˜»å¡è¿›ç¨‹çš„æ‰§è¡Œ   <span class="hljs-keyword">type</span>-=<span class="hljs-variable language_">module</span>ç›¸å½“äºscriptä¸Šçš„<span class="hljs-keyword">async</span>å±æ€§ï¼Œå¦‚æœåé¢è¿˜æœ‰jsä»£ç ï¼Œä»–ä¸ä¼šé˜»å¡jsä»£ç çš„æ‰§è¡Œ   <span class="hljs-variable constant_">ES</span> <span class="hljs-title class_">Module</span>é€šè¿‡<span class="hljs-keyword">export</span>å¯¼å‡ºçš„æ˜¯å˜é‡æœ¬èº«çš„å¼•ç”¨ï¼š <span class="hljs-keyword">export</span>åœ¨å¯¼å‡ºä¸€ä¸ªå˜é‡æ—¶ï¼Œjså¼•æ“ä¼šè§£æè¿™ä¸ªè¯­æ³•ï¼Œå¹¶ä¸”åˆ›å»ºæ¨¡å—ç¯å¢ƒè®°å½•ï¼ˆ<span class="hljs-variable language_">module</span> environment recordï¼‰ï¼› æ¨¡å—ç¯å¢ƒè®°å½•ä¼šå’Œå˜é‡è¿›è¡Œ ç»‘å®šï¼ˆbindingï¼‰ï¼Œå¹¶ä¸”è¿™ä¸ªç»‘å®šæ˜¯å®æ—¶çš„ï¼› è€Œåœ¨å¯¼å…¥çš„åœ°æ–¹ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥å®æ—¶çš„è·å–åˆ°ç»‘å®šçš„æœ€æ–°å€¼çš„ï¼›  æ‰€ä»¥ï¼Œå¦‚æœåœ¨å¯¼å‡ºçš„æ¨¡å—ä¸­ä¿®æ”¹äº†å˜åŒ–ï¼Œé‚£ä¹ˆå¯¼å…¥çš„åœ°æ–¹å¯ä»¥å®æ—¶è·å–æœ€æ–°çš„å˜é‡ï¼›  æ³¨æ„ï¼šåœ¨å¯¼å…¥çš„åœ°æ–¹ä¸å¯ä»¥ä¿®æ”¹å˜é‡ï¼Œå› ä¸ºå®ƒåªæ˜¯è¢«ç»‘å®šåˆ°äº†è¿™ä¸ªå˜é‡ä¸Šï¼ˆå…¶å®æ˜¯ä¸€ä¸ªå¸¸é‡ï¼‰   <span class="hljs-number">14.</span>åœ¨nodeä¸­è¦ä½¿ç”¨es <span class="hljs-variable language_">module</span> æ–¹å¼ä¸€ï¼špackage.<span class="hljs-property">json</span>ä¸­é…ç½®<span class="hljs-attr">type</span>:<span class="hljs-variable language_">module</span> æ–¹å¼äºŒ:ä½¿ç”¨ä»¥.<span class="hljs-property">mjs</span>ç»“å°¾çš„æ–‡ä»¶ <span class="hljs-number">15.</span>å†…ç½®æ¨¡å—path ä»è·¯å¾„è·å–ä¿¡æ¯ <span class="hljs-title function_">dirname</span>()<span class="hljs-comment">//è·å–æ–‡ä»¶çš„çˆ¶æ–‡ä»¶å¤¹</span> <span class="hljs-title function_">basename</span>()<span class="hljs-comment">//è·å–æ–‡ä»¶å</span> <span class="hljs-title function_">extname</span>()<span class="hljs-comment">//è·å–æ–‡ä»¶æ‰©å±•å</span> è·¯å¾„çš„æ‹¼æ¥ å¦‚æœæˆ‘ä»¬å¸Œæœ›å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥ï¼Œä½†æ˜¯ä¸åŒçš„æ“ä½œç³»ç»Ÿå¯èƒ½æ˜¯ä½¿ç”¨ä¸åŒçš„åˆ†éš”ç¬¦ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨path.<span class="hljs-property">join</span>å‡½æ•° å°†æ–‡ä»¶å’ŒæŸä¸ªæ–‡ä»¶å¤¹æ‹¼æ¥ å¦‚æœæˆ‘ä»¬å¸Œæœ›å°†æŸä¸ªæ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‹¼æ¥ï¼Œå¯ä»¥ä½¿ç”¨path.<span class="hljs-property">resolve</span> resolveå‡½æ•°ä¼šåˆ¤æ–­æˆ‘ä»¬æ‹¼æ¥çš„è·¯å¾„å‰é¢æ˜¯å¦æœ‰/æˆ–è€…../æˆ–è€…./ å¦‚æœæœ‰è¡¨ç¤ºæ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œä¼šè¿”å›å¯¹åº”çš„æ‹¼æ¥è·¯å¾„ å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆä¼šå’Œå½“å‰æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹è¿›è¡Œè·¯å¾„çš„æ‹¼æ¥ path.<span class="hljs-title function_">resolve</span>() æ–¹æ³•å°†è·¯å¾„æˆ–è·¯å¾„ç‰‡æ®µçš„åºåˆ—è§£æä¸ºç»å¯¹è·¯å¾„ã€‚ å¦‚æœæ²¡æœ‰ä¼ å…¥ path ç‰‡æ®µï¼Œåˆ™ path.<span class="hljs-title function_">resolve</span>() å°†è¿”å›å½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚  path.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;/foo/bar&#x27;</span>, <span class="hljs-string">&#x27;./baz&#x27;</span>);            <span class="hljs-comment">// è¿”å›: &#x27;/foo/bar/baz&#x27;</span>            path.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;/foo/bar&#x27;</span>, <span class="hljs-string">&#x27;/tmp/file/&#x27;</span>);            <span class="hljs-comment">// è¿”å›: &#x27;/tmp/file&#x27;</span>            path.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;wwwroot&#x27;</span>, <span class="hljs-string">&#x27;static_files/png/&#x27;</span>, <span class="hljs-string">&#x27;../gif/image.gif&#x27;</span>);            <span class="hljs-comment">// å¦‚æœå½“å‰å·¥ä½œç›®å½•æ˜¯ /home/myself/nodeï¼Œ</span>            <span class="hljs-comment">// åˆ™è¿”å› &#x27;/home/myself/node/wwwroot/static_files/gif/image.gif&#x27;</span> <span class="hljs-number">16.</span>fsæ¨¡å— fsæ“ä½œæ–‡ä»¶çš„ä¸‰ç§æ–¹å¼</code></pre></div><p><img src="https://img1.imgtp.com/2022/09/11/T30nJvRF.png" alt="QQæˆªå›¾20220618120700.png"></p><p>17.æ–‡ä»¶æè¿°ç¬¦</p><p>â€‹    åœ¨POSIXç³»ç»Ÿä¸Šï¼Œå¯¹äºæ¯ä¸ªè¿›ç¨‹ï¼Œå†…æ ¸éƒ½ç»´æŠ¤è€…ä¸€å¼ å½“å‰æ‰“å¼€çš„èµ„æºå’Œæ–‡ä»¶çš„è¡¨æ ¼</p><p>â€‹    æ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶éƒ½ä¼šåˆ†é…ä¸€ä¸ªç§°ä¸ºæ–‡ä»¶ç§’å¸ˆå‚…çš„ç®€å•æ•°å­—æ ‡è¯†ç¬¦</p><p>â€‹    åœ¨ç³»ç»Ÿå±‚ï¼Œæ‰€æœ‰ç³»ç»Ÿæ“ä½œéƒ½æ˜¯ä½¿ç”¨è¿™äº›æ–‡ä»¶æè¿°ç¬¦æ¥æ ‡è¯†å’Œè·Ÿè¸ªæ¯ä¸€ä¸ªç‰¹å®šæ–‡ä»¶</p><p>â€‹    windowsç³»ç»Ÿæœ‰ä¸åŒçš„æœºåˆ¶</p><p>â€‹    fs.open()ç”¨äºåˆ†é…æ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä¸€æ—¦è¢«åˆ†é…ï¼Œåˆ™æ–‡ä»¶æè¿°ç¬¦å¯ç”¨äºæ–‡ä»¶çš„è¯»å–æ•°æ®ï¼Œå‘æ–‡ä»¶å†™å…¥æ•°æ®æˆ–è€…è¯·æ±‚å…³äºæ–‡ä»¶çš„ä¿¡æ¯</p><p><img src="https://img1.imgtp.com/2022/09/11/TXLJdkIn.png" alt="QQæˆªå›¾20220619093740.png"></p><p>18.æ–‡ä»¶çš„è¯»å†™</p><p>â€‹    </p><div class="code-wrapper"><pre><code class="hljs reasonml">fs.read<span class="hljs-constructor">File(<span class="hljs-params">path</span>,<span class="hljs-params">options</span>?,<span class="hljs-params">callback</span>)</span>   <span class="hljs-comment">//è¯»å–æ–‡ä»¶çš„å†…å®¹</span>fs.write<span class="hljs-constructor">File(<span class="hljs-params">file</span>,<span class="hljs-params">data</span>,<span class="hljs-params">options</span>?,<span class="hljs-params">callback</span>)</span> <span class="hljs-comment">//å†™å…¥æ–‡ä»¶</span></code></pre></div><p><img src="https://img1.imgtp.com/2022/09/11/gbD9UytN.png" alt="QQæˆªå›¾20220619094754.png"></p><div class="code-wrapper"><pre><code class="hljs dts">optionsä¸­çš„å±æ€§<span class="hljs-symbol">flag:</span>å†™å…¥çš„æ–¹å¼<span class="hljs-symbol">w:</span>æ‰“å¼€æ–‡ä»¶å†™å…¥ï¼Œé»˜è®¤å€¼w+:æ‰“å¼€æ–‡ä»¶è¿›è¡Œè¯»å†™ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šåˆ›å»ºæ–‡ä»¶r+:æ‰“å¼€æ–‡ä»¶è¿›è¡Œè¯»å†™ï¼Œå¦‚æœä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºå¼‚å¸¸<span class="hljs-symbol">r:</span>æ‰“å¼€æ–‡ä»¶è¯»å–ï¼Œè¯»å–æ—¶çš„é»˜è®¤å€¼<span class="hljs-symbol">a:</span>æ‰“å¼€è¦å†™å…¥çš„æ–‡ä»¶ï¼Œå°†æµæ”¾åœ¨æ–‡ä»¶çš„æœ«å°¾ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šåˆ›å»ºæ–‡ä»¶a+:æ‰“å¼€æ–‡ä»¶è¿›è¡Œè¯»å†™ï¼Œå°†æµæ”¾åˆ°æ–‡ä»¶æœ«å°¾ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º<span class="hljs-symbol">encoding:</span>å­—ç¬¦çš„ç¼–ç ç°åœ¨åŸºæœ¬ä¸Šä½¿ç”¨utf<span class="hljs-number">-8</span>å¦‚æœä¸å¡«encodingåˆ™ä¼šè¿”å›buffer</code></pre></div><p>19.æ–‡ä»¶å¤¹çš„æ“ä½œ</p><p><img src="https://img1.imgtp.com/2022/09/11/ladw1Jt6.png" alt="QQæˆªå›¾20220619093820.png"><br>20.eventsæ¨¡å—</p><p>â€‹     Nodeä¸­çš„æ ¸å¿ƒAPIéƒ½æ˜¯åŸºäºå¼‚æ­¥äº‹ä»¶é©±åŠ¨çš„ï¼š</p><p>â€‹     å‘å‡ºäº‹ä»¶å’Œç›‘å¬äº‹ä»¶éƒ½æ˜¯é€šè¿‡EventEmitterç±»æ¥å®Œæˆï¼Œä»–ä»¬éƒ½æ˜¯å±äºeventså¯¹è±¡</p><p>â€‹      </p><div class="code-wrapper"><pre><code class="hljs mel">const <span class="hljs-keyword">emitter</span>=new EventEmitter()<span class="hljs-keyword">emitter</span>.on(eventName.listener)<span class="hljs-comment">//ç›‘å¬äº‹ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨addListener</span><span class="hljs-keyword">emitter</span>.off(eventName.listener)<span class="hljs-comment">//ç§»å‡ºäº‹ä»¶ç›‘å¬ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨removeLitener</span><span class="hljs-keyword">emitter</span>.<span class="hljs-keyword">emit</span>(eventName,...args?)<span class="hljs-comment">//å‘å‡ºäº‹ä»¶ï¼Œå¯ä»¥æºå¸¦å‚æ•°</span></code></pre></div><p><img src="https://img1.imgtp.com/2022/09/11/gbfKncoB.png" alt="QQæˆªå›¾20220619135051.png"><br><img src="https://img1.imgtp.com/2022/09/11/z58jVfjS.png" alt="QQæˆªå›¾20220619135226.png"></p><div class="code-wrapper"><pre><code class="hljs shij">emitter.once(eventName,listener)äº‹ä»¶åªç›‘å¬ä¸€æ¬¡emitter.prependListener()å°†ç›‘å¬äº‹ä»¶æ·»åŠ åˆ°æœ€å‰é¢emitter.prependOnceListener()å°†ç›‘å¬äº‹ä»¶æ·»åŠ åˆ°æœ€å‰é¢ä½†åªç›‘å¬ä¸€æ¬¡emitter.removeAllListeners(eventName?)ç§»é™¤æ‰€æœ‰äº‹ä»¶</code></pre></div><p>21ã€npmåŒ…ç®¡ç†å·¥å…·</p><p>â€‹            npm run start=&gt;npm start</p><p>â€‹            npm run test=&gt;npm test</p><p>â€‹            npm run stop=&gt;npm stop</p><p>â€‹            npm run restart=&gt;npm restart</p><p>22.npm config get cache //cmdä¸­æ‰§è¡ŒæŸ¥çœ‹ç¼“å­˜æ‰€åœ¨ç›®å½•</p><p>23.Bufferç±»</p><p>â€‹    ä½¿ç”¨Bufferæ¥å­˜å‚¨äºŒè¿›åˆ¶</p><p>â€‹    buf=Buffer.from()//è½¬æ¢æˆbuffer</p><p>â€‹    ä¸­æ–‡ä¼šè½¬æ¢æˆunicodeç¼–ç   3ä¸ªunicodeç¼–ç ä»£è¡¨ä¸€ä¸ªæ±‰å­— é»˜è®¤æ˜¯utf8ç¼–ç </p><p>â€‹    <code>buf.toString([encoding[, start[, end]]])</code>//è§£ç  encodeé»˜è®¤æ˜¯utf8</p><p>â€‹    bufferçš„å¦å¤–ä¸€ç§åˆ›å»ºæ–¹å¼</p><p>â€‹    <code>Buffer.alloc(size[, fill[, encoding]])</code> sizeè¡¨ç¤ºåˆ›å»ºçš„å¤§å° é»˜è®¤æ˜¯utf8</p><p>â€‹    bufferå¯ä»¥å°†å›¾ç‰‡è½¬æ¢æˆäºŒè¿›åˆ¶æµè¿›è¡Œä¼ è¾“ï¼Œä¹Ÿå¯ä»¥æŠŠäºŒè¿›åˆ¶è½¬æ¢æˆå›¾ç‰‡å­˜å‚¨</p><p>24.è¯»å–æ–‡ä»¶è¿”å›çš„æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æµ</p><p><img src="https://img1.imgtp.com/2022/09/11/yyxGHUMi.png" alt="QQæˆªå›¾20220623141058.png"><br>25.è¯»å–å›¾ç‰‡å¹¶ä¸”å†™å…¥åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶</p><p><img src="https://img1.imgtp.com/2022/09/11/TduZGuBK.png" alt="QQæˆªå›¾20220623141209.png"><br>26.sharpæ’ä»¶è¿›è¡Œè®¾ç½®å›¾ç‰‡</p><p>27.Bufferçš„åˆ›å»ºè¿‡ç¨‹</p><p>â€‹    äº‹å®ä¸Šæˆ‘ä»¬åˆ›å»ºBufferæ—¶ï¼Œå¹¶ä¸ä¼šé¢‘ç¹çš„å‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œå®ƒä¼šé»˜è®¤å…ˆç”³è¯·ä¸€ä¸ª8 * 1024ä¸ªå­—èŠ‚å¤§å°çš„å†…å­˜ï¼Œ ä¹Ÿå°±æ˜¯8kb</p><p>28.Bufferçš„æºç </p><p>29.è¿›ç¨‹å’Œçº¿ç¨‹</p><p>â€‹    è¿›ç¨‹:å¯åŠ¨ä¸€ä¸ªç¨‹åºï¼Œæ—¢å¯ä»¥é»˜è®¤å¼€å¯ä¸€ä¸ªè¿›ç¨‹ï¼ˆä¹Ÿå¯ä»¥å¤šè¿›ç¨‹ï¼‰</p><p>â€‹    çº¿ç¨‹ï¼šæ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿è¡Œè°ƒåº¦çš„æœ€å°å•ä½</p><p>30.Nodeäº‹ä»¶å¾ªç¯çš„é˜¶æ®µ</p><p>â€‹     ä¸€æ¬¡å®Œæ•´çš„äº‹ä»¶å¾ªç¯Tickåˆ†æˆå¾ˆå¤šä¸ªé˜¶æ®µ</p><p>â€‹    å®šæ—¶å™¨(Timer):æœ¬é˜¶æ®µæ‰§è¡Œå·²ç»è¢« setTimeout() å’Œ setInterval() çš„è°ƒåº¦å›è°ƒå‡½æ•°</p><p>â€‹    å¾…å®šå›è°ƒï¼ˆPending Callbackï¼‰ï¼šå¯¹æŸäº›ç³»ç»Ÿæ“ä½œï¼ˆå¦‚TCPé”™è¯¯ç±»å‹ï¼‰æ‰§è¡Œå›è°ƒï¼Œæ¯”å¦‚TCPè¿æ¥æ—¶æ¥æ”¶åˆ° ECONNREFUSED</p><p>â€‹    idle, prepareï¼šä»…ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨</p><p>â€‹    è½®è¯¢ï¼ˆPollï¼‰ï¼šæ£€ç´¢æ–°çš„ I/O äº‹ä»¶ï¼›æ‰§è¡Œä¸ I/O ç›¸å…³çš„å›è°ƒ</p><p>â€‹    æ£€æµ‹ï¼šsetImmediate() å›è°ƒå‡½æ•°åœ¨è¿™é‡Œæ‰§è¡Œ</p><p>â€‹    å…³é—­çš„å›è°ƒå‡½æ•°ï¼šä¸€äº›å…³é—­çš„å›è°ƒå‡½æ•°ï¼Œå¦‚ï¼šsocket.on(â€˜closeâ€™, â€¦)</p><p>31.Nodeçš„å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡</p><p>â€‹    å¾®ä»»åŠ¡é˜Ÿåˆ—</p><p>â€‹    nettick queue:process.nextTick</p><p>â€‹    other queue:Promiseçš„thenå›è°ƒï¼ŒqueueMicrotask</p><p>â€‹    å®ä»»åŠ¡é˜Ÿåˆ—</p><p>â€‹    timer queue:setTimeout,setInterval    </p><p>â€‹    poll queue :IOäº‹ä»¶</p><p>â€‹    check queue:setImmediate</p><p>â€‹    close queue:closeäº‹ä»¶</p><p>32.Streamå¯ä»¥è¯»å–æˆ–è€…å†™å…¥éƒ¨åˆ†</p><p>â€‹    4.ä¸­åŸºæœ¬çš„æµç±»å‹</p><p>â€‹        writable:å¯ä»¥å‘å…¶å†™äººæ•°æ®çš„æµ fs.createWriteStream()</p><p>â€‹        Readable:å¯ä»¥ä»ä¸­è¯»å–æ•°æ®çš„æµ fs.createReadStream()</p><p>â€‹        Duplexï¼šåŒæ—¶ä¸ºReadableå’Œwratable net.Socket</p><p>â€‹        Transform:Duplexå¯ä»¥åœ¨å†™å…¥å’Œè¯»å–æ•°æ®æ—¶ä¿®æ”¹æˆ–è€…è½¬æ¢æ•°æ®çš„æµ  zlib.createDeflate()</p><p>33.Readable</p><p><img src="https://img1.imgtp.com/2022/09/11/QggeUwVk.png" alt="QQæˆªå›¾20220624165628.png"><br>34.writable</p><p><img src="https://img1.imgtp.com/2022/09/11/14Ca9DGs.png" alt="QQæˆªå›¾20220624183130.png"><br>35.pipe</p><p>ä»è¯»å–åˆ°è¾“å‡ºåˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™</p><p><img src="https://img1.imgtp.com/2022/09/11/14Ca9DGs.png" alt="QQæˆªå›¾20220624183130.png"><br>36.http</p><p>å®‰è£…nodemonæ¥çƒ­æ›´æ–°è‡ªåŠ¨å¯åŠ¨</p><p>37.axioså¯ä»¥åœ¨æµè§ˆå™¨ç”¨ä¹Ÿå¯ä»¥åœ¨nodeä¸­ç”¨ï¼Œæµè§ˆå™¨ç”¨çš„æ˜¯xhr,nodeä¸­ä½¿ç”¨çš„æ˜¯httpå†…ç½®æ¨¡å—</p><p>38.æ–‡ä»¶ä¸Šä¼ </p><p>39.express</p><p>â€‹        expressæ ¸å¿ƒæ˜¯ä¸­é—´ä»¶</p><p>â€‹        å®‰è£…express</p><p>â€‹        1.åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ </p><p>â€‹        2.npx express-generator</p><p>â€‹        3.npm install</p><p>â€‹        4.DEBUG=express:* npm start</p><p>â€‹        ç¬¬äºŒç§å®‰è£…æ–¹å¼</p><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> init<span class="hljs-built_in">npm</span> install express</code></pre></div><p>40.ä¸­é—´ä»¶</p><p>41.æ–‡ä»¶ä¸Šä¼ </p><p>â€‹    ä½¿ç”¨multer  npm install multer</p><p>42.æ‰“å°æ—¥å¿—</p><p>â€‹    ä½¿ç”¨morgan npm install morgan</p><p>43expressè·¯ç”±</p><p>44.ä½¿ç”¨expresséƒ¨ç½²é™æ€èµ„æºï¼Œå°†expressä½œä¸ºé™æ€èµ„æºæœåŠ¡å™¨</p><p>45.é”™è¯¯å¤„ç†</p><p>46.è°ƒç”¨express()åˆ°åº•åˆ›å»ºçš„æ˜¯ä»€ä¹ˆ</p><p>47.app.listen()å¯åŠ¨æœåŠ¡å™¨</p><p>â€‹        å¦‚ä½•å¯ä»¥ç»“åˆåŸç”Ÿæ¥å¯åŠ¨æœåŠ¡å™¨</p><p>â€‹        express-&gt;http.createServer.listen</p><p>48.app.use(ä¸­é—´ä»¶)å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆ</p><p>49.ç”¨æˆ·å‘é€äº†è¯·æ±‚ï¼Œä¸­é—´ä»¶æ˜¯å¦‚ä½•è¢«å›è°ƒ</p><p>50.nextçš„ä¸ºä»€ä¹ˆä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶</p><p>51.koaæ´‹è‘±æ¨¡å‹</p><p>â€‹        koaçš„åŒæ­¥å’Œå¼‚æ­¥éƒ½æ˜¯ç¬¦åˆæ´‹è‘±æ¨¡å‹çš„</p><p>â€‹        expressåªæœ‰åŒæ­¥ä»£ç æ‰ä¼šç¬¦åˆæ´‹è‘±æ¨¡å‹</p><p>52.koaå’Œexpressçš„åŒºåˆ«</p><p>â€‹    </p>]]></content>
    
    
    <categories>
      
      <category>node</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨axioså°è£…è¯·æ±‚å·¥å…·</title>
    <link href="/2022/09/09/%E4%BD%BF%E7%94%A8axios%E5%B0%81%E8%A3%85%E8%AF%B7%E6%B1%82%E5%B7%A5%E5%85%B7/"/>
    <url>/2022/09/09/%E4%BD%BF%E7%94%A8axios%E5%B0%81%E8%A3%85%E8%AF%B7%E6%B1%82%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//request.js</span><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;axios&quot;</span>;<span class="hljs-keyword">import</span> type &#123; <span class="hljs-title class_">AxiosInstance</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;axios&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">RequestInterceptors</span>, <span class="hljs-title class_">RequestConfig</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./type&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">ElLoading</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;element-plus&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_LOADING</span> = <span class="hljs-literal">true</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">axiosRequest</span> &#123;  <span class="hljs-attr">instance</span>: <span class="hljs-title class_">AxiosInstance</span>;  interceptors?: <span class="hljs-title class_">RequestInterceptors</span>;  <span class="hljs-attr">showLoading</span>: boolean;  loading?: any;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: RequestConfig</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span> = axios.<span class="hljs-title function_">create</span>(config);    <span class="hljs-variable language_">this</span>.<span class="hljs-property">showLoading</span> = config.<span class="hljs-property">showLoading</span> ?? <span class="hljs-variable constant_">DEFAULT_LOADING</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span> = config.<span class="hljs-property">interceptors</span>;    <span class="hljs-comment">// å°†configä¸­çš„æ‹¦æˆªå™¨ä¼ å…¥</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(      <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span>?.<span class="hljs-property">requestInterceptor</span>,      <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span>?.<span class="hljs-property">requestInterceptorCatch</span>,    );    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(      <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span>?.<span class="hljs-property">responseInterceptor</span>,      <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span>?.<span class="hljs-property">responseInterceptorCatch</span>,    );    <span class="hljs-comment">// è®¾ç½®é€šç”¨çš„æ‹¦æˆªå™¨</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(      <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">showLoading</span>) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-title class_">ElLoading</span>.<span class="hljs-title function_">service</span>(&#123;            <span class="hljs-attr">lock</span>: <span class="hljs-literal">true</span>,            <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;æ­£åœ¨è¯·æ±‚æ•°æ®ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>,            <span class="hljs-attr">background</span>: <span class="hljs-string">&quot;rgba(0, 0, 0, 0.5)&quot;</span>,          &#125;);        &#125;        <span class="hljs-keyword">return</span> config;      &#125;,      <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;        <span class="hljs-keyword">return</span> err;      &#125;,    );    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(      <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span>?.<span class="hljs-title function_">close</span>();        <span class="hljs-keyword">const</span> data = res.<span class="hljs-property">data</span>;        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">returnCode</span> == <span class="hljs-string">&quot;-1001&quot;</span>) &#123;          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;è¯·æ±‚å¤±è´¥â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span>);        &#125; <span class="hljs-keyword">else</span> &#123;          <span class="hljs-keyword">return</span> data;        &#125;      &#125;,      <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span>?.<span class="hljs-title function_">close</span>();        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">response</span>.<span class="hljs-property">status</span> === <span class="hljs-string">&quot;404&quot;</span>) &#123;          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;é¡µé¢ä¸å­˜åœ¨&quot;</span>);        &#125;        <span class="hljs-keyword">return</span> err;      &#125;,    );  &#125;  request&lt;T = any&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">RequestConfig</span>&lt;T&gt;): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (config.<span class="hljs-property">interceptors</span>?.<span class="hljs-property">requestInterceptor</span>) &#123;        config = config.<span class="hljs-property">interceptors</span>.<span class="hljs-title function_">requestInterceptor</span>(config);      &#125;      <span class="hljs-keyword">if</span> (config.<span class="hljs-property">showLoading</span> === <span class="hljs-literal">false</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">showLoading</span> = config.<span class="hljs-property">showLoading</span>;      &#125;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>        .<span class="hljs-property">request</span>&lt;any, T&gt;(config)        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (config.<span class="hljs-property">interceptors</span>?.<span class="hljs-property">responseInterceptor</span>) &#123;            res = config.<span class="hljs-property">interceptors</span>.<span class="hljs-title function_">responseInterceptor</span>(res);          &#125;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">showLoading</span> = <span class="hljs-variable constant_">DEFAULT_LOADING</span>;          <span class="hljs-title function_">resolve</span>(res);        &#125;)        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">showLoading</span> = <span class="hljs-variable constant_">DEFAULT_LOADING</span>;          <span class="hljs-title function_">reject</span>(err);          <span class="hljs-keyword">return</span> err;        &#125;);    &#125;);  &#125;  get&lt;T = any&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">RequestConfig</span>&lt;T&gt;): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">request</span>&lt;T&gt;(&#123; ...config, <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;GET&quot;</span> &#125;);  &#125;  post&lt;T = any&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">RequestConfig</span>&lt;T&gt;): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">request</span>&lt;T&gt;(&#123; ...config, <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;POST&quot;</span> &#125;);  &#125;  <span class="hljs-keyword">delete</span>&lt;T = any&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">RequestConfig</span>&lt;T&gt;): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">request</span>&lt;T&gt;(&#123; ...config, <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;DELETE&quot;</span> &#125;);  &#125;  patch&lt;T = any&gt;(<span class="hljs-attr">config</span>: <span class="hljs-title class_">RequestConfig</span>&lt;T&gt;): <span class="hljs-title class_">Promise</span>&lt;T&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">request</span>&lt;T&gt;(&#123; ...config, <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;PATCH&quot;</span> &#125;);  &#125;&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> axiosRequest;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//type.js</span><span class="hljs-keyword">import</span> type &#123; <span class="hljs-title class_">AxiosRequestConfig</span>, <span class="hljs-title class_">AxiosResponse</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;axios&quot;</span>;<span class="hljs-keyword">export</span> interface <span class="hljs-title class_">RequestInterceptors</span>&lt;T = <span class="hljs-title class_">AxiosResponse</span>&gt; &#123;  requestInterceptor?: <span class="hljs-function">(<span class="hljs-params">config: AxiosRequestConfig</span>) =&gt;</span> <span class="hljs-title class_">AxiosRequestConfig</span>;  requestInterceptorCatch?: <span class="hljs-function">(<span class="hljs-params">error: any</span>) =&gt;</span> any;  responseInterceptor?: <span class="hljs-function">(<span class="hljs-params">res: T</span>) =&gt;</span> T;  responseInterceptorCatch?: <span class="hljs-function">(<span class="hljs-params">error: any</span>) =&gt;</span> any;&#125;<span class="hljs-keyword">export</span> interface <span class="hljs-title class_">RequestConfig</span>&lt;T = <span class="hljs-title class_">AxiosResponse</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AxiosRequestConfig</span> &#123;  interceptors?: <span class="hljs-title class_">RequestInterceptors</span>&lt;T&gt;;  showLoading?: boolean;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//index.js</span><span class="hljs-keyword">import</span> axiosRequest <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./request&quot;</span>;<span class="hljs-keyword">import</span> localCache <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/utils/cache&quot;</span>;<span class="hljs-keyword">const</span> httpRequest = <span class="hljs-keyword">new</span> <span class="hljs-title function_">axiosRequest</span>(&#123;  <span class="hljs-attr">baseURL</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_APP_BASE_URL</span>,  <span class="hljs-attr">timeout</span>: <span class="hljs-title class_">Number</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_TIME_OUT</span>),  <span class="hljs-attr">interceptors</span>: &#123;    <span class="hljs-attr">requestInterceptor</span>: <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> &#123;      <span class="hljs-keyword">const</span> token = localCache.<span class="hljs-title function_">getCache</span>(<span class="hljs-string">&quot;token&quot;</span>);      <span class="hljs-keyword">if</span> (token) &#123;        config.<span class="hljs-property">headers</span> = &#123;&#125;;        config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">$&#123;token&#125;</span>`</span>;      &#125;      <span class="hljs-keyword">return</span> config;    &#125;,    <span class="hljs-attr">requestInterceptorCatch</span>: <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> error;    &#125;,    <span class="hljs-attr">responseInterceptor</span>: <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> res;    &#125;,    <span class="hljs-attr">responseInterceptorCatch</span>: <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> error;    &#125;,  &#125;,&#125;);<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> httpRequest;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
      <category>axios</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>gulpå­¦ä¹ </title>
    <link href="/2022/09/08/gulp%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/09/08/gulp%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>å¸¸ç”¨æ„å»ºå·¥å…·</category>
      
      <category>glup</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>rollupå­¦ä¹ </title>
    <link href="/2022/09/08/rollup%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/09/08/rollup%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>å¸¸ç”¨æ„å»ºå·¥å…·</category>
      
      <category>rollup</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>vite3å­¦ä¹ </title>
    <link href="/2022/09/08/vite3%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/09/08/vite3%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>å¸¸ç”¨æ„å»ºå·¥å…·</category>
      
      <category>vite</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>webpack5å­¦ä¹ </title>
    <link href="/2022/09/08/webpack5%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/09/08/webpack5%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//path.js</span><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<span class="hljs-keyword">const</span> appDir = process.<span class="hljs-title function_">cwd</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Current directory: <span class="hljs-subst">$&#123;appDir&#125;</span>`</span>);<span class="hljs-keyword">const</span> <span class="hljs-title function_">resolveApp</span> = (<span class="hljs-params">relativePath</span>) =&gt; path.<span class="hljs-title function_">resolve</span>(appDir, relativePath);<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = resolveApp;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//webpack.common.js</span><span class="hljs-keyword">const</span> resolveApp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./paths&#x27;</span>);<span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">DefinePlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>);<span class="hljs-keyword">const</span> <span class="hljs-title class_">CopyWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;copy-webpack-plugin&#x27;</span>);<span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;eslint-webpack-plugin&#x27;</span>);<span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mini-css-extract-plugin&#x27;</span>);<span class="hljs-keyword">const</span> &#123; merge &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-merge&#x27;</span>);<span class="hljs-keyword">const</span> productionConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./webpack.prod&#x27;</span>);<span class="hljs-keyword">const</span> developmentConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./webpack.dev&#x27;</span>);<span class="hljs-comment">/***</span><span class="hljs-comment"> * è¿™é‡Œæœ‰ä¸‰ç§æ–¹æ³•æ¥è¿›è¡Œä»£ç åˆ†ç¦»ï¼Œå®ƒå¯ä»¥å‡å°‘æ‰“åŒ…æ–‡ä»¶å¤§å°ï¼Œå‡å°‘æ–‡ä»¶çš„åŠ è½½æ—¶é—´</span><span class="hljs-comment"> *  å®ƒä¸»è¦çš„ç›®çš„æ˜¯å°†ä»£ç åˆ†ç¦»åˆ°ä¸åŒçš„bundleä¸­ï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥æŒ‰éœ€åŠ è½½ï¼Œæˆ–è€…å¹¶è¡ŒåŠ è½½è¿™äº›æ–‡ä»¶ï¼›</span><span class="hljs-comment">    æ¯”å¦‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„JavaScriptä»£ç ï¼ˆä¸šåŠ¡ä»£ç ã€ç¬¬ä¸‰æ–¹ä¾èµ–ã€æš‚æ—¶æ²¡æœ‰ç”¨åˆ°çš„æ¨¡å—ï¼‰åœ¨é¦–é¡µå…¨éƒ¨éƒ½åŠ è½½ï¼Œ</span><span class="hljs-comment">å°±ä¼šå½±å“é¦–é¡µçš„åŠ è½½é€Ÿåº¦</span><span class="hljs-comment">    ä»£ç åˆ†ç¦»å¯ä»¥åˆ†å‡ºå‡ºæ›´å°çš„bundleï¼Œä»¥åŠæ§åˆ¶èµ„æºåŠ è½½ä¼˜å…ˆçº§ï¼Œæä¾›ä»£ç çš„åŠ è½½æ€§èƒ½</span><span class="hljs-comment">      1.å…¥å£èµ·ç‚¹ï¼šä½¿ç”¨entryé…ç½®æ‰‹åŠ¨åˆ†ç¦»ä»£ç ï¼›</span><span class="hljs-comment">      2.é˜²æ­¢é‡å¤ï¼šä½¿ç”¨Entry Dependenciesæˆ–è€…SplitChunksPluginå»é‡å’Œåˆ†ç¦»ä»£ç ï¼›</span><span class="hljs-comment">      3.åŠ¨æ€å¯¼å…¥ï¼šé€šè¿‡æ¨¡å—çš„å†…è”å‡½æ•°è°ƒç”¨æ¥åˆ†ç¦»ä»£ç </span><span class="hljs-comment"> */</span><span class="hljs-keyword">const</span> <span class="hljs-title function_">commonConfig</span> = (<span class="hljs-params">env, args</span>) =&gt; &#123;  <span class="hljs-keyword">const</span> devMode = args.<span class="hljs-property">mode</span> !== <span class="hljs-string">&#x27;production&#x27;</span>;  <span class="hljs-keyword">return</span> &#123;    <span class="hljs-attr">entry</span>: [<span class="hljs-string">&#x27;./src/index.js&#x27;</span>],    <span class="hljs-comment">// å¤šå…¥å£æ–‡ä»¶ å¦‚æœä¸¤ä¸ªæ–‡ä»¶å¼•ç”¨ç›¸åŒçš„ä»£ç ä¼šé€ æˆé‡å¤æ‰“åŒ…ï¼Œå¢å¤§å•ä¸ªbundleçš„å¤§å°ï¼Œä»è€Œæµªè´¹å¸¦å®½</span>    <span class="hljs-comment">// entry: &#123;</span>    <span class="hljs-comment">//   index: &#x27;./src/index.js&#x27;,</span>    <span class="hljs-comment">//   another: &#x27;./src/another-module.js&#x27;</span>    <span class="hljs-comment">// &#125;,</span>    <span class="hljs-comment">//å°†å…¬å…±çš„åŒ…åˆ†ç¦»å‡ºæ¥ï¼Œå‡å°bundleä½“ç§¯</span>    <span class="hljs-comment">// entry: &#123;</span>    <span class="hljs-comment">//   index: &#123;</span>    <span class="hljs-comment">//     import: &#x27;./src/index.js&#x27;,</span>    <span class="hljs-comment">//     dependOn: &#x27;shared&#x27;</span>    <span class="hljs-comment">//   &#125;,</span>    <span class="hljs-comment">//   another: &#123;</span>    <span class="hljs-comment">//     import: &#x27;./src/another-module.js&#x27;,</span>    <span class="hljs-comment">//     dependOn: &#x27;shared&#x27;</span>    <span class="hljs-comment">//   &#125;,</span>    <span class="hljs-comment">//   shared: &#x27;lodash&#x27;</span>    <span class="hljs-comment">// &#125;,</span>    <span class="hljs-attr">output</span>: &#123;      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;js/[name].bundle.js&#x27;</span>,      <span class="hljs-comment">// ä¸ºimport().thenå¼‚æ­¥åŠ è½½ä½¿ç”¨</span>      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&#x27;js/[name].[hash:6].chunk.js&#x27;</span>,      <span class="hljs-comment">// å¿…é¡»æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„</span>      <span class="hljs-attr">path</span>: <span class="hljs-title function_">resolveApp</span>(<span class="hljs-string">&#x27;./dist&#x27;</span>),      <span class="hljs-comment">// é‡æ–°æ‰“åŒ…æ—¶æ¸…ç†distæ–‡ä»¶å¤¹</span>      <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>      <span class="hljs-comment">// ä½¿ç”¨webpack-dev-middlewareéœ€è¦ ç›®çš„æ˜¯è®©æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨,æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶,è¦åœ¨ç”Ÿäº§ç¯å¢ƒæ”¾åˆ°æœåŠ¡å™¨ä¸­æ‰åŠ </span>      <span class="hljs-comment">// outputä¸­çš„pathçš„ä½œç”¨æ˜¯å‘ŠçŸ¥webpackä¹‹åçš„è¾“å‡ºç›®å½•</span>      <span class="hljs-comment">// publicPath: &quot;/&quot;,</span>      <span class="hljs-comment">// Asset Modules å°†è¿™ä¸ªæ¨¡å—ä¸‹çš„æ–‡ä»¶è¾“å‡ºåˆ°distä¸‹çš„æŒ‡å®šæ–‡ä»¶å¤¹</span>      <span class="hljs-comment">// assetModuleFilename: &quot;img/[name].[hash:6][ext]&quot;</span>    &#125;,    <span class="hljs-comment">// /å¦‚æœæˆ‘ä»¬è¦åœ¨å•ä¸ª HTML é¡µé¢ä¸Šä½¿ç”¨å¤šä¸ªå…¥å£ç‚¹ï¼Œè¿˜éœ€è¦ optimization.runtimeChunk: &#x27;single&#x27;</span>    <span class="hljs-comment">// optimization: &#123;</span>    <span class="hljs-comment">//   runtimeChunk: &#x27;single&#x27;</span>    <span class="hljs-comment">// &#125;,</span>    <span class="hljs-attr">optimization</span>: &#123;      <span class="hljs-comment">// optimization.chunkIdsé…ç½®ç”¨äºå‘ŠçŸ¥webpackæ¨¡å—çš„idé‡‡ç”¨ä»€ä¹ˆç®—æ³•ç”Ÿæˆ</span>      <span class="hljs-comment">// natural: ä½¿ç”¨è‡ªç„¶æ•°(ä¸æ¨è),</span>      <span class="hljs-comment">// named: ä½¿ç”¨åŒ…æ‰€åœ¨ç›®å½•ä½œä¸ºname(åœ¨å¼€å‘ç¯å¢ƒæ¨è)</span>      <span class="hljs-comment">// deterministic: ç”Ÿæˆid, é’ˆå¯¹ç›¸åŒæ–‡ä»¶ç”Ÿæˆçš„idæ˜¯ä¸å˜</span>      <span class="hljs-comment">// chunkIds: devMode ? &#x27;deterministic&#x27; : &#x27;named&#x27;,</span>      <span class="hljs-comment">// æ–¹å¼äºŒä½¿ç”¨splitChunkPluginé»˜è®¤é›†æˆ</span>      <span class="hljs-attr">splitChunks</span>: &#123;        <span class="hljs-comment">/**</span><span class="hljs-comment">         * async é»˜è®¤ é’ˆå¯¹å¼‚æ­¥å¯¼å…¥</span><span class="hljs-comment">         * initial é’ˆå¯¹åŒæ­¥å¯¼å…¥</span><span class="hljs-comment">         * all é’ˆå¯¹åŒæ­¥å’Œå¼‚æ­¥</span><span class="hljs-comment">         */</span>        <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;all&#x27;</span>,        <span class="hljs-comment">// æœ€å°å°ºå¯¸: å¦‚æœæ‹†åˆ†å‡ºæ¥ä¸€ä¸ª, é‚£ä¹ˆæ‹†åˆ†å‡ºæ¥çš„è¿™ä¸ªåŒ…çš„å¤§å°æœ€å°ä¸ºminSize</span>        <span class="hljs-attr">minSize</span>: <span class="hljs-number">20000</span>,        <span class="hljs-comment">// å°†å¤§äºmaxSizeçš„åŒ…, æ‹†åˆ†æˆä¸å°äºminSizeçš„åŒ…</span>        <span class="hljs-attr">maxSize</span>: <span class="hljs-number">20000</span>,        <span class="hljs-comment">// è¡¨ç¤ºè‡³å°‘è¢«å¼•å…¥ä¸€æ¬¡çš„åŒ…æ‰ä¼šè¢«åˆ†åŒ…ï¼Œæ²¡æœ‰å¼•ç”¨è¿‡çš„ä¸ä¼šè¢«æ‰“åŒ…</span>        <span class="hljs-attr">minChunks</span>: <span class="hljs-number">1</span>,        <span class="hljs-comment">/**</span><span class="hljs-comment">         * cacheGroupsï¼š</span><span class="hljs-comment"> ç”¨äºå¯¹æ‹†åˆ†çš„åŒ…å°±è¡Œåˆ†ç»„ï¼Œæ¯”å¦‚ä¸€ä¸ªlodashåœ¨æ‹†åˆ†ä¹‹åï¼Œå¹¶ä¸ä¼šç«‹å³æ‰“åŒ…ï¼Œè€Œæ˜¯ä¼šç­‰åˆ°æœ‰æ²¡æœ‰å…¶ä»–ç¬¦åˆè§„åˆ™çš„åŒ…ä¸€èµ·æ¥æ‰“</span><span class="hljs-comment">åŒ…ï¼›</span><span class="hljs-comment"> testå±æ€§ï¼šåŒ¹é…ç¬¦åˆè§„åˆ™çš„åŒ…ï¼›</span><span class="hljs-comment"> nameå±æ€§ï¼šæ‹†åˆ†åŒ…çš„nameå±æ€§ï¼›</span><span class="hljs-comment"> filenameå±æ€§ï¼šæ‹†åˆ†åŒ…çš„åç§°ï¼Œå¯ä»¥è‡ªå·±ä½¿ç”¨placeholderå±æ€§</span><span class="hljs-comment">         */</span>        <span class="hljs-attr">cacheGroups</span>: &#123;          <span class="hljs-attr">vendor</span>: &#123;            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;js/[id]_venders.js&#x27;</span>,            <span class="hljs-attr">priority</span>: -<span class="hljs-number">10</span>          &#125;,          <span class="hljs-attr">default</span>: &#123;            <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>,            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;js/common_[id].js&#x27;</span>,            <span class="hljs-attr">priority</span>: -<span class="hljs-number">20</span>          &#125;        &#125;      &#125;,      <span class="hljs-comment">/**optimization. runtimeChunké…ç½®</span><span class="hljs-comment">       * é…ç½®runtimeç›¸å…³çš„ä»£ç æ˜¯å¦æŠ½å–åˆ°ä¸€ä¸ªå•ç‹¬çš„chunkä¸­ï¼š</span><span class="hljs-comment">       * runtimeç›¸å…³çš„ä»£ç æŒ‡çš„æ˜¯åœ¨è¿è¡Œç¯å¢ƒä¸­ï¼Œå¯¹æ¨¡å—è¿›è¡Œè§£æã€åŠ è½½ã€æ¨¡å—ä¿¡æ¯ç›¸å…³çš„ä»£ç ï¼›</span><span class="hljs-comment">       * æŠ½ç¦»å‡ºæ¥åï¼Œæœ‰åˆ©äºæµè§ˆå™¨ç¼“å­˜çš„ç­–ç•¥ï¼š</span><span class="hljs-comment">       * æ¯”å¦‚æˆ‘ä»¬ä¿®æ”¹äº†ä¸šåŠ¡ä»£ç ï¼ˆmainï¼‰ï¼Œé‚£ä¹ˆruntimeå’Œcomponentã€barçš„chunkæ˜¯ä¸éœ€è¦é‡æ–°åŠ è½½çš„</span><span class="hljs-comment">       * æ¯”å¦‚æˆ‘ä»¬ä¿®æ”¹äº†componentã€barçš„ä»£ç ï¼Œé‚£ä¹ˆmainä¸­çš„ä»£ç æ˜¯ä¸éœ€è¦é‡æ–°åŠ è½½çš„</span><span class="hljs-comment">       *   true/multiple ï¼šé’ˆå¯¹æ¯ä¸ªå…¥å£æ‰“åŒ…ä¸€ä¸ªruntimeæ–‡ä»¶ï¼›</span><span class="hljs-comment">             single æ‰“åŒ…ä¸€ä¸ªruntimeæ–‡ä»¶</span><span class="hljs-comment">             object: name nameå±æ€§å†³å®šruntimeChunkçš„åç§°ï¼›</span><span class="hljs-comment">       */</span>      <span class="hljs-attr">runtimeChunk</span>: &#123;        <span class="hljs-attr">name</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">entrypoint</span>) &#123;          <span class="hljs-keyword">return</span> <span class="hljs-string">`other-<span class="hljs-subst">$&#123;entrypoint.name&#125;</span>`</span>;        &#125;      &#125;    &#125;,    <span class="hljs-attr">module</span>: &#123;      <span class="hljs-attr">rules</span>: [        &#123;          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.ts$/</span>,          <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,          <span class="hljs-comment">// æœ¬è´¨ä¸Šæ˜¯ä¾èµ–äºtypescript(typescript compiler)</span>          <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;babel-loader&#x27;</span>        &#125;,        &#123; <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jsx$/i</span>, <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>, <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;babel-loader&#x27;</span> &#125;,        &#123;          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.m?js$/i</span>,          <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,          <span class="hljs-comment">// å°†es6=ã€‹es5</span>          <span class="hljs-attr">use</span>: &#123;            <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;babel-loader&#x27;</span>          &#125;        &#125;,        &#123;          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/i</span>,          <span class="hljs-attr">use</span>: [            devMode ? <span class="hljs-string">&#x27;style-loader&#x27;</span> : <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,            &#123;              <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;css-loader&#x27;</span>,              <span class="hljs-attr">options</span>: &#123;                <span class="hljs-comment">// å…è®¸åœ¨ä½¿ç”¨css-loaderä¹‹å‰åŠ è½½å¤šå°‘ä¸ªæ¨¡å— postcss-loader</span>                <span class="hljs-attr">importLoaders</span>: <span class="hljs-number">1</span>              &#125;            &#125;,            <span class="hljs-string">&#x27;postcss-loader&#x27;</span>          ]        &#125;,        &#123;          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/i</span>,          <span class="hljs-attr">use</span>: [            devMode ? <span class="hljs-string">&#x27;style-loader&#x27;</span> : <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,            &#123;              <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;css-loader&#x27;</span>,              <span class="hljs-attr">options</span>: &#123;                <span class="hljs-comment">// 0 =&gt; no loaders (default);</span>                <span class="hljs-comment">// 1 =&gt; postcss-loader;</span>                <span class="hljs-comment">// 2 =&gt; postcss-loader, less-loader</span>                <span class="hljs-attr">importLoaders</span>: <span class="hljs-number">2</span>              &#125;            &#125;,            <span class="hljs-string">&#x27;postcss-loader&#x27;</span>,            <span class="hljs-string">&#x27;less-loader&#x27;</span>          ]        &#125;,        <span class="hljs-comment">/**</span><span class="hljs-comment">         * èµ„æºæ¨¡å—ç±»å‹(asset module type)ï¼Œé€šè¿‡æ·»åŠ  4 ç§æ–°çš„æ¨¡å—ç±»å‹ï¼Œæ¥æ›¿æ¢æ‰€æœ‰è¿™äº› loaderï¼š</span><span class="hljs-comment">         * 1.asset/resource å‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å¹¶å¯¼å‡º URLã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ file-loader å®ç°</span><span class="hljs-comment">         * 2.asset/inline å¯¼å‡ºä¸€ä¸ªèµ„æºçš„ data URIã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loader å®ç°</span><span class="hljs-comment">         * 3.asset/source å¯¼å‡ºèµ„æºçš„æºä»£ç ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ raw-loader å®ç°</span><span class="hljs-comment">         * 4.asset åœ¨å¯¼å‡ºä¸€ä¸ª data URI å’Œå‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¹‹é—´è‡ªåŠ¨é€‰æ‹©ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loaderï¼Œå¹¶ä¸”é…ç½®èµ„æº</span><span class="hljs-comment">  ä½“ç§¯é™åˆ¶å®ç°</span><span class="hljs-comment">         */</span>        &#123;          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpeg|svg|gif|jpg)$/</span>,          <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset&#x27;</span>,          <span class="hljs-attr">generator</span>: &#123;            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;img/[name].[hash:6].[ext]&#x27;</span>          &#125;,          <span class="hljs-attr">parser</span>: &#123;            <span class="hljs-attr">dataUrlCondition</span>: &#123;              <span class="hljs-attr">maxSize</span>: <span class="hljs-number">100</span> * <span class="hljs-number">1024</span>            &#125;          &#125;        &#125;,        &#123;          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(woff|woff2|eot|ttf|otf)$/i</span>,          <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/resource&#x27;</span>,          <span class="hljs-attr">generator</span>: &#123;            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;font/[name].[hash:6].[ext]&#x27;</span>          &#125;        &#125;,        &#123;          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(csv|tsv)$/</span>,          <span class="hljs-attr">use</span>: [<span class="hljs-string">&#x27;csv-loader&#x27;</span>]        &#125;,        &#123;          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.xml$/</span>,          <span class="hljs-attr">use</span>: [<span class="hljs-string">&#x27;xml-loader&#x27;</span>]        &#125;      ]    &#125;,    <span class="hljs-attr">resolve</span>: &#123;      <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&#x27;.wasm&#x27;</span>, <span class="hljs-string">&#x27;.mjs&#x27;</span>, <span class="hljs-string">&#x27;.js&#x27;</span>, <span class="hljs-string">&#x27;.json&#x27;</span>, <span class="hljs-string">&#x27;.jsx&#x27;</span>, <span class="hljs-string">&#x27;.ts&#x27;</span>, <span class="hljs-string">&#x27;.vue&#x27;</span>],      <span class="hljs-attr">alias</span>: &#123;        <span class="hljs-string">&#x27;@&#x27;</span>: <span class="hljs-title function_">resolveApp</span>(<span class="hljs-string">&#x27;./src&#x27;</span>)      &#125;    &#125;,    <span class="hljs-attr">plugins</span>: [      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintPlugin</span>(),      <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;        <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;developement&#x27;</span>,        <span class="hljs-comment">// htmlæ¨¡æ¿</span>        <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./src/asset/index.html&#x27;</span>      &#125;),      <span class="hljs-comment">// å®šä¹‰å…¨å±€å¸¸é‡</span>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefinePlugin</span>(&#123;        <span class="hljs-attr">BASE_URL</span>: <span class="hljs-string">&#x27;&quot;./&quot;&#x27;</span>      &#125;),      <span class="hljs-comment">// å¤åˆ¶æ–‡ä»¶åˆ°distæ–‡ä»¶å¤¹</span>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyWebpackPlugin</span>(&#123;        <span class="hljs-attr">patterns</span>: [          &#123;            <span class="hljs-attr">from</span>: <span class="hljs-string">&#x27;src/asset&#x27;</span>,            <span class="hljs-attr">globOptions</span>: &#123;              <span class="hljs-attr">ignore</span>: [<span class="hljs-string">&#x27;**/index.html&#x27;</span>, <span class="hljs-string">&#x27;**/.DS_Store&#x27;</span>]            &#125;          &#125;        ]      &#125;)    ]  &#125;;&#125;;<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">env, args</span>) =&gt;</span> &#123;  <span class="hljs-keyword">switch</span> (args.<span class="hljs-property">mode</span>) &#123;    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;development&#x27;</span>:      <span class="hljs-keyword">return</span> <span class="hljs-title function_">merge</span>(<span class="hljs-title function_">commonConfig</span>(env, args), developmentConfig);    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;production&#x27;</span>:      <span class="hljs-keyword">return</span> <span class="hljs-title function_">merge</span>(<span class="hljs-title function_">commonConfig</span>(env, args), productionConfig);    <span class="hljs-attr">default</span>:      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;No matching configuration was fou)nd!&#x27;</span>);  &#125;&#125;;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//webpack.dev.js</span><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">HotModuleReplacementPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>);<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;  <span class="hljs-attr">entry</span>: [<span class="hljs-string">&#x27;webpack-hot-middleware/client?noInfo=false&amp;reload=true&#x27;</span>],  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,  <span class="hljs-comment">// åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨</span>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&#x27;source-map&#x27;</span>,  <span class="hljs-comment">// --watch éœ€è¦æ‰‹åŠ¨åˆ·æ–°é¡µé¢ä¸æ–¹ä¾¿</span>  <span class="hljs-comment">// å¼€å¯æœ¬åœ°æœåŠ¡å™¨</span>  <span class="hljs-comment">// å®˜æ–¹å…¶å®æœ‰æåˆ°ï¼Œå»ºè®® devServer.publicPath ä¸ output.publicPathç›¸åŒ</span>  <span class="hljs-attr">devServer</span>: &#123;    <span class="hljs-attr">static</span>: <span class="hljs-string">&#x27;./dist&#x27;</span>,    <span class="hljs-comment">/**</span><span class="hljs-comment">     *  hot: &#x27;only&#x27;ï¼šè¡¨ç¤ºçƒ­æ¨¡å—æ›¿æ¢ï¼Œç¼–è¯‘å¤±è´¥åä¸ä¼šåˆ·æ–°æ•´ä¸ªé¡µé¢</span><span class="hljs-comment">     */</span>    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//å¼€å¯gzipå‹ç¼©</span>    <span class="hljs-attr">port</span>: <span class="hljs-string">&#x27;auto&#x27;</span>, <span class="hljs-comment">//ä¿®æ”¹æœ¬åœ°æœåŠ¡å™¨ç«¯å£å·, autoç”±æœåŠ¡å™¨è‡ªåŠ¨åˆ†é…ä¸€ä¸ªç«¯å£å·</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * historyApiFallbackæ˜¯å¼€å‘ä¸­ä¸€ä¸ªéå¸¸å¸¸è§çš„å±æ€§ï¼Œå®ƒä¸»è¦çš„ä½œç”¨æ˜¯è§£å†³SPAé¡µé¢åœ¨è·¯ç”±è·³è½¬ä¹‹åï¼Œè¿›è¡Œé¡µé¢åˆ·æ–°</span><span class="hljs-comment">æ—¶ï¼Œè¿”å›404çš„é”™è¯¯</span><span class="hljs-comment">    å¦‚æœè®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆåœ¨åˆ·æ–°æ—¶ï¼Œè¿”å›404é”™è¯¯æ—¶ï¼Œä¼šè‡ªåŠ¨è¿”å› index.html çš„å†…å®¹</span><span class="hljs-comment">     */</span>    <span class="hljs-attr">historyApiFallback</span>: <span class="hljs-literal">true</span>,    <span class="hljs-comment">//  è®¾ç½®ä¸»æœºåœ°å€</span>    <span class="hljs-comment">// host: &#x27;0.0.0.0&#x27;,</span>    <span class="hljs-comment">// æ˜¯å¦è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</span>    <span class="hljs-comment">// open: true,</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¾ç½®å¼€å‘ä»£ç†</span><span class="hljs-comment">     */</span>    <span class="hljs-attr">proxy</span>: &#123;      <span class="hljs-string">&#x27;/api&#x27;</span>: &#123;        <span class="hljs-attr">target</span>: <span class="hljs-string">&#x27;http://localhost:3000/api&#x27;</span>,        <span class="hljs-attr">pathRewrite</span>: &#123; <span class="hljs-string">&#x27;^/api&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span> &#125;,        <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span>      &#125;    &#125;  &#125;,  <span class="hljs-attr">plugins</span>: [    <span class="hljs-comment">// ä½¿ç”¨webpack-hot-middlewareæ›¿ä»£webpack-dev-middlewareå¼€å¯çƒ­æ›´æ–°ï¼Œå› ä¸ºwebpack-dev-middlewareä¸èƒ½å¤Ÿçƒ­æ›´æ–°</span>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HotModuleReplacementPlugin</span>()  ]&#125;;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//webpack.prod.js</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mini-css-extract-plugin&#x27;</span>);<span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;css-minimizer-webpack-plugin&#x27;</span>);<span class="hljs-comment">// const TerserPlugin = require(&#x27;terser-webpack-plugin&#x27;);</span><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&#x27;source-map&#x27;</span>,  <span class="hljs-comment">/**</span><span class="hljs-comment">   * ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨CDNï¼Œä¸éœ€è¦ä¸‹è½½åŒ…ï¼Œæ’é™¤è¿™äº›åº“</span><span class="hljs-comment">   */</span>  <span class="hljs-attr">externals</span>: &#123;    <span class="hljs-comment">// window._</span>    <span class="hljs-attr">lodash</span>: <span class="hljs-string">&#x27;_&#x27;</span>,    <span class="hljs-comment">// window.dayjs</span>    <span class="hljs-attr">dayjs</span>: <span class="hljs-string">&#x27;dayjs&#x27;</span>  &#125;,  <span class="hljs-comment">// optimization: &#123;</span>  <span class="hljs-comment">//   //  ç”Ÿäº§ç¯å¢ƒä¸­æœ‰tree shaking</span>  <span class="hljs-comment">//   minimize: false,</span>  <span class="hljs-comment">//   minimizer: [</span>  <span class="hljs-comment">//     // å¯¹jsä»£ç è¿›è¡Œå‹ç¼©ç›¸å…³çš„æ“ä½œï¼Œå¼€å‘ç¯å¢ƒä¸éœ€è¦å‹ç¼©ï¼Œå‡å°‘æ‰“åŒ…æ—¶é—´</span>  <span class="hljs-comment">//     new TerserPlugin(&#123;</span>  <span class="hljs-comment">//       parallel: true,</span>  <span class="hljs-comment">//       extractComments: false,</span>  <span class="hljs-comment">//       terserOptions: &#123;</span>  <span class="hljs-comment">//         compress: &#123;</span>  <span class="hljs-comment">//           arguments: false,</span>  <span class="hljs-comment">//           dead_code: true</span>  <span class="hljs-comment">//         &#125;,</span>  <span class="hljs-comment">//         mangle: true,</span>  <span class="hljs-comment">//         toplevel: true,</span>  <span class="hljs-comment">//         keep_classnames: true,</span>  <span class="hljs-comment">//         keep_fnames: true</span>  <span class="hljs-comment">//       &#125;</span>  <span class="hljs-comment">//     &#125;)</span>  <span class="hljs-comment">//   ]</span>  <span class="hljs-comment">// &#125;,</span>  <span class="hljs-attr">plugins</span>: [    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è¯¥æ’ä»¶å°† CSS æå–åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚å®ƒä¸ºæ¯ä¸ªåŒ…å« CSS çš„ JS æ–‡ä»¶åˆ›å»ºä¸€ä¸ª CSS æ–‡ä»¶ã€‚å®ƒæ”¯æŒ CSS å’Œ SourceMaps çš„æŒ‰éœ€åŠ è½½ã€‚å®ƒå»ºç«‹åœ¨æ–°çš„ webpack v5 åŠŸèƒ½ä¹‹ä¸Šï¼Œéœ€è¦ webpack 5 æ‰èƒ½å·¥ä½œã€‚</span><span class="hljs-comment">     * å¼‚æ­¥åŠ è½½</span><span class="hljs-comment">æ— é‡å¤ç¼–è¯‘ï¼ˆæ€§èƒ½ï¼‰</span><span class="hljs-comment">æ›´å®¹æ˜“ä½¿ç”¨</span><span class="hljs-comment">ç‰¹å®šäº CSS</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;css/[name].[contenthash:8].css&#x27;</span>,      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&#x27;css/[name].[contenthash:8].css&#x27;</span>    &#125;),    <span class="hljs-comment">// å¯¹cssè¿›è¡Œå‹ç¼© è¿™æ ·å†™å¯ä»¥åªåœ¨productionä¸­ä½¿ç”¨</span>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>()  ]&#125;;<span class="hljs-comment">/**</span><span class="hljs-comment"> * Hashã€ContentHashã€ChunkHash</span><span class="hljs-comment"> */</span><span class="hljs-comment">//  åœ¨æˆ‘ä»¬ç»™æ‰“åŒ…çš„æ–‡ä»¶è¿›è¡Œå‘½åçš„æ—¶å€™ï¼Œä¼šä½¿ç”¨placeholderï¼Œplaceholderä¸­æœ‰å‡ ä¸ªå±æ€§æ¯”è¾ƒç›¸ä¼¼ï¼š</span><span class="hljs-comment">// p hashã€chunkhashã€contenthash</span><span class="hljs-comment">// p hashæœ¬èº«æ˜¯é€šè¿‡MD4çš„æ•£åˆ—å‡½æ•°å¤„ç†åï¼Œç”Ÿæˆä¸€ä¸ª128ä½çš„hashå€¼ï¼ˆ32ä¸ªåå…­è¿›åˆ¶ï¼‰ï¼›</span><span class="hljs-comment">// n hashå€¼çš„ç”Ÿæˆå’Œæ•´ä¸ªé¡¹ç›®æœ‰å…³ç³»ï¼š</span><span class="hljs-comment">// p æ¯”å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªå…¥å£index.jså’Œmain.jsï¼›</span><span class="hljs-comment">// p å®ƒä»¬åˆ†åˆ«ä¼šè¾“å‡ºåˆ°ä¸åŒçš„bundleæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”åœ¨æ–‡ä»¶åç§°ä¸­æˆ‘ä»¬æœ‰ä½¿ç”¨hashï¼›</span><span class="hljs-comment">// p è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœä¿®æ”¹äº†index.jsæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆhashä¼šå‘ç”Ÿå˜åŒ–ï¼›</span><span class="hljs-comment">// p é‚£å°±æ„å‘³ç€ä¸¤ä¸ªæ–‡ä»¶çš„åç§°éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼›</span><span class="hljs-comment">// n chunkhashå¯ä»¥æœ‰æ•ˆçš„è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå®ƒä¼šæ ¹æ®ä¸åŒçš„å…¥å£è¿›è¡Œå€Ÿæ¥è§£ææ¥ç”Ÿæˆhashå€¼ï¼š</span><span class="hljs-comment">// p æ¯”å¦‚æˆ‘ä»¬ä¿®æ”¹äº†index.jsï¼Œé‚£ä¹ˆmain.jsçš„chunkhashæ˜¯ä¸ä¼šå‘ç”Ÿæ”¹å˜çš„ï¼›</span><span class="hljs-comment">// n contenthashè¡¨ç¤ºç”Ÿæˆçš„æ–‡ä»¶hashåç§°ï¼Œåªå’Œå†…å®¹æœ‰å…³ç³»ï¼š</span><span class="hljs-comment">// p æ¯”å¦‚æˆ‘ä»¬çš„index.jsï¼Œå¼•å…¥äº†ä¸€ä¸ªstyle.cssï¼Œstyle.cssæœ‰è¢«æŠ½å–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„cssæ–‡ä»¶ä¸­ï¼›</span><span class="hljs-comment">// p è¿™ä¸ªcssæ–‡ä»¶åœ¨å‘½åæ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯chunkhashï¼›</span><span class="hljs-comment">// p é‚£ä¹ˆå½“index.jsæ–‡ä»¶çš„å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œcssæ–‡ä»¶çš„å‘½åä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼›</span><span class="hljs-comment">// p è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨contenthash</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//server.js</span><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>);<span class="hljs-keyword">const</span> webpackDevMiddleware = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-dev-middleware&#x27;</span>);<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<span class="hljs-keyword">const</span> config = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./config/webpack.common&#x27;</span>)(&#123;&#125;, &#123; <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span> &#125;);<span class="hljs-keyword">const</span> compiler = <span class="hljs-title function_">webpack</span>(config);<span class="hljs-comment">// Tell express to use the webpack-dev-middleware and use the webpack.config.js</span><span class="hljs-comment">// configuration file as a base.</span>app.<span class="hljs-title function_">use</span>(  <span class="hljs-title function_">webpackDevMiddleware</span>(compiler, &#123;    <span class="hljs-attr">publicPath</span>: config.<span class="hljs-property">output</span>.<span class="hljs-property">publicPath</span>  &#125;));<span class="hljs-comment">// webpack-hot-middlewareå¯ä»¥å¼€å¯çƒ­æ›´æ–°</span>app.<span class="hljs-title function_">use</span>(<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-hot-middleware&#x27;</span>)(compiler));<span class="hljs-comment">// Serve the files on port 3000.</span>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">4000</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Example app listening on port 4000!\n&#x27;</span>);&#125;);</code></pre></div><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-comment">//package,son</span><span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;test&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack --config ./config/webpack.common.js  --mode production --env production&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack serve --open  --config ./config/webpack.common.js  --mode development --env development&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;watch&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack --config ./config/webpack.common.js --watch  --mode development --env development&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;serve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;node server.js&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;type-check&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tsc --noEmit&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;type-check-watch&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tsc --noEmit --watch&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;prettier&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;prettier --write .&quot;</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å¸¸ç”¨æ„å»ºå·¥å…·</category>
      
      <category>webpack</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼</title>
    <link href="/2022/09/08/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/2022/09/08/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// åˆ›å»ºæ­£åˆ™</span>   <span class="hljs-comment">// 1&gt; åŒ¹é…çš„è§„åˆ™pattern</span>   <span class="hljs-comment">// 2&gt; åŒ¹é…çš„ä¿®é¥°ç¬¦flags</span>   <span class="hljs-keyword">const</span> re1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-string">&quot;ig&quot;</span>)   <span class="hljs-keyword">const</span> re2 = <span class="hljs-regexp">/abc/ig</span> <span class="hljs-comment">// æˆ‘æ˜¯æ³¨é‡Š</span></code></pre></div><h4 id="æ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨æ–¹æ³•"><a href="#æ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨æ–¹æ³•" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨æ–¹æ³•"></a>æ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨æ–¹æ³•</h4><p>JavaScriptä¸­çš„æ­£åˆ™è¡¨è¾¾å¼è¢«ç”¨äº RegExp çš„ exec å’Œ test æ–¹æ³•</p><p>ä¹ŸåŒ…æ‹¬ String çš„ matchã€matchAllã€replaceã€search å’Œ split æ–¹æ³•</p><p>exec : ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æ‰§è¡ŒæŸ¥æ‰¾åŒ¹é…çš„ RegExp æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ˆæœªåŒ¹é…åˆ°åˆ™è¿”å› nullï¼‰</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> message = <span class="hljs-string">&quot;fdabc123 faBC323 dfABC222 A2324aaBc&quot;</span>;<span class="hljs-keyword">const</span> re1 = <span class="hljs-regexp">/abc/gi</span>;<span class="hljs-comment">// console.log(re1.test(message));</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(re1.<span class="hljs-title function_">exec</span>(message));<span class="hljs-comment">/**</span><span class="hljs-comment"> * [</span><span class="hljs-comment">  &#x27;aBC&#x27;,</span><span class="hljs-comment">  index: 10,</span><span class="hljs-comment">  input: &#x27;fdabc123 faBC323 dfABC222 A2324aaBc&#x27;,</span><span class="hljs-comment">  groups: undefined</span><span class="hljs-comment">]</span><span class="hljs-comment"> */</span></code></pre></div><p>test:ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æµ‹è¯•æ˜¯å¦åŒ¹é…çš„ RegExp æ–¹æ³•ï¼Œå®ƒè¿”å› true æˆ– false</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> message = <span class="hljs-string">&quot;fdabc123 faBC323 dfABC222 A2324aaBc&quot;</span>;<span class="hljs-keyword">const</span> re1 = <span class="hljs-regexp">/abc/gi</span>; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(re1.<span class="hljs-title function_">test</span>(message));</code></pre></div><p>match:ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æ‰§è¡ŒæŸ¥æ‰¾åŒ¹é…çš„ String æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œåœ¨æœªåŒ¹é…åˆ°æ—¶ä¼šè¿”å› null</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// matchæ–¹æ³•</span><span class="hljs-keyword">const</span> res2 = message.<span class="hljs-title function_">match</span>(re1);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res2);<span class="hljs-comment">//[ &#x27;abc&#x27;, &#x27;aBC&#x27;, &#x27;ABC&#x27;, &#x27;aBc&#x27; ]</span></code></pre></div><p>matchAll :ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æ‰§è¡ŒæŸ¥æ‰¾æ‰€æœ‰åŒ¹é…çš„ String æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆiteratorï¼‰</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// matchAll</span><span class="hljs-keyword">const</span> res = message.<span class="hljs-title function_">matchAll</span>(re1);<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> iterator <span class="hljs-keyword">of</span> res) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iterator);&#125;[  <span class="hljs-string">&#x27;abc&#x27;</span>,  <span class="hljs-attr">index</span>: <span class="hljs-number">2</span>,  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;fdabc123 faBC323 dfABC222 A2324aaBc&#x27;</span>,  <span class="hljs-attr">groups</span>: <span class="hljs-literal">undefined</span>][  <span class="hljs-string">&#x27;aBC&#x27;</span>,  <span class="hljs-attr">index</span>: <span class="hljs-number">10</span>,  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;fdabc123 faBC323 dfABC222 A2324aaBc&#x27;</span>,  <span class="hljs-attr">groups</span>: <span class="hljs-literal">undefined</span>][  <span class="hljs-string">&#x27;ABC&#x27;</span>,  <span class="hljs-attr">index</span>: <span class="hljs-number">19</span>,  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;fdabc123 faBC323 dfABC222 A2324aaBc&#x27;</span>,  <span class="hljs-attr">groups</span>: <span class="hljs-literal">undefined</span>][  <span class="hljs-string">&#x27;aBc&#x27;</span>,  <span class="hljs-attr">index</span>: <span class="hljs-number">32</span>,  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;fdabc123 faBC323 dfABC222 A2324aaBc&#x27;</span>,  <span class="hljs-attr">groups</span>: <span class="hljs-literal">undefined</span>]</code></pre></div><p>search :ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æµ‹è¯•åŒ¹é…çš„ String æ–¹æ³•ï¼Œå®ƒè¿”å›åŒ¹é…åˆ°çš„ä½ç½®ç´¢å¼•ï¼Œæˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å›-1ã€‚</p><div class="code-wrapper"><pre><code class="hljs stata"><span class="hljs-keyword">const</span> result5 = message.<span class="hljs-keyword">search</span>(re1)console.<span class="hljs-built_in">log</span>(result5)</code></pre></div><p>replace:ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æ‰§è¡ŒæŸ¥æ‰¾åŒ¹é…çš„ String æ–¹æ³•ï¼Œå¹¶ä¸”ä½¿ç”¨æ›¿æ¢å­—ç¬¦ä¸²æ›¿æ¢æ‰åŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸²</p><p>split:ä¸€ä¸ªä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æˆ–è€…ä¸€ä¸ªå›ºå®šå­—ç¬¦ä¸²åˆ†éš”ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å°†åˆ†éš”åçš„å­å­—ç¬¦ä¸²å­˜å‚¨åˆ°æ•°ç»„ä¸­ çš„ String æ–¹æ³•</p><h4 id="ä¿®é¥°ç¬¦flagçš„ä½¿ç”¨"><a href="#ä¿®é¥°ç¬¦flagçš„ä½¿ç”¨" class="headerlink" title="ä¿®é¥°ç¬¦flagçš„ä½¿ç”¨"></a>ä¿®é¥°ç¬¦flagçš„ä½¿ç”¨</h4><p>å¸¸è§çš„ä¿®é¥°ç¬¦</p><p>g:å…¨å±€åŒ¹é…</p><p>i:ä¸åŒºåˆ†å¤§å°å†™</p><p>m:å¤šè¡ŒåŒ¹é…</p><h4 id="è§„åˆ™-â€“-å­—ç¬¦ç±»"><a href="#è§„åˆ™-â€“-å­—ç¬¦ç±»" class="headerlink" title="è§„åˆ™ â€“ å­—ç¬¦ç±»"></a>è§„åˆ™ â€“ å­—ç¬¦ç±»</h4><div class="code-wrapper"><pre><code class="hljs livescript"><span class="hljs-string">\d</span>  å¹³åŒ¹é…æ•°å­—<span class="hljs-number">0</span>-<span class="hljs-number">9</span><span class="hljs-string">\s</span>  ç©ºæ ¼ç¬¦å·ï¼ŒåŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦<span class="hljs-string">\t</span> , æ¢è¡Œç¬¦<span class="hljs-string">\n,å’Œå…¶ä»–å°‘æ•°ç¨€æœ‰å­—ç¬¦ï¼Œä¾‹å¦‚\v,\f,\r</span><span class="hljs-string">\w</span>  è¡¨ç¤ºå•å­—å­—ç¬¦  å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿</code></pre></div><p>åå‘ç±»</p><p>\D è¡¨ç¤ºéæ•°å­—çš„å…¶ä»–å­—ç¬¦åŒ…æ‹¬æ•°å­—</p><p>\W è¡¨ç¤ºéå•å­—å­—ç¬¦</p><p>\S éç©ºæ ¼å­—ç¬¦</p><h4 id="è§„åˆ™-â€“-é”šç‚¹"><a href="#è§„åˆ™-â€“-é”šç‚¹" class="headerlink" title="è§„åˆ™ â€“ é”šç‚¹"></a>è§„åˆ™ â€“ é”šç‚¹</h4><p>ç¬¦å· ^ å’Œç¬¦å· $ åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å…·æœ‰ç‰¹æ®Šçš„æ„ä¹‰ï¼Œå®ƒä»¬è¢«ç§°ä¸ºâ€œé”šç‚¹â€</p><p>ç¬¦å· ^ åŒ¹é…æ–‡æœ¬å¼€å¤´ï¼›</p><p>ç¬¦å· $ åŒ¹é…æ–‡æœ¬æœ«å°¾ï¼›</p><p>è¯è¾¹ç•Œï¼ˆWord boundaryï¼‰</p><p>â€‹    è¯è¾¹ç•Œ \b æ˜¯ä¸€ç§æ£€æŸ¥ï¼Œå°±åƒ ^ å’Œ $ ä¸€æ ·ï¼Œå®ƒä¼šæ£€æŸ¥å­—ç¬¦ä¸²ä¸­çš„ä½ç½®æ˜¯å¦æ˜¯è¯è¾¹ç•Œ</p><p>â€‹    è¯è¾¹ç•Œæµ‹è¯• \b æ£€æŸ¥ä½ç½®çš„ä¸€ä¾§æ˜¯å¦åŒ¹é… \wï¼Œè€Œå¦ä¸€ä¾§åˆ™ä¸åŒ¹é… â€œ\wâ€</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> message = <span class="hljs-string">&quot;My name! is WHY.&quot;</span>;<span class="hljs-comment">// éœ€æ±‚: name, nameå¿…é¡»æ˜¯ä¸€ä¸ªå•ç‹¬çš„è¯</span><span class="hljs-comment">// è¯è¾¹ç•Œ</span><span class="hljs-keyword">if</span> (<span class="hljs-regexp">/\bname\b/i</span>.<span class="hljs-title function_">test</span>(message)) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;æœ‰name, nameæœ‰è¾¹ç•Œ&quot;</span>);&#125;<span class="hljs-comment">// è¯è¾¹ç•Œçš„åº”ç”¨</span><span class="hljs-keyword">const</span> infos = <span class="hljs-string">&quot;now time is 11:56, 12:00 eat food, number is 123:456&quot;</span>;<span class="hljs-keyword">const</span> timeRe = <span class="hljs-regexp">/\b\d\d:\d\d\b/gi</span>;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(infos.<span class="hljs-title function_">match</span>(timeRe));<span class="hljs-comment">/**</span><span class="hljs-comment"> * æœ‰name, nameæœ‰è¾¹ç•Œ</span><span class="hljs-comment">[ &#x27;11:56&#x27;, &#x27;12:00&#x27; ]</span><span class="hljs-comment"> */</span></code></pre></div><h4 id="è§„åˆ™-â€“-è½¬ä¹‰å­—ç¬¦ä¸²"><a href="#è§„åˆ™-â€“-è½¬ä¹‰å­—ç¬¦ä¸²" class="headerlink" title="è§„åˆ™ â€“ è½¬ä¹‰å­—ç¬¦ä¸²"></a>è§„åˆ™ â€“ è½¬ä¹‰å­—ç¬¦ä¸²</h4><p>è½¬ä¹‰å­—ç¬¦è¦åšå¸¸è§„å­—ç¬¦æ¥ä½¿ç”¨ï¼Œéœ€è¦ä½¿ç”¨å¯¹å…¶è¿›è¡Œè½¬ä¹‰ï¼Œåªè¦åœ¨å®ƒå‰é¢åŠ ä¸ªåæ–œæ </p><p>å¸¸è§çš„éœ€è¦è½¬ä¹‰çš„å­—ç¬¦ï¼š</p><div class="code-wrapper"><pre><code class="hljs 1c">[] \  ^ $ . <span class="hljs-string">| ? * + ()</span></code></pre></div><h6 id="æ–œæ ç¬¦å·-â€˜-â€™-å¹¶ä¸æ˜¯ä¸€ä¸ªç‰¹æ®Šç¬¦å·ï¼Œä½†æ˜¯åœ¨å­—é¢é‡æ­£åˆ™è¡¨è¾¾å¼ä¸­ä¹Ÿéœ€è¦è½¬ä¹‰"><a href="#æ–œæ ç¬¦å·-â€˜-â€™-å¹¶ä¸æ˜¯ä¸€ä¸ªç‰¹æ®Šç¬¦å·ï¼Œä½†æ˜¯åœ¨å­—é¢é‡æ­£åˆ™è¡¨è¾¾å¼ä¸­ä¹Ÿéœ€è¦è½¬ä¹‰" class="headerlink" title="æ–œæ ç¬¦å· â€˜/â€™ å¹¶ä¸æ˜¯ä¸€ä¸ªç‰¹æ®Šç¬¦å·ï¼Œä½†æ˜¯åœ¨å­—é¢é‡æ­£åˆ™è¡¨è¾¾å¼ä¸­ä¹Ÿéœ€è¦è½¬ä¹‰"></a>æ–œæ ç¬¦å· â€˜/â€™ å¹¶ä¸æ˜¯ä¸€ä¸ªç‰¹æ®Šç¬¦å·ï¼Œä½†æ˜¯åœ¨å­—é¢é‡æ­£åˆ™è¡¨è¾¾å¼ä¸­ä¹Ÿéœ€è¦è½¬ä¹‰</h6><h4 id="é›†åˆï¼ˆSetsï¼‰å’ŒèŒƒå›´ï¼ˆRangesï¼‰"><a href="#é›†åˆï¼ˆSetsï¼‰å’ŒèŒƒå›´ï¼ˆRangesï¼‰" class="headerlink" title="é›†åˆï¼ˆSetsï¼‰å’ŒèŒƒå›´ï¼ˆRangesï¼‰"></a>é›†åˆï¼ˆSetsï¼‰å’ŒèŒƒå›´ï¼ˆRangesï¼‰</h4><h6 id="æœ‰æ—¶å€™æˆ‘ä»¬åªè¦é€‰æ‹©å¤šä¸ªåŒ¹é…å­—ç¬¦çš„å…¶ä¸­ä¹‹ä¸€å°±å¯ä»¥"><a href="#æœ‰æ—¶å€™æˆ‘ä»¬åªè¦é€‰æ‹©å¤šä¸ªåŒ¹é…å­—ç¬¦çš„å…¶ä¸­ä¹‹ä¸€å°±å¯ä»¥" class="headerlink" title="æœ‰æ—¶å€™æˆ‘ä»¬åªè¦é€‰æ‹©å¤šä¸ªåŒ¹é…å­—ç¬¦çš„å…¶ä¸­ä¹‹ä¸€å°±å¯ä»¥"></a>æœ‰æ—¶å€™æˆ‘ä»¬åªè¦é€‰æ‹©å¤šä¸ªåŒ¹é…å­—ç¬¦çš„å…¶ä¸­ä¹‹ä¸€å°±å¯ä»¥</h6><div class="code-wrapper"><pre><code class="hljs"> æœ‰æ—¶å€™æˆ‘ä»¬åªè¦é€‰æ‹©å¤šä¸ªåŒ¹é…å­—ç¬¦çš„å…¶ä¸­ä¹‹ä¸€å°±å¯ä»¥</code></pre></div><p>é›†åˆ  []  è¡¨ç¤ºåŒ¹é…ä¸­æ‹¬å·é‡Œé¢çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</p><p>èŒƒå›´  </p><p>â€‹    [0-9] æ–¹æ‹¬å·ä¹Ÿå¯ä»¥åŒ…å«å­—ç¬¦èŒƒå›´ï¼Œä¾‹å¦‚åŒ¹é…ä»aåˆ°zèŒƒå›´çš„å­—æ¯[a-z],[0-5],</p><p>â€‹    \d  ===[0-9]</p><p>â€‹    \w ===[a-zA-Z0-9]</p><p>â€‹    .    ç‚¹è¡¨ç¤ºåŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„æ‰€æœ‰å­—ç¬¦</p><h5 id="æ’é™¤èŒƒå›´ï¼šé™¤äº†æ™®é€šçš„èŒƒå›´åŒ¹é…ï¼Œè¿˜æœ‰ç±»ä¼¼-â€¦-çš„â€œæ’é™¤â€èŒƒå›´åŒ¹é…"><a href="#æ’é™¤èŒƒå›´ï¼šé™¤äº†æ™®é€šçš„èŒƒå›´åŒ¹é…ï¼Œè¿˜æœ‰ç±»ä¼¼-â€¦-çš„â€œæ’é™¤â€èŒƒå›´åŒ¹é…" class="headerlink" title="æ’é™¤èŒƒå›´ï¼šé™¤äº†æ™®é€šçš„èŒƒå›´åŒ¹é…ï¼Œè¿˜æœ‰ç±»ä¼¼ [^â€¦] çš„â€œæ’é™¤â€èŒƒå›´åŒ¹é…"></a>æ’é™¤èŒƒå›´ï¼šé™¤äº†æ™®é€šçš„èŒƒå›´åŒ¹é…ï¼Œè¿˜æœ‰ç±»ä¼¼ [^â€¦] çš„â€œæ’é™¤â€èŒƒå›´åŒ¹é…</h5><h4 id="é‡è¯"><a href="#é‡è¯" class="headerlink" title="é‡è¯"></a>é‡è¯</h4><p>æ•°é‡  {n} ç¡®åˆ‡çš„æ•°  ,{n,m} è¡¨ç¤ºå¤šå°‘èŒƒå›´åŒ¹é…</p><p>ç¼©å†™</p><p>â€‹    +  è¡¨ç¤ºä¸€ä¸ªæˆ–è€…å¤šä¸ª ==={1ï¼Œ}</p><p>â€‹    ï¼Ÿè¡¨ç¤ºé›¶ä¸ªæˆ–è€…ä¸€ä¸ª ==={0ï¼Œ1}</p><p>â€‹    *  è¡¨ç¤ºé›¶ä¸ªæˆ–è€…å¤šä¸ª ==={0ï¼Œ}</p><h4 id="è´ªå©ªï¼ˆ-Greedyï¼‰å’Œæƒ°æ€§ï¼ˆ-lazyï¼‰æ¨¡å¼"><a href="#è´ªå©ªï¼ˆ-Greedyï¼‰å’Œæƒ°æ€§ï¼ˆ-lazyï¼‰æ¨¡å¼" class="headerlink" title="è´ªå©ªï¼ˆ Greedyï¼‰å’Œæƒ°æ€§ï¼ˆ lazyï¼‰æ¨¡å¼"></a>è´ªå©ªï¼ˆ Greedyï¼‰å’Œæƒ°æ€§ï¼ˆ lazyï¼‰æ¨¡å¼</h4><p>é»˜è®¤æ˜¯è´ªå©ªæ¨¡å¼ï¼Œ</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// 1.è´ªå©ªæ¨¡å¼/æƒ°æ€§æ¨¡å¼</span><span class="hljs-keyword">const</span> message =  <span class="hljs-string">&quot;æˆ‘æœ€å–œæ¬¢çš„ä¸¤æœ¬ä¹¦: ã€Šé»„é‡‘æ—¶ä»£ã€‹å’Œã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹ã€ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&quot;</span>;<span class="hljs-comment">// é»˜è®¤.+é‡‡ç”¨è´ªå©ªæ¨¡å¼</span><span class="hljs-keyword">const</span> nameRe = <span class="hljs-regexp">/ã€Š.+ã€‹/gi</span>;<span class="hljs-keyword">const</span> result1 = message.<span class="hljs-title function_">match</span>(nameRe);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result1);<span class="hljs-comment">//[ &#x27;ã€Šé»„é‡‘æ—¶ä»£ã€‹å’Œã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹ã€ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&#x27; ]</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> message =  <span class="hljs-string">&quot;æˆ‘æœ€å–œæ¬¢çš„ä¸¤æœ¬ä¹¦: ã€Šé»„é‡‘æ—¶ä»£ã€‹å’Œã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹ã€ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&quot;</span>;<span class="hljs-comment">// // é»˜è®¤.+é‡‡ç”¨è´ªå©ªæ¨¡å¼</span><span class="hljs-comment">// const nameRe = /ã€Š.+ã€‹/gi;</span><span class="hljs-comment">// const result1 = message.match(nameRe);</span><span class="hljs-comment">// console.log(result1);</span><span class="hljs-comment">// ä½¿ç”¨æƒ°æ€§æ¨¡å¼</span><span class="hljs-keyword">const</span> nameRe = <span class="hljs-regexp">/ã€Š.+?ã€‹/gi</span>;<span class="hljs-keyword">const</span> result1 = message.<span class="hljs-title function_">match</span>(nameRe);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result1);<span class="hljs-comment">//[ &#x27;ã€Šé»„é‡‘æ—¶ä»£ã€‹&#x27;, &#x27;ã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹&#x27;, &#x27;ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&#x27; ]</span></code></pre></div><p>é»˜è®¤æƒ…å†µä¸‹çš„åŒ¹é…è§„åˆ™æ˜¯æŸ¥æ‰¾åˆ°åŒ¹é…çš„å†…å®¹åï¼Œä¼šç»§ç»­å‘åæŸ¥æ‰¾ï¼Œä¸€ç›´æ‰¾åˆ°æœ€åä¸€ä¸ªåŒ¹é…çš„å†…å®¹ , è¿™ç§åŒ¹é…çš„æ–¹å¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºè´ªå©ªæ¨¡å¼ï¼ˆGreedyï¼‰</p><p>æ‡’æƒ°æ¨¡å¼ä¸­çš„é‡è¯ä¸è´ªå©ªæ¨¡å¼ä¸­çš„æ˜¯ç›¸åçš„ã€‚ </p><p>åªè¦è·å–åˆ°å¯¹åº”çš„å†…å®¹åï¼Œå°±ä¸å†ç»§ç»­å‘ååŒ¹é…ï¼› </p><p>æˆ‘ä»¬å¯ä»¥åœ¨é‡è¯åé¢å†åŠ ä¸€ä¸ªé—®å· â€˜?â€™ æ¥å¯ç”¨å®ƒï¼› </p><p> æ‰€ä»¥åŒ¹é…æ¨¡å¼å˜ä¸º *? æˆ– +?ï¼Œç”šè‡³å°† â€˜?â€™ å˜ä¸º ?</p><h4 id="æ•è·ç»„ï¼ˆcapturing-groupï¼‰"><a href="#æ•è·ç»„ï¼ˆcapturing-groupï¼‰" class="headerlink" title="æ•è·ç»„ï¼ˆcapturing groupï¼‰"></a>æ•è·ç»„ï¼ˆcapturing groupï¼‰</h4><p>æ¨¡å¼çš„ä¸€éƒ¨åˆ†å¯ä»¥ç”¨æ‹¬å·æ‹¬èµ·æ¥ (â€¦)ï¼Œè¿™ç§°ä¸ºâ€œæ•è·ç»„ï¼ˆcapturing groupï¼‰â€</p><p>æ¨¡å¼çš„ä¸€éƒ¨åˆ†å¯ä»¥ç”¨æ‹¬å·æ‹¬èµ·æ¥ (â€¦)ï¼Œè¿™ç§°ä¸ºâ€œæ•è·ç»„ï¼ˆcapturing groupï¼‰â€ã€‚</p><p> â—¼ è¿™æœ‰ä¸¤ä¸ªä½œç”¨ï¼š </p><p>â€‹    å®ƒå…è®¸å°†åŒ¹é…çš„ä¸€éƒ¨åˆ†ä½œä¸ºç»“æœæ•°ç»„ä¸­çš„å•ç‹¬é¡¹ï¼›</p><p>â€‹     å®ƒå°†æ‹¬å·è§†ä¸ºä¸€ä¸ªæ•´ä½“ï¼› </p><p>â€‹            æ–¹æ³• str.match(regexp)ï¼Œå¦‚æœ regexp æ²¡æœ‰ g æ ‡å¿—ï¼Œå°†æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…å¹¶å°†å®ƒä½œä¸ºä¸€ä¸ªæ•°ç»„è¿”å›ï¼š</p><p>â€‹                 ï° åœ¨ç´¢å¼• 0 å¤„ï¼šå®Œå…¨åŒ¹é…ã€‚</p><p>â€‹                 ï° åœ¨ç´¢å¼• 1 å¤„ï¼šç¬¬ä¸€ä¸ªæ‹¬å·çš„å†…å®¹ã€‚ </p><p>â€‹                ï° åœ¨ç´¢å¼• 2 å¤„ï¼šç¬¬äºŒä¸ªæ‹¬å·çš„å†…å®¹ã€‚ </p><p>â€‹                    ï° â€¦ç­‰ç­‰</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// 1.æ•è·ç»„</span><span class="hljs-keyword">const</span> message =  <span class="hljs-string">&quot;æˆ‘æœ€å–œæ¬¢çš„ä¸¤æœ¬ä¹¦: ã€Šé»„é‡‘æ—¶ä»£ã€‹å’Œã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹ã€ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&quot;</span>;<span class="hljs-comment">// ä½¿ç”¨æƒ°æ€§æ¨¡å¼</span><span class="hljs-comment">//è¿™æ˜¯é€šè¿‡åœ¨å¼€å§‹æ‹¬å·ä¹‹åç«‹å³æ”¾ç½® ?&lt;name&gt; æ¥å®Œæˆçš„</span><span class="hljs-keyword">const</span> nameRe = <span class="hljs-regexp">/(?:ã€Š)(?&lt;why&gt;.+?)(?:ã€‹)/gi</span>;<span class="hljs-comment">//å¯ä»¥ç»™æ•è·ç»„èµ·åå­—</span><span class="hljs-keyword">const</span> iterator = message.<span class="hljs-title function_">matchAll</span>(nameRe);<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> iterator) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item);&#125;<span class="hljs-comment">// 2.å°†æ•è·ç»„ä½œä¸ºæ•´ä½“</span><span class="hljs-keyword">const</span> info = <span class="hljs-string">&quot;dfabcabcfabcdfdabcabcabcljll;jk;j&quot;</span>;<span class="hljs-keyword">const</span> abcRe = <span class="hljs-regexp">/(abc)&#123;2,&#125;/gi</span>;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(info.<span class="hljs-title function_">match</span>(abcRe));[  <span class="hljs-string">&#x27;ã€Šé»„é‡‘æ—¶ä»£ã€‹&#x27;</span>,  <span class="hljs-string">&#x27;é»„é‡‘æ—¶ä»£&#x27;</span>,  <span class="hljs-attr">index</span>: <span class="hljs-number">10</span>,  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;æˆ‘æœ€å–œæ¬¢çš„ä¸¤æœ¬ä¹¦: ã€Šé»„é‡‘æ—¶ä»£ã€‹å’Œã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹ã€ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&#x27;</span>,  <span class="hljs-attr">groups</span>: [<span class="hljs-title class_">Object</span>: <span class="hljs-literal">null</span> prototype] &#123; <span class="hljs-attr">why</span>: <span class="hljs-string">&#x27;é»„é‡‘æ—¶ä»£&#x27;</span> &#125;][  <span class="hljs-string">&#x27;ã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹&#x27;</span>,  <span class="hljs-string">&#x27;æ²‰é»˜çš„å¤§å¤šæ•°&#x27;</span>,  <span class="hljs-attr">index</span>: <span class="hljs-number">17</span>,  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;æˆ‘æœ€å–œæ¬¢çš„ä¸¤æœ¬ä¹¦: ã€Šé»„é‡‘æ—¶ä»£ã€‹å’Œã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹ã€ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&#x27;</span>,  <span class="hljs-attr">groups</span>: [<span class="hljs-title class_">Object</span>: <span class="hljs-literal">null</span> prototype] &#123; <span class="hljs-attr">why</span>: <span class="hljs-string">&#x27;æ²‰é»˜çš„å¤§å¤šæ•°&#x27;</span> &#125;][  <span class="hljs-string">&#x27;ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&#x27;</span>,  <span class="hljs-string">&#x27;ä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒª&#x27;</span>,  <span class="hljs-attr">index</span>: <span class="hljs-number">26</span>,  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;æˆ‘æœ€å–œæ¬¢çš„ä¸¤æœ¬ä¹¦: ã€Šé»„é‡‘æ—¶ä»£ã€‹å’Œã€Šæ²‰é»˜çš„å¤§å¤šæ•°ã€‹ã€ã€Šä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒªã€‹&#x27;</span>,  <span class="hljs-attr">groups</span>: [<span class="hljs-title class_">Object</span>: <span class="hljs-literal">null</span> prototype] &#123; <span class="hljs-attr">why</span>: <span class="hljs-string">&#x27;ä¸€åªç‰¹ç«‹ç‹¬è¡Œçš„çŒª&#x27;</span> &#125;][ <span class="hljs-string">&#x27;abcabc&#x27;</span>, <span class="hljs-string">&#x27;abcabcabc&#x27;</span> ]</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// 1.å°†æ•è·ç»„ä½œä¸ºæ•´ä½“</span><span class="hljs-keyword">const</span> info = <span class="hljs-string">&quot;dfabcabcfabcdfdabcabcabcljcbacballnbanba;jk;j&quot;</span>;<span class="hljs-keyword">const</span> abcRe = <span class="hljs-regexp">/(abc|cba|nba)&#123;2,&#125;/gi</span>;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(info.<span class="hljs-title function_">match</span>(abcRe));<span class="hljs-comment">//[ &#x27;abcabc&#x27;, &#x27;abcabcabc&#x27;, &#x27;cbacba&#x27;, &#x27;nbanba&#x27; ]</span></code></pre></div><p>éæ•è·ç»„ï¼š</p><p>  æœ‰æ—¶æˆ‘ä»¬éœ€è¦æ‹¬å·æ‰èƒ½æ­£ç¡®åº”ç”¨é‡è¯ï¼Œä½†æˆ‘ä»¬ä¸å¸Œæœ›å®ƒä»¬çš„å†…å®¹å‡ºç°åœ¨ç»“æœä¸­ã€‚</p><p> å¯ä»¥é€šè¿‡åœ¨å¼€å¤´æ·»åŠ  ?: æ¥æ’é™¤ç»„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ­£åˆ™è¡¨è¾¾å¼</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸ç”¨çš„gitæ“ä½œ</title>
    <link href="/2022/09/08/%E5%B8%B8%E7%94%A8%E7%9A%84git%E6%93%8D%E4%BD%9C/"/>
    <url>/2022/09/08/%E5%B8%B8%E7%94%A8%E7%9A%84git%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h4 id="gitåŸºæœ¬ä½¿ç”¨"><a href="#gitåŸºæœ¬ä½¿ç”¨" class="headerlink" title="##gitåŸºæœ¬ä½¿ç”¨"></a>##gitåŸºæœ¬ä½¿ç”¨</h4><h5 id="åˆå§‹åŒ–Gitä»“åº“"><a href="#åˆå§‹åŒ–Gitä»“åº“" class="headerlink" title="åˆå§‹åŒ–Gitä»“åº“"></a>åˆå§‹åŒ–Gitä»“åº“</h5><div class="code-wrapper"><pre><code class="hljs csharp">git <span class="hljs-keyword">init</span></code></pre></div><h5 id="å…‹éš†ä»“åº“"><a href="#å…‹éš†ä»“åº“" class="headerlink" title="å…‹éš†ä»“åº“"></a>å…‹éš†ä»“åº“</h5><div class="code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/coderwhy/</span>hy-react-web-music.git</code></pre></div><h4 id="æ£€æµ‹æ–‡ä»¶çš„çŠ¶æ€"><a href="#æ£€æµ‹æ–‡ä»¶çš„çŠ¶æ€" class="headerlink" title="æ£€æµ‹æ–‡ä»¶çš„çŠ¶æ€"></a>æ£€æµ‹æ–‡ä»¶çš„çŠ¶æ€</h4><div class="code-wrapper"><pre><code class="hljs lua">git <span class="hljs-built_in">status</span>git <span class="hljs-built_in">status</span> -sgit <span class="hljs-built_in">status</span> <span class="hljs-comment">--short</span></code></pre></div><h4 id="å°†æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº"><a href="#å°†æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº" class="headerlink" title="å°†æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº"></a>å°†æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº</h4><div class="code-wrapper"><pre><code class="hljs routeros">git <span class="hljs-built_in">add</span> .</code></pre></div><h4 id="å°†æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤"><a href="#å°†æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤" class="headerlink" title="å°†æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤"></a>å°†æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤</h4><div class="code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">git</span> commit -m <span class="hljs-string">&quot;æäº¤ä¿¡æ¯&quot;</span></code></pre></div><h4 id="add-commit-è¿›è¡Œåˆå¹¶æ“ä½œ"><a href="#add-commit-è¿›è¡Œåˆå¹¶æ“ä½œ" class="headerlink" title="add commit è¿›è¡Œåˆå¹¶æ“ä½œ"></a>add commit è¿›è¡Œåˆå¹¶æ“ä½œ</h4><div class="code-wrapper"><pre><code class="hljs livecodeserver">git commit -<span class="hljs-keyword">a</span> -m <span class="hljs-string">&quot;ä¿®æ”¹æ–‡ä»¶&quot;</span></code></pre></div><h4 id="æŸ¥çœ‹æäº¤å†å²"><a href="#æŸ¥çœ‹æäº¤å†å²" class="headerlink" title="æŸ¥çœ‹æäº¤å†å²"></a>æŸ¥çœ‹æäº¤å†å²</h4><div class="code-wrapper"><pre><code class="hljs applescript">git <span class="hljs-built_in">log</span>git <span class="hljs-built_in">log</span> <span class="hljs-comment">--pretty=oneline</span></code></pre></div><h4 id="ç‰ˆæœ¬å›é€€"><a href="#ç‰ˆæœ¬å›é€€" class="headerlink" title="ç‰ˆæœ¬å›é€€"></a>ç‰ˆæœ¬å›é€€</h4><div class="code-wrapper"><pre><code class="hljs pgsql">git <span class="hljs-keyword">reset</span>  <span class="hljs-comment">--hard HEAD^</span>git <span class="hljs-keyword">reset</span>  <span class="hljs-comment">--hard HEAD~1000</span>git <span class="hljs-keyword">reset</span>  <span class="hljs-comment">--hard 2d44982</span></code></pre></div><h4 id="ç®¡ç†è¿œç¨‹ä»“åº“"><a href="#ç®¡ç†è¿œç¨‹ä»“åº“" class="headerlink" title="ç®¡ç†è¿œç¨‹ä»“åº“"></a>ç®¡ç†è¿œç¨‹ä»“åº“</h4><div class="code-wrapper"><pre><code class="hljs <">git remote -v  //æŸ¥çœ‹è¿œç¨‹ä»“åº“åœ°å€git remote add &lt;shortname&gt; &lt;url&gt;  //æ·»åŠ è¿œç¨‹ä»“åº“ï¼Œè®©æœ¬åœ°ä»“åº“å’Œè¿œç¨‹ä»“åº“å»ºç«‹è¿æ¥git remote rename gitlab glab  //é‡å‘½åè¿œç¨‹ä»“åº“git remote remove gitlab  //ç§»é™¤è¿œç¨‹ä»“åº“</code></pre></div><h4 id="å°†ä»£ç pushåˆ°è¿œç¨‹ä»“åº“ï¼šå°†æœ¬åœ°ä»“åº“çš„ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“ä¸­"><a href="#å°†ä»£ç pushåˆ°è¿œç¨‹ä»“åº“ï¼šå°†æœ¬åœ°ä»“åº“çš„ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“ä¸­" class="headerlink" title="å°†ä»£ç pushåˆ°è¿œç¨‹ä»“åº“ï¼šå°†æœ¬åœ°ä»“åº“çš„ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“ä¸­"></a>å°†ä»£ç pushåˆ°è¿œç¨‹ä»“åº“ï¼šå°†æœ¬åœ°ä»“åº“çš„ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“ä¸­</h4><div class="code-wrapper"><pre><code class="hljs maxima">é»˜è®¤æƒ…å†µä¸‹æ˜¯å°†å½“å‰åˆ†æ”¯ï¼ˆæ¯”å¦‚masterï¼‰<span class="hljs-built_in">push</span>åˆ°<span class="hljs-built_in">origin</span>è¿œç¨‹ä»“åº“çš„ï¼›git <span class="hljs-built_in">push</span>git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> master</code></pre></div><h4 id="ä»è¿œç¨‹ä»“åº“fetchä»£ç ï¼šä»è¿œç¨‹ä»“åº“è·å–æœ€æ–°çš„ä»£ç "><a href="#ä»è¿œç¨‹ä»“åº“fetchä»£ç ï¼šä»è¿œç¨‹ä»“åº“è·å–æœ€æ–°çš„ä»£ç " class="headerlink" title="ä»è¿œç¨‹ä»“åº“fetchä»£ç ï¼šä»è¿œç¨‹ä»“åº“è·å–æœ€æ–°çš„ä»£ç "></a>ä»è¿œç¨‹ä»“åº“fetchä»£ç ï¼šä»è¿œç¨‹ä»“åº“è·å–æœ€æ–°çš„ä»£ç </h4><div class="code-wrapper"><pre><code class="hljs sql">é»˜è®¤æƒ…å†µä¸‹æ˜¯ä»originä¸­è·å–ä»£ç ï¼›git <span class="hljs-keyword">fetch</span>git <span class="hljs-keyword">fetch</span> originè·å–åˆ°ä»£ç åé»˜è®¤å¹¶æ²¡æœ‰åˆå¹¶åˆ°æœ¬åœ°ä»“åº“ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡<span class="hljs-keyword">merge</span>æ¥åˆå¹¶ï¼›git <span class="hljs-keyword">merge</span></code></pre></div><h4 id="ä»è¿œç¨‹ä»“åº“pullä»£ç ï¼šä¸Šé¢çš„ä¸¤æ¬¡æ“ä½œæœ‰ç‚¹ç¹çï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå‘½ä»¤æ¥æ“ä½œ"><a href="#ä»è¿œç¨‹ä»“åº“pullä»£ç ï¼šä¸Šé¢çš„ä¸¤æ¬¡æ“ä½œæœ‰ç‚¹ç¹çï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå‘½ä»¤æ¥æ“ä½œ" class="headerlink" title="ä»è¿œç¨‹ä»“åº“pullä»£ç ï¼šä¸Šé¢çš„ä¸¤æ¬¡æ“ä½œæœ‰ç‚¹ç¹çï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå‘½ä»¤æ¥æ“ä½œ"></a>ä»è¿œç¨‹ä»“åº“pullä»£ç ï¼šä¸Šé¢çš„ä¸¤æ¬¡æ“ä½œæœ‰ç‚¹ç¹çï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå‘½ä»¤æ¥æ“ä½œ</h4><div class="code-wrapper"><pre><code class="hljs isbl"><span class="hljs-variable">git</span> <span class="hljs-variable">pull</span> ===<span class="hljs-variable">git</span> <span class="hljs-variable">fetch</span> + <span class="hljs-variable">git</span> <span class="hljs-function"><span class="hljs-title">merge</span>(<span class="hljs-variable">rebase</span>)</span></code></pre></div><h4 id="åˆå¹¶å†²çª"><a href="#åˆå¹¶å†²çª" class="headerlink" title="åˆå¹¶å†²çª"></a>åˆå¹¶å†²çª</h4><h4 id="Gitæ ‡ç­¾ï¼ˆtagï¼‰-åˆ›å»ºtag"><a href="#Gitæ ‡ç­¾ï¼ˆtagï¼‰-åˆ›å»ºtag" class="headerlink" title="Gitæ ‡ç­¾ï¼ˆtagï¼‰ - åˆ›å»ºtag"></a>Gitæ ‡ç­¾ï¼ˆtagï¼‰ - åˆ›å»ºtag</h4><div class="code-wrapper"><pre><code class="hljs crmsh">git <span class="hljs-keyword">tag</span> <span class="hljs-title">v1</span>.<span class="hljs-number">0</span>git <span class="hljs-keyword">tag</span> <span class="hljs-title">-a</span> v1.<span class="hljs-number">1</span> -m <span class="hljs-string">&quot;é™„æ³¨æ ‡ç­¾&quot;</span></code></pre></div><h4 id="push-tag"><a href="#push-tag" class="headerlink" title="push tag"></a>push tag</h4><div class="code-wrapper"><pre><code class="hljs maxima">git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> v1<span class="hljs-number">.0</span>git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> --tags</code></pre></div><h4 id="åˆ é™¤æœ¬åœ°tag"><a href="#åˆ é™¤æœ¬åœ°tag" class="headerlink" title="åˆ é™¤æœ¬åœ°tag"></a>åˆ é™¤æœ¬åœ°tag</h4><div class="code-wrapper"><pre><code class="hljs crmsh">git <span class="hljs-keyword">tag</span> <span class="hljs-title">-d</span> v1.<span class="hljs-number">1</span></code></pre></div><h4 id="åˆ é™¤è¿œç¨‹tag"><a href="#åˆ é™¤è¿œç¨‹tag" class="headerlink" title="åˆ é™¤è¿œç¨‹tag"></a>åˆ é™¤è¿œç¨‹tag</h4><div class="code-wrapper"><pre><code class="hljs maxima">git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span>  --<span class="hljs-built_in">delete</span> v1<span class="hljs-number">.1</span></code></pre></div><h4 id="åˆ‡æ¢åˆ°ç›®æ ‡tagç‰ˆæœ¬"><a href="#åˆ‡æ¢åˆ°ç›®æ ‡tagç‰ˆæœ¬" class="headerlink" title="åˆ‡æ¢åˆ°ç›®æ ‡tagç‰ˆæœ¬"></a>åˆ‡æ¢åˆ°ç›®æ ‡tagç‰ˆæœ¬</h4><div class="code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">git</span> checkout v1.<span class="hljs-number">0</span></code></pre></div><h4 id="Gitåˆ›å»ºåˆ†æ”¯"><a href="#Gitåˆ›å»ºåˆ†æ”¯" class="headerlink" title="Gitåˆ›å»ºåˆ†æ”¯"></a>Gitåˆ›å»ºåˆ†æ”¯</h4><div class="code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">git branch testing</span></code></pre></div><h4 id="Gitåˆ‡æ¢åˆ†æ”¯"><a href="#Gitåˆ‡æ¢åˆ†æ”¯" class="headerlink" title="Gitåˆ‡æ¢åˆ†æ”¯"></a>Gitåˆ‡æ¢åˆ†æ”¯</h4><div class="code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">git checkout testing</span></code></pre></div><h4 id="åˆ›å»ºåˆ†æ”¯åŒæ—¶åˆ‡æ¢"><a href="#åˆ›å»ºåˆ†æ”¯åŒæ—¶åˆ‡æ¢" class="headerlink" title="åˆ›å»ºåˆ†æ”¯åŒæ—¶åˆ‡æ¢"></a>åˆ›å»ºåˆ†æ”¯åŒæ—¶åˆ‡æ¢</h4><div class="code-wrapper"><pre><code class="hljs armasm"><span class="hljs-symbol">git</span> checkout -<span class="hljs-keyword">b</span> testing</code></pre></div><h4 id="åˆ†æ”¯å¼€å‘ä¸åˆå¹¶"><a href="#åˆ†æ”¯å¼€å‘ä¸åˆå¹¶" class="headerlink" title="åˆ†æ”¯å¼€å‘ä¸åˆå¹¶"></a>åˆ†æ”¯å¼€å‘ä¸åˆå¹¶</h4><div class="code-wrapper"><pre><code class="hljs crmsh">git checkout <span class="hljs-keyword">master</span><span class="hljs-title">git</span> merge hotfix</code></pre></div><h4 id="æŸ¥çœ‹å’Œåˆ é™¤åˆ†æ”¯"><a href="#æŸ¥çœ‹å’Œåˆ é™¤åˆ†æ”¯" class="headerlink" title="æŸ¥çœ‹å’Œåˆ é™¤åˆ†æ”¯"></a>æŸ¥çœ‹å’Œåˆ é™¤åˆ†æ”¯</h4><div class="code-wrapper"><pre><code class="hljs mipsasm">git <span class="hljs-keyword">branch </span> æŸ¥çœ‹å½“å‰æ‰€æœ‰åˆ†æ”¯git <span class="hljs-keyword">brabch </span>-v  æŸ¥çœ‹æœ€åä¸€æ¬¡æäº¤git <span class="hljs-keyword">branch </span>--merged æŸ¥çœ‹æ‰€æœ‰åˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯git <span class="hljs-keyword">branch </span>--no-merged æŸ¥çœ‹æ‰€æœ‰æ²¡æœ‰åˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯</code></pre></div><h4 id="è¿œç¨‹åˆ†æ”¯çš„ç®¡ç†"><a href="#è¿œç¨‹åˆ†æ”¯çš„ç®¡ç†" class="headerlink" title="è¿œç¨‹åˆ†æ”¯çš„ç®¡ç†"></a>è¿œç¨‹åˆ†æ”¯çš„ç®¡ç†</h4><div class="code-wrapper"><pre><code class="hljs vim">git push <span class="hljs-symbol">&lt;remote&gt;</span> <span class="hljs-symbol">&lt;branch&gt;</span>  æ¨é€è¿œç¨‹åˆ†æ”¯git checkout --track <span class="hljs-symbol">&lt;remote&gt;</span>/<span class="hljs-symbol">&lt;branch&gt;</span> è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯git push origin --<span class="hljs-keyword">delete</span> <span class="hljs-symbol">&lt;branch&gt;</span> åˆ é™¤è¿œç¨‹åˆ†æ”¯</code></pre></div><h4 id="Git-rebaseç”¨æ³•"><a href="#Git-rebaseç”¨æ³•" class="headerlink" title="Git rebaseç”¨æ³•"></a>Git rebaseç”¨æ³•</h4><div class="code-wrapper"><pre><code class="hljs crmsh">git checkout experimentgit rebase <span class="hljs-keyword">master</span><span class="hljs-title">git</span> checkout <span class="hljs-keyword">master</span><span class="hljs-title">git</span> merge experiment</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>git</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä»€ä¹ˆæ˜¯tailwindcss</title>
    <link href="/2022/09/08/%E4%BB%80%E4%B9%88%E6%98%AFtailwindcss/"/>
    <url>/2022/09/08/%E4%BB%80%E4%B9%88%E6%98%AFtailwindcss/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>http2äº†è§£</title>
    <link href="/2022/09/08/http2%E4%BA%86%E8%A7%A3/"/>
    <url>/2022/09/08/http2%E4%BA%86%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
      <category>HTTP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>fetchç¬”è®°</title>
    <link href="/2022/09/08/fetch%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/09/08/fetch%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
      <category>fetch</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ajaxç¬”è®°</title>
    <link href="/2022/09/08/ajax%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/09/08/ajax%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h3 id="ajaxçš„å°è£…"><a href="#ajaxçš„å°è£…" class="headerlink" title="##ajaxçš„å°è£…"></a>##ajaxçš„å°è£…</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">&#123;</span><span class="hljs-params">  url,</span><span class="hljs-params">  method = <span class="hljs-string">&quot;get&quot;</span>,</span><span class="hljs-params">  data = &#123;&#125;,</span><span class="hljs-params">  headers = &#123;&#125;,</span><span class="hljs-params">  success,</span><span class="hljs-params">  failure,</span><span class="hljs-params">&#125; = &#123;&#125;</span>) &#123;  <span class="hljs-comment">// 1.åˆ›å»ºå¯¹è±¡</span>  <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();  <span class="hljs-comment">// 2.ç›‘å¬æ•°æ®</span>  xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span> || xhr.<span class="hljs-property">status</span> === <span class="hljs-number">304</span>) &#123;      <span class="hljs-comment">// xhr.responseXML/xhr.responseText</span>      success &amp;&amp; <span class="hljs-title function_">success</span>(xhr.<span class="hljs-property">response</span>);    &#125; <span class="hljs-keyword">else</span> &#123;      failure &amp;&amp; <span class="hljs-title function_">failure</span>(&#123; <span class="hljs-attr">status</span>: xhr.<span class="hljs-property">status</span>, <span class="hljs-attr">message</span>: xhr.<span class="hljs-property">statusText</span> &#125;);    &#125;  &#125;;  <span class="hljs-comment">// ç°åœ¨è¿”å›çš„æ•°æ®ç±»å‹ä¸€èˆ¬éƒ½æ˜¯json,å¦‚æœè®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²åˆ™ä¼šä½¿ç”¨textä½œä¸ºé»˜è®¤å€¼</span>  <span class="hljs-comment">// 3.è®¾ç½®ç±»å‹</span>  xhr.<span class="hljs-property">responseType</span> = <span class="hljs-string">&quot;json&quot;</span>;  <span class="hljs-comment">// xhr.responseType=&quot;xml&quot;/blob/text/arraybufferç­‰</span>  <span class="hljs-comment">// 4.è®¾ç½®è¿‡æœŸè¶…æ—¶äº‹ä»¶</span>  xhr.<span class="hljs-property">timeout</span> = timeout;  <span class="hljs-comment">// 5.openæ–¹æ³•</span>  <span class="hljs-keyword">if</span> (method.<span class="hljs-title function_">toUpperCase</span>() === <span class="hljs-string">&quot;GET&quot;</span>) &#123;    <span class="hljs-keyword">const</span> queryString = [];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> data) &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(data, key)) &#123;        <span class="hljs-keyword">const</span> item = data[key];        queryString.<span class="hljs-title function_">push</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;key&#125;</span>=<span class="hljs-subst">$&#123;item&#125;</span>`</span>);      &#125;    &#125;    url = url + <span class="hljs-string">&quot;?&quot;</span> + queryString.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&amp;&quot;</span>);    xhr.<span class="hljs-title function_">open</span>(method, url);  &#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-comment">// post</span>    xhr.<span class="hljs-title function_">open</span>(method, url);    xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&quot;Content-type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);  &#125;  <span class="hljs-comment">// 6è®¾ç½®headers</span>  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;      xhr.<span class="hljs-title function_">setRequestHeader</span>(key, headers[key]);    &#125;);  &#125;  <span class="hljs-keyword">if</span> (method.<span class="hljs-property">toUpperCase</span> === <span class="hljs-string">&quot;POST&quot;</span>) &#123;    xhr.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.<span class="hljs-property">toUpperCase</span> === <span class="hljs-string">&quot;GET&quot;</span>) &#123;    xhr.<span class="hljs-title function_">send</span>();  &#125;  <span class="hljs-comment">// return xhrå¯ä»¥ç”¨äºè°ƒç”¨abort()æ–¹æ³•è¿›è¡Œç»ˆæ­¢è¯·æ±‚</span>  <span class="hljs-keyword">return</span> xhr;&#125;</code></pre></div><h4 id="ajaxçš„promiseçš„å°è£…"><a href="#ajaxçš„promiseçš„å°è£…" class="headerlink" title="ajaxçš„promiseçš„å°è£…"></a>ajaxçš„promiseçš„å°è£…</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">&#123; url, method = <span class="hljs-string">&quot;get&quot;</span>, data = &#123;&#125;, headers = &#123;&#125; &#125; = &#123;&#125;</span>) &#123;  <span class="hljs-comment">// 1.åˆ›å»ºå¯¹è±¡</span>  <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();  <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;    <span class="hljs-comment">// 2.ç›‘å¬æ•°æ®</span>    xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;      <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span> || xhr.<span class="hljs-property">status</span> === <span class="hljs-number">304</span>) &#123;        <span class="hljs-comment">// xhr.responseXML/xhr.responseText</span>        <span class="hljs-title function_">resolve</span>(xhr.<span class="hljs-property">response</span>);      &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-title function_">reject</span>(&#123; <span class="hljs-attr">status</span>: xhr.<span class="hljs-property">status</span>, <span class="hljs-attr">message</span>: xhr.<span class="hljs-property">statusText</span> &#125;);      &#125;    &#125;;    <span class="hljs-comment">// ç°åœ¨è¿”å›çš„æ•°æ®ç±»å‹ä¸€èˆ¬éƒ½æ˜¯json,å¦‚æœè®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²åˆ™ä¼šä½¿ç”¨textä½œä¸ºé»˜è®¤å€¼</span>    <span class="hljs-comment">// 3.è®¾ç½®ç±»å‹</span>    xhr.<span class="hljs-property">responseType</span> = <span class="hljs-string">&quot;json&quot;</span>;    <span class="hljs-comment">// xhr.responseType=&quot;xml&quot;/blob/text/arraybufferç­‰</span>    <span class="hljs-comment">// 4.è®¾ç½®è¿‡æœŸè¶…æ—¶äº‹ä»¶</span>    xhr.<span class="hljs-property">timeout</span> = timeout;    <span class="hljs-comment">// 5.openæ–¹æ³•</span>    <span class="hljs-keyword">if</span> (method.<span class="hljs-title function_">toUpperCase</span>() === <span class="hljs-string">&quot;GET&quot;</span>) &#123;      <span class="hljs-keyword">const</span> queryString = [];      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> data) &#123;        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(data, key)) &#123;          <span class="hljs-keyword">const</span> item = data[key];          queryString.<span class="hljs-title function_">push</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;key&#125;</span>=<span class="hljs-subst">$&#123;item&#125;</span>`</span>);        &#125;      &#125;      url = url + <span class="hljs-string">&quot;?&quot;</span> + queryString.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&amp;&quot;</span>);      xhr.<span class="hljs-title function_">open</span>(method, url);    &#125; <span class="hljs-keyword">else</span> &#123;      <span class="hljs-comment">// post</span>      xhr.<span class="hljs-title function_">open</span>(method, url);      xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&quot;Content-type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);    &#125;    <span class="hljs-comment">// 6è®¾ç½®headers</span>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;        xhr.<span class="hljs-title function_">setRequestHeader</span>(key, headers[key]);      &#125;);    &#125;    <span class="hljs-keyword">if</span> (method.<span class="hljs-property">toUpperCase</span> === <span class="hljs-string">&quot;POST&quot;</span>) &#123;      xhr.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.<span class="hljs-property">toUpperCase</span> === <span class="hljs-string">&quot;GET&quot;</span>) &#123;      xhr.<span class="hljs-title function_">send</span>();    &#125;  &#125;);  <span class="hljs-comment">// return xhrå¯ä»¥ç”¨äºè°ƒç”¨abort()æ–¹æ³•è¿›è¡Œç»ˆæ­¢è¯·æ±‚</span>  promise.<span class="hljs-property">xhr</span> = xhr;  <span class="hljs-keyword">return</span> promise;&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
      <category>Ajax</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>react-router-v6ç¬”è®°</title>
    <link href="/2022/09/08/react-router-v6%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/09/08/react-router-v6%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs qml"><span class="hljs-number">1.</span>å‰ç«¯è·¯ç”±çš„åŸç†å½“<span class="hljs-built_in">url</span>å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå¼•èµ·é¡µé¢ä¸åˆ·æ–°æ¥ä¿®æ”¹é¡µé¢çš„å†…å®¹çš„ä¸¤ä¸ªæ–¹æ³•<span class="hljs-number">1.</span>é€šè¿‡ä¿®æ”¹<span class="hljs-built_in">url</span>ä¸­çš„hashçš„å˜åŒ–æ¥ä¿®æ”¹é¡µé¢çš„å†…å®¹<span class="hljs-built_in">window</span>.onhashchange=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">switch</span>(location.hash)&#123;<span class="hljs-keyword">case</span> <span class="hljs-string">&quot;#/a&quot;</span>:div.innerHTML=<span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">break</span>;&#125;&#125;<span class="hljs-comment">//urlçš„hashä¹Ÿå°±æ˜¯é”šç‚¹ã€‚æœ¬è´¨ä¸Šå°±æ˜¯ä¿®æ”¹äº†window.locationçš„href</span><span class="hljs-comment">//å¯ä»¥é€šè¿‡ç›´æ¥èµ‹å€¼location.hashæ¥æ”¹å˜href.ä½†æ˜¯é¡µé¢ä¸ä¼šåˆ·æ–°ï¼Œ</span><span class="hljs-comment">//ä½†æ˜¯hashä¼šå¸¦æœ‰#</span><span class="hljs-number">2.</span>å¯ä»¥ä½¿ç”¨HTML5çš„historyæ¨¡å¼æ¥ä¿®æ”¹<span class="hljs-built_in">url</span>,ä»–æœ‰å…­ç§æ¨¡å¼æ¥æ”¹å˜URLçš„å˜åŒ–è€Œä¸åˆ·æ–°é¡µé¢history.replactState():æ›¿æ¢åŸæ¥çš„è·¯å¾„history.pushState():ä½¿ç”¨æ–°çš„è·¯å¾„history.popState():è·¯å¾„çš„å›é€€history.go():å‘å‰æˆ–è€…å‘åæ”¹å˜è·¯å¾„history.back():å‘åæ”¹å˜è·¯å¾„</code></pre></div><p><img src="https://img1.imgtp.com/2022/09/13/WPC9CvI7.png" alt="QQæˆªå›¾20220607102052.png"></p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-number">2.</span>react-routeræœ‰ä¸¤éƒ¨åˆ†ç»„æˆ<span class="hljs-number">1.</span>react-router<span class="hljs-comment">//è¿™æ˜¯æ ¸å¿ƒä»£ç </span><span class="hljs-number">2.</span>react-router-dom<span class="hljs-comment">//è¿™æ˜¯ç”¨äºæµè§ˆå™¨çš„</span><span class="hljs-number">3.</span>react-router-native<span class="hljs-comment">//è¿™ä¸ªé€‚ç”¨äºåŸç”Ÿåº”ç”¨</span>ä½¿ç”¨react-routeréœ€è¦ä½¿ç”¨npm install react-router-dom ä»–ä¼šè‡ªåŠ¨å®‰è£…react-router<span class="hljs-number">3.</span>react-routerçš„ç»„ä»¶ä½¿ç”¨&lt;<span class="hljs-title class_">BrowserRouter</span>&gt;æ˜¯ä½¿ç”¨historyæ¨¡å¼<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;    <span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>;    <span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">BrowserRouter</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;    <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">BrowserRouter</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">BrowserRouter</span>&gt;</span></span>,      root    );<span class="hljs-comment">//è¿™å°±æ˜¯ç›®å‰æ¯”è¾ƒæ™®éçš„ç”¨æ³•ï¼Œä¹Ÿæ˜¯å®˜æ–¹æ¯”è¾ƒæ¨èçš„ç”¨æ³•ï¼Œå°†ä»–åŒ…è£¹åœ¨Appç»„ä»¶</span>   <span class="hljs-number">3.1</span>&lt;<span class="hljs-title class_">HashRouter</span>&gt;æ˜¯ä½¿ç”¨hashæ¨¡å¼ï¼Œå®˜æ–¹ä¸æ¨èä½¿ç”¨   <span class="hljs-number">3.2</span>&lt;link&gt;ç»„ä»¶æ˜¯è·³è½¬çš„ç»„ä»¶ï¼Œå®ƒæœ€ç»ˆä¼šè¢«æ¸²æŸ“æˆaå…ƒç´    <span class="hljs-number">3.3</span>&lt;<span class="hljs-title class_">NavLink</span>&gt;æ˜¯åœ¨<span class="hljs-title class_">Link</span>çš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›æ ·å¼   <span class="hljs-number">3.3</span><span class="hljs-number">.1</span> toå±æ€§æ˜¯<span class="hljs-title class_">Link</span>å’Œ<span class="hljs-title class_">NavLink</span>ç»„ä»¶ä¸­æœ€é‡è¦çš„å±æ€§ï¼Œç”¨äºè®¾ç½®è·³è½¬çš„è·¯å¾„   <span class="hljs-number">3.4</span>.<span class="hljs-property">Route</span>ç»„ä»¶   <span class="hljs-number">3.4</span><span class="hljs-number">.1</span> <span class="hljs-title class_">Route</span>ç»„ä»¶ä¸»è¦é€‚ç”¨äºè·¯ç”±è·¯å¾„çš„åŒ¹é…   <span class="hljs-number">3.4</span><span class="hljs-number">.2</span> pathå±æ€§:ç”¨äºè®¾ç½®åŒ¹é…åˆ°çš„è·¯å¾„   <span class="hljs-number">3.4</span><span class="hljs-number">.3</span> componentå±æ€§ï¼šè®¾ç½®åŒ¹é…åˆ°çš„è·¯å¾„åæ¸²æŸ“çš„ç»„ä»¶ï¼Œ   <span class="hljs-number">3.4</span><span class="hljs-number">.4</span>.<span class="hljs-property">exact</span>:ç²¾å‡†åŒ¹é…   ä¸Šè¿°çš„å±æ€§å±äºv5çš„ç‰ˆæœ¬   åœ¨v6ç‰ˆæœ¬ä¸­æ‰€æœ‰&lt;<span class="hljs-title class_">Route</span>&gt;ç»„ä»¶å°†æ”¾åœ¨&lt;<span class="hljs-title class_">Routes</span>&gt;ä¸­ï¼Œcomponentæ”¹æˆelement,</code></pre></div><p><img src="https://img1.imgtp.com/2022/09/13/TzYXcXQV.png" alt="QQæˆªå›¾20220607144416.png"></p><p><img src="https://img1.imgtp.com/2022/09/13/XwuhkKsl.png" alt="QQæˆªå›¾20220607215036.png"></p><p><img src="https://img1.imgtp.com/2022/09/13/djJ6Fots.png" alt="QQæˆªå›¾20220607144950.png"></p><div class="code-wrapper"><pre><code class="hljs angelscript">&lt;NavLink&gt;çš„ç”¨æ³•ç”¨äºå¯ä»¥å¤„äºå½“å‰è®¿é—®è¿æ¥æ—¶ä¿®æ”¹è¿æ¥çš„æ ·å¼ï¼Œå¤„äºactiveçŠ¶æ€v5çš„å†™æ³•å¯ä»¥æ·»åŠ å¦‚ä¸‹å±æ€§activeStyle:æ´»è·ƒæ—¶çš„æ ·å¼activeClassNameï¼šæ´»è·ƒæ—¶æ·»åŠ <span class="hljs-keyword">class</span><span class="hljs-symbol">exact</span>ç²¾ç¡®åŒ¹é…ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰<span class="hljs-symbol">class</span></code></pre></div><p><img src="https://img1.imgtp.com/2022/09/13/Ml03VBOs.png" alt="QQæˆªå›¾20220607151506.png"></p><p>v6çš„å†™æ³•ï¼Œä¸éœ€è¦activeStyleå’ŒactiveClassNameï¼Œå¯ä»¥åœ¨æ™®é€šçš„styleå’ŒclassNameä¸­ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œæ›´åŠ çµæ´»æ–¹ä¾¿</p><p><img src="https://img1.imgtp.com/2022/09/13/EfvZ4TfB.png" alt="QQæˆªå›¾20220607151735.png"></p><div class="code-wrapper"><pre><code class="hljs armasm"><span class="hljs-symbol">Switch</span>çš„ä½œç”¨ <span class="hljs-built_in">V5</span> åœ¨<span class="hljs-built_in">V6</span>æ²¡æœ‰è¯¥ç»„ä»¶</code></pre></div><p>ç»„ä»¶ä¸­è·å–è·¯ç”±å‚æ•°ï¼Œparamsä¸­å­˜åœ¨å¯¹é¥®çš„è·¯ç”±å‚æ•°</p><div class="code-wrapper"><pre><code class="hljs csharp"><span class="hljs-keyword">const</span> <span class="hljs-keyword">params</span> = useParams()</code></pre></div><h4 id="Navigateå¯¼èˆª"><a href="#Navigateå¯¼èˆª" class="headerlink" title="Navigateå¯¼èˆª"></a>Navigateå¯¼èˆª</h4><p>Navigateç”¨äºè·¯ç”±çš„é‡å®šå‘</p><div class="code-wrapper"><pre><code class="hljs routeros">&lt;Route <span class="hljs-attribute">path</span>=<span class="hljs-string">&#x27;/home&#x27;</span> element=&#123;&lt;Navigate <span class="hljs-attribute">to</span>=<span class="hljs-string">&quot;/home/recommend&quot;</span>/&gt;&#125;/&gt;</code></pre></div><h4 id="Not-Foundé¡µé¢é…ç½®"><a href="#Not-Foundé¡µé¢é…ç½®" class="headerlink" title="Not Foundé¡µé¢é…ç½®"></a>Not Foundé¡µé¢é…ç½®</h4><div class="code-wrapper"><pre><code class="hljs awk">&lt;Route path=<span class="hljs-string">&#x27;*&#x27;</span> element=&#123;&lt;NotFound<span class="hljs-regexp">/&gt;&#125;/</span>&gt;</code></pre></div><h3 id="Search-Params"><a href="#Search-Params" class="headerlink" title="Search Params"></a>Search Params</h3><p><img src="https://img1.imgtp.com/2022/09/13/TdiJP94D.png" alt="QQæˆªå›¾20220607203231.png"></p><h3 id="useNavigate"><a href="#useNavigate" class="headerlink" title="useNavigate"></a>useNavigate</h3><div class="code-wrapper"><pre><code class="hljs reasonml">import &#123; useNavigate &#125; from <span class="hljs-string">&quot;react-router-dom&quot;</span>;<span class="hljs-keyword">function</span> <span class="hljs-constructor">SignupForm()</span> &#123;  <span class="hljs-keyword">let</span> navigate = use<span class="hljs-constructor">Navigate()</span>;  async <span class="hljs-keyword">function</span> handle<span class="hljs-constructor">Submit(<span class="hljs-params">event</span>)</span> &#123;    event.prevent<span class="hljs-constructor">Default()</span>;    await submit<span class="hljs-constructor">Form(<span class="hljs-params">event</span>.<span class="hljs-params">target</span>)</span>;    navigate(<span class="hljs-string">&quot;../success&quot;</span>, &#123; replace: <span class="hljs-literal">true</span> &#125;);  &#125;  return &lt;form onSubmit=&#123;handleSubmit&#125;&gt;&#123;<span class="hljs-comment">/* ... */</span>&#125;&lt;/form&gt;;&#125;ä½¿ç”¨useNavigateå¯ä»¥å®ç°æ‰‹åŠ¨è¿›è¡Œè·¯ç”±è·³è½¬ï¼Œ<span class="hljs-keyword">let</span> navigate = use<span class="hljs-constructor">Navigate()</span>;ä»–ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯<span class="hljs-keyword">to</span>, å¦ä¸€ä¸ªoptional second &#123; replace, state &#125; argï¼Œæˆ–è€…ä½¿ç”¨å†å²è°ƒç”¨æ ˆç±»ä¼¼äºgo<span class="hljs-number">(-1)</span>è°ƒç”¨navigate<span class="hljs-number">(-1)</span></code></pre></div><h3 id="useLocation"><a href="#useLocation" class="headerlink" title="useLocation"></a>useLocation</h3><div class="code-wrapper"><pre><code class="hljs crmsh">let <span class="hljs-keyword">location</span> <span class="hljs-title">= useLocation</span>();//è·å–location</code></pre></div><p><img src="https://img1.imgtp.com/2022/09/13/LD2qs0Cd.png" alt="QQæˆªå›¾20220607212846.png"></p><h3 id="withRouter-component"><a href="#withRouter-component" class="headerlink" title="withRouter(component)"></a>withRouter(component)</h3><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123;  useLocation,  useNavigate,  useParams,  useSearchParams&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;<span class="hljs-keyword">function</span> <span class="hljs-title function_">withRouter</span>(<span class="hljs-params">Component</span>) &#123;  <span class="hljs-keyword">function</span> <span class="hljs-title function_">ComponentWithRouterProp</span>(<span class="hljs-params">props</span>) &#123;    <span class="hljs-keyword">const</span> location = <span class="hljs-title function_">useLocation</span>();    <span class="hljs-keyword">const</span> navigate = <span class="hljs-title function_">useNavigate</span>();    <span class="hljs-keyword">const</span> params = <span class="hljs-title function_">useParams</span>();    <span class="hljs-keyword">const</span> [searchParams] = <span class="hljs-title function_">useSearchParams</span>()    <span class="hljs-keyword">const</span> query = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(searchParams)    <span class="hljs-keyword">return</span> (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span></span></span><span class="hljs-tag"><span class="language-xml">        &#123;<span class="hljs-attr">...props</span>&#125;</span></span><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">router</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">location</span>, <span class="hljs-attr">navigate</span>, <span class="hljs-attr">params</span>,<span class="hljs-attr">query</span> &#125;&#125;</span></span><span class="hljs-tag"><span class="language-xml">      /&gt;</span></span>    );  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentWithRouterProp</span>;&#125;<span class="hljs-comment">//åœ¨v6ä¸­æ²¡æœ‰è¿™ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå› ä¸ºv6éƒ½æ˜¯ä½¿ç”¨åˆ°çš„æ˜¯å‡½æ•°å¼ç»„ä»¶ï¼Œæ‰€ä»¥ä¸éœ€è¦ï¼Œå¦‚æœæƒ³ç”¨å¯ä»¥è¿™æ ·å°è£…ï¼Œåœ¨v5ä¸­çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ‰‹åŠ¨è°ƒç”¨è·¯ç”±å¯ä»¥è·å–åˆ°history,ç»„ä»¶å¯ä»¥é€šè¿‡this.props.history,push()æ¥æ‰‹åŠ¨è¿›è¡Œè·¯ç”±è·³è½¬ï¼Œv6å¯ä»¥ä½¿ç”¨åˆ°useNavigate()</span></code></pre></div><h4 id="è·¯ç”±çš„é…ç½®æ–‡ä»¶"><a href="#è·¯ç”±çš„é…ç½®æ–‡ä»¶" class="headerlink" title="è·¯ç”±çš„é…ç½®æ–‡ä»¶"></a>è·¯ç”±çš„é…ç½®æ–‡ä»¶</h4><p>é€šè¿‡åƒvue-routeræ¥å°†è·¯ç”±å®šä¹‰åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//router.js</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../pages/Home&#x27;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">HomeRecommend</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../pages/HomeRecommend&quot;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">HomeRanking</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../pages/HomeRanking&quot;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">HomeSongMenu</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../pages/HomeSongMenu&#x27;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">Category</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../pages/Category&quot;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">Order</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../pages/Order&quot;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">NotFound</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../pages/NotFound&#x27;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">Detail</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../pages/Detail&#x27;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../pages/User&#x27;</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Navigate</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-router-dom&#x27;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">About</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../pages/About&quot;</span>))<span class="hljs-keyword">const</span> <span class="hljs-title class_">Login</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../pages/Login&quot;</span>))<span class="hljs-keyword">const</span> routes = [  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/home&quot;</span>/&gt;</span></span>  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/home&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Home</span>/&gt;</span></span>,    <span class="hljs-attr">children</span>: [      &#123;        <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/home&quot;</span>,        <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/home/recommend&quot;</span>/&gt;</span></span>      &#125;,      &#123;        <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/home/recommend&quot;</span>,        <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">HomeRecommend</span>/&gt;</span></span>      &#125;,      &#123;        <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/home/ranking&quot;</span>,        <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">HomeRanking</span>/&gt;</span></span>      &#125;,      &#123;        <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/home/songmenu&quot;</span>,        <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">HomeSongMenu</span>/&gt;</span></span>      &#125;    ]  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/about&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">About</span>/&gt;</span></span>  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/login&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Login</span>/&gt;</span></span>  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/category&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Category</span>/&gt;</span></span>  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/order&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Order</span>/&gt;</span></span>  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/detail/:id&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Detail</span>/&gt;</span></span>  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/user&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">User</span>/&gt;</span></span>  &#125;,  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;*&quot;</span>,    <span class="hljs-attr">element</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">NotFound</span>/&gt;</span></span>  &#125;]<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> routes</code></pre></div><div class="code-wrapper"><pre><code class="hljs reasonml">&#123;use<span class="hljs-constructor">Routes(<span class="hljs-params">routes</span>)</span>&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>react</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Reduxç¬”è®°</title>
    <link href="/2022/09/08/Redux%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/09/08/Redux%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="çº¯å‡½æ•°"><a href="#çº¯å‡½æ•°" class="headerlink" title="##çº¯å‡½æ•°"></a>##çº¯å‡½æ•°</h4><p> ç¡®å®šçš„è¾“å…¥ï¼Œä¸€å®šä¼šäº§ç”Ÿç¡®å®šçš„è¾“å‡ºï¼›</p><p>å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸èƒ½äº§ç”Ÿå‰¯ä½œç”¨</p><h4 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h4><p>ä¸€ä¸ªstoreæ–‡ä»¶å¤¹ç”±4ä¸ªæ–‡ä»¶ç»„æˆ</p><p>actionCreator.js</p><p>è¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨æ¥ç¼–å†™action,actionæ˜¯ä¸€ä¸ªæ™®é€šçš„JavaScriptå¯¹è±¡ï¼Œç”¨æ¥æè¿°è¿™æ¬¡æ›´æ–°çš„typeå’Œcontent</p><p>å¼ºåˆ¶ä½¿ç”¨actionçš„å¥½å¤„æ˜¯å¯ä»¥æ¸…æ™°çš„çŸ¥é“æ•°æ®åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆæ ·çš„å˜åŒ–ï¼Œæ‰€æœ‰çš„æ•°æ®å˜åŒ–éƒ½æ˜¯å¯è·Ÿè¿½ã€å¯é¢„æµ‹çš„ï¼›</p><p>å½“ç„¶ï¼Œç›®å‰æˆ‘ä»¬çš„actionæ˜¯å›ºå®šçš„å¯¹è±¡</p><p>çœŸå®åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ä¼šé€šè¿‡å‡½æ•°æ¥å®šä¹‰ï¼Œè¿”å›ä¸€ä¸ªaction</p><p>Reduxè¦æ±‚æˆ‘ä»¬é€šè¿‡actionæ¥æ›´æ–°æ•°æ®,é€šè¿‡dispatch actionæ¥æ›´æ–°æ•°æ®</p><div class="code-wrapper"><pre><code class="hljs coffeescript">//actionCreator.jsconst &#123; ADD_NUMBER, CHANGE_NAME &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./constants&quot;</span>)const changeNameAction = <span class="hljs-function"><span class="hljs-params">(name)</span> =&gt;</span> (&#123;  type: CHANGE_NAME,  name&#125;)const addNumberAction = <span class="hljs-function"><span class="hljs-params">(num)</span> =&gt;</span> (&#123;  type: ADD_NUMBER,  num&#125;)module.<span class="hljs-built_in">exports</span> = &#123;  changeNameAction,  addNumberAction&#125;</code></pre></div><p>constants.js ç”¨æ¥å®šä¹‰typeå¸¸é‡</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ADD_NUMBER</span> = <span class="hljs-string">&quot;add_number&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CHANGE_NAME</span> = <span class="hljs-string">&quot;change_name&quot;</span><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;  <span class="hljs-variable constant_">ADD_NUMBER</span>,  <span class="hljs-variable constant_">CHANGE_NAME</span>&#125;</code></pre></div><p>reducer.js</p><p>reduceræ˜¯å°†stateå’Œactionè”ç³»èµ·æ¥çš„æ¡¥æ¢ï¼Œreduceræ˜¯çº¯å‡½æ•°ï¼Œreduceråšçš„äº‹æƒ…æ˜¯å°†ä¼ å…¥çš„stateå’Œactionç»“åˆèµ·æ¥ç”Ÿæˆæ–°çš„state</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; <span class="hljs-variable constant_">ADD_NUMBER</span>, <span class="hljs-variable constant_">CHANGE_NAME</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./constants&quot;</span>)<span class="hljs-comment">// åˆå§‹åŒ–çš„æ•°æ®</span><span class="hljs-keyword">const</span> initialState = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>,  <span class="hljs-attr">counter</span>: <span class="hljs-number">100</span>&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">reducer</span>(<span class="hljs-params">state = initialState, action</span>) &#123;  <span class="hljs-keyword">switch</span>(action.<span class="hljs-property">type</span>) &#123;    <span class="hljs-keyword">case</span> <span class="hljs-attr">CHANGE_NAME</span>:      <span class="hljs-keyword">return</span> &#123; ...state, <span class="hljs-attr">name</span>: action.<span class="hljs-property">name</span> &#125;    <span class="hljs-keyword">case</span> <span class="hljs-attr">ADD_NUMBER</span>:      <span class="hljs-keyword">return</span> &#123; ...state, <span class="hljs-attr">counter</span>: state.<span class="hljs-property">counter</span> + action.<span class="hljs-property">num</span> &#125;    <span class="hljs-attr">default</span>:      <span class="hljs-keyword">return</span> state  &#125;&#125;<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = reducer</code></pre></div><p>index.js</p><p>åˆ›å»ºstoreå®ä¾‹</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; createStore &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;redux&quot;</span>)<span class="hljs-keyword">const</span> reducer =  <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./reducer.js&quot;</span>)<span class="hljs-comment">// åˆ›å»ºçš„store</span><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(reducer)<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = store</code></pre></div><p>ä½¿ç”¨storeä¸­çš„æ•°æ®</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> store = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./store&quot;</span>)<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(store.<span class="hljs-title function_">getState</span>())</code></pre></div><p>ä¿®æ”¹storeä¸­çš„æ•°æ®</p><div class="code-wrapper"><pre><code class="hljs js">store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">changeNameAction</span>(<span class="hljs-string">&quot;kobe&quot;</span>))</code></pre></div><p>è®¢é˜…storeä¸­çš„æ•°æ®</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> store = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./store&quot;</span>)<span class="hljs-keyword">const</span> unsubscribe = store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;è®¢é˜…æ•°æ®çš„å˜åŒ–:&quot;</span>, store.<span class="hljs-title function_">getState</span>())&#125;)<span class="hljs-comment">// ä¿®æ”¹storeä¸­çš„æ•°æ®: å¿…é¡»action</span>store.<span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;change_name&quot;</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;kobe&quot;</span> &#125;)store.<span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;change_name&quot;</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;lilei&quot;</span> &#125;)<span class="hljs-title function_">unsubscribe</span>()</code></pre></div><h4 id="redux-ä¸‰å¤§æ ¸å¿ƒ-store-action-reducer"><a href="#redux-ä¸‰å¤§æ ¸å¿ƒ-store-action-reducer" class="headerlink" title="redux ä¸‰å¤§æ ¸å¿ƒ store action reducer"></a>redux ä¸‰å¤§æ ¸å¿ƒ store action reducer</h4><h4 id="redux-çš„ä¸‰å¤§åŸåˆ™"><a href="#redux-çš„ä¸‰å¤§åŸåˆ™" class="headerlink" title="redux çš„ä¸‰å¤§åŸåˆ™"></a>redux çš„ä¸‰å¤§åŸåˆ™</h4><ul><li>å•ä¸€æ•°æ®æº<ol><li>ï° æ•´ä¸ªåº”ç”¨ç¨‹åºçš„stateè¢«å­˜å‚¨åœ¨ä¸€é¢—object treeä¸­ï¼Œå¹¶ä¸”è¿™ä¸ªobject treeåªå­˜å‚¨åœ¨ä¸€ä¸ª store ä¸­</li><li>Reduxå¹¶æ²¡æœ‰å¼ºåˆ¶è®©æˆ‘ä»¬ä¸èƒ½åˆ›å»ºå¤šä¸ªStoreï¼Œä½†æ˜¯é‚£æ ·åšå¹¶ä¸åˆ©äºæ•°æ®çš„ç»´æŠ¤</li><li>å•ä¸€çš„æ•°æ®æºå¯ä»¥è®©æ•´ä¸ªåº”ç”¨ç¨‹åºçš„stateå˜å¾—æ–¹ä¾¿ç»´æŠ¤ã€è¿½è¸ªã€ä¿®æ”¹</li></ol></li><li>Stateæ˜¯åªè¯»çš„<ol><li>â€‹    å”¯ä¸€ä¿®æ”¹Stateçš„æ–¹æ³•ä¸€å®šæ˜¯è§¦å‘actionï¼Œä¸è¦è¯•å›¾åœ¨å…¶ä»–åœ°æ–¹é€šè¿‡ä»»ä½•çš„æ–¹å¼æ¥ä¿®æ”¹State</li><li>â€‹    è¿™æ ·å°±ç¡®ä¿äº†Viewæˆ–ç½‘ç»œè¯·æ±‚éƒ½ä¸èƒ½ç›´æ¥ä¿®æ”¹stateï¼Œå®ƒä»¬åªèƒ½é€šè¿‡actionæ¥æè¿°è‡ªå·±æƒ³è¦å¦‚ä½•ä¿®æ”¹state</li><li>è¿™æ ·å¯ä»¥ä¿è¯æ‰€æœ‰çš„ä¿®æ”¹éƒ½è¢«é›†ä¸­åŒ–å¤„ç†ï¼Œå¹¶ä¸”æŒ‰ç…§ä¸¥æ ¼çš„é¡ºåºæ¥æ‰§è¡Œï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒrace conditionï¼ˆç«Ÿæ€ï¼‰çš„é—®é¢˜</li></ol></li><li>ä½¿ç”¨çº¯å‡½æ•°æ¥æ‰§è¡Œä¿®æ”¹<ol><li>â€‹    é€šè¿‡reducerå°† æ—§stateå’Œ actionsè”ç³»åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªæ–°çš„State</li><li>â€‹    éšç€åº”ç”¨ç¨‹åºçš„å¤æ‚åº¦å¢åŠ ï¼Œæˆ‘ä»¬å¯ä»¥å°†reduceræ‹†åˆ†æˆå¤šä¸ªå°çš„reducersï¼Œåˆ†åˆ«æ“ä½œä¸åŒstate treeçš„ä¸€éƒ¨åˆ†</li><li>   ä½†æ˜¯æ‰€æœ‰çš„reduceréƒ½åº”è¯¥æ˜¯çº¯å‡½æ•°ï¼Œä¸èƒ½äº§ç”Ÿä»»ä½•çš„å‰¯ä½œç”¨</li></ol></li></ul><img src="https://img1.imgtp.com/2022/09/13/UQYkeCuR.png" alt="QQæˆªå›¾20220913015123.png" style="zoom:200%;" /><p><img src="https://img1.imgtp.com/2022/09/13/6ShJ2AyZ.png" alt="QQæˆªå›¾20220913015145.png"></p><h4 id="reactå’Œreduxç»“åˆä½¿ç”¨"><a href="#reactå’Œreduxç»“åˆä½¿ç”¨" class="headerlink" title="reactå’Œreduxç»“åˆä½¿ç”¨"></a>reactå’Œreduxç»“åˆä½¿ç”¨</h4><p>react-reduxçš„ä½¿ç”¨</p><div class="code-wrapper"><pre><code class="hljs html">//index.jsimport React from &#x27;react&#x27;;import ReactDOM from &#x27;react-dom/client&#x27;;import App from &#x27;./App&#x27;;import &#123; Provider &#125; from &quot;react-redux&quot;import store from &quot;./store&quot;const root = ReactDOM.createRoot(document.getElementById(&#x27;root&#x27;));root.render(  // <span class="hljs-tag">&lt;<span class="hljs-name">React.StrictMode</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">&#123;store&#125;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span>  // <span class="hljs-tag">&lt;/<span class="hljs-name">React.StrictMode</span>&gt;</span>);</code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; <span class="hljs-title class_">PureComponent</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">import</span> &#123; connect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span><span class="hljs-comment">// import store from &quot;../store&quot;</span><span class="hljs-keyword">import</span> &#123; addNumberAction, subNumberAction &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../store/counter&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">PureComponent</span> &#123;  <span class="hljs-title function_">calcNumber</span>(<span class="hljs-params">num, isAdd</span>) &#123;    <span class="hljs-keyword">if</span> (isAdd) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-title function_">addNumber</span>(num)    &#125; <span class="hljs-keyword">else</span> &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-title function_">subNumber</span>(num)    &#125;  &#125;  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">const</span> &#123; counter, banners, recommends, userInfo &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>    <span class="hljs-keyword">return</span> (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&#x27;user&#x27;</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>nickname: &#123;userInfo.nickname&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>About Page: &#123;counter&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> this.calcNumber(6, true)&#125;&gt;+6<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> this.calcNumber(88, true)&#125;&gt;+88<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> this.calcNumber(6, false)&#125;&gt;-6<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> this.calcNumber(88, false)&#125;&gt;-88<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&#x27;banner&#x27;</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>è½®æ’­å›¾æ•°æ®:<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><span class="language-xml">            &#123;</span><span class="language-xml">              banners.map((item, index) =&gt; &#123;</span><span class="language-xml">                return <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;index&#125;</span>&gt;</span>&#123;item.title&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span class="language-xml">              &#125;)</span><span class="language-xml">            &#125;</span><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&#x27;recommend&#x27;</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æ¨èæ•°æ®:<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><span class="language-xml">            &#123;</span><span class="language-xml">              recommends.map((item, index) =&gt; &#123;</span><span class="language-xml">                return <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;index&#125;</span>&gt;</span>&#123;item.title&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span class="language-xml">              &#125;)</span><span class="language-xml">            &#125;</span><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>    )  &#125;&#125;<span class="hljs-keyword">const</span> <span class="hljs-title function_">mapStateToProps</span> = (<span class="hljs-params">state</span>) =&gt; (&#123;  <span class="hljs-attr">counter</span>: state.<span class="hljs-property">counter</span>.<span class="hljs-property">counter</span>,  <span class="hljs-attr">banners</span>: state.<span class="hljs-property">home</span>.<span class="hljs-property">banners</span>,  <span class="hljs-attr">recommends</span>: state.<span class="hljs-property">home</span>.<span class="hljs-property">recommends</span>,  <span class="hljs-attr">userInfo</span>: state.<span class="hljs-property">user</span>.<span class="hljs-property">userInfo</span>&#125;)<span class="hljs-keyword">const</span> <span class="hljs-title function_">mapDispatchToProps</span> = (<span class="hljs-params">dispatch</span>) =&gt; (&#123;  <span class="hljs-title function_">addNumber</span>(<span class="hljs-params">num</span>) &#123;    <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">addNumberAction</span>(num))  &#125;,  <span class="hljs-title function_">subNumber</span>(<span class="hljs-params">num</span>) &#123;    <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">subNumberAction</span>(num))  &#125;&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">connect</span>(mapStateToProps, mapDispatchToProps)(<span class="hljs-title class_">About</span>)</code></pre></div><p>æ²¡æœ‰ä½¿ç”¨react-reduxçš„å†™æ³•</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; <span class="hljs-title class_">PureComponent</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../store&quot;</span><span class="hljs-keyword">import</span> &#123; addNumberAction &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../store/counter&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">PureComponent</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">super</span>()    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;      <span class="hljs-attr">counter</span>: store.<span class="hljs-title function_">getState</span>().<span class="hljs-property">counter</span>.<span class="hljs-property">counter</span>,      <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Hello World&quot;</span>,      <span class="hljs-attr">friends</span>: [        &#123;<span class="hljs-attr">id</span>: <span class="hljs-number">111</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>&#125;,        &#123;<span class="hljs-attr">id</span>: <span class="hljs-number">112</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;kobe&quot;</span>&#125;,        &#123;<span class="hljs-attr">id</span>: <span class="hljs-number">113</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;james&quot;</span>&#125;,      ]    &#125;  &#125;  <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;    store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> &#123;      <span class="hljs-keyword">const</span> state = store.<span class="hljs-title function_">getState</span>().<span class="hljs-property">counter</span>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">counter</span>: state.<span class="hljs-property">counter</span> &#125;)    &#125;)  &#125;  <span class="hljs-title function_">addNumber</span>(<span class="hljs-params">num</span>) &#123;    store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">addNumberAction</span>(num))  &#125;  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">const</span> &#123; counter &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>    <span class="hljs-keyword">return</span> (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Home Counter: &#123;counter&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> this.addNumber(1)&#125;&gt;+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> this.addNumber(5)&#125;&gt;+5<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> this.addNumber(8)&#125;&gt;+8<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>    )  &#125;&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Home</span></code></pre></div><h4 id="æˆ‘ä»¬å¯ä»¥å°†reactç»„ä»¶ä¸­çš„å¼‚æ­¥æ“ä½œæ”¾åˆ°reduxä¸­ï¼Œä½¿ç”¨ä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶çš„ç›®çš„æ˜¯åœ¨dispatchçš„actionå’Œæœ€ç»ˆè¾¾åˆ°çš„reducerä¹‹é—´ï¼Œæ‰©å±•ä¸€äº›è‡ªå·±çš„ä»£ç "><a href="#æˆ‘ä»¬å¯ä»¥å°†reactç»„ä»¶ä¸­çš„å¼‚æ­¥æ“ä½œæ”¾åˆ°reduxä¸­ï¼Œä½¿ç”¨ä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶çš„ç›®çš„æ˜¯åœ¨dispatchçš„actionå’Œæœ€ç»ˆè¾¾åˆ°çš„reducerä¹‹é—´ï¼Œæ‰©å±•ä¸€äº›è‡ªå·±çš„ä»£ç " class="headerlink" title="æˆ‘ä»¬å¯ä»¥å°†reactç»„ä»¶ä¸­çš„å¼‚æ­¥æ“ä½œæ”¾åˆ°reduxä¸­ï¼Œä½¿ç”¨ä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶çš„ç›®çš„æ˜¯åœ¨dispatchçš„actionå’Œæœ€ç»ˆè¾¾åˆ°çš„reducerä¹‹é—´ï¼Œæ‰©å±•ä¸€äº›è‡ªå·±çš„ä»£ç "></a>æˆ‘ä»¬å¯ä»¥å°†reactç»„ä»¶ä¸­çš„å¼‚æ­¥æ“ä½œæ”¾åˆ°reduxä¸­ï¼Œä½¿ç”¨ä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶çš„ç›®çš„æ˜¯åœ¨dispatchçš„actionå’Œæœ€ç»ˆè¾¾åˆ°çš„reducerä¹‹é—´ï¼Œæ‰©å±•ä¸€äº›è‡ªå·±çš„ä»£ç </h4><p>ä½¿ç”¨redux-thunkæ¥å‘å¸ƒå¼‚æ­¥è¯·æ±‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createStore, applyMiddleware, compose &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span><span class="hljs-keyword">import</span> thunk <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux-thunk&quot;</span><span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./reducer&quot;</span><span class="hljs-comment">// æ­£å¸¸æƒ…å†µä¸‹ store.dispatch(object)</span><span class="hljs-comment">// æƒ³è¦æ´¾å‘å‡½æ•° store.dispatch(function)</span><span class="hljs-comment">// redux-devtools</span><span class="hljs-keyword">const</span> composeEnhancers = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span>(&#123;<span class="hljs-attr">trace</span>: <span class="hljs-literal">true</span>&#125;) || compose;<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(reducer, <span class="hljs-title function_">composeEnhancers</span>(<span class="hljs-title function_">applyMiddleware</span>(thunk)))<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store</code></pre></div><p>å®šä¹‰ä¸€ä¸ªè¿”å›å‡½æ•°çš„action</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchHomeMultidataAction</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-comment">// å¦‚æœæ˜¯ä¸€ä¸ªæ™®é€šçš„action, é‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œéœ€è¦è¿”å›actionå¯¹è±¡</span>  <span class="hljs-comment">// é—®é¢˜: å¯¹è±¡ä¸­æ˜¯ä¸èƒ½ç›´æ¥æ‹¿åˆ°ä»æœåŠ¡å™¨è¯·æ±‚çš„å¼‚æ­¥æ•°æ®çš„</span>  <span class="hljs-comment">// return &#123;&#125;</span>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">dispatch, getState</span>) &#123;    <span class="hljs-comment">// å¼‚æ­¥æ“ä½œ: ç½‘ç»œè¯·æ±‚</span>    <span class="hljs-comment">// console.log(&quot;foo function execution-----&quot;, getState().counter)</span>    axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;http://123.207.32.32:8000/home/multidata&quot;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;      <span class="hljs-keyword">const</span> banners = res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">banner</span>.<span class="hljs-property">list</span>      <span class="hljs-keyword">const</span> recommends = res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">recommend</span>.<span class="hljs-property">list</span>      <span class="hljs-comment">// dispatch(&#123; type: actionTypes.CHANGE_BANNERS, banners &#125;)</span>      <span class="hljs-comment">// dispatch(&#123; type: actionTypes.CHANGE_RECOMMENDS, recommends &#125;)</span>      <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">changeBannersAction</span>(banners))      <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">changeRecommendsAction</span>(recommends))    &#125;)  &#125;  <span class="hljs-comment">// å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°, é‚£ä¹ˆreduxæ˜¯ä¸æ”¯æŒçš„</span>  <span class="hljs-comment">// return foo</span>&#125;</code></pre></div><h4 id="å®šä¹‰applyMiddlewareä¸­é—´ä»¶"><a href="#å®šä¹‰applyMiddlewareä¸­é—´ä»¶" class="headerlink" title="å®šä¹‰applyMiddlewareä¸­é—´ä»¶"></a>å®šä¹‰applyMiddlewareä¸­é—´ä»¶</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">applyMiddleware</span>(<span class="hljs-params">store, ...fns</span>) &#123;  fns.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> &#123;    <span class="hljs-title function_">fn</span>(store)  &#125;)&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> applyMiddleware</code></pre></div><h4 id="å®šä¹‰logä¸­é—´ä»¶"><a href="#å®šä¹‰logä¸­é—´ä»¶" class="headerlink" title="å®šä¹‰logä¸­é—´ä»¶"></a>å®šä¹‰logä¸­é—´ä»¶</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">store</span>) &#123;  <span class="hljs-keyword">const</span> next = store.<span class="hljs-property">dispatch</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">logAndDispatch</span>(<span class="hljs-params">action</span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;å½“å‰æ´¾å‘çš„action:&quot;</span>, action)    <span class="hljs-comment">// çœŸæ­£æ´¾å‘çš„ä»£ç : ä½¿ç”¨ä¹‹å‰çš„dispatchè¿›è¡Œæ´¾å‘</span>    <span class="hljs-title function_">next</span>(action)    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;æ´¾å‘ä¹‹åçš„ç»“æœ:&quot;</span>, store.<span class="hljs-title function_">getState</span>())  &#125;  <span class="hljs-comment">// monkey patch: çŒ´è¡¥ä¸ =&gt; ç¯¡æ”¹ç°æœ‰çš„ä»£ç , å¯¹æ•´ä½“çš„æ‰§è¡Œé€»è¾‘è¿›è¡Œä¿®æ”¹</span>  store.<span class="hljs-property">dispatch</span> = logAndDispatch&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> log</code></pre></div><h4 id="å®šä¹‰thunkä¸­é—´ä»¶"><a href="#å®šä¹‰thunkä¸­é—´ä»¶" class="headerlink" title="å®šä¹‰thunkä¸­é—´ä»¶"></a>å®šä¹‰thunkä¸­é—´ä»¶</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">thunk</span>(<span class="hljs-params">store</span>) &#123;  <span class="hljs-keyword">const</span> next = store.<span class="hljs-property">dispatch</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">dispatchThunk</span>(<span class="hljs-params">action</span>) &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> action === <span class="hljs-string">&quot;function&quot;</span>) &#123;      <span class="hljs-title function_">action</span>(store.<span class="hljs-property">dispatch</span>, store.<span class="hljs-property">getState</span>)    &#125; <span class="hljs-keyword">else</span> &#123;      <span class="hljs-title function_">next</span>(action)    &#125;  &#125;  store.<span class="hljs-property">dispatch</span> = dispatchThunk&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> thunk</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createStore, compose, combineReducers &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span><span class="hljs-keyword">import</span> &#123; log, thunk, applyMiddleware &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./middleware&quot;</span><span class="hljs-comment">// import thunk from &quot;redux-thunk&quot;</span><span class="hljs-keyword">import</span> counterReducer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./counter&quot;</span><span class="hljs-keyword">import</span> homeReducer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./home&quot;</span><span class="hljs-keyword">import</span> userReducer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./user&quot;</span><span class="hljs-comment">// æ­£å¸¸æƒ…å†µä¸‹ store.dispatch(object)</span><span class="hljs-comment">// æƒ³è¦æ´¾å‘å‡½æ•° store.dispatch(function)</span><span class="hljs-comment">// å°†ä¸¤ä¸ªreduceråˆå¹¶åœ¨ä¸€èµ·</span><span class="hljs-keyword">const</span> reducer = <span class="hljs-title function_">combineReducers</span>(&#123;  <span class="hljs-attr">counter</span>: counterReducer,  <span class="hljs-attr">home</span>: homeReducer,  <span class="hljs-attr">user</span>: userReducer&#125;)<span class="hljs-comment">// combineReducerså®ç°åŸç†(äº†è§£)</span><span class="hljs-comment">// function reducer(state = &#123;&#125;, action) &#123;</span><span class="hljs-comment">//   // è¿”å›ä¸€ä¸ªå¯¹è±¡, storeçš„state</span><span class="hljs-comment">//   return &#123;</span><span class="hljs-comment">//     counter: counterReducer(state.counter, action),</span><span class="hljs-comment">//     home: homeReducer(state.home, action),</span><span class="hljs-comment">//     user: userReducer(state.user, action)</span><span class="hljs-comment">//   &#125;</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// redux-devtools</span><span class="hljs-keyword">const</span> composeEnhancers = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span>(&#123;<span class="hljs-attr">trace</span>: <span class="hljs-literal">true</span>&#125;) || compose;<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(reducer)<span class="hljs-title function_">applyMiddleware</span>(store, log, thunk)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store</code></pre></div><h4 id="combineReducers"><a href="#combineReducers" class="headerlink" title="combineReducers"></a>combineReducers</h4><p>reduxç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªcombineReducerså‡½æ•°å¯ä»¥æ–¹ä¾¿çš„è®©æˆ‘ä»¬å¯¹å¤šä¸ªreducerè¿›è¡Œåˆå¹¶</p><p>äº‹å®ä¸Šï¼Œå®ƒä¹Ÿæ˜¯å°†æˆ‘ä»¬ä¼ å…¥çš„reducersåˆå¹¶åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªcombinationçš„å‡½æ•°ï¼ˆç›¸å½“äºæˆ‘ä»¬ä¹‹å‰çš„reducerå‡½ æ•°äº†ï¼‰ï¼› </p><p>ï° åœ¨æ‰§è¡Œcombinationå‡½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šé€šè¿‡åˆ¤æ–­å‰åè¿”å›çš„æ•°æ®æ˜¯å¦ç›¸åŒæ¥å†³å®šè¿”å›ä¹‹å‰çš„stateè¿˜æ˜¯æ–°çš„stateï¼›</p><p>ï° æ–°çš„stateä¼šè§¦å‘è®¢é˜…è€…å‘ç”Ÿå¯¹åº”çš„åˆ·æ–°ï¼Œè€Œæ—§çš„stateå¯ä»¥æœ‰æ•ˆçš„ç»„ç»‡è®¢é˜…è€…å‘ç”Ÿåˆ·æ–°</p><h4 id="Redux-Toolkitçš„ç”¨æ³•"><a href="#Redux-Toolkitçš„ç”¨æ³•" class="headerlink" title="Redux Toolkitçš„ç”¨æ³•"></a>Redux Toolkitçš„ç”¨æ³•</h4><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install @reduxjs/toolkit react-redux</code></pre></div><p>Redux Toolkit æ˜¯å®˜æ–¹æ¨èçš„ç¼–å†™ Redux é€»è¾‘çš„æ–¹æ³•ã€‚</p><p>redux toolkit API </p><ul><li>configureStore:åŒ…è£…createStoreä»¥æä¾›ç®€åŒ–çš„é…ç½®é€‰é¡¹å’Œè‰¯å¥½çš„é»˜è®¤å€¼ã€‚å®ƒå¯ä»¥è‡ªåŠ¨ç»„åˆä½ çš„ slice reducerï¼Œæ·»åŠ ä½ æä¾› çš„ä»»ä½• Redux ä¸­é—´ä»¶ï¼Œredux-thunké»˜è®¤åŒ…å«ï¼Œå¹¶å¯ç”¨ Redux DevTools Extension</li><li>createSlice:æ¥å—reducerå‡½æ•°çš„å¯¹è±¡ã€åˆ‡ç‰‡åç§°å’Œåˆå§‹çŠ¶æ€å€¼ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆåˆ‡ç‰‡reducerï¼Œå¹¶å¸¦æœ‰ç›¸åº”çš„actions</li><li>createAsyncThunk:æ¥å—ä¸€ä¸ªåŠ¨ä½œç±»å‹å­—ç¬¦ä¸²å’Œä¸€ä¸ªè¿”å›promiseçš„å‡½æ•°ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªpending/fulfilled/rejectedåŸºäºè¯¥promiseåˆ†æ´¾åŠ¨ä½œç±»å‹çš„ thunk</li></ul><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//store.index.js</span><span class="hljs-keyword">import</span> &#123; configureStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@reduxjs/toolkit&quot;</span><span class="hljs-keyword">import</span> counterReducer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./features/counter&quot;</span><span class="hljs-keyword">import</span> homeReducer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./features/home&quot;</span><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">configureStore</span>(&#123;  <span class="hljs-attr">reducer</span>: &#123;    <span class="hljs-attr">counter</span>: counterReducer,    <span class="hljs-attr">home</span>: homeReducer  &#125;&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">///features/counter.js</span><span class="hljs-keyword">import</span> &#123; createSlice &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@reduxjs/toolkit&quot;</span><span class="hljs-keyword">const</span> counterSlice = <span class="hljs-title function_">createSlice</span>(&#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;counter&quot;</span>,<span class="hljs-comment">//ç”¨æˆ·æ ‡è®°sliceçš„åè¯,åœ¨ä¹‹åçš„redux-devtoolä¸­ä¼šæ˜¾ç¤ºå¯¹åº”çš„åè¯ï¼›</span>  <span class="hljs-comment">//åˆå§‹åŒ–å€¼</span>  <span class="hljs-attr">initialState</span>: &#123;    <span class="hljs-attr">counter</span>: <span class="hljs-number">888</span>  &#125;,  <span class="hljs-comment">//ç›¸å½“äºä¹‹å‰çš„reducerå‡½æ•°</span>  <span class="hljs-attr">reducers</span>: &#123;    <span class="hljs-title function_">addNumber</span>(<span class="hljs-params">state, &#123; payload &#125;</span>) &#123;      state.<span class="hljs-property">counter</span> = state.<span class="hljs-property">counter</span> + payload    &#125;,    <span class="hljs-title function_">subNumber</span>(<span class="hljs-params">state, &#123; payload &#125;</span>) &#123;      state.<span class="hljs-property">counter</span> = state.<span class="hljs-property">counter</span> - payload    &#125;  &#125;&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> &#123; addNumber, subNumber &#125; = counterSlice.<span class="hljs-property">actions</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> counterSlice.<span class="hljs-property">reducer</span></code></pre></div><p>//åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; <span class="hljs-title class_">PureComponent</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">import</span> &#123; connect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../hoc&quot;</span><span class="hljs-keyword">import</span> &#123; addNumber &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../store/features/counter&quot;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">PureComponent</span> &#123;  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">const</span> &#123; counter &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>    <span class="hljs-keyword">return</span> (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>About Counter: &#123;counter&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>    )  &#125;&#125;<span class="hljs-keyword">const</span> <span class="hljs-title function_">mapStateToProps</span> = (<span class="hljs-params">state</span>) =&gt; (&#123;  <span class="hljs-attr">counter</span>: state.<span class="hljs-property">counter</span>.<span class="hljs-property">counter</span>&#125;)<span class="hljs-keyword">const</span> <span class="hljs-title function_">mapDispatchToProps</span> = (<span class="hljs-params">dispatch</span>) =&gt; (&#123;  <span class="hljs-title function_">addNumber</span>(<span class="hljs-params">num</span>) &#123;    <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">addNumber</span>(num))  &#125;&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">connect</span>(mapStateToProps, mapDispatchToProps)(<span class="hljs-title class_">About</span>)</code></pre></div><h4 id="Redux-Toolkitçš„å¼‚æ­¥æ“ä½œ"><a href="#Redux-Toolkitçš„å¼‚æ­¥æ“ä½œ" class="headerlink" title="Redux Toolkitçš„å¼‚æ­¥æ“ä½œ"></a>Redux Toolkitçš„å¼‚æ­¥æ“ä½œ</h4><p>Redux Toolkité»˜è®¤å·²ç»ç»™æˆ‘ä»¬ç»§æ‰¿äº†Thunkç›¸å…³çš„åŠŸèƒ½ï¼šcreateAsyncThunk</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createSlice, createAsyncThunk &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@reduxjs/toolkit&#x27;</span><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> fetchHomeMultidataAction = <span class="hljs-title function_">createAsyncThunk</span>(  <span class="hljs-string">&quot;fetch/homemultidata&quot;</span>,   <span class="hljs-keyword">async</span> (extraInfo, &#123; dispatch, getState &#125;) =&gt; &#123;    <span class="hljs-comment">// console.log(extraInfo, dispatch, getState)</span>    <span class="hljs-comment">// 1.å‘é€ç½‘ç»œè¯·æ±‚, è·å–æ•°æ®</span>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;http://123.207.32.32:8000/home/multidata&quot;</span>)    <span class="hljs-comment">// 2.å–å‡ºæ•°æ®, å¹¶ä¸”åœ¨æ­¤å¤„ç›´æ¥dispatchæ“ä½œ(å¯ä»¥ä¸åš)</span>    <span class="hljs-keyword">const</span> banners = res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">banner</span>.<span class="hljs-property">list</span>    <span class="hljs-keyword">const</span> recommends = res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">recommend</span>.<span class="hljs-property">list</span>    <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">changeBanners</span>(banners))    <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">changeRecommends</span>(recommends))    <span class="hljs-comment">// 3.è¿”å›ç»“æœ, é‚£ä¹ˆactionçŠ¶æ€ä¼šå˜æˆfulfilledçŠ¶æ€</span>    <span class="hljs-keyword">return</span> res.<span class="hljs-property">data</span>&#125;)<span class="hljs-keyword">const</span> homeSlice = <span class="hljs-title function_">createSlice</span>(&#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;home&quot;</span>,  <span class="hljs-attr">initialState</span>: &#123;    <span class="hljs-attr">banners</span>: [],    <span class="hljs-attr">recommends</span>: []  &#125;,  <span class="hljs-attr">reducers</span>: &#123;    <span class="hljs-title function_">changeBanners</span>(<span class="hljs-params">state, &#123; payload &#125;</span>) &#123;      state.<span class="hljs-property">banners</span> = payload    &#125;,    <span class="hljs-title function_">changeRecommends</span>(<span class="hljs-params">state, &#123; payload &#125;</span>) &#123;      state.<span class="hljs-property">recommends</span> = payload    &#125;  &#125;,  <span class="hljs-comment">// extraReducers: &#123;</span>  <span class="hljs-comment">//   [fetchHomeMultidataAction.pending](state, action) &#123;</span>  <span class="hljs-comment">//     console.log(&quot;fetchHomeMultidataAction pending&quot;)</span>  <span class="hljs-comment">//   &#125;,</span>  <span class="hljs-comment">//   [fetchHomeMultidataAction.fulfilled](state, &#123; payload &#125;) &#123;</span>  <span class="hljs-comment">//     state.banners = payload.data.banner.list</span>  <span class="hljs-comment">//     state.recommends = payload.data.recommend.list</span>  <span class="hljs-comment">//   &#125;,</span>  <span class="hljs-comment">//   [fetchHomeMultidataAction.rejected](state, action) &#123;</span>  <span class="hljs-comment">//     console.log(&quot;fetchHomeMultidataAction rejected&quot;)</span>  <span class="hljs-comment">//   &#125;</span>  <span class="hljs-comment">// &#125;</span>  <span class="hljs-attr">extraReducers</span>: <span class="hljs-function">(<span class="hljs-params">builder</span>) =&gt;</span> &#123;    <span class="hljs-comment">// builder.addCase(fetchHomeMultidataAction.pending, (state, action) =&gt; &#123;</span>    <span class="hljs-comment">//   console.log(&quot;fetchHomeMultidataAction pending&quot;)</span>    <span class="hljs-comment">// &#125;).addCase(fetchHomeMultidataAction.fulfilled, (state, &#123; payload &#125;) =&gt; &#123;</span>    <span class="hljs-comment">//   state.banners = payload.data.banner.list</span>    <span class="hljs-comment">//   state.recommends = payload.data.recommend.list</span>    <span class="hljs-comment">// &#125;)</span>  &#125;&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> &#123; changeBanners, changeRecommends &#125; = homeSlice.<span class="hljs-property">actions</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> homeSlice.<span class="hljs-property">reducer</span></code></pre></div><h4 id="Redux-Toolkitçš„æ•°æ®ä¸å¯å˜æ€§"><a href="#Redux-Toolkitçš„æ•°æ®ä¸å¯å˜æ€§" class="headerlink" title="Redux Toolkitçš„æ•°æ®ä¸å¯å˜æ€§"></a>Redux Toolkitçš„æ•°æ®ä¸å¯å˜æ€§</h4><p>æˆ‘ä»¬ç»å¸¸ä¼šè¿›è¡Œæµ…æ‹·è´æ¥å®ŒæˆæŸäº›æ“ä½œï¼Œä½†æ˜¯æµ…æ‹·è´äº‹å®ä¸Šä¹Ÿæ˜¯å­˜åœ¨é—®é¢˜çš„</p><p>æ¯”å¦‚è¿‡å¤§çš„å¯¹è±¡ï¼Œè¿›è¡Œæµ…æ‹·è´ä¹Ÿä¼šé€ æˆæ€§èƒ½çš„æµªè´¹</p><p>æ¯”å¦‚æµ…æ‹·è´åçš„å¯¹è±¡ï¼Œåœ¨æ·±å±‚æ”¹å˜æ—¶ï¼Œä¾ç„¶ä¼šå¯¹ä¹‹å‰çš„å¯¹è±¡äº§ç”Ÿå½±å“</p><p>äº‹å®ä¸ŠRedux Toolkitåº•å±‚ä½¿ç”¨äº†immerjsçš„ä¸€ä¸ªåº“æ¥ä¿è¯æ•°æ®çš„ä¸å¯å˜æ€§</p><p>ä¸ºäº†èŠ‚çº¦å†…å­˜ï¼Œåˆå‡ºç°äº†ä¸€ä¸ªæ–°çš„ç®—æ³•ï¼šPersistent Data Structureï¼ˆæŒä¹…åŒ–æ•°æ®ç»“æ„æˆ–ä¸€è‡´æ€§ æ•°æ®ç»“æ„ï¼‰ï¼›</p><p>â€‹    ç”¨ä¸€ç§æ•°æ®ç»“æ„æ¥ä¿å­˜æ•°æ®ï¼›</p><p>â€‹    å½“æ•°æ®è¢«ä¿®æ”¹æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯æ–°çš„å¯¹è±¡ä¼šå°½å¯èƒ½çš„åˆ©ç”¨ä¹‹å‰çš„æ•°æ®ç»“æ„è€Œä¸ä¼š å¯¹å†…å­˜é€ æˆæµªè´¹ï¼›</p><h4 id="è‡ªå®šä¹‰connectå‡½æ•°"><a href="#è‡ªå®šä¹‰connectå‡½æ•°" class="headerlink" title="è‡ªå®šä¹‰connectå‡½æ•°"></a>è‡ªå®šä¹‰connectå‡½æ•°</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//connect.js</span><span class="hljs-comment">// connectçš„å‚æ•°:</span><span class="hljs-comment">// å‚æ•°ä¸€: å‡½æ•°</span><span class="hljs-comment">// å‚æ•°äºŒ: å‡½æ•°</span><span class="hljs-comment">// è¿”å›å€¼: å‡½æ•° =&gt; é«˜é˜¶ç»„ä»¶</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">PureComponent</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">StoreContext</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./StoreContext&quot;</span>;<span class="hljs-comment">// import store from &quot;../store&quot;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">connect</span>(<span class="hljs-params">mapStateToProps, mapDispatchToProps, store</span>) &#123;  <span class="hljs-comment">// é«˜é˜¶ç»„ä»¶: å‡½æ•°</span>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">WrapperComponent</span>) &#123;    <span class="hljs-keyword">class</span> <span class="hljs-title class_">NewComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">PureComponent</span> &#123;      <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props, context</span>) &#123;        <span class="hljs-variable language_">super</span>(props)                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-title function_">mapStateToProps</span>(context.<span class="hljs-title function_">getState</span>())      &#125;      <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">unsubscribe</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-comment">// this.forceUpdate()</span>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(<span class="hljs-title function_">mapStateToProps</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">getState</span>()))        &#125;)      &#125;      <span class="hljs-title function_">componentWillUnmount</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">unsubscribe</span>()      &#125;      <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">const</span> stateObj = <span class="hljs-title function_">mapStateToProps</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">getState</span>())        <span class="hljs-keyword">const</span> dispatchObj = <span class="hljs-title function_">mapDispatchToProps</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">dispatch</span>)        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">WrapperComponent</span> &#123;<span class="hljs-attr">...this.props</span>&#125; &#123;<span class="hljs-attr">...stateObj</span>&#125; &#123;<span class="hljs-attr">...dispatchObj</span>&#125;/&gt;</span></span>      &#125;    &#125;    <span class="hljs-title class_">NewComponent</span>.<span class="hljs-property">contextType</span> = <span class="hljs-title class_">StoreContext</span>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">NewComponent</span>  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//StoreContext.js</span><span class="hljs-keyword">import</span> &#123; createContext &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">StoreContext</span> = <span class="hljs-title function_">createContext</span>()</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>react</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é¢å‘å¯¹è±¡çš„åŸå‹ç»§æ‰¿</title>
    <link href="/2022/09/08/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8E%9F%E5%9E%8B%E7%BB%A7%E6%89%BF/"/>
    <url>/2022/09/08/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8E%9F%E5%9E%8B%E7%BB%A7%E6%89%BF/</url>
    
    <content type="html"><![CDATA[<h4 id="ç›´æ¥å°†çˆ¶ç±»çš„åŸå‹èµ‹å€¼ç»™å­ç±»"><a href="#ç›´æ¥å°†çˆ¶ç±»çš„åŸå‹èµ‹å€¼ç»™å­ç±»" class="headerlink" title="ç›´æ¥å°†çˆ¶ç±»çš„åŸå‹èµ‹å€¼ç»™å­ç±»"></a>ç›´æ¥å°†çˆ¶ç±»çš„åŸå‹èµ‹å€¼ç»™å­ç±»</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰Personæ„é€ å‡½æ•°(ç±»)</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age, height, address</span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">address</span> = address;&#125;<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">running</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;running~&quot;</span>);&#125;;<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eating</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;eating~&quot;</span>);&#125;;<span class="hljs-comment">// å®šä¹‰å­¦ç”Ÿç±»</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params">name, age, height, address, sno, score</span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">address</span> = address;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">sno</span> = sno;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> = score;&#125;<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;&#125;;<span class="hljs-keyword">const</span> stu = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>, <span class="hljs-string">&quot;333&quot;</span>, <span class="hljs-string">&quot;444&quot;</span>, <span class="hljs-string">&quot;555&quot;</span>, <span class="hljs-string">&quot;666&quot;</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu.<span class="hljs-title function_">getName</span>());<span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;777&quot;</span>, <span class="hljs-string">&quot;888&quot;</span>, <span class="hljs-string">&quot;999&quot;</span>, <span class="hljs-string">&quot;101010&quot;</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p.<span class="hljs-title function_">getName</span>());</code></pre></div><p>è¿™ç§æ–¹å¼ä¼šä½¿çˆ¶ç±»å’Œå­ç±»å…±ç”¨åŸå‹é“¾ä¸Šçš„æ–¹æ³•ï¼Œå­ç±»ä¹Ÿä¼šä¿®æ”¹çˆ¶ç±»åŸå‹é“¾çš„æ–¹æ³•ï¼Œä¿®æ”¹æˆ–è€…æ·»åŠ å­ç±»åŸå‹é“¾ä¸Šçš„æ–¹æ³•ï¼Œçˆ¶ç±»ä¹Ÿä¼šå—åˆ°å½±å“ï¼Œçˆ¶ç±»åŸå‹é“¾ä¸Šä¹Ÿä¼šæœ‰è¿™ä¸ªæ–¹æ³•</p><h4 id="é€šè¿‡çˆ¶ç±»å®ä¾‹å®ç°ç»§æ‰¿"><a href="#é€šè¿‡çˆ¶ç±»å®ä¾‹å®ç°ç»§æ‰¿" class="headerlink" title="é€šè¿‡çˆ¶ç±»å®ä¾‹å®ç°ç»§æ‰¿"></a>é€šè¿‡çˆ¶ç±»å®ä¾‹å®ç°ç»§æ‰¿</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰Personæ„é€ å‡½æ•°(ç±»)</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age, height, address</span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">address</span> = address;&#125;<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">running</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;running~&quot;</span>);&#125;;<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eating</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;eating~&quot;</span>);&#125;;<span class="hljs-comment">// å®šä¹‰å­¦ç”Ÿç±»</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params">sno, score</span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">sno</span> = sno;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> = score;&#125;<span class="hljs-comment">// Student.prototypeæŒ‡å‘Personå®ä¾‹</span><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = p1;<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;&#125;;<span class="hljs-keyword">const</span> stu = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;555&quot;</span>, <span class="hljs-string">&quot;666&quot;</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu.<span class="hljs-title function_">getName</span>());<span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;777&quot;</span>, <span class="hljs-string">&quot;888&quot;</span>, <span class="hljs-string">&quot;999&quot;</span>, <span class="hljs-string">&quot;101010&quot;</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p.<span class="hljs-title function_">getName</span>());</code></pre></div><p>åŸå‹é“¾ç»§æ‰¿è™½ç„¶å¯ä»¥è§£å†³å­ç±»ä¼šä¿®æ”¹çˆ¶ç±»çš„åŸå‹é“¾ä¸Šçš„æ–¹æ³•çš„é—®é¢˜ï¼Œä½†æ˜¯å­ç±»æ— æ³•æŸ¥çœ‹çˆ¶ç±»çš„å‚æ•°ï¼Œä¹Ÿï¼Œä¹Ÿæ²¡åŠæ³•ä¿®æ”¹çˆ¶ç±»çš„å‚æ•°ï¼Œæ‰“å°çœ‹ä¸åˆ°çˆ¶ç±»çš„å‚æ•°ï¼Œä¸å¯ä»¥ç»™çˆ¶ç±»ä¼ å‚</p><h4 id="å€Ÿç”¨æ„é€ å‡½æ•°çš„ç»§æ‰¿"><a href="#å€Ÿç”¨æ„é€ å‡½æ•°çš„ç»§æ‰¿" class="headerlink" title="å€Ÿç”¨æ„é€ å‡½æ•°çš„ç»§æ‰¿"></a>å€Ÿç”¨æ„é€ å‡½æ•°çš„ç»§æ‰¿</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age, height, address</span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">address</span> = address;&#125;<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">running</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;running~&quot;</span>);&#125;;<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eating</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;eating~&quot;</span>);&#125;;<span class="hljs-comment">// å®šä¹‰å­¦ç”Ÿç±»</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params">name, age, height, address, sno, score</span>) &#123;  <span class="hljs-comment">// å€Ÿç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</span>  <span class="hljs-title class_">Person</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name, age, height, address);  <span class="hljs-variable language_">this</span>.<span class="hljs-property">sno</span> = sno;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> = score;&#125;<span class="hljs-comment">// Student.prototypeæŒ‡å‘Personå®ä¾‹</span><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = p1;<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;&#125;;<span class="hljs-keyword">const</span> stu = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>, <span class="hljs-string">&quot;333&quot;</span>, <span class="hljs-string">&quot;444&quot;</span>, <span class="hljs-string">&quot;555&quot;</span>, <span class="hljs-string">&quot;666&quot;</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu.<span class="hljs-title function_">getName</span>());<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu.<span class="hljs-title function_">eating</span>());<span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;777&quot;</span>, <span class="hljs-string">&quot;888&quot;</span>, <span class="hljs-string">&quot;999&quot;</span>, <span class="hljs-string">&quot;101010&quot;</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p.<span class="hljs-title function_">eating</span>());</code></pre></div><p>è¿™ç§æ–¹å¼ä¼šè°ƒç”¨ä¸¤æ¬¡çˆ¶ç±»çš„æ„é€ å‡½æ•°</p><p>ä¸€æ¬¡åœ¨åˆ›å»ºå­ç±»åŸå‹çš„æ—¶å€™</p><p>å¦ä¸€æ¬¡åœ¨å­ç±»æ„é€ å‡½æ•°å†…éƒ¨(ä¹Ÿå°±æ˜¯æ¯æ¬¡åˆ›å»ºå­ç±»å®ä¾‹çš„æ—¶å€™)ï¼›</p><h4 id="ç»„åˆå¯„ç”Ÿå¼ç»§æ‰¿"><a href="#ç»„åˆå¯„ç”Ÿå¼ç»§æ‰¿" class="headerlink" title="ç»„åˆå¯„ç”Ÿå¼ç»§æ‰¿"></a>ç»„åˆå¯„ç”Ÿå¼ç»§æ‰¿</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// åˆ›å»ºå·¥å…·å‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">createObject</span>(<span class="hljs-params">o</span>) &#123;  <span class="hljs-keyword">function</span> <span class="hljs-title function_">F</span>(<span class="hljs-params"></span>) &#123;&#125;  F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = o;  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();&#125;<span class="hljs-comment">// åˆ›å»ºå¯„ç”Ÿå‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">inherit</span>(<span class="hljs-params">Subtype, Supertype</span>) &#123;  <span class="hljs-comment">// æ–¹å¼ä¸€</span>  <span class="hljs-comment">// const obj=Object.create(Supertype.prototype)</span>  <span class="hljs-comment">// Subtype.prototype=obj</span>  <span class="hljs-comment">// æ–¹å¼äºŒ</span>  <span class="hljs-title class_">Subtype</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title function_">createObject</span>(<span class="hljs-title class_">Supertype</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-title class_">Subtype</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, <span class="hljs-string">&quot;constructor&quot;</span>, &#123;    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,    <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">value</span>: <span class="hljs-title class_">Subtype</span>,  &#125;);  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(<span class="hljs-title class_">Subtype</span>, <span class="hljs-title class_">Supertype</span>);  <span class="hljs-comment">// Subtype.__proto__=Supertype</span>&#125;<span class="hljs-comment">// å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿</span><span class="hljs-comment">// åŸå‹é“¾/å€Ÿç”¨/åŸå‹å¼(å¯¹è±¡ä¹‹é—´)/å¯„ç”Ÿå¼å‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age, height</span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;&#125;<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">running</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;running~&quot;</span>);&#125;;<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eating</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;eating~&quot;</span>);&#125;;<span class="hljs-comment">//ç±»æ–¹æ³•</span><span class="hljs-title class_">Person</span>.<span class="hljs-property">sleep</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;static sleep&quot;</span>);&#125;;<span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params">name, age, height, sno, score</span>) &#123;  <span class="hljs-title class_">Person</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name, age, height);  <span class="hljs-variable language_">this</span>.<span class="hljs-property">sno</span> = sno;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> = score;&#125;<span class="hljs-title function_">inherit</span>(<span class="hljs-title class_">Student</span>, <span class="hljs-title class_">Person</span>);<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">studying</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;studying&quot;</span>);&#125;;<span class="hljs-comment">// åˆ›å»ºå®ä¾‹å¯¹è±¡</span><span class="hljs-keyword">var</span> stu1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-number">18</span>, <span class="hljs-number">1.88</span>, <span class="hljs-number">111</span>, <span class="hljs-number">100</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu1);stu1.<span class="hljs-title function_">studying</span>();<span class="hljs-title class_">Student</span>.<span class="hljs-title function_">sleep</span>();</code></pre></div><h4 id="ES6ä¸­çš„ç»§æ‰¿"><a href="#ES6ä¸­çš„ç»§æ‰¿" class="headerlink" title="ES6ä¸­çš„ç»§æ‰¿"></a>ES6ä¸­çš„ç»§æ‰¿</h4><p>es6ä¸­å¢åŠ äº†extendså…³é”®å­—æ¥å®ç°ç»§æ‰¿</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;   <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age</span>) &#123;     <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;     <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;   &#125;   <span class="hljs-title function_">running</span>(<span class="hljs-params"></span>) &#123;     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;running~&quot;</span>);   &#125;   <span class="hljs-title function_">eating</span>(<span class="hljs-params"></span>) &#123;     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;eating~&quot;</span>);   &#125;   <span class="hljs-keyword">static</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-params"></span>) &#123;     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;static animal sleep&quot;</span>);   &#125; &#125; <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span> &#123;   <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age, sno, score</span>) &#123;     <span class="hljs-comment">// superå¯ç”¨æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€å®ä¾‹æ–¹æ³•ï¼Œé™æ€æ–¹æ³•</span>     <span class="hljs-variable language_">super</span>(name, age);     <span class="hljs-variable language_">this</span>.<span class="hljs-property">sno</span> = sno;     <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> = score;   &#125;   <span class="hljs-title function_">studying</span>(<span class="hljs-params"></span>) &#123;     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;studying~&quot;</span>);   &#125; &#125; <span class="hljs-keyword">const</span> stu = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>, <span class="hljs-string">&quot;333&quot;</span>, <span class="hljs-string">&quot;444&quot;</span>, <span class="hljs-string">&quot;555&quot;</span>); <span class="hljs-comment">// ç±»æ–¹æ³•ä¹Ÿå¯ä»¥å®ç°ç»§æ‰¿</span> <span class="hljs-title class_">Student</span>.<span class="hljs-title function_">sleep</span>();</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>callå‡½æ•°çš„å®ç°</title>
    <link href="/2022/09/07/call%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/09/07/call%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">MyCall</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">thisArg, ...args</span>) &#123;  <span class="hljs-keyword">const</span> fn = <span class="hljs-variable language_">this</span>;  thisArg = thisArg != <span class="hljs-literal">null</span> ? <span class="hljs-title class_">Object</span>(thisArg) : globalThis; <span class="hljs-comment">//Object(thisArg)å¦‚æœæ˜¯åŸºæœ¬ç±»å‹å°†ä¼šå°†æ¢æˆåŒ…è£…ç±»ï¼ŒglobalThisåˆ†åˆ«å¯¹åº”window/nodeçš„ç¯å¢ƒ</span>  args = args || [];  thisArg.<span class="hljs-property">fn</span> = fn;  <span class="hljs-keyword">const</span> result = thisArg.<span class="hljs-title function_">fn</span>(...args);  <span class="hljs-keyword">delete</span> thisArg.<span class="hljs-property">fn</span>;  <span class="hljs-keyword">return</span> result;&#125;;<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;fooå‡½æ•°è¢«æ‰§è¡Œ&quot;</span>, <span class="hljs-variable language_">this</span>);&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">num1, num2</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sumå‡½æ•°è¢«æ‰§è¡Œ&quot;</span>, <span class="hljs-variable language_">this</span>, num1, num2);  <span class="hljs-keyword">return</span> num1 + num2;&#125;foo.<span class="hljs-title function_">call</span>(<span class="hljs-literal">undefined</span>);<span class="hljs-keyword">var</span> result = sum.<span class="hljs-title function_">call</span>(&#123;&#125;, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>);<span class="hljs-comment">// console.log(&quot;ç³»ç»Ÿè°ƒç”¨çš„ç»“æœ:&quot;, result)</span><span class="hljs-comment">// è‡ªå·±å®ç°çš„å‡½æ•°çš„hycallæ–¹æ³•</span><span class="hljs-comment">// é»˜è®¤è¿›è¡Œéšå¼ç»‘å®š</span><span class="hljs-comment">// foo.hycall(&#123;name: &quot;why&quot;&#125;)</span>foo.<span class="hljs-title class_">MyCall</span>(<span class="hljs-literal">undefined</span>);<span class="hljs-keyword">var</span> result = sum.<span class="hljs-title class_">MyCall</span>(<span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hycallçš„è°ƒç”¨:&quot;</span>, result);</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Applyå‡½æ•°çš„å®ç°</title>
    <link href="/2022/09/07/Apply%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/09/07/Apply%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">apply</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">thisArg, args</span>) &#123;  <span class="hljs-keyword">const</span> fn = <span class="hljs-variable language_">this</span>;  thisArg = thisArg != <span class="hljs-literal">null</span> ? <span class="hljs-title class_">Object</span>(thisArg) : globalThis;  <span class="hljs-keyword">if</span> (!(args <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>)) &#123;    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;args is no array&quot;</span>);  &#125;  args = args || [];  thisArg.<span class="hljs-property">fn</span> = fn;  <span class="hljs-keyword">const</span> result = thisArg.<span class="hljs-title function_">fn</span>(...args);  <span class="hljs-keyword">delete</span> thisArg.<span class="hljs-property">fn</span>;  <span class="hljs-keyword">return</span> result;&#125;;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>èŠ‚æµå‡½æ•°çš„å®ç°</title>
    <link href="/2022/09/07/%E8%8A%82%E6%B5%81%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/09/07/%E8%8A%82%E6%B5%81%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="èŠ‚æµå‡½æ•°çš„åŸºæœ¬å®ç°"><a href="#èŠ‚æµå‡½æ•°çš„åŸºæœ¬å®ç°" class="headerlink" title="èŠ‚æµå‡½æ•°çš„åŸºæœ¬å®ç°"></a>èŠ‚æµå‡½æ•°çš„åŸºæœ¬å®ç°</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">myThrottle</span>(<span class="hljs-params">fn, interval</span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> startTime = <span class="hljs-number">0</span>;</span><span class="language-javascript">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">_throttle</span>(<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> nowTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">          <span class="hljs-keyword">const</span> waitTime = interval - (nowTime - startTime); <span class="hljs-comment">//ç¬¬ä¸€æ¬¡è‚¯å®šä¼šæ‰§è¡Œï¼Œå› ä¸ºstartTimeä¸º0</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (waitTime &lt;= <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">            <span class="hljs-title function_">fn</span>();</span><span class="language-javascript">            startTime = nowTime;</span><span class="language-javascript">          &#125;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = <span class="hljs-title function_">myThrottle</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-string">&quot;-----&quot;</span>);</span><span class="language-javascript">      &#125;, <span class="hljs-number">1000</span>);</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><h4 id="thiså’Œå‚æ•°ç»‘å®š"><a href="#thiså’Œå‚æ•°ç»‘å®š" class="headerlink" title="thiså’Œå‚æ•°ç»‘å®š"></a>thiså’Œå‚æ•°ç»‘å®š</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">myThrottle</span>(<span class="hljs-params">fn, interval</span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> startTime = <span class="hljs-number">0</span>;</span><span class="language-javascript">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">_throttle</span>(<span class="hljs-params">...args</span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> nowTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">          <span class="hljs-keyword">const</span> waitTime = interval - (nowTime - startTime); <span class="hljs-comment">//ç¬¬ä¸€æ¬¡è‚¯å®šä¼šæ‰§è¡Œï¼Œå› ä¸ºstartTimeä¸º0</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (waitTime &lt;= <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">            startTime = nowTime;</span><span class="language-javascript">          &#125;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = <span class="hljs-title function_">myThrottle</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-string">&quot;-----&quot;</span>);</span><span class="language-javascript">      &#125;, <span class="hljs-number">1000</span>);</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><h4 id="å¯¹ç«‹å³æ‰§è¡Œè¿›è¡Œæ§åˆ¶"><a href="#å¯¹ç«‹å³æ‰§è¡Œè¿›è¡Œæ§åˆ¶" class="headerlink" title="å¯¹ç«‹å³æ‰§è¡Œè¿›è¡Œæ§åˆ¶"></a>å¯¹ç«‹å³æ‰§è¡Œè¿›è¡Œæ§åˆ¶</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">myThrottle</span>(<span class="hljs-params">fn, interval, leading = <span class="hljs-literal">true</span></span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> startTime = <span class="hljs-number">0</span>;</span><span class="language-javascript"></span><span class="language-javascript">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">_throttle</span>(<span class="hljs-params">...args</span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> nowTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">          <span class="hljs-comment">// å¯¹ç«‹å³æ‰§è¡Œè¿›è¡Œæ§åˆ¶</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (!leading &amp;&amp; startTime === <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">            startTime = nowTime;</span><span class="language-javascript">          &#125;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> waitTime = interval - (nowTime - startTime); <span class="hljs-comment">//ç¬¬ä¸€æ¬¡è‚¯å®šä¼šæ‰§è¡Œï¼Œå› ä¸ºstartTimeä¸º0</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (waitTime &lt;= <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">            startTime = nowTime;</span><span class="language-javascript">          &#125;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = <span class="hljs-title function_">myThrottle</span>(</span><span class="language-javascript">        <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-string">&quot;-----&quot;</span>);</span><span class="language-javascript">        &#125;,</span><span class="language-javascript">        <span class="hljs-number">1000</span>,</span><span class="language-javascript">        <span class="hljs-literal">false</span></span><span class="language-javascript">      );</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><p>å°¾éƒ¨æ‰§è¡Œæ§åˆ¶</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">myThrottle</span>(<span class="hljs-params"></span></span><span class="hljs-params"><span class="language-javascript">        fn,</span></span><span class="hljs-params"><span class="language-javascript">        interval,</span></span><span class="hljs-params"><span class="language-javascript">        &#123; leading = <span class="hljs-literal">true</span>, trailing = <span class="hljs-literal">false</span> &#125; = &#123;&#125;</span></span><span class="hljs-params"><span class="language-javascript">      </span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> startTime = <span class="hljs-number">0</span>;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">_throttle</span>(<span class="hljs-params">...args</span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> nowTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">          <span class="hljs-comment">// å¯¹ç«‹å³æ‰§è¡Œè¿›è¡Œæ§åˆ¶</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (!leading &amp;&amp; startTime === <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">            startTime = nowTime;</span><span class="language-javascript">          &#125;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> waitTime = interval - (nowTime - startTime); <span class="hljs-comment">//ç¬¬ä¸€æ¬¡è‚¯å®šä¼šæ‰§è¡Œï¼Œå› ä¸ºstartTimeä¸º0</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (waitTime &lt;= <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">            <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">            startTime = nowTime;</span><span class="language-javascript">            timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">            <span class="hljs-keyword">return</span>;</span><span class="language-javascript">          &#125;</span><span class="language-javascript">          <span class="hljs-comment">// é’ˆå¯¹waitTimeè¿˜æœ‰ä½™æ•°çš„æ—¶å€™</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (trailing &amp;&amp; !timer) &#123;</span><span class="language-javascript">            timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">              fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">              timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">              startTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">            &#125;, waitTime);</span><span class="language-javascript">          &#125;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = <span class="hljs-title function_">myThrottle</span>(</span><span class="language-javascript">        <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-string">&quot;-----&quot;</span>);</span><span class="language-javascript">        &#125;,</span><span class="language-javascript">        <span class="hljs-number">1000</span>,</span><span class="language-javascript">        &#123; <span class="hljs-attr">trailing</span>: <span class="hljs-literal">true</span> &#125;</span><span class="language-javascript">      );</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><h4 id="å–æ¶ˆå‡½æ•°"><a href="#å–æ¶ˆå‡½æ•°" class="headerlink" title="å–æ¶ˆå‡½æ•°"></a>å–æ¶ˆå‡½æ•°</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">myThrottle</span>(<span class="hljs-params"></span></span><span class="hljs-params"><span class="language-javascript">        fn,</span></span><span class="hljs-params"><span class="language-javascript">        interval,</span></span><span class="hljs-params"><span class="language-javascript">        &#123; leading = <span class="hljs-literal">true</span>, trailing = <span class="hljs-literal">false</span> &#125; = &#123;&#125;</span></span><span class="hljs-params"><span class="language-javascript">      </span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> startTime = <span class="hljs-number">0</span>;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">_throttle</span>(<span class="hljs-params">...args</span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> nowTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">          <span class="hljs-comment">// å¯¹ç«‹å³æ‰§è¡Œè¿›è¡Œæ§åˆ¶</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (!leading &amp;&amp; startTime === <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">            startTime = nowTime;</span><span class="language-javascript">          &#125;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> waitTime = interval - (nowTime - startTime); <span class="hljs-comment">//ç¬¬ä¸€æ¬¡è‚¯å®šä¼šæ‰§è¡Œï¼Œå› ä¸ºstartTimeä¸º0</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (waitTime &lt;= <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">            <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">            startTime = nowTime;</span><span class="language-javascript">            timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">            <span class="hljs-keyword">return</span>;</span><span class="language-javascript">          &#125;</span><span class="language-javascript">          <span class="hljs-comment">// é’ˆå¯¹waitTimeè¿˜æœ‰ä½™æ•°çš„æ—¶å€™</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (trailing &amp;&amp; !timer) &#123;</span><span class="language-javascript">            timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">              fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">              timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">              startTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">            &#125;, waitTime);</span><span class="language-javascript">          &#125;</span><span class="language-javascript">        &#125;</span><span class="language-javascript">        <span class="hljs-comment">// å–æ¶ˆå‡½æ•°</span></span><span class="language-javascript">        _throttle.<span class="hljs-property">cancel</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">          timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">          startTime = <span class="hljs-number">0</span>;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">        <span class="hljs-keyword">return</span> _throttle;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = <span class="hljs-title function_">myThrottle</span>(</span><span class="language-javascript">        <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-string">&quot;-----&quot;</span>);</span><span class="language-javascript">        &#125;,</span><span class="language-javascript">        <span class="hljs-number">1000</span>,</span><span class="language-javascript">        &#123; <span class="hljs-attr">trailing</span>: <span class="hljs-literal">true</span> &#125;</span><span class="language-javascript">      );</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><h4 id="è·å–è¿”å›å€¼"><a href="#è·å–è¿”å›å€¼" class="headerlink" title="è·å–è¿”å›å€¼"></a>è·å–è¿”å›å€¼</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">myThrottle</span>(<span class="hljs-params"></span></span><span class="hljs-params"><span class="language-javascript">        fn,</span></span><span class="hljs-params"><span class="language-javascript">        interval,</span></span><span class="hljs-params"><span class="language-javascript">        &#123; leading = <span class="hljs-literal">true</span>, trailing = <span class="hljs-literal">false</span> &#125; = &#123;&#125;</span></span><span class="hljs-params"><span class="language-javascript">      </span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> startTime = <span class="hljs-number">0</span>;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">_throttle</span>(<span class="hljs-params">...args</span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">try</span> &#123;</span><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><span class="language-javascript">              <span class="hljs-keyword">try</span> &#123;</span><span class="language-javascript">              &#125; <span class="hljs-keyword">catch</span> (error) &#123;&#125;</span><span class="language-javascript">            &#125;);</span><span class="language-javascript">            <span class="hljs-keyword">const</span> nowTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">            <span class="hljs-comment">// å¯¹ç«‹å³æ‰§è¡Œè¿›è¡Œæ§åˆ¶</span></span><span class="language-javascript">            <span class="hljs-keyword">if</span> (!leading &amp;&amp; startTime === <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">              startTime = nowTime;</span><span class="language-javascript">            &#125;</span><span class="language-javascript">            <span class="hljs-keyword">const</span> waitTime = interval - (nowTime - startTime); <span class="hljs-comment">//ç¬¬ä¸€æ¬¡è‚¯å®šä¼šæ‰§è¡Œï¼Œå› ä¸ºstartTimeä¸º0</span></span><span class="language-javascript">            <span class="hljs-keyword">if</span> (waitTime &lt;= <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">              <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">              <span class="hljs-keyword">const</span> res = fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">              <span class="hljs-title function_">resolve</span>(res);</span><span class="language-javascript">              startTime = nowTime;</span><span class="language-javascript">              timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">              <span class="hljs-keyword">return</span>;</span><span class="language-javascript">            &#125;</span><span class="language-javascript">            <span class="hljs-comment">// é’ˆå¯¹waitTimeè¿˜æœ‰ä½™æ•°çš„æ—¶å€™</span></span><span class="language-javascript">            <span class="hljs-keyword">if</span> (trailing &amp;&amp; !timer) &#123;</span><span class="language-javascript">              timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">                fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">                timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">                startTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();</span><span class="language-javascript">              &#125;, waitTime);</span><span class="language-javascript">            &#125;</span><span class="language-javascript">          &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span><span class="language-javascript">            <span class="hljs-title function_">reject</span>(error);</span><span class="language-javascript">          &#125;</span><span class="language-javascript">        &#125;</span><span class="language-javascript">        <span class="hljs-comment">// å–æ¶ˆå‡½æ•°</span></span><span class="language-javascript">        _throttle.<span class="hljs-property">cancel</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">          timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">          startTime = <span class="hljs-number">0</span>;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">        <span class="hljs-keyword">return</span> _throttle;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = <span class="hljs-title function_">myThrottle</span>(</span><span class="language-javascript">        <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-string">&quot;-----&quot;</span>);</span><span class="language-javascript">        &#125;,</span><span class="language-javascript">        <span class="hljs-number">1000</span>,</span><span class="language-javascript">        &#123; <span class="hljs-attr">trailing</span>: <span class="hljs-literal">true</span> &#125;</span><span class="language-javascript">      );</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é˜²æŠ–å‡½æ•°çš„å®ç°</title>
    <link href="/2022/09/07/%E9%98%B2%E6%8A%96%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/09/07/%E9%98%B2%E6%8A%96%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="èŠ‚æµå‡½æ•°çš„åŸºæœ¬å®ç°"><a href="#èŠ‚æµå‡½æ•°çš„åŸºæœ¬å®ç°" class="headerlink" title="èŠ‚æµå‡½æ•°çš„åŸºæœ¬å®ç°"></a>èŠ‚æµå‡½æ•°çš„åŸºæœ¬å®ç°</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">mydebounce</span>(<span class="hljs-params">fn, delay</span>) &#123;</span><span class="language-javascript">        <span class="hljs-comment">// è®°å½•ä¸Šä¸€æ¬¡çš„timer</span></span><span class="language-javascript">        <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        <span class="hljs-comment">// è¿”å›éœ€è¦æ‰§è¡Œçš„å‡½æ•°</span></span><span class="language-javascript">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">_debounce</span>(<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">          <span class="hljs-comment">//é¢‘ç¹è§¦å‘æ‰§è¡Œéƒ½ä¼šå…ˆæ¸…é™¤ä¸Šä¸€æ¬¡çš„timer</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript"></span><span class="language-javascript">          timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">            <span class="hljs-title function_">fn</span>();</span><span class="language-javascript">            timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ‰§è¡Œè¿‡å‡½æ•°ä¹‹å, å°†timeré‡æ–°ç½®null</span></span><span class="language-javascript">          &#125;, delay);</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = <span class="hljs-title function_">mydebounce</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;</span><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-string">&quot;----------&quot;</span>);</span><span class="language-javascript">      &#125;, <span class="hljs-number">1000</span>);</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><h4 id="thisçš„ç»‘å®šå’Œå‚æ•°ä¼ é€’"><a href="#thisçš„ç»‘å®šå’Œå‚æ•°ä¼ é€’" class="headerlink" title="thisçš„ç»‘å®šå’Œå‚æ•°ä¼ é€’"></a>thisçš„ç»‘å®šå’Œå‚æ•°ä¼ é€’</h4><div class="code-wrapper"><pre><code class="hljs js">&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">mydebounce</span>(<span class="hljs-params">fn, delay</span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// è®°å½•ä¸Šä¸€æ¬¡çš„timer</span></span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;</span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// è¿”å›éœ€è¦æ‰§è¡Œçš„å‡½æ•°</span></span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">_debounce</span>(<span class="hljs-params">...args</span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">//é¢‘ç¹è§¦å‘æ‰§è¡Œéƒ½ä¼šå…ˆæ¸…é™¤ä¸Šä¸€æ¬¡çš„timer</span></span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml">          timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span></span><span class="language-javascript"><span class="language-xml">            timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ‰§è¡Œè¿‡å‡½æ•°ä¹‹å, å°†timeré‡æ–°ç½®null</span></span></span><span class="language-javascript"><span class="language-xml">          &#125;, delay);</span></span><span class="language-javascript"><span class="language-xml">        &#125;;</span></span><span class="language-javascript"><span class="language-xml">      &#125;</span></span><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span></span><span class="language-javascript"><span class="language-xml">      inputEl.<span class="hljs-property">oninput</span> = <span class="hljs-title function_">mydebounce</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-variable language_">this</span>, <span class="hljs-string">&quot;----------&quot;</span>);</span></span><span class="language-javascript"><span class="language-xml">      &#125;, <span class="hljs-number">1000</span>);</span></span><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span></code></pre></div><h4 id="å–æ¶ˆåŠŸèƒ½çš„å®ç°"><a href="#å–æ¶ˆåŠŸèƒ½çš„å®ç°" class="headerlink" title="å–æ¶ˆåŠŸèƒ½çš„å®ç°"></a>å–æ¶ˆåŠŸèƒ½çš„å®ç°</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>å–æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">mydebounce</span>(<span class="hljs-params">fn, delay</span>) &#123;</span><span class="language-javascript">        <span class="hljs-comment">// è®°å½•ä¸Šä¸€æ¬¡çš„timer</span></span><span class="language-javascript">        <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        <span class="hljs-comment">// è¿”å›éœ€è¦æ‰§è¡Œçš„å‡½æ•°</span></span><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">_debounce</span>(<span class="hljs-params">...args</span>) &#123;</span><span class="language-javascript">          <span class="hljs-comment">//é¢‘ç¹è§¦å‘æ‰§è¡Œéƒ½ä¼šå…ˆæ¸…é™¤ä¸Šä¸€æ¬¡çš„timer</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript"></span><span class="language-javascript">          timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">            timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ‰§è¡Œè¿‡å‡½æ•°ä¹‹å, å°†timeré‡æ–°ç½®null</span></span><span class="language-javascript">          &#125;, delay);</span><span class="language-javascript">        &#125;</span><span class="language-javascript">        <span class="hljs-comment">// å–æ¶ˆåŠŸèƒ½</span></span><span class="language-javascript">        _debounce.<span class="hljs-property">cancel</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;button&quot;</span>);</span><span class="language-javascript">          timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">        <span class="hljs-keyword">return</span> _debounce;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      <span class="hljs-keyword">const</span> buttonEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;button&quot;</span>);</span><span class="language-javascript">      <span class="hljs-keyword">const</span> debounce = <span class="hljs-title function_">mydebounce</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;</span><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-variable language_">this</span>, <span class="hljs-string">&quot;----------&quot;</span>);</span><span class="language-javascript">      &#125;, <span class="hljs-number">3000</span>);</span><span class="language-javascript"></span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = debounce;</span><span class="language-javascript"></span><span class="language-javascript">      buttonEl.<span class="hljs-property">onclick</span> = debounce.<span class="hljs-property">cancel</span>;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><h4 id="å®ç°ç«‹å³æ‰§è¡ŒåŠŸèƒ½"><a href="#å®ç°ç«‹å³æ‰§è¡ŒåŠŸèƒ½" class="headerlink" title="å®ç°ç«‹å³æ‰§è¡ŒåŠŸèƒ½"></a>å®ç°ç«‹å³æ‰§è¡ŒåŠŸèƒ½</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>å–æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">mydebounce</span>(<span class="hljs-params">fn, delay, immediate = <span class="hljs-literal">false</span></span>) &#123;</span><span class="language-javascript">        <span class="hljs-comment">// è®°å½•ä¸Šä¸€æ¬¡çš„timer</span></span><span class="language-javascript">        <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        <span class="hljs-comment">// è®°å½•æ˜¯å¦éœ€è¦ç¬¬ä¸€æ¬¡æ˜¯å¦æ‰§è¡Œå’Œimmediateé…åˆ</span></span><span class="language-javascript">        <span class="hljs-keyword">let</span> isInvoke = <span class="hljs-literal">false</span>;</span><span class="language-javascript">        <span class="hljs-comment">// è¿”å›éœ€è¦æ‰§è¡Œçš„å‡½æ•°</span></span><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">_debounce</span>(<span class="hljs-params">...args</span>) &#123;</span><span class="language-javascript">          <span class="hljs-comment">//é¢‘ç¹è§¦å‘æ‰§è¡Œéƒ½ä¼šå…ˆæ¸…é™¤ä¸Šä¸€æ¬¡çš„timer</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">          <span class="hljs-comment">// å½“immediateä¸ºtrueæ—¶</span></span><span class="language-javascript">          <span class="hljs-keyword">if</span> (immediate &amp;&amp; !isInvoke) &#123;</span><span class="language-javascript">            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">            isInvoke = <span class="hljs-literal">true</span>;</span><span class="language-javascript">            <span class="hljs-keyword">return</span>;</span><span class="language-javascript">          &#125;</span><span class="language-javascript"></span><span class="language-javascript">          timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">            timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ‰§è¡Œè¿‡å‡½æ•°ä¹‹å, å°†timeré‡æ–°ç½®null</span></span><span class="language-javascript">            isInvoke = <span class="hljs-literal">false</span>; <span class="hljs-comment">//é‡ç½®</span></span><span class="language-javascript">          &#125;, delay);</span><span class="language-javascript">        &#125;</span><span class="language-javascript">        <span class="hljs-comment">// å–æ¶ˆåŠŸèƒ½</span></span><span class="language-javascript">        _debounce.<span class="hljs-property">cancel</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;button&quot;</span>);</span><span class="language-javascript">          timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">        <span class="hljs-keyword">return</span> _debounce;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      <span class="hljs-keyword">const</span> buttonEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;button&quot;</span>);</span><span class="language-javascript">      <span class="hljs-keyword">const</span> debounce = <span class="hljs-title function_">mydebounce</span>(</span><span class="language-javascript">        <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-variable language_">this</span>, <span class="hljs-string">&quot;----------&quot;</span>);</span><span class="language-javascript">        &#125;,</span><span class="language-javascript">        <span class="hljs-number">3000</span>,</span><span class="language-javascript">        <span class="hljs-literal">true</span></span><span class="language-javascript">      );</span><span class="language-javascript"></span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = debounce;</span><span class="language-javascript"></span><span class="language-javascript">      buttonEl.<span class="hljs-property">onclick</span> = debounce.<span class="hljs-property">cancel</span>;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><h4 id="è·å–è¿”å›å€¼çš„å®ç°"><a href="#è·å–è¿”å›å€¼çš„å®ç°" class="headerlink" title="è·å–è¿”å›å€¼çš„å®ç°"></a>è·å–è¿”å›å€¼çš„å®ç°</h4><p>è·å–è¿”å›å€¼çš„æ–¹å¼æœ‰ä¸¤ç§</p><p>ä¼ å…¥å›è°ƒå‡½æ•°</p><p>é€šè¿‡promise.thenæ¥è·å–</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>å–æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">mydebounce</span>(<span class="hljs-params"></span></span><span class="hljs-params"><span class="language-javascript">        fn,</span></span><span class="hljs-params"><span class="language-javascript">        delay,</span></span><span class="hljs-params"><span class="language-javascript">        immediate = <span class="hljs-literal">false</span>,</span></span><span class="hljs-params"><span class="language-javascript">        resultCallback = () =&gt; &#123;&#125;</span></span><span class="hljs-params"><span class="language-javascript">      </span>) &#123;</span><span class="language-javascript">        <span class="hljs-comment">// è®°å½•ä¸Šä¸€æ¬¡çš„timer</span></span><span class="language-javascript">        <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">        <span class="hljs-comment">// è®°å½•æ˜¯å¦éœ€è¦ç¬¬ä¸€æ¬¡æ˜¯å¦æ‰§è¡Œå’Œimmediateé…åˆ</span></span><span class="language-javascript">        <span class="hljs-keyword">let</span> isInvoke = <span class="hljs-literal">false</span>;</span><span class="language-javascript">        <span class="hljs-comment">// è¿”å›éœ€è¦æ‰§è¡Œçš„å‡½æ•°</span></span><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">_debounce</span>(<span class="hljs-params">...args</span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><span class="language-javascript">            <span class="hljs-keyword">try</span> &#123;</span><span class="language-javascript">              <span class="hljs-comment">//é¢‘ç¹è§¦å‘æ‰§è¡Œéƒ½ä¼šå…ˆæ¸…é™¤ä¸Šä¸€æ¬¡çš„timer</span></span><span class="language-javascript">              <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">              <span class="hljs-comment">// å½“immediateä¸ºtrueæ—¶</span></span><span class="language-javascript">              <span class="hljs-keyword">if</span> (immediate &amp;&amp; !isInvoke) &#123;</span><span class="language-javascript">                <span class="hljs-keyword">const</span> result = fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">                <span class="hljs-title function_">resultCallback</span>(result);</span><span class="language-javascript">                <span class="hljs-title function_">resolve</span>(result);</span><span class="language-javascript">                isInvoke = <span class="hljs-literal">true</span>;</span><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><span class="language-javascript">              &#125;</span><span class="language-javascript"></span><span class="language-javascript">              timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">                <span class="hljs-keyword">const</span> result = fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);</span><span class="language-javascript">                <span class="hljs-title function_">resultCallback</span>(result);</span><span class="language-javascript">                <span class="hljs-title function_">resolve</span>(result);</span><span class="language-javascript">                timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ‰§è¡Œè¿‡å‡½æ•°ä¹‹å, å°†timeré‡æ–°ç½®null</span></span><span class="language-javascript">                isInvoke = <span class="hljs-literal">false</span>; <span class="hljs-comment">//é‡ç½®</span></span><span class="language-javascript">              &#125;, delay);</span><span class="language-javascript">            &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span><span class="language-javascript">              <span class="hljs-title function_">reject</span>(error);</span><span class="language-javascript">            &#125;</span><span class="language-javascript">          &#125;);</span><span class="language-javascript">        &#125;</span><span class="language-javascript">        <span class="hljs-comment">// å–æ¶ˆåŠŸèƒ½</span></span><span class="language-javascript">        _debounce.<span class="hljs-property">cancel</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;button&quot;</span>);</span><span class="language-javascript">          timer = <span class="hljs-literal">null</span>;</span><span class="language-javascript">          isInvoke = <span class="hljs-literal">false</span>;</span><span class="language-javascript">        &#125;;</span><span class="language-javascript">        <span class="hljs-keyword">return</span> _debounce;</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-keyword">const</span> inputEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;input&quot;</span>);</span><span class="language-javascript">      <span class="hljs-keyword">const</span> buttonEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;button&quot;</span>);</span><span class="language-javascript">      <span class="hljs-keyword">const</span> debounce = <span class="hljs-title function_">mydebounce</span>(</span><span class="language-javascript">        <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;</span><span class="language-javascript">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-variable language_">this</span>, <span class="hljs-string">&quot;----------&quot;</span>);</span><span class="language-javascript">        &#125;,</span><span class="language-javascript">        <span class="hljs-number">3000</span>,</span><span class="language-javascript">        <span class="hljs-literal">true</span></span><span class="language-javascript">      );</span><span class="language-javascript"></span><span class="language-javascript">      inputEl.<span class="hljs-property">oninput</span> = debounce;</span><span class="language-javascript"></span><span class="language-javascript">      buttonEl.<span class="hljs-property">onclick</span> = debounce.<span class="hljs-property">cancel</span>;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è‡ªå®šä¹‰äº‹ä»¶æ€»çº¿</title>
    <link href="/2022/09/05/%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF/"/>
    <url>/2022/09/05/%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs HTML"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-btn&quot;</span>&gt;</span>nav button<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript"></span><span class="language-javascript">    <span class="hljs-comment">// ç±»EventBus -&gt; äº‹ä»¶æ€»çº¿å¯¹è±¡</span></span><span class="language-javascript">    <span class="hljs-keyword">class</span> <span class="hljs-title class_">HYEventBus</span> &#123;</span><span class="language-javascript">      <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventMap</span> = &#123;&#125;</span><span class="language-javascript">      &#125;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, eventFn</span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> eventFns = <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventMap</span>[eventName]</span><span class="language-javascript">        <span class="hljs-keyword">if</span> (!eventFns) &#123;</span><span class="language-javascript">          eventFns = []</span><span class="language-javascript">          <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventMap</span>[eventName] = eventFns</span><span class="language-javascript">        &#125;</span><span class="language-javascript">        eventFns.<span class="hljs-title function_">push</span>(eventFn)</span><span class="language-javascript">      &#125;</span><span class="language-javascript">      </span><span class="language-javascript">      <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, eventFn</span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> eventFns = <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventMap</span>[eventName]</span><span class="language-javascript">        <span class="hljs-keyword">if</span> (!eventFns) <span class="hljs-keyword">return</span></span><span class="language-javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; eventFns.<span class="hljs-property">length</span>; i++) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">const</span> fn = eventFns[i]</span><span class="language-javascript">          <span class="hljs-keyword">if</span> (fn === eventFn) &#123;</span><span class="language-javascript">            eventFns.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>)</span><span class="language-javascript">            <span class="hljs-keyword">break</span></span><span class="language-javascript">          &#125;</span><span class="language-javascript">        &#125;</span><span class="language-javascript"></span><span class="language-javascript">        <span class="hljs-comment">// å¦‚æœeventFnså·²ç»æ¸…ç©ºäº†</span></span><span class="language-javascript">        <span class="hljs-keyword">if</span> (eventFns.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) &#123;</span><span class="language-javascript">          <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventMap</span>[eventName]</span><span class="language-javascript">        &#125;</span><span class="language-javascript">      &#125;</span><span class="language-javascript"></span><span class="language-javascript">      <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) &#123;</span><span class="language-javascript">        <span class="hljs-keyword">let</span> eventFns = <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventMap</span>[eventName]</span><span class="language-javascript">        <span class="hljs-keyword">if</span> (!eventFns) <span class="hljs-keyword">return</span></span><span class="language-javascript">        eventFns.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> &#123;</span><span class="language-javascript">          <span class="hljs-title function_">fn</span>(...args)</span><span class="language-javascript">        &#125;)</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    &#125;</span><span class="language-javascript"></span><span class="language-javascript"></span><span class="language-javascript">    <span class="hljs-comment">// ä½¿ç”¨è¿‡ç¨‹</span></span><span class="language-javascript">    <span class="hljs-keyword">const</span> eventBus = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HYEventBus</span>()</span><span class="language-javascript"></span><span class="language-javascript">    <span class="hljs-comment">// aside.vueç»„ä»¶ä¸­ç›‘å¬äº‹ä»¶</span></span><span class="language-javascript">    eventBus.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;navclick&quot;</span>, <span class="hljs-function">(<span class="hljs-params">name, age, height</span>) =&gt;</span> &#123;</span><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;navclick listener 01&quot;</span>, name, age, height)</span><span class="language-javascript">    &#125;)</span><span class="language-javascript"></span><span class="language-javascript">    <span class="hljs-keyword">const</span> <span class="hljs-title function_">click</span> =  (<span class="hljs-params"></span>) =&gt; &#123;</span><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;navclick listener 02&quot;</span>)</span><span class="language-javascript">    &#125;</span><span class="language-javascript">    eventBus.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;navclick&quot;</span>, click)</span><span class="language-javascript"></span><span class="language-javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">      eventBus.<span class="hljs-title function_">off</span>(<span class="hljs-string">&quot;navclick&quot;</span>, click)</span><span class="language-javascript">    &#125;, <span class="hljs-number">5000</span>);</span><span class="language-javascript"></span><span class="language-javascript">    eventBus.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;asideclick&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;</span><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;asideclick listener&quot;</span>)</span><span class="language-javascript">    &#125;)</span><span class="language-javascript"></span><span class="language-javascript"></span><span class="language-javascript">    <span class="hljs-comment">// nav.vue</span></span><span class="language-javascript">    <span class="hljs-keyword">const</span> navBtnEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.nav-btn&quot;</span>)</span><span class="language-javascript">    navBtnEl.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;è‡ªå·±ç›‘å¬åˆ°&quot;</span>)</span><span class="language-javascript">      eventBus.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;navclick&quot;</span>, <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-number">18</span>, <span class="hljs-number">1.88</span>)</span><span class="language-javascript">    &#125;</span><span class="language-javascript"></span><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å“åº”å¼åŸç†çš„å®ç°</title>
    <link href="/2022/09/05/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/09/05/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="ä»€ä¹ˆæ˜¯å“åº”å¼"><a href="#ä»€ä¹ˆæ˜¯å“åº”å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯å“åº”å¼"></a>ä»€ä¹ˆæ˜¯å“åº”å¼</h4><p>å“åº”å¼å°±æ˜¯å½“å¯¹è±¡ä¸­çš„å±æ€§å‘ç”Ÿæ›´æ”¹çš„æ—¶å€™ï¼Œä¾èµ–è¯¥å±æ€§çš„å‡½æ•°ä¹Ÿä¼šé‡æ–°æ‰§è¡Œ</p><h4 id="å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•°"><a href="#å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•°" class="headerlink" title="å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•°"></a>å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•°</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå®¹å™¨æ¥æ”¶é›†ä¾èµ–</span><span class="hljs-keyword">const</span> reactiveFns = [];<span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªæ”¶é›†ä¾èµ–çš„å‡½æ•°</span><span class="hljs-keyword">const</span> <span class="hljs-title function_">watchFn</span> = (<span class="hljs-params">fn</span>) =&gt; &#123;  reactiveFns.<span class="hljs-title function_">push</span>(fn);&#125;;<span class="hljs-comment">// å¯¹è±¡çš„å“åº”å¼</span><span class="hljs-keyword">const</span> obj = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>,  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,&#125;;<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">const</span> newName = obj.<span class="hljs-property">name</span>;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hello World&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">name</span>); <span class="hljs-comment">// 100è¡Œ</span>&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">name</span>, <span class="hljs-string">&quot;demo function -------&quot;</span>);&#125;);<span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;æ™®é€šçš„å…¶ä»–å‡½æ•°&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;è¿™ä¸ªå‡½æ•°ä¸éœ€è¦æœ‰ä»»ä½•å“åº”å¼&quot;</span>);&#125;obj.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;kobe&quot;</span>;<span class="hljs-comment">// å½“æ•°æ®å˜åŒ–çš„æ—¶å€™ï¼Œæ‰§è¡Œå¯¹åº”çš„å‡½æ•°</span>reactiveFns.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;  <span class="hljs-title function_">fn</span>();&#125;);</code></pre></div><h4 id="ä¾èµ–æ”¶é›†ç±»çš„å°è£…"><a href="#ä¾èµ–æ”¶é›†ç±»çš„å°è£…" class="headerlink" title="ä¾èµ–æ”¶é›†ç±»çš„å°è£…"></a>ä¾èµ–æ”¶é›†ç±»çš„å°è£…</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Depend</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// ä¾èµ–æ”¶é›†å®¹å™¨</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span> = [];  &#125;  <span class="hljs-comment">// ä¾èµ–æ”¶é›†çš„æ–¹æ³•</span>  <span class="hljs-title function_">addDepend</span>(<span class="hljs-params">fn</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">push</span>(fn);  &#125;  <span class="hljs-comment">// æ›´æ–°æ–¹æ³•</span>  <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;      <span class="hljs-title function_">fn</span>();    &#125;);  &#125;&#125;<span class="hljs-keyword">const</span> depend = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Depend</span>();<span class="hljs-keyword">function</span> <span class="hljs-title function_">watchFn</span>(<span class="hljs-params">fn</span>) &#123;  depend.<span class="hljs-title function_">addDepend</span>(fn);&#125;<span class="hljs-comment">// å¯¹è±¡çš„å“åº”å¼</span><span class="hljs-keyword">const</span> obj = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>&#125;;<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">const</span> newName = obj.<span class="hljs-property">name</span>;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hello World&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">name</span>); <span class="hljs-comment">// 100è¡Œ</span>&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">name</span>, <span class="hljs-string">&quot;demo function -------&quot;</span>);&#125;);obj.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;kobe&quot;</span>;depend.<span class="hljs-title function_">notify</span>();</code></pre></div><h4 id="è‡ªåŠ¨ç›‘å¬å¯¹è±¡çš„å˜åŒ–"><a href="#è‡ªåŠ¨ç›‘å¬å¯¹è±¡çš„å˜åŒ–" class="headerlink" title="è‡ªåŠ¨ç›‘å¬å¯¹è±¡çš„å˜åŒ–"></a>è‡ªåŠ¨ç›‘å¬å¯¹è±¡çš„å˜åŒ–</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Depend</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// ä¾èµ–æ”¶é›†å®¹å™¨</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span> = [];  &#125;  <span class="hljs-comment">// ä¾èµ–æ”¶é›†çš„æ–¹æ³•</span>  <span class="hljs-title function_">addDepend</span>(<span class="hljs-params">fn</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">push</span>(fn);  &#125;  <span class="hljs-comment">// æ›´æ–°æ–¹æ³•</span>  <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;      <span class="hljs-title function_">fn</span>();    &#125;);  &#125;&#125;<span class="hljs-keyword">const</span> depend = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Depend</span>();<span class="hljs-keyword">function</span> <span class="hljs-title function_">watchFn</span>(<span class="hljs-params">fn</span>) &#123;  depend.<span class="hljs-title function_">addDepend</span>(fn);&#125;<span class="hljs-comment">// å¯¹è±¡çš„å“åº”å¼</span><span class="hljs-keyword">const</span> obj = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>&#125;;<span class="hljs-comment">// è‡ªåŠ¨ç›‘å¬å¯¹è±¡ä¸­å±æ€§çš„å˜åŒ–vue2-&gt;Object.defineProperty,vue3-&gt;Proxy</span><span class="hljs-keyword">const</span> objProxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(obj, &#123;  <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key, receiver</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);  &#125;,  <span class="hljs-comment">// receiverå°±æ˜¯objProxy</span>  <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, newValue, receiver</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, key, newValue, receiver);  &#125;,&#125;);<span class="hljs-comment">// ä½¿ç”¨å¯¹è±¡ä»£ç†çš„æ–¹å¼å»æ“ä½œå¯¹è±¡ï¼Œä¸è¦ç›´æ¥æ“ä½œå¯¹è±¡</span><span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">const</span> newName = objProxy.<span class="hljs-property">name</span>;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hello World&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">name</span>); <span class="hljs-comment">// 100è¡Œ</span>&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">name</span>, <span class="hljs-string">&quot;demo function -------&quot;</span>);&#125;);objProxy.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;kobe&quot;</span>;depend.<span class="hljs-title function_">notify</span>();</code></pre></div><h4 id="ä¾èµ–æ”¶é›†çš„ç®¡ç†"><a href="#ä¾èµ–æ”¶é›†çš„ç®¡ç†" class="headerlink" title="ä¾èµ–æ”¶é›†çš„ç®¡ç†"></a>ä¾èµ–æ”¶é›†çš„ç®¡ç†</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Depend</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// ä¾èµ–æ”¶é›†å®¹å™¨</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span> = [];  &#125;  <span class="hljs-comment">// ä¾èµ–æ”¶é›†çš„æ–¹æ³•</span>  <span class="hljs-title function_">addDepend</span>(<span class="hljs-params">fn</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">push</span>(fn);  &#125;  <span class="hljs-comment">// æ›´æ–°æ–¹æ³•</span>  <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (fn) &#123;        <span class="hljs-title function_">fn</span>();      &#125;    &#125;);  &#125;&#125;<span class="hljs-comment">// ç›®çš„æ˜¯å°†fnå…ˆå­˜èµ·æ¥åœ¨getä¸­ä½¿ç”¨ï¼Œå°±æ˜¯åœ¨getä¸­è¿›è¡Œä¾èµ–æ”¶é›†</span><span class="hljs-keyword">let</span> activeReactiveFn = <span class="hljs-literal">null</span>;<span class="hljs-keyword">function</span> <span class="hljs-title function_">watchFn</span>(<span class="hljs-params">fn</span>) &#123;  activeReactiveFn = fn;  <span class="hljs-comment">// å…ˆæ‰§è¡Œä¸€æ¬¡è§¦å‘getè¿›è¡Œä¾èµ–æ”¶é›†</span>  <span class="hljs-title function_">fn</span>();  <span class="hljs-comment">// å°†ç½®ä¸ºnull</span>  activeReactiveFn = <span class="hljs-literal">null</span>;&#125;<span class="hljs-comment">// å°è£…ä¸€ä¸ªdependå‡½æ•°ï¼Œå¯¹å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå±æ€§è¿›è¡Œä¾èµ–æ”¶é›†ç®¡ç†</span><span class="hljs-keyword">const</span> targetMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>(); <span class="hljs-comment">//ä½¿ç”¨WeakMapå¯ä»¥è®©æ²¡æœ‰è¢«å¼•ç”¨äº†çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶åŠæ—¶å›æ”¶æ‰ï¼Œå› ä¸ºweakMapæ˜¯å¼±å¼•ç”¨ï¼Œå¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">getDepend</span>(<span class="hljs-params">target, key</span>) &#123;  <span class="hljs-comment">// æ ¹æ®targetå¯¹è±¡è·å–mapçš„è¿‡ç¨‹</span>  <span class="hljs-keyword">let</span> map = targetMap.<span class="hljs-title function_">get</span>(target); <span class="hljs-comment">//è·å–å¯¹åº”çš„å¯¹è±¡çš„æ˜ å°„</span>  <span class="hljs-keyword">if</span> (!map) &#123;    map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();    targetMap.<span class="hljs-title function_">set</span>(target, map);  &#125;  <span class="hljs-keyword">let</span> depend = map.<span class="hljs-title function_">get</span>(key);  <span class="hljs-keyword">if</span> (!depend) &#123;    depend = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Depend</span>();    map.<span class="hljs-title function_">set</span>(key, depend);  &#125;  <span class="hljs-keyword">return</span> depend;&#125;<span class="hljs-comment">// å¯¹è±¡çš„å“åº”å¼</span><span class="hljs-keyword">const</span> obj = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>&#125;;<span class="hljs-comment">// è‡ªåŠ¨ç›‘å¬å¯¹è±¡ä¸­å±æ€§çš„å˜åŒ–vue2-&gt;Object.defineProperty,vue3-&gt;Proxy</span><span class="hljs-keyword">const</span> objProxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(obj, &#123;  <span class="hljs-comment">// receiver è¡¨ç¤ºå½“å‰çš„proxy,å°†receiverä¼ å…¥è¡¨ç¤ºå½“å‰proxy,åœ¨å¯¹å¯¹è±¡ç›´æ¥æ“ä½œçš„æ—¶å€™å¯ä»¥åŒæ ·å¯¹å…¶è¿›è¡Œç›‘å¬get/setè¿›è¡Œä»¥ä¸‹æ“ä½œ</span>  <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key, receiver</span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(receiver === objProxy)<span class="hljs-comment">//true</span>    <span class="hljs-comment">// åœ¨getä¸­è·å–å¯¹åº”çš„depend</span>    <span class="hljs-keyword">const</span> depend = <span class="hljs-title function_">getDepend</span>(target, key);    <span class="hljs-comment">// ç»™dependæ·»åŠ å“åº”å‡½æ•°</span>    depend.<span class="hljs-title function_">addDepend</span>(activeReactiveFn);    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);  &#125;,  <span class="hljs-comment">// receiverå°±æ˜¯objProxy</span>  <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, newValue, receiver</span>) &#123;    <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, key, newValue, receiver);    <span class="hljs-keyword">const</span> depend = <span class="hljs-title function_">getDepend</span>(target, key);    depend.<span class="hljs-title function_">notify</span>();  &#125;,&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">const</span> newName = objProxy.<span class="hljs-property">name</span>;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hello World&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">name</span>); <span class="hljs-comment">// 100è¡Œ</span>&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">name</span>, <span class="hljs-string">&quot;demo function -------&quot;</span>);&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">age</span>, <span class="hljs-string">&quot;age å‘ç”Ÿå˜åŒ–æ˜¯éœ€è¦æ‰§è¡Œçš„----1&quot;</span>);&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">age</span>, <span class="hljs-string">&quot;age å‘ç”Ÿå˜åŒ–æ˜¯éœ€è¦æ‰§è¡Œçš„----2&quot;</span>);&#125;);objProxy.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;kobe&quot;</span>;objProxy.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;james&quot;</span>;objProxy.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;curry&quot;</span>;objProxy.<span class="hljs-property">age</span> = <span class="hljs-number">100</span>;<span class="hljs-keyword">const</span> info = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;kobe&quot;</span>,  <span class="hljs-attr">address</span>: <span class="hljs-string">&quot;å¹¿å·å¸‚&quot;</span>,&#125;;<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(info.<span class="hljs-property">address</span>, <span class="hljs-string">&quot;ç›‘å¬addresså˜åŒ–+++++++++1&quot;</span>);&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(info.<span class="hljs-property">address</span>, <span class="hljs-string">&quot;ç›‘å¬addresså˜åŒ–+++++++++2&quot;</span>);&#125;);</code></pre></div><h4 id="é‡æ„Depend"><a href="#é‡æ„Depend" class="headerlink" title="é‡æ„Depend"></a>é‡æ„Depend</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ç›®çš„æ˜¯å°†fnå…ˆå­˜èµ·æ¥åœ¨getä¸­ä½¿ç”¨ï¼Œå°±æ˜¯åœ¨getä¸­è¿›è¡Œä¾èµ–æ”¶é›†</span><span class="hljs-keyword">let</span> activeReactiveFn = <span class="hljs-literal">null</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Depend</span> &#123;  <span class="hljs-comment">/**</span><span class="hljs-comment">   * Dependä¼˜åŒ–:</span><span class="hljs-comment">   *  1&gt; dependæ–¹æ³•</span><span class="hljs-comment">   *  2&gt; ä½¿ç”¨Setæ¥ä¿å­˜ä¾èµ–å‡½æ•°, è€Œä¸æ˜¯æ•°ç»„[]</span><span class="hljs-comment">   */</span>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// ä¾èµ–æ”¶é›†å®¹å™¨</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();  &#125;  <span class="hljs-comment">// ä¾èµ–æ”¶é›†çš„æ–¹æ³•</span>  <span class="hljs-title function_">depend</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (activeReactiveFn) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">add</span>(activeReactiveFn);    &#125;  &#125;  <span class="hljs-comment">// æ›´æ–°æ–¹æ³•</span>  <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (fn) &#123;        <span class="hljs-title function_">fn</span>();      &#125;    &#125;);  &#125;&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">watchFn</span>(<span class="hljs-params">fn</span>) &#123;  activeReactiveFn = fn;  <span class="hljs-comment">// å…ˆæ‰§è¡Œä¸€æ¬¡è§¦å‘getè¿›è¡Œä¾èµ–æ”¶é›†</span>  <span class="hljs-title function_">fn</span>();  <span class="hljs-comment">// å°†ç½®ä¸ºnull</span>  activeReactiveFn = <span class="hljs-literal">null</span>;&#125;<span class="hljs-comment">// å°è£…ä¸€ä¸ªdependå‡½æ•°ï¼Œå¯¹å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå±æ€§è¿›è¡Œä¾èµ–æ”¶é›†ç®¡ç†</span><span class="hljs-keyword">const</span> targetMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>(); <span class="hljs-comment">//ä½¿ç”¨WeakMapå¯ä»¥è®©æ²¡æœ‰è¢«å¼•ç”¨äº†çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶åŠæ—¶å›æ”¶æ‰ï¼Œå› ä¸ºweakMapæ˜¯å¼±å¼•ç”¨ï¼Œå¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">getDepend</span>(<span class="hljs-params">target, key</span>) &#123;  <span class="hljs-comment">// æ ¹æ®targetå¯¹è±¡è·å–mapçš„è¿‡ç¨‹</span>  <span class="hljs-keyword">let</span> map = targetMap.<span class="hljs-title function_">get</span>(target); <span class="hljs-comment">//è·å–å¯¹åº”çš„å¯¹è±¡çš„æ˜ å°„</span>  <span class="hljs-keyword">if</span> (!map) &#123;    map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();    targetMap.<span class="hljs-title function_">set</span>(target, map);  &#125;  <span class="hljs-keyword">let</span> depend = map.<span class="hljs-title function_">get</span>(key);  <span class="hljs-keyword">if</span> (!depend) &#123;    depend = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Depend</span>();    map.<span class="hljs-title function_">set</span>(key, depend);  &#125;  <span class="hljs-keyword">return</span> depend;&#125;<span class="hljs-comment">// å¯¹è±¡çš„å“åº”å¼</span><span class="hljs-keyword">const</span> obj = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>&#125;;<span class="hljs-comment">// è‡ªåŠ¨ç›‘å¬å¯¹è±¡ä¸­å±æ€§çš„å˜åŒ–vue2-&gt;Object.defineProperty,vue3-&gt;Proxy</span><span class="hljs-keyword">const</span> objProxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(obj, &#123;  <span class="hljs-comment">// receiver è¡¨ç¤ºå½“å‰çš„proxy,å°†receiverä¼ å…¥è¡¨ç¤ºå½“å‰proxy,åœ¨å¯¹å¯¹è±¡ç›´æ¥æ“ä½œçš„æ—¶å€™å¯ä»¥åŒæ ·å¯¹å…¶è¿›è¡Œç›‘å¬get/setè¿›è¡Œä»¥ä¸‹æ“ä½œ</span>  <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key, receiver</span>) &#123;    <span class="hljs-comment">// åœ¨getä¸­è·å–å¯¹åº”çš„depend</span>    <span class="hljs-keyword">const</span> depend = <span class="hljs-title function_">getDepend</span>(target, key);    <span class="hljs-comment">// ç»™dependæ·»åŠ å“åº”å‡½æ•°</span>    depend.<span class="hljs-title function_">depend</span>();    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);  &#125;,  <span class="hljs-comment">// receiverå°±æ˜¯objProxy</span>  <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, newValue, receiver</span>) &#123;    <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, key, newValue, receiver);    <span class="hljs-keyword">const</span> depend = <span class="hljs-title function_">getDepend</span>(target, key);    depend.<span class="hljs-title function_">notify</span>();  &#125;,&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">const</span> newName = objProxy.<span class="hljs-property">name</span>;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hello World&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">name</span>); <span class="hljs-comment">// 100è¡Œ</span>&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">name</span>, <span class="hljs-string">&quot;demo function -------&quot;</span>);&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">age</span>, <span class="hljs-string">&quot;age å‘ç”Ÿå˜åŒ–æ˜¯éœ€è¦æ‰§è¡Œçš„----1&quot;</span>);&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(objProxy.<span class="hljs-property">age</span>, <span class="hljs-string">&quot;age å‘ç”Ÿå˜åŒ–æ˜¯éœ€è¦æ‰§è¡Œçš„----2&quot;</span>);&#125;);objProxy.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;kobe&quot;</span>;objProxy.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;james&quot;</span>;objProxy.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;curry&quot;</span>;objProxy.<span class="hljs-property">age</span> = <span class="hljs-number">100</span>;<span class="hljs-keyword">const</span> info = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;kobe&quot;</span>,  <span class="hljs-attr">address</span>: <span class="hljs-string">&quot;å¹¿å·å¸‚&quot;</span>,&#125;;<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(info.<span class="hljs-property">address</span>, <span class="hljs-string">&quot;ç›‘å¬addresså˜åŒ–+++++++++1&quot;</span>);&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(info.<span class="hljs-property">address</span>, <span class="hljs-string">&quot;ç›‘å¬addresså˜åŒ–+++++++++2&quot;</span>);&#125;);</code></pre></div><h4 id="vue3å¯¹è±¡çš„å“åº”å¼æ“ä½œ"><a href="#vue3å¯¹è±¡çš„å“åº”å¼æ“ä½œ" class="headerlink" title="vue3å¯¹è±¡çš„å“åº”å¼æ“ä½œ"></a>vue3å¯¹è±¡çš„å“åº”å¼æ“ä½œ</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ç›®çš„æ˜¯å°†fnå…ˆå­˜èµ·æ¥åœ¨getä¸­ä½¿ç”¨ï¼Œå°±æ˜¯åœ¨getä¸­è¿›è¡Œä¾èµ–æ”¶é›†</span><span class="hljs-keyword">let</span> activeReactiveFn = <span class="hljs-literal">null</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Depend</span> &#123;  <span class="hljs-comment">/**</span><span class="hljs-comment">   * Dependä¼˜åŒ–:</span><span class="hljs-comment">   *  1&gt; dependæ–¹æ³•</span><span class="hljs-comment">   *  2&gt; ä½¿ç”¨Setæ¥ä¿å­˜ä¾èµ–å‡½æ•°, è€Œä¸æ˜¯æ•°ç»„[]</span><span class="hljs-comment">   */</span>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// ä¾èµ–æ”¶é›†å®¹å™¨</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();  &#125;  <span class="hljs-comment">// ä¾èµ–æ”¶é›†çš„æ–¹æ³•</span>  <span class="hljs-title function_">depend</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (activeReactiveFn) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">add</span>(activeReactiveFn);    &#125;  &#125;  <span class="hljs-comment">// æ›´æ–°æ–¹æ³•</span>  <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (fn) &#123;        <span class="hljs-title function_">fn</span>();      &#125;    &#125;);  &#125;&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">watchFn</span>(<span class="hljs-params">fn</span>) &#123;  activeReactiveFn = fn;  <span class="hljs-comment">// å…ˆæ‰§è¡Œä¸€æ¬¡è§¦å‘getè¿›è¡Œä¾èµ–æ”¶é›†</span>  <span class="hljs-title function_">fn</span>();  <span class="hljs-comment">// å°†ç½®ä¸ºnull</span>  activeReactiveFn = <span class="hljs-literal">null</span>;&#125;<span class="hljs-comment">// å°è£…ä¸€ä¸ªdependå‡½æ•°ï¼Œå¯¹å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå±æ€§è¿›è¡Œä¾èµ–æ”¶é›†ç®¡ç†</span><span class="hljs-keyword">const</span> targetMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>(); <span class="hljs-comment">//ä½¿ç”¨WeakMapå¯ä»¥è®©æ²¡æœ‰è¢«å¼•ç”¨äº†çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶åŠæ—¶å›æ”¶æ‰ï¼Œå› ä¸ºweakMapæ˜¯å¼±å¼•ç”¨ï¼Œå¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">getDepend</span>(<span class="hljs-params">target, key</span>) &#123;  <span class="hljs-comment">// æ ¹æ®targetå¯¹è±¡è·å–mapçš„è¿‡ç¨‹</span>  <span class="hljs-keyword">let</span> map = targetMap.<span class="hljs-title function_">get</span>(target); <span class="hljs-comment">//è·å–å¯¹åº”çš„å¯¹è±¡çš„æ˜ å°„</span>  <span class="hljs-keyword">if</span> (!map) &#123;    map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();    targetMap.<span class="hljs-title function_">set</span>(target, map);  &#125;  <span class="hljs-keyword">let</span> depend = map.<span class="hljs-title function_">get</span>(key);  <span class="hljs-keyword">if</span> (!depend) &#123;    depend = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Depend</span>();    map.<span class="hljs-title function_">set</span>(key, depend);  &#125;  <span class="hljs-keyword">return</span> depend;&#125;<span class="hljs-comment">// å¯¹è±¡çš„å“åº”å¼</span><span class="hljs-keyword">const</span> obj = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>&#125;;<span class="hljs-comment">// è‡ªåŠ¨ç›‘å¬å¯¹è±¡ä¸­å±æ€§çš„å˜åŒ–vue2-&gt;Object.defineProperty,vue3-&gt;Proxy</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">reactive</span>(<span class="hljs-params">obj</span>) &#123;  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(obj, &#123;    <span class="hljs-comment">// receiver è¡¨ç¤ºå½“å‰çš„proxy,å°†receiverä¼ å…¥è¡¨ç¤ºå½“å‰proxy,åœ¨å¯¹å¯¹è±¡ç›´æ¥æ“ä½œçš„æ—¶å€™å¯ä»¥åŒæ ·å¯¹å…¶è¿›è¡Œç›‘å¬get/setè¿›è¡Œä»¥ä¸‹æ“ä½œ</span>    <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key, receiver</span>) &#123;      <span class="hljs-comment">// åœ¨getä¸­è·å–å¯¹åº”çš„depend</span>      <span class="hljs-keyword">const</span> depend = <span class="hljs-title function_">getDepend</span>(target, key);      <span class="hljs-comment">// ç»™dependæ·»åŠ å“åº”å‡½æ•°</span>      depend.<span class="hljs-title function_">depend</span>();      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);    &#125;,    <span class="hljs-comment">// receiverå°±æ˜¯objProxy</span>    <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, newValue, receiver</span>) &#123;      <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, key, newValue, receiver);      <span class="hljs-keyword">const</span> depend = <span class="hljs-title function_">getDepend</span>(target, key);      depend.<span class="hljs-title function_">notify</span>();    &#125;,  &#125;);&#125;<span class="hljs-keyword">const</span> objProxy = <span class="hljs-title function_">reactive</span>(&#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>, <span class="hljs-comment">// dependå¯¹è±¡</span>&#125;);<span class="hljs-keyword">const</span> infoProxy = <span class="hljs-title function_">reactive</span>(&#123;  <span class="hljs-attr">address</span>: <span class="hljs-string">&quot;å¹¿å·å¸‚&quot;</span>,  <span class="hljs-attr">height</span>: <span class="hljs-number">1.88</span>,&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(infoProxy.<span class="hljs-property">address</span>);&#125;);infoProxy.<span class="hljs-property">address</span> = <span class="hljs-string">&quot;åŒ—äº¬å¸‚&quot;</span>;<span class="hljs-keyword">const</span> foo = <span class="hljs-title function_">reactive</span>(&#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;foo&quot;</span>,&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property">name</span>);&#125;);foo.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;bar&quot;</span>;</code></pre></div><h4 id="vue2å¯¹è±¡çš„å“åº”å¼æ“ä½œ"><a href="#vue2å¯¹è±¡çš„å“åº”å¼æ“ä½œ" class="headerlink" title="vue2å¯¹è±¡çš„å“åº”å¼æ“ä½œ"></a>vue2å¯¹è±¡çš„å“åº”å¼æ“ä½œ</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ç›®çš„æ˜¯å°†fnå…ˆå­˜èµ·æ¥åœ¨getä¸­ä½¿ç”¨ï¼Œå°±æ˜¯åœ¨getä¸­è¿›è¡Œä¾èµ–æ”¶é›†</span><span class="hljs-keyword">let</span> activeReactiveFn = <span class="hljs-literal">null</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Depend</span> &#123;  <span class="hljs-comment">/**</span><span class="hljs-comment">   * Dependä¼˜åŒ–:</span><span class="hljs-comment">   *  1&gt; dependæ–¹æ³•</span><span class="hljs-comment">   *  2&gt; ä½¿ç”¨Setæ¥ä¿å­˜ä¾èµ–å‡½æ•°, è€Œä¸æ˜¯æ•°ç»„[]</span><span class="hljs-comment">   */</span>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// ä¾èµ–æ”¶é›†å®¹å™¨</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();  &#125;  <span class="hljs-comment">// ä¾èµ–æ”¶é›†çš„æ–¹æ³•</span>  <span class="hljs-title function_">depend</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">if</span> (activeReactiveFn) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">add</span>(activeReactiveFn);    &#125;  &#125;  <span class="hljs-comment">// æ›´æ–°æ–¹æ³•</span>  <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (fn) &#123;        <span class="hljs-title function_">fn</span>();      &#125;    &#125;);  &#125;&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">watchFn</span>(<span class="hljs-params">fn</span>) &#123;  activeReactiveFn = fn;  <span class="hljs-comment">// å…ˆæ‰§è¡Œä¸€æ¬¡è§¦å‘getè¿›è¡Œä¾èµ–æ”¶é›†</span>  <span class="hljs-title function_">fn</span>();  <span class="hljs-comment">// å°†ç½®ä¸ºnull</span>  activeReactiveFn = <span class="hljs-literal">null</span>;&#125;<span class="hljs-comment">// å°è£…ä¸€ä¸ªdependå‡½æ•°ï¼Œå¯¹å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå±æ€§è¿›è¡Œä¾èµ–æ”¶é›†ç®¡ç†</span><span class="hljs-keyword">const</span> targetMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>(); <span class="hljs-comment">//ä½¿ç”¨WeakMapå¯ä»¥è®©æ²¡æœ‰è¢«å¼•ç”¨äº†çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶åŠæ—¶å›æ”¶æ‰ï¼Œå› ä¸ºweakMapæ˜¯å¼±å¼•ç”¨ï¼Œå¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">getDepend</span>(<span class="hljs-params">target, key</span>) &#123;  <span class="hljs-comment">// æ ¹æ®targetå¯¹è±¡è·å–mapçš„è¿‡ç¨‹</span>  <span class="hljs-keyword">let</span> map = targetMap.<span class="hljs-title function_">get</span>(target); <span class="hljs-comment">//è·å–å¯¹åº”çš„å¯¹è±¡çš„æ˜ å°„</span>  <span class="hljs-keyword">if</span> (!map) &#123;    map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();    targetMap.<span class="hljs-title function_">set</span>(target, map);  &#125;  <span class="hljs-keyword">let</span> depend = map.<span class="hljs-title function_">get</span>(key);  <span class="hljs-keyword">if</span> (!depend) &#123;    depend = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Depend</span>();    map.<span class="hljs-title function_">set</span>(key, depend);  &#125;  <span class="hljs-keyword">return</span> depend;&#125;<span class="hljs-comment">// è‡ªåŠ¨ç›‘å¬å¯¹è±¡ä¸­å±æ€§çš„å˜åŒ–vue2-&gt;Object.defineProperty,vue3-&gt;Proxy</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">reactive</span>(<span class="hljs-params">obj</span>) &#123;  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;    <span class="hljs-keyword">let</span> value = obj[key];    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, &#123;      <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">const</span> depend = <span class="hljs-title function_">getDepend</span>(obj, key);        depend.<span class="hljs-title function_">depend</span>();        <span class="hljs-keyword">return</span> value;      &#125;,      <span class="hljs-title function_">set</span>(<span class="hljs-params">newValue</span>) &#123;        value = newValue;        <span class="hljs-keyword">const</span> depend = <span class="hljs-title function_">getDepend</span>(obj, key);        depend.<span class="hljs-title function_">notify</span>();      &#125;,    &#125;);  &#125;);  <span class="hljs-keyword">return</span> obj;&#125;<span class="hljs-keyword">const</span> infoProxy = <span class="hljs-title function_">reactive</span>(&#123;  <span class="hljs-attr">address</span>: <span class="hljs-string">&quot;å¹¿å·å¸‚&quot;</span>,  <span class="hljs-attr">height</span>: <span class="hljs-number">1.88</span>,&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(infoProxy.<span class="hljs-property">address</span>);&#125;);infoProxy.<span class="hljs-property">address</span> = <span class="hljs-string">&quot;åŒ—äº¬å¸‚&quot;</span>;<span class="hljs-keyword">const</span> foo = <span class="hljs-title function_">reactive</span>(&#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;foo&quot;</span>,&#125;);<span class="hljs-title function_">watchFn</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property">name</span>);&#125;);foo.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;bar&quot;</span>;foo.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;hhh&quot;</span>;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>æœé›†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ•°ç»„è½¬æ¢æˆæ ‘å½¢è§£æ„</title>
    <link href="/2022/09/05/%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E6%88%90%E6%A0%91%E5%BD%A2%E8%A7%A3%E6%9E%84/"/>
    <url>/2022/09/05/%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E6%88%90%E6%A0%91%E5%BD%A2%E8%A7%A3%E6%9E%84/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°è‡ªåŠ¨æŸ¯é‡ŒåŒ–å‡½æ•°</title>
    <link href="/2022/09/05/%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E6%9F%AF%E9%87%8C%E5%8C%96%E5%87%BD%E6%95%B0/"/>
    <url>/2022/09/05/%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E6%9F%AF%E9%87%8C%E5%8C%96%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ·±æ‹·è´çš„å®ç°æ–¹å¼</title>
    <link href="/2022/09/05/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/"/>
    <url>/2022/09/05/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯å¯¹è±¡</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">isObject</span>(<span class="hljs-params">value</span>) &#123;  <span class="hljs-keyword">const</span> valueType = <span class="hljs-keyword">typeof</span> value;  <span class="hljs-keyword">return</span> value != <span class="hljs-literal">null</span> &amp;&amp; (valueType === <span class="hljs-string">&quot;object&quot;</span> || valueType === <span class="hljs-string">&quot;function&quot;</span>);&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">originValue</span>) &#123;   <span class="hljs-comment">// æ•°æ®ç±»å‹æ˜¯symbol</span>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> originValue === <span class="hljs-string">&quot;symbol&quot;</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Symbol</span>(originValue.<span class="hljs-property">description</span>);  &#125;  <span class="hljs-comment">// åŸå§‹æ•°æ®ç±»å‹ç›´æ¥è¿”å›</span>  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isObject</span>(originValue)) &#123;    <span class="hljs-keyword">return</span> originValue;  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯function</span>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> originValue === <span class="hljs-string">&quot;function&quot;</span>) &#123;    <span class="hljs-keyword">return</span> originValue;  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯setç±»å‹</span>  <span class="hljs-keyword">if</span> (originValue <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Set</span>) &#123;    <span class="hljs-keyword">const</span> newSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> originValue) &#123;      newSet.<span class="hljs-title function_">add</span>(<span class="hljs-title function_">deepClone</span>(item));    &#125;    <span class="hljs-keyword">return</span> newSet;  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯Mapç±»å‹</span>  <span class="hljs-keyword">if</span> (originValue <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Map</span>) &#123;    <span class="hljs-keyword">const</span> newMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> originValue) &#123;      newMap.<span class="hljs-title function_">set</span>(key, <span class="hljs-title function_">deepClone</span>(value));    &#125;  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯Array</span>  <span class="hljs-keyword">const</span> newOBj = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(originValue) ? [] : &#123;&#125;;  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> originValue) &#123;    newOBj[key] = <span class="hljs-title function_">deepClone</span>(originValue[key]);  &#125;  <span class="hljs-comment">// å•ç‹¬éå†Symbol</span>  <span class="hljs-keyword">const</span> symbolKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertySymbols</span>(originValue);  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> symbolKey <span class="hljs-keyword">of</span> symbolKeys) &#123;    newOBj[<span class="hljs-title class_">Symbol</span>(symbolKey.<span class="hljs-property">description</span>)] = <span class="hljs-title function_">deepClone</span>(originValue[symbolKey]);  &#125;  <span class="hljs-keyword">return</span> newOBj;&#125;</code></pre></div><h4 id="å½“æ‹·è´çš„å¯¹è±¡ä¸­å‡ºç°å¾ªç¯å¼•ç”¨æ—¶"><a href="#å½“æ‹·è´çš„å¯¹è±¡ä¸­å‡ºç°å¾ªç¯å¼•ç”¨æ—¶" class="headerlink" title="å½“æ‹·è´çš„å¯¹è±¡ä¸­å‡ºç°å¾ªç¯å¼•ç”¨æ—¶"></a>å½“æ‹·è´çš„å¯¹è±¡ä¸­å‡ºç°å¾ªç¯å¼•ç”¨æ—¶</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯å¯¹è±¡</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">isObject</span>(<span class="hljs-params">value</span>) &#123;  <span class="hljs-keyword">const</span> valueType = <span class="hljs-keyword">typeof</span> value;  <span class="hljs-keyword">return</span> value != <span class="hljs-literal">null</span> &amp;&amp; (valueType === <span class="hljs-string">&quot;object&quot;</span> || valueType === <span class="hljs-string">&quot;function&quot;</span>);&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">originValue, map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>()</span>) &#123;  <span class="hljs-comment">// æ•°æ®ç±»å‹æ˜¯symbol</span>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> originValue === <span class="hljs-string">&quot;symbol&quot;</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Symbol</span>(originValue.<span class="hljs-property">description</span>);  &#125;  <span class="hljs-comment">// åŸå§‹æ•°æ®ç±»å‹ç›´æ¥è¿”å›</span>  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isObject</span>(originValue)) &#123;    <span class="hljs-keyword">return</span> originValue;  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯function</span>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> originValue === <span class="hljs-string">&quot;function&quot;</span>) &#123;    <span class="hljs-keyword">return</span> originValue;  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯setç±»å‹</span>  <span class="hljs-keyword">if</span> (originValue <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Set</span>) &#123;    <span class="hljs-keyword">const</span> newSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> originValue) &#123;      newSet.<span class="hljs-title function_">add</span>(<span class="hljs-title function_">deepClone</span>(item));    &#125;    <span class="hljs-keyword">return</span> newSet;  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯Mapç±»å‹</span>  <span class="hljs-keyword">if</span> (originValue <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Map</span>) &#123;    <span class="hljs-keyword">const</span> newMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> originValue) &#123;      newMap.<span class="hljs-title function_">set</span>(key, <span class="hljs-title function_">deepClone</span>(value));    &#125;  &#125;  <span class="hljs-comment">// å¦‚æœæœ‰å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼Œreturn</span>  <span class="hljs-keyword">if</span> (map.<span class="hljs-title function_">get</span>(originValue)) &#123;    <span class="hljs-keyword">return</span> map.<span class="hljs-title function_">get</span>(originValue);  &#125;  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯Array</span>  <span class="hljs-keyword">const</span> newOBj = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(originValue) ? [] : &#123;&#125;;  map.<span class="hljs-title function_">set</span>(originValue, newOBj);  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> originValue) &#123;    newOBj[key] = <span class="hljs-title function_">deepClone</span>(originValue[key], map);  &#125;  <span class="hljs-comment">// ä»¥symbolä½œä¸ºkey</span>  <span class="hljs-keyword">const</span> symbolKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertySymbols</span>(originValue);  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> symbolKey <span class="hljs-keyword">of</span> symbolKeys) &#123;    newOBj[<span class="hljs-title class_">Symbol</span>(symbolKey.<span class="hljs-property">description</span>)] = <span class="hljs-title function_">deepClone</span>(      originValue[symbolKey],      map    );  &#125;  <span class="hljs-keyword">return</span> newOBj;&#125;<span class="hljs-comment">// const info = &#123;</span><span class="hljs-comment">//   name: &quot;why&quot;,</span><span class="hljs-comment">//   age: 18,</span><span class="hljs-comment">//   friend: &#123;</span><span class="hljs-comment">//     name: &quot;kobe&quot;,</span><span class="hljs-comment">//     address: &#123;</span><span class="hljs-comment">//       name: &quot;æ´›æ‰çŸ¶&quot;,</span><span class="hljs-comment">//       detail: &quot;æ–¯å¦æ™®æ–¯ä¸­å¿ƒ&quot;,</span><span class="hljs-comment">//     &#125;,</span><span class="hljs-comment">//   &#125;,</span><span class="hljs-comment">//   // self: info</span><span class="hljs-comment">// &#125;;</span><span class="hljs-comment">// info.self = info;</span><span class="hljs-comment">// let newObj = deepClone(info);</span><span class="hljs-comment">// console.log(newObj);</span><span class="hljs-comment">// console.log(newObj.self === newObj);</span><span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-string">&quot;cba&quot;</span>, <span class="hljs-string">&quot;nba&quot;</span>]);<span class="hljs-keyword">const</span> s1 = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&quot;s1&quot;</span>);<span class="hljs-keyword">const</span> s2 = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&quot;s2&quot;</span>);<span class="hljs-keyword">const</span> info1 = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>,  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,  <span class="hljs-attr">friend</span>: &#123;    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;kobe&quot;</span>,    <span class="hljs-attr">address</span>: &#123;      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;æ´›æ‰çŸ¶&quot;</span>,      <span class="hljs-attr">detail</span>: <span class="hljs-string">&quot;æ–¯å¦æ™®æ–¯ä¸­å¿ƒ&quot;</span>,    &#125;,  &#125;,  <span class="hljs-comment">// 1.ç‰¹æ®Šç±»å‹: Set</span>  <span class="hljs-attr">set</span>: set,  <span class="hljs-comment">// 2.ç‰¹æ€§ç±»å‹: function</span>  <span class="hljs-attr">running</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;running~&quot;</span>);  &#125;,  <span class="hljs-comment">// 3.å€¼çš„ç‰¹æ®Šç±»å‹: Symbol</span>  <span class="hljs-attr">symbolKey</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&quot;abc&quot;</span>),  <span class="hljs-comment">// 4.keyæ˜¯symbolæ—¶</span>  [s1]: <span class="hljs-string">&quot;aaaa&quot;</span>,  [s2]: <span class="hljs-string">&quot;bbbb&quot;</span>,&#125;;info1.<span class="hljs-property">self</span> = info1;<span class="hljs-keyword">const</span> newObj1 = <span class="hljs-title function_">deepClone</span>(info1);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(newObj1);</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>åŸç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Promiseçš„å®ç°</title>
    <link href="/2022/09/05/Promise%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/09/05/Promise%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="ç»“æ„è®¾è®¡"><a href="#ç»“æ„è®¾è®¡" class="headerlink" title="ç»“æ„è®¾è®¡"></a>ç»“æ„è®¾è®¡</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;resolveè¢«è°ƒç”¨&quot;</span>);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;rejectè¢«è°ƒç”¨&quot;</span>);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;&#125;<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;padding&quot;</span>);  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">111</span>);  <span class="hljs-title function_">reject</span>(<span class="hljs-number">222</span>);&#125;);</code></pre></div><h4 id="thenæ–¹æ³•çš„ç»“æ„è®¾è®¡"><a href="#thenæ–¹æ³•çš„ç»“æ„è®¾è®¡" class="headerlink" title="thenæ–¹æ³•çš„ç»“æ„è®¾è®¡"></a>thenæ–¹æ³•çš„ç»“æ„è®¾è®¡</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;        <span class="hljs-comment">// å°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰è°ƒç”¨thenè·å–åˆ°onFulfilledå‡½æ•°çš„æ—¶å€™å†è°ƒç”¨æ‰§è¡Œ</span>        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;resolve&quot;</span>);          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onFulfilled</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;reject&quot;</span>);          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onRejected</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;  <span class="hljs-comment">// thenæ–¹æ³•çš„å®ç°</span>  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilled</span> = onFulfilled;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejected</span> = onRejected;  &#125;&#125;<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;padding&quot;</span>);  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">111</span>);  <span class="hljs-title function_">reject</span>(<span class="hljs-number">222</span>);&#125;);<span class="hljs-comment">// æ­¤æ—¶ä¸å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™</span>promise.<span class="hljs-title function_">then</span>(  <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res1:&quot;</span>, res);    <span class="hljs-keyword">return</span> <span class="hljs-number">1111</span>;  &#125;,  <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err:&quot;</span>, err);  &#125;);</code></pre></div><h4 id="thenæ–¹æ³•çš„ç»“æ„è®¾è®¡-ä¼˜åŒ–"><a href="#thenæ–¹æ³•çš„ç»“æ„è®¾è®¡-ä¼˜åŒ–" class="headerlink" title="thenæ–¹æ³•çš„ç»“æ„è®¾è®¡-ä¼˜åŒ–"></a>thenæ–¹æ³•çš„ç»“æ„è®¾è®¡-ä¼˜åŒ–</h4><h5 id="è§£å†³thenåœ¨çŠ¶æ€ç¡®å®šä¹‹åè°ƒç”¨çš„é—®é¢˜"><a href="#è§£å†³thenåœ¨çŠ¶æ€ç¡®å®šä¹‹åè°ƒç”¨çš„é—®é¢˜" class="headerlink" title="è§£å†³thenåœ¨çŠ¶æ€ç¡®å®šä¹‹åè°ƒç”¨çš„é—®é¢˜"></a>è§£å†³thenåœ¨çŠ¶æ€ç¡®å®šä¹‹åè°ƒç”¨çš„é—®é¢˜</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span> = [];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span> = [];    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-comment">// å°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰è°ƒç”¨thenè·å–åˆ°onFulfilledå‡½æ•°çš„æ—¶å€™å†è°ƒç”¨æ‰§è¡Œ</span>        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;resolve&quot;</span>);          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;reject&quot;</span>);          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;  <span class="hljs-comment">// thenæ–¹æ³•çš„å®ç°</span>  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;    <span class="hljs-comment">//å½“è°ƒç”¨thençš„æ—¶å€™ï¼ŒçŠ¶æ€å·²ç»ç¡®å®š</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> &amp;&amp; onFulfilled) &#123;      <span class="hljs-title function_">onFulfilled</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);    &#125;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> &amp;&amp; onRejected) &#123;      <span class="hljs-title function_">onRejected</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);    &#125;    <span class="hljs-comment">// å½“çŠ¶æ€è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„æ—¶å€™,å°†æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒæ”¾å…¥æ•°ç»„</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">push</span>(onFulfilled);      <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">push</span>(onRejected);    &#125;  &#125;&#125;<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;padding&quot;</span>);  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">111</span>);  <span class="hljs-title function_">reject</span>(<span class="hljs-number">222</span>);&#125;);<span class="hljs-comment">// è°ƒç”¨thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨</span>promise.<span class="hljs-title function_">then</span>(  <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res1:&quot;</span>, res);  &#125;,  <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err:&quot;</span>, err);  &#125;);promise.<span class="hljs-title function_">then</span>(  <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res2:&quot;</span>, res);  &#125;,  <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err2:&quot;</span>, err);  &#125;);<span class="hljs-comment">// const promise = new Promise((resolve, reject) =&gt; &#123;</span><span class="hljs-comment">//   resolve(&quot;aaaaa&quot;)</span><span class="hljs-comment">// &#125;)</span><span class="hljs-comment">// åœ¨ç¡®å®šPromiseçŠ¶æ€ä¹‹å, å†æ¬¡è°ƒç”¨then</span><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;  promise.<span class="hljs-title function_">then</span>(    <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res3:&quot;</span>, res);    &#125;,    <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err3:&quot;</span>, err);    &#125;  );&#125;, <span class="hljs-number">1000</span>);</code></pre></div><h4 id="thenæ–¹æ³•çš„ç»“æ„è®¾è®¡-ä¼˜åŒ–äºŒ"><a href="#thenæ–¹æ³•çš„ç»“æ„è®¾è®¡-ä¼˜åŒ–äºŒ" class="headerlink" title="thenæ–¹æ³•çš„ç»“æ„è®¾è®¡-ä¼˜åŒ–äºŒ"></a>thenæ–¹æ³•çš„ç»“æ„è®¾è®¡-ä¼˜åŒ–äºŒ</h4><h5 id="è§£å†³thenæ–¹æ³•é“¾å¼è°ƒç”¨"><a href="#è§£å†³thenæ–¹æ³•é“¾å¼è°ƒç”¨" class="headerlink" title="è§£å†³thenæ–¹æ³•é“¾å¼è°ƒç”¨"></a>è§£å†³thenæ–¹æ³•é“¾å¼è°ƒç”¨</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-comment">// å·¥å…·å‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">execFunctionWithCatchError</span>(<span class="hljs-params">execFn, value, resolve, reject</span>) &#123;  <span class="hljs-keyword">try</span> &#123;    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">execFn</span>(value);    <span class="hljs-title function_">resolve</span>(result);  &#125; <span class="hljs-keyword">catch</span> (error) &#123;    <span class="hljs-title function_">reject</span>(error);  &#125;&#125;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span> = [];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span> = [];    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-comment">// å°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰è°ƒç”¨thenè·å–åˆ°onFulfilledå‡½æ•°çš„æ—¶å€™å†è°ƒç”¨æ‰§è¡Œ</span>        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;resolve&quot;</span>);          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;reject&quot;</span>);          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;  <span class="hljs-comment">// thenæ–¹æ³•çš„å®ç°</span>  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªpromise,å°±å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨äº†</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-comment">//å½“è°ƒç”¨thençš„æ—¶å€™ï¼ŒçŠ¶æ€å·²ç»ç¡®å®š</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> &amp;&amp; onFulfilled) &#123;        <span class="hljs-comment">// try &#123;</span>        <span class="hljs-comment">//   const value = onFulfilled(this.value);</span>        <span class="hljs-comment">//   resolve(value);</span>        <span class="hljs-comment">// &#125; catch (error) &#123;</span>        <span class="hljs-comment">//   reject(error);</span>        <span class="hljs-comment">// &#125;</span>        <span class="hljs-title function_">execFunctionWithCatchError</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>, resolve, reject);      &#125;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> &amp;&amp; onRejected) &#123;        <span class="hljs-comment">// try &#123;</span>        <span class="hljs-comment">//   const reason = onRejected(this.reason);</span>        <span class="hljs-comment">//   resolve(reason);</span>        <span class="hljs-comment">// &#125; catch (error) &#123;</span>        <span class="hljs-comment">//   reject(error);</span>        <span class="hljs-comment">// &#125;</span>        <span class="hljs-title function_">execFunctionWithCatchError</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>, resolve, reject);      &#125;      <span class="hljs-comment">// å½“çŠ¶æ€è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„æ—¶å€™,å°†æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒæ”¾å…¥æ•°ç»„</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-comment">// try &#123;</span>          <span class="hljs-comment">//   const value = onFulfilled(this.value);</span>          <span class="hljs-comment">//   resolve(value);</span>          <span class="hljs-comment">// &#125; catch (error) &#123;</span>          <span class="hljs-comment">//   reject(error);</span>          <span class="hljs-comment">// &#125;</span>          <span class="hljs-title function_">execFunctionWithCatchError</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>, resolve, reject);        &#125;);        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-comment">// try &#123;</span>          <span class="hljs-comment">//   const reason = onRejected(this.reason);</span>          <span class="hljs-comment">//   resolve(reason);</span>          <span class="hljs-comment">// &#125; catch (error) &#123;</span>          <span class="hljs-comment">//   reject(error);</span>          <span class="hljs-comment">// &#125;</span>          <span class="hljs-title function_">execFunctionWithCatchError</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>, resolve, reject);        &#125;);      &#125;    &#125;);  &#125;&#125;<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;padding&quot;</span>);  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">111</span>);  <span class="hljs-title function_">reject</span>(<span class="hljs-number">222</span>);&#125;);<span class="hljs-comment">// è°ƒç”¨thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨</span>promise  .<span class="hljs-title function_">then</span>(    <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res1:&quot;</span>, res);      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;aaaa&quot;</span>;      <span class="hljs-comment">// throw new Error(&quot;err message&quot;)</span>    &#125;,    <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err1:&quot;</span>, err);      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;bbbbb&quot;</span>;      <span class="hljs-comment">// throw new Error(&quot;err message&quot;)</span>    &#125;  )  .<span class="hljs-title function_">then</span>(    <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res2:&quot;</span>, res);    &#125;,    <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err2:&quot;</span>, err);    &#125;  );</code></pre></div><h4 id="catchçš„è®¾è®¡æ–¹æ³•"><a href="#catchçš„è®¾è®¡æ–¹æ³•" class="headerlink" title="catchçš„è®¾è®¡æ–¹æ³•"></a>catchçš„è®¾è®¡æ–¹æ³•</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-comment">// å·¥å…·å‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">execFunctionWithCatchError</span>(<span class="hljs-params">execFn, value, resolve, reject</span>) &#123;  <span class="hljs-keyword">try</span> &#123;    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">execFn</span>(value);    <span class="hljs-title function_">resolve</span>(result);  &#125; <span class="hljs-keyword">catch</span> (error) &#123;    <span class="hljs-title function_">reject</span>(error);  &#125;&#125;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span> = [];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span> = [];    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-comment">// å°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰è°ƒç”¨thenè·å–åˆ°onFulfilledå‡½æ•°çš„æ—¶å€™å†è°ƒç”¨æ‰§è¡Œ</span>        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;  <span class="hljs-comment">// thenæ–¹æ³•çš„å®ç°</span>  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;    <span class="hljs-comment">// å°†errorä¼ é€’ä¸‹å»äº¤ç»™catchå¤„ç†</span>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnRejected</span> = (<span class="hljs-params">err</span>) =&gt; &#123;      <span class="hljs-keyword">throw</span> err;    &#125;;    onRejected = onRejected || defaultOnRejected;    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªpromise,å°±å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨äº†</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-comment">//å½“è°ƒç”¨thençš„æ—¶å€™ï¼ŒçŠ¶æ€å·²ç»ç¡®å®š</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> &amp;&amp; onFulfilled) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>, resolve, reject);      &#125;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> &amp;&amp; onRejected) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>, resolve, reject);      &#125;      <span class="hljs-comment">// å½“çŠ¶æ€è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„æ—¶å€™,å°†æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒæ”¾å…¥æ•°ç»„</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-keyword">if</span> (onFulfilled) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onFulfilled,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,              resolve,              reject            );          &#125;);        &#125;        <span class="hljs-keyword">if</span> (onRejected) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onRejected,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>,              resolve,              reject            );          &#125;);        &#125;      &#125;    &#125;);  &#125;  <span class="hljs-keyword">catch</span>(onRejected) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">undefined</span>, onRejected);  &#125;&#125;<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;çŠ¶æ€pending&quot;</span>);  <span class="hljs-comment">// resolve(1111) // resolved/fulfilled</span>  <span class="hljs-title function_">reject</span>(<span class="hljs-number">2222</span>);&#125;);<span class="hljs-comment">// è°ƒç”¨thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨</span>promise  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res:&quot;</span>, res);  &#125;)  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err:&quot;</span>, err);  &#125;);</code></pre></div><h4 id="finallyæ–¹æ³•çš„è®¾è®¡"><a href="#finallyæ–¹æ³•çš„è®¾è®¡" class="headerlink" title="finallyæ–¹æ³•çš„è®¾è®¡"></a>finallyæ–¹æ³•çš„è®¾è®¡</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-comment">// å·¥å…·å‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">execFunctionWithCatchError</span>(<span class="hljs-params">execFn, value, resolve, reject</span>) &#123;  <span class="hljs-keyword">try</span> &#123;    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">execFn</span>(value);    <span class="hljs-title function_">resolve</span>(result);  &#125; <span class="hljs-keyword">catch</span> (error) &#123;    <span class="hljs-title function_">reject</span>(error);  &#125;&#125;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span> = [];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span> = [];    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-comment">// å°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰è°ƒç”¨thenè·å–åˆ°onFulfilledå‡½æ•°çš„æ—¶å€™å†è°ƒç”¨æ‰§è¡Œ</span>        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;  <span class="hljs-comment">// thenæ–¹æ³•çš„å®ç°</span>  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;    <span class="hljs-comment">// å°†errorä¼ é€’ä¸‹å»äº¤ç»™catchå¤„ç†</span>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnRejected</span> = (<span class="hljs-params">err</span>) =&gt; &#123;      <span class="hljs-keyword">throw</span> err;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnFulfilled</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-keyword">return</span> value;    &#125;;    onRejected = onRejected || defaultOnRejected;    onFulfilled = onFulfilled || defaultOnFulfilled;    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªpromise,å°±å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨äº†</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-comment">//å½“è°ƒç”¨thençš„æ—¶å€™ï¼ŒçŠ¶æ€å·²ç»ç¡®å®š</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> &amp;&amp; onFulfilled) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>, resolve, reject);      &#125;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> &amp;&amp; onRejected) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>, resolve, reject);      &#125;      <span class="hljs-comment">// å½“çŠ¶æ€è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„æ—¶å€™,å°†æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒæ”¾å…¥æ•°ç»„</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-keyword">if</span> (onFulfilled) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onFulfilled,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,              resolve,              reject            );          &#125;);        &#125;        <span class="hljs-keyword">if</span> (onRejected) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onRejected,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>,              resolve,              reject            );          &#125;);        &#125;      &#125;    &#125;);  &#125;  <span class="hljs-keyword">catch</span>(onRejected) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">undefined</span>, onRejected);  &#125;  <span class="hljs-title function_">finally</span>(<span class="hljs-params">onfinally</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(      <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-title function_">onfinally</span>();      &#125;,      <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-title function_">onfinally</span>();      &#125;    );  &#125;&#125;<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;çŠ¶æ€pending&quot;</span>);  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">1111</span>); <span class="hljs-comment">// resolved/fulfilled</span>  <span class="hljs-comment">// reject(2222);</span>&#125;);<span class="hljs-comment">// è°ƒç”¨thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨</span>promise  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res1:&quot;</span>, res);    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;aaaaa&quot;</span>;  &#125;)  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res2:&quot;</span>, res);  &#125;)  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err:&quot;</span>, err);  &#125;)  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;finally&quot;</span>);  &#125;);</code></pre></div><h4 id="promiseçš„ç±»æ–¹æ³•resolve-reject"><a href="#promiseçš„ç±»æ–¹æ³•resolve-reject" class="headerlink" title="promiseçš„ç±»æ–¹æ³•resolve/reject"></a>promiseçš„ç±»æ–¹æ³•resolve/reject</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-comment">// å·¥å…·å‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">execFunctionWithCatchError</span>(<span class="hljs-params">execFn, value, resolve, reject</span>) &#123;  <span class="hljs-keyword">try</span> &#123;    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">execFn</span>(value);    <span class="hljs-title function_">resolve</span>(result);  &#125; <span class="hljs-keyword">catch</span> (error) &#123;    <span class="hljs-title function_">reject</span>(error);  &#125;&#125;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span> = [];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span> = [];    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-comment">// å°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰è°ƒç”¨thenè·å–åˆ°onFulfilledå‡½æ•°çš„æ—¶å€™å†è°ƒç”¨æ‰§è¡Œ</span>        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;  <span class="hljs-comment">// thenæ–¹æ³•çš„å®ç°</span>  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;    <span class="hljs-comment">// å°†errorä¼ é€’ä¸‹å»äº¤ç»™catchå¤„ç†</span>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnRejected</span> = (<span class="hljs-params">err</span>) =&gt; &#123;      <span class="hljs-keyword">throw</span> err;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnFulfilled</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-keyword">return</span> value;    &#125;;    onRejected = onRejected || defaultOnRejected;    onFulfilled = onFulfilled || defaultOnFulfilled;    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªpromise,å°±å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨äº†</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-comment">//å½“è°ƒç”¨thençš„æ—¶å€™ï¼ŒçŠ¶æ€å·²ç»ç¡®å®š</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> &amp;&amp; onFulfilled) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>, resolve, reject);      &#125;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> &amp;&amp; onRejected) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>, resolve, reject);      &#125;      <span class="hljs-comment">// å½“çŠ¶æ€è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„æ—¶å€™,å°†æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒæ”¾å…¥æ•°ç»„</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-keyword">if</span> (onFulfilled) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onFulfilled,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,              resolve,              reject            );          &#125;);        &#125;        <span class="hljs-keyword">if</span> (onRejected) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onRejected,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>,              resolve,              reject            );          &#125;);        &#125;      &#125;    &#125;);  &#125;  <span class="hljs-keyword">catch</span>(onRejected) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">undefined</span>, onRejected);  &#125;  <span class="hljs-title function_">finally</span>(<span class="hljs-params">onfinally</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(      <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-title function_">onfinally</span>();      &#125;,      <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-title function_">onfinally</span>();      &#125;    );  &#125;  <span class="hljs-comment">// å°±æ˜¯å°†valueè½¬æˆfulfilledçŠ¶æ€å¯ä»¥è¿›è¡Œthenè°ƒç”¨</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-params">value</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> <span class="hljs-title function_">resolve</span>(value);    &#125;);  &#125;  <span class="hljs-comment">// å°†reasonè£…æˆrejectedçŠ¶æ€</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">reject</span>(<span class="hljs-params">reason</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> <span class="hljs-title function_">reject</span>(reason);    &#125;);  &#125;&#125;myPromise.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&quot;Hello World&quot;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res:&quot;</span>, res);&#125;);myPromise.<span class="hljs-title function_">reject</span>(<span class="hljs-string">&quot;Error Message&quot;</span>).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err:&quot;</span>, err);&#125;);</code></pre></div><h4 id="promiseçš„ç±»æ–¹æ³•all-allSettled"><a href="#promiseçš„ç±»æ–¹æ³•all-allSettled" class="headerlink" title="promiseçš„ç±»æ–¹æ³•all/allSettled"></a>promiseçš„ç±»æ–¹æ³•all/allSettled</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-comment">// å·¥å…·å‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">execFunctionWithCatchError</span>(<span class="hljs-params">execFn, value, resolve, reject</span>) &#123;  <span class="hljs-keyword">try</span> &#123;    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">execFn</span>(value);    <span class="hljs-title function_">resolve</span>(result);  &#125; <span class="hljs-keyword">catch</span> (error) &#123;    <span class="hljs-title function_">reject</span>(error);  &#125;&#125;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span> = [];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span> = [];    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-comment">// å°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰è°ƒç”¨thenè·å–åˆ°onFulfilledå‡½æ•°çš„æ—¶å€™å†è°ƒç”¨æ‰§è¡Œ</span>        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;  <span class="hljs-comment">// thenæ–¹æ³•çš„å®ç°</span>  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;    <span class="hljs-comment">// å°†errorä¼ é€’ä¸‹å»äº¤ç»™catchå¤„ç†</span>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnRejected</span> = (<span class="hljs-params">err</span>) =&gt; &#123;      <span class="hljs-keyword">throw</span> err;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnFulfilled</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-keyword">return</span> value;    &#125;;    onRejected = onRejected || defaultOnRejected;    onFulfilled = onFulfilled || defaultOnFulfilled;    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªpromise,å°±å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨äº†</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-comment">//å½“è°ƒç”¨thençš„æ—¶å€™ï¼ŒçŠ¶æ€å·²ç»ç¡®å®š</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> &amp;&amp; onFulfilled) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>, resolve, reject);      &#125;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> &amp;&amp; onRejected) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>, resolve, reject);      &#125;      <span class="hljs-comment">// å½“çŠ¶æ€è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„æ—¶å€™,å°†æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒæ”¾å…¥æ•°ç»„</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-keyword">if</span> (onFulfilled) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onFulfilled,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,              resolve,              reject            );          &#125;);        &#125;        <span class="hljs-keyword">if</span> (onRejected) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onRejected,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>,              resolve,              reject            );          &#125;);        &#125;      &#125;    &#125;);  &#125;  <span class="hljs-keyword">catch</span>(onRejected) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">undefined</span>, onRejected);  &#125;  <span class="hljs-title function_">finally</span>(<span class="hljs-params">onfinally</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(      <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-title function_">onfinally</span>();      &#125;,      <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-title function_">onfinally</span>();      &#125;    );  &#125;  <span class="hljs-comment">// å°±æ˜¯å°†valueè½¬æˆfulfilledçŠ¶æ€å¯ä»¥è¿›è¡Œthenè°ƒç”¨</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-params">value</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> <span class="hljs-title function_">resolve</span>(value);    &#125;);  &#125;  <span class="hljs-comment">// å°†reasonè£…æˆrejectedçŠ¶æ€</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">reject</span>(<span class="hljs-params">reason</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> <span class="hljs-title function_">reject</span>(reason);    &#125;);  &#125;  <span class="hljs-comment">// allä¼ å…¥ä¸€ä¸ªpromiseæ•°ç»„ï¼Œå¦‚æœpromise itemçŠ¶æ€éƒ½æ˜¯fulfulledï¼Œallæ‰æ˜¯fuldilledçŠ¶æ€ï¼Œå¦åˆ™åªè¦å‡ºç°äº†rejectå°±ä¼šå˜æˆrenject</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">all</span>(<span class="hljs-params">promises</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">const</span> values = [];      promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">promise</span>) =&gt;</span> &#123;        promise.<span class="hljs-title function_">then</span>(          <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;            values.<span class="hljs-title function_">push</span>(res);            <span class="hljs-keyword">if</span> (values.<span class="hljs-property">length</span> === promises.<span class="hljs-property">length</span>) &#123;              <span class="hljs-title function_">resolve</span>(values);            &#125;          &#125;,          <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;            <span class="hljs-title function_">reject</span>(err);          &#125;        );      &#125;);    &#125;);  &#125;  <span class="hljs-keyword">static</span> <span class="hljs-title function_">allSettled</span>(<span class="hljs-params">promises</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">const</span> values = [];      promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">promise</span>) =&gt;</span> &#123;        promise.<span class="hljs-title function_">then</span>(          <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;            values.<span class="hljs-title function_">push</span>(&#123;              <span class="hljs-attr">status</span>: <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>,              <span class="hljs-attr">value</span>: res,            &#125;);            <span class="hljs-keyword">if</span> (values.<span class="hljs-property">length</span> === promises.<span class="hljs-property">length</span>) &#123;              <span class="hljs-title function_">resolve</span>(values);            &#125;          &#125;,          <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;            values.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">status</span>: <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>, <span class="hljs-attr">value</span>: err &#125;);            <span class="hljs-keyword">if</span> (values.<span class="hljs-property">length</span> === promises.<span class="hljs-property">length</span>) &#123;              <span class="hljs-title function_">resolve</span>(values);            &#125;          &#125;        );      &#125;);    &#125;);  &#125;&#125;<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-title function_">resolve</span>(<span class="hljs-number">1111</span>);  &#125;, <span class="hljs-number">1000</span>);&#125;);<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-title function_">reject</span>(<span class="hljs-number">2222</span>);  &#125;, <span class="hljs-number">2000</span>);&#125;);<span class="hljs-keyword">const</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-title function_">resolve</span>(<span class="hljs-number">3333</span>);  &#125;, <span class="hljs-number">3000</span>);&#125;);myPromise  .<span class="hljs-title function_">all</span>([p1, p2, p3])  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);  &#125;)  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);  &#125;);myPromise.<span class="hljs-title function_">allSettled</span>([p1, p2, p3]).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);&#125;);</code></pre></div><h4 id="promiseç±»æ–¹æ³•-any-race"><a href="#promiseç±»æ–¹æ³•-any-race" class="headerlink" title="promiseç±»æ–¹æ³•-any/race"></a>promiseç±»æ–¹æ³•-any/race</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰promiseçš„ä¸‰ç§çŠ¶æ€</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<span class="hljs-comment">// å·¥å…·å‡½æ•°</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">execFunctionWithCatchError</span>(<span class="hljs-params">execFn, value, resolve, reject</span>) &#123;  <span class="hljs-keyword">try</span> &#123;    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">execFn</span>(value);    <span class="hljs-title function_">resolve</span>(result);  &#125; <span class="hljs-keyword">catch</span> (error) &#123;    <span class="hljs-title function_">reject</span>(error);  &#125;&#125;<span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;    <span class="hljs-comment">// çŠ¶æ€åˆå§‹åŒ–</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>;    <span class="hljs-comment">// å®šä¹‰resolveï¼Œrejectçš„å‚æ•°</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span> = [];    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span> = [];    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-comment">// åªæœ‰çŠ¶æ€æ˜¯paddingçš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œæ”¹å˜ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰è¾“å‡º</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-comment">// å°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰è°ƒç”¨thenè·å–åˆ°onFulfilledå‡½æ•°çš„æ—¶å€™å†è°ƒç”¨æ‰§è¡Œ</span>        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> !== <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) <span class="hljs-keyword">return</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> &#123;            <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);          &#125;);        &#125;);      &#125;    &#125;;    <span class="hljs-keyword">try</span> &#123;      <span class="hljs-title function_">executor</span>(resolve, reject);    &#125; <span class="hljs-keyword">catch</span> (error) &#123;      <span class="hljs-title function_">reject</span>(error);    &#125;  &#125;  <span class="hljs-comment">// thenæ–¹æ³•çš„å®ç°</span>  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;    <span class="hljs-comment">// å°†errorä¼ é€’ä¸‹å»äº¤ç»™catchå¤„ç†</span>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnRejected</span> = (<span class="hljs-params">err</span>) =&gt; &#123;      <span class="hljs-keyword">throw</span> err;    &#125;;    <span class="hljs-keyword">const</span> <span class="hljs-title function_">defaultOnFulfilled</span> = (<span class="hljs-params">value</span>) =&gt; &#123;      <span class="hljs-keyword">return</span> value;    &#125;;    onRejected = onRejected || defaultOnRejected;    onFulfilled = onFulfilled || defaultOnFulfilled;    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªpromise,å°±å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨äº†</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-comment">//å½“è°ƒç”¨thençš„æ—¶å€™ï¼ŒçŠ¶æ€å·²ç»ç¡®å®š</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span> &amp;&amp; onFulfilled) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>, resolve, reject);      &#125;      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span> &amp;&amp; onRejected) &#123;        <span class="hljs-title function_">execFunctionWithCatchError</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>, resolve, reject);      &#125;      <span class="hljs-comment">// å½“çŠ¶æ€è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„æ—¶å€™,å°†æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒæ”¾å…¥æ•°ç»„</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PROMISE_STATUS_PENDING</span>) &#123;        <span class="hljs-keyword">if</span> (onFulfilled) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onFulfilled,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,              resolve,              reject            );          &#125;);        &#125;        <span class="hljs-keyword">if</span> (onRejected) &#123;          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> &#123;            <span class="hljs-title function_">execFunctionWithCatchError</span>(              onRejected,              <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>,              resolve,              reject            );          &#125;);        &#125;      &#125;    &#125;);  &#125;  <span class="hljs-keyword">catch</span>(onRejected) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">undefined</span>, onRejected);  &#125;  <span class="hljs-title function_">finally</span>(<span class="hljs-params">onfinally</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(      <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-title function_">onfinally</span>();      &#125;,      <span class="hljs-function">() =&gt;</span> &#123;        <span class="hljs-title function_">onfinally</span>();      &#125;    );  &#125;  <span class="hljs-comment">// å°±æ˜¯å°†valueè½¬æˆfulfilledçŠ¶æ€å¯ä»¥è¿›è¡Œthenè°ƒç”¨</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-params">value</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> <span class="hljs-title function_">resolve</span>(value);    &#125;);  &#125;  <span class="hljs-comment">// å°†reasonè£…æˆrejectedçŠ¶æ€</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">reject</span>(<span class="hljs-params">reason</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">return</span> <span class="hljs-title function_">reject</span>(reason);    &#125;);  &#125;  <span class="hljs-comment">// allä¼ å…¥ä¸€ä¸ªpromiseæ•°ç»„ï¼Œå¦‚æœpromise itemçŠ¶æ€éƒ½æ˜¯fulfulledï¼Œallæ‰æ˜¯fuldilledçŠ¶æ€ï¼Œå¦åˆ™åªè¦å‡ºç°äº†rejectå°±ä¼šå˜æˆrenject</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">all</span>(<span class="hljs-params">promises</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">const</span> values = [];      promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">promise</span>) =&gt;</span> &#123;        promise.<span class="hljs-title function_">then</span>(          <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;            values.<span class="hljs-title function_">push</span>(res);            <span class="hljs-keyword">if</span> (values.<span class="hljs-property">length</span> === promises.<span class="hljs-property">length</span>) &#123;              <span class="hljs-title function_">resolve</span>(values);            &#125;          &#125;,          <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;            <span class="hljs-title function_">reject</span>(err);          &#125;        );      &#125;);    &#125;);  &#125;  <span class="hljs-keyword">static</span> <span class="hljs-title function_">allSettled</span>(<span class="hljs-params">promises</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">const</span> values = [];      promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">promise</span>) =&gt;</span> &#123;        promise.<span class="hljs-title function_">then</span>(          <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;            values.<span class="hljs-title function_">push</span>(&#123;              <span class="hljs-attr">status</span>: <span class="hljs-variable constant_">PROMISE_STATUS_FULFILLED</span>,              <span class="hljs-attr">value</span>: res,            &#125;);            <span class="hljs-keyword">if</span> (values.<span class="hljs-property">length</span> === promises.<span class="hljs-property">length</span>) &#123;              <span class="hljs-title function_">resolve</span>(values);            &#125;          &#125;,          <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;            values.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">status</span>: <span class="hljs-variable constant_">PROMISE_STATUS_REJECTED</span>, <span class="hljs-attr">value</span>: err &#125;);            <span class="hljs-keyword">if</span> (values.<span class="hljs-property">length</span> === promises.<span class="hljs-property">length</span>) &#123;              <span class="hljs-title function_">resolve</span>(values);            &#125;          &#125;        );      &#125;);    &#125;);  &#125;  <span class="hljs-comment">// ç›¸å½“äºæ˜¯ç«èµ›ï¼Œè°çš„çŠ¶æ€å…ˆæ”¹å˜å°±ç”¨è°çš„</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">race</span>(<span class="hljs-params">promsies</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      promsies.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">promise</span>) =&gt;</span> &#123;        promise.<span class="hljs-title function_">then</span>(resolve, reject);      &#125;);    &#125;);  &#125;  <span class="hljs-comment">//æœ‰ä¸€ä¸ªçŠ¶æ€æ—¶fulfilledçŠ¶æ€å°±æ˜¯æ‰§è¡Œresolve,ç­‰æ‰€æœ‰éƒ½å˜æˆrejectedçŠ¶æ€æ‰ä¼šæ˜¯reject  å’Œallç›¸å</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">any</span>(<span class="hljs-params">promises</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-keyword">const</span> reasons = [];      promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">promise</span>) =&gt;</span> &#123;        promise.<span class="hljs-title function_">then</span>(          <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;            <span class="hljs-title function_">resolve</span>(res);          &#125;,          <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;            reasons.<span class="hljs-title function_">push</span>(err);            <span class="hljs-keyword">if</span> (reasons.<span class="hljs-property">length</span> === promises.<span class="hljs-property">length</span>) &#123;              <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AggregateError</span>(reasons));            &#125;          &#125;        );      &#125;);    &#125;);  &#125;&#125;<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-title function_">reject</span>(<span class="hljs-number">1111</span>);  &#125;, <span class="hljs-number">3000</span>);&#125;);<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-title function_">reject</span>(<span class="hljs-number">2222</span>);  &#125;, <span class="hljs-number">2000</span>);&#125;);<span class="hljs-keyword">const</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-title function_">reject</span>(<span class="hljs-number">3333</span>);  &#125;, <span class="hljs-number">3000</span>);&#125;);myPromise  .<span class="hljs-title function_">race</span>([p1, p2, p3])  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res:&quot;</span>, res);  &#125;)  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err:&quot;</span>, err);  &#125;);myPromise  .<span class="hljs-title function_">any</span>([p1, p2, p3])  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;res:&quot;</span>, res);  &#125;)  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;err:&quot;</span>, err.<span class="hljs-property">errors</span>);  &#125;);</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>æœé›†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°bind</title>
    <link href="/2022/09/05/%E5%AE%9E%E7%8E%B0bind/"/>
    <url>/2022/09/05/%E5%AE%9E%E7%8E%B0bind/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mybind</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">thisArg, ...args</span>) &#123;  <span class="hljs-comment">// è·å¾—thisçš„æŒ‡å‘ï¼Œå°±æ˜¯å®é™…çš„è°ƒç”¨è€…</span>  <span class="hljs-keyword">let</span> fn = <span class="hljs-variable language_">this</span>;  <span class="hljs-comment">// è·å–thisArg,å¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹é™¤äº†null,undefinedéƒ½è½¬æˆåŒ…è£…ç±»å‹ï¼Œå¦åˆ™æŒ‡å‘å…¨å±€</span>  thisArg = thisArg != <span class="hljs-literal">null</span> ? <span class="hljs-title class_">Object</span>(thisArg) : globalThis;  <span class="hljs-comment">// bindä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°</span>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">newFn</span>(<span class="hljs-params">...argArr</span>) &#123;    <span class="hljs-comment">// å‘thisArgå¯¹è±¡æ·»åŠ è¿™ä¸ªæ–¹æ³•</span>    thisArg.<span class="hljs-property">fn</span> = fn;    <span class="hljs-comment">// åˆå¹¶å‚æ•°</span>    <span class="hljs-keyword">const</span> argTotals = [...args, ...argArr];    <span class="hljs-comment">// æ‰§è¡Œå‡½æ•°</span>    <span class="hljs-keyword">const</span> result = thisArg.<span class="hljs-title function_">fn</span>(...argTotals);    <span class="hljs-comment">// æ‰§è¡Œå®Œæˆååˆ é™¤æ–¹æ³•</span>    <span class="hljs-keyword">delete</span> thisArg.<span class="hljs-property">fn</span>;    <span class="hljs-keyword">return</span> result;  &#125;;&#125;;<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;fooè¢«æ‰§è¡Œ&quot;</span>, <span class="hljs-variable language_">this</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">20</span>;&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">num1, num2, num3, num4</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num1, num2, num3, num4);&#125;<span class="hljs-comment">// ç³»ç»Ÿçš„bindä½¿ç”¨</span><span class="hljs-keyword">var</span> bar = foo.<span class="hljs-title function_">bind</span>(<span class="hljs-string">&quot;abc&quot;</span>);<span class="hljs-title function_">bar</span>();<span class="hljs-keyword">var</span> newSum = sum.<span class="hljs-title function_">bind</span>(<span class="hljs-string">&quot;aaa&quot;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>);<span class="hljs-title function_">newSum</span>();<span class="hljs-comment">// ä½¿ç”¨è‡ªå·±å®šä¹‰çš„bind</span><span class="hljs-keyword">var</span> bar = foo.<span class="hljs-title function_">mybind</span>(<span class="hljs-string">&quot;abc&quot;</span>);<span class="hljs-keyword">var</span> result = <span class="hljs-title function_">bar</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<span class="hljs-keyword">var</span> newSum = sum.<span class="hljs-title function_">mybind</span>(<span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>);<span class="hljs-keyword">var</span> result = <span class="hljs-title function_">newSum</span>(<span class="hljs-number">30</span>, <span class="hljs-number">40</span>);</code></pre></div>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-Reactå…¨å®¶æ¡¶</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-React%E5%85%A8%E5%AE%B6%E6%A1%B6/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-React%E5%85%A8%E5%AE%B6%E6%A1%B6/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="pdf/09-Reactå…¨å®¶æ¡¶å®æˆ˜.pdf" width="100%" height="550" type="application/pdf"></div>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-å°ç¨‹åºäº‘å¼€å‘</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BA%91%E5%BC%80%E5%8F%91/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BA%91%E5%BC%80%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="pdf/08-å°ç¨‹åºäº‘å¼€å‘å®æˆ˜.pdf" width="100%" height="550" type="application/pdf"></div>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-å°ç¨‹åºå¼€å‘</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="pdf/07-å°ç¨‹åºå¼€å‘å®æˆ˜.pdf" width="100%" height="550" type="application/pdf"></div>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-Vue3å…¨å®¶æ¡¶å®æˆ˜</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-Vue3%E5%85%A8%E5%AE%B6%E6%A1%B6%E5%AE%9E%E6%88%98/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-Vue3%E5%85%A8%E5%AE%B6%E6%A1%B6%E5%AE%9E%E6%88%98/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="pdf/06-Vue3å…¨å®¶æ¡¶å®æˆ˜.pdf" width="100%" height="550" type="application/pdf"></div>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-å‰ç«¯å·¥ç¨‹åŒ–åŸºç¡€</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%9F%BA%E7%A1%80/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="pdf/05-å‰ç«¯å·¥ç¨‹åŒ–åŸºç¡€.pdf" width="100%" height="550" type="application/pdf"></div>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-æ¡†æ¶å®æˆ˜</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-%E6%A1%86%E6%9E%B6%E5%AE%9E%E6%88%98/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-%E6%A1%86%E6%9E%B6%E5%AE%9E%E6%88%98/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="pdf/04-æ¡†æ¶å®æˆ˜.pdf" width="100%" height="550" type="application/pdf"></div>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-JSé«˜çº§</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-JS%E9%AB%98%E7%BA%A7/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-JS%E9%AB%98%E7%BA%A7/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="pdf/03-JSé«˜çº§.pdf" width="100%" height="550" type="application/pdf"></div>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-JSåŸºç¡€</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-JS%E5%9F%BA%E7%A1%80/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-JS%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="pdf/02-JSåŸºç¡€.pdf" width="100%" height="550" type="application/pdf"></div>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å…«è‚¡æ–‡-html-css</title>
    <link href="/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-html-css/"/>
    <url>/2022/09/04/%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87-html-css/</url>
    
    <content type="html"><![CDATA[<h1 id="01-HTML-CSS-å¸¸â»…â¾¯è¯•é¢˜"><a href="#01-HTML-CSS-å¸¸â»…â¾¯è¯•é¢˜" class="headerlink" title="01-HTML-CSS-å¸¸â»…â¾¯è¯•é¢˜"></a>01-HTML-CSS-å¸¸â»…â¾¯è¯•é¢˜</h1><h2 id="1-HTML-æ ‡ç­¾æœ‰å“ªäº›â¾å†…å…ƒç´ "><a href="#1-HTML-æ ‡ç­¾æœ‰å“ªäº›â¾å†…å…ƒç´ " class="headerlink" title="1.HTML æ ‡ç­¾æœ‰å“ªäº›â¾å†…å…ƒç´ "></a><strong>1.HTML</strong> <strong>æ ‡ç­¾æœ‰å“ªäº›â¾å†…å…ƒç´ </strong></h2><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span><span class="hljs-selector-tag">img</span>picture<span class="hljs-selector-tag">span</span><span class="hljs-selector-tag">input</span><span class="hljs-selector-tag">textarea</span>selectlabe</code></pre></div><h2 id="2-è¯´è¯´ä½ å¯¹å…ƒç´ è¯­ä¹‰åŒ–çš„ç†è§£"><a href="#2-è¯´è¯´ä½ å¯¹å…ƒç´ è¯­ä¹‰åŒ–çš„ç†è§£" class="headerlink" title="2.è¯´è¯´ä½ å¯¹å…ƒç´ è¯­ä¹‰åŒ–çš„ç†è§£"></a><strong>2.è¯´è¯´ä½ å¯¹å…ƒç´ è¯­ä¹‰åŒ–çš„ç†è§£</strong></h2><p>å…ƒç´ è¯­ä¹‰åŒ–å°±æ˜¯â½¤æ­£ç¡®çš„å…ƒç´ åšæ­£ç¡®çš„äº‹æƒ…ã€‚è™½ç„¶åœ¨ç†è®ºä¸Šï¼Œæ‰€ä»¥çš„htmlå…ƒç´ éƒ½å¯ä»¥é€šè¿‡cssæ ·å¼å®ç°</p><p>ç›¸åŒçš„äº‹æƒ…ï¼Œä½†æ˜¯è¿™ä¹ˆåšä¼šä½¿äº‹æƒ…å¤æ‚åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ƒç´ è¯­ä¹‰åŒ–æ¥é™ä½å¤æ‚åº¦ã€‚</p><p>å…ƒç´ è¯­ä¹‰åŒ–åœ¨æˆ‘ä»¬å®é™…çš„å¼€å‘ä¸­æœ‰å¾ˆå¤šå¥½å¤„ï¼Œâ½å¦‚ï¼š</p><p>æâ¾¼ä»£ç çš„é˜…è¯»æ€§å’Œå¯ç»´æŠ¤æ€§;</p><p>å‡å°‘coderä¹‹é—´çš„æ²Ÿé€šæˆæœ¬;</p><p>èƒ½è®©è¯­â¾³åˆæˆâ¼¯å…·æ­£ç¡®è¯†åˆ«â½¹â»šå…ƒç´ çš„â½¤é€”ï¼Œä»¥ä¾¿åšå‡ºæ­£ç¡®çš„ååº”</p><p>æœ‰åˆ©äºSEO(Search Engine Optimization)</p><h2 id="3-HTML-ä¸­æœ‰å“ªäº›è¯­ä¹‰åŒ–æ ‡ç­¾"><a href="#3-HTML-ä¸­æœ‰å“ªäº›è¯­ä¹‰åŒ–æ ‡ç­¾" class="headerlink" title="3.HTML ä¸­æœ‰å“ªäº›è¯­ä¹‰åŒ–æ ‡ç­¾"></a><strong>3.HTML</strong> <strong>ä¸­æœ‰å“ªäº›è¯­ä¹‰åŒ–æ ‡ç­¾</strong></h2><ul><li>header</li><li>footer</li><li>main</li><li>aside</li><li>article</li><li>section</li><li>address</li><li>summary/details</li><li>menu</li><li>h1/h2/h3/h4/h5/h6</li><li>img</li><li>p</li><li>strong/italic</li></ul><h2 id="4-ä»€ä¹ˆæ˜¯-URL-ç¼–ç -URL-Encode"><a href="#4-ä»€ä¹ˆæ˜¯-URL-ç¼–ç -URL-Encode" class="headerlink" title="4.ä»€ä¹ˆæ˜¯ URL ç¼–ç  (URL Encode)"></a><strong>4.ä»€ä¹ˆæ˜¯</strong> <strong>URL</strong> <strong>ç¼–ç </strong> <strong>(URL Encode)</strong></h2><p>encodeURI â½¤æ¥ç¼–ç <strong>URI</strong>ï¼Œå…¶ä¸ä¼šç¼–ç ä¿ç•™å­—ç¬¦ã€‚</p><p>encodeURIComponent â½¤æ¥ç¼–ç  URI<strong>å‚æ•°</strong>ï¼Œé™¤äº†å­—ç¬¦ï¼šA-Z a-z 0-9 - _ . ! ~ * â€˜ ( )ï¼Œéƒ½å°†ä¼šè½¬ä¹‰</p><h2 id="5-è¯´è¯´ä½ å¯¹SEO-çš„ç†è§£"><a href="#5-è¯´è¯´ä½ å¯¹SEO-çš„ç†è§£" class="headerlink" title="5.è¯´è¯´ä½ å¯¹SEO****çš„ç†è§£"></a><strong>5.è¯´è¯´ä½ å¯¹</strong>SEO****çš„ç†è§£</h2><p>SEOå°±æ˜¯æœç´¢å¼•æ“ä¼˜åŒ–(Search Engine Optimization)ï¼ŒSEOé€šè¿‡äº†è§£æœç´¢å¼•æ“çš„è¿â¾è§„åˆ™æ¥è°ƒæ•´â½¹ç«™ï¼Œ</p><p>ä»¥æâ¾¼â½¹ç«™çš„æ›å…‰åº¦,ä»¥åŠâ½¹ç«™çš„æ’åã€‚</p><p>Google æœç´¢å¼•æ“çš„â¼¯ä½œæµç¨‹ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p><p><strong>æŠ“å–</strong>ï¼šGoogle ä¼šä½¿â½¤åä¸ºâ€œæŠ“å–â¼¯å…·â€çš„â¾ƒåŠ¨ç¨‹åºæœç´¢â½¹ç»œï¼Œä»¥æŸ¥æ‰¾æ–°â½¹â»šæˆ–æ›´æ–°åçš„â½¹â»šã€‚Google ä¼š</p><p>å°†è¿™äº›â½¹â»šçš„åœ°å€ï¼ˆå³â½¹å€ï¼‰å­˜å‚¨åœ¨â¼€ä¸ªâ¼¤å‹åˆ—è¡¨ä¸­ï¼Œä»¥ä¾¿â½‡åæŸ¥çœ‹ã€‚æˆ‘ä»¬ä¼šé€šè¿‡è®¸å¤šä¸åŒçš„â½…æ³•æŸ¥æ‰¾</p><p>â½¹â»šï¼Œä½†ä¸»è¦â½…æ³•æ˜¯è·Ÿè¸ªæˆ‘ä»¬å·²çŸ¥çš„â½¹â»šä¸­çš„é“¾æ¥ã€‚</p><p><strong>ç¼–â¼Šç´¢å¼•</strong>ï¼šGoogle ä¼šè®¿é—®å®ƒé€šè¿‡æŠ“å–å¾—çŸ¥çš„â½¹â»šï¼Œå¹¶ä¼šå°è¯•åˆ†ææ¯ä¸ªâ½¹â»šçš„ä¸»é¢˜ã€‚Google ä¼šåˆ†æâ½¹â»š</p><p>ä¸­çš„å†…å®¹ã€å›¾â½šå’Œè§†é¢‘â½‚ä»¶ï¼Œå°è¯•äº†è§£â½¹â»šçš„ä¸»é¢˜ã€‚è¿™äº›ä¿¡æ¯å­˜å‚¨åœ¨ Google ç´¢å¼•ä¸­ï¼Œâ½½ Google ç´¢å¼•</p><p>æ˜¯â¼€ä¸ªå­˜å‚¨åœ¨æµ·é‡è®¡ç®—æœºä¸­çš„å·¨â¼¤æ•°æ®åº“ã€‚</p><p><strong>å‘ˆç°æœç´¢ç»“æœ</strong>ï¼šå½“â½¤æˆ·åœ¨ Google ä¸Šè¿›â¾æœç´¢æ—¶ï¼ŒGoogle ä¼šå°è¯•ç¡®å®šæœ€ä¼˜è´¨çš„æœç´¢ç»“æœã€‚â€œæœ€ä½³â€ç»“æœå–</p><p>å†³äºè®¸å¤šå› ç´ ï¼ŒåŒ…æ‹¬â½¤æˆ·çš„ä½ç½®ã€è¯­â¾”ã€è®¾å¤‡ï¼ˆæ¡Œâ¾¯è®¾å¤‡æˆ–â¼¿æœºï¼‰ä»¥åŠå…ˆå‰â½¤è¿‡çš„æœç´¢æŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼Œåœ¨</p><p>â½¤æˆ·æœç´¢â€œâ¾ƒâ¾â»‹ç»´ä¿®åº—â€åï¼ŒGoogle å‘å·´é»â½¤æˆ·æ˜¾ç¤ºçš„ç­”æ¡ˆä¸å‘â¾¹æ¸¯â½¤æˆ·æ˜¾ç¤ºçš„ç­”æ¡ˆæœ‰æ‰€ä¸åŒã€‚â½€ä»˜è´¹</p><p>â½¤ä¸èƒ½æâ¾¼â½¹â»šåœ¨ Google æœç´¢ç»“æœä¸­çš„æ’åï¼Œâ½¹â»šæ’åæ˜¯å®Œå…¨ä¾é ç®—æ³•å®Œæˆçš„ã€‚</p><h2 id="6-â€™-â€™-ä¸-â€˜-â€™-é€‰æ‹©å™¨æœ‰ä»€ä¹ˆä¸åŒ"><a href="#6-â€™-â€™-ä¸-â€˜-â€™-é€‰æ‹©å™¨æœ‰ä»€ä¹ˆä¸åŒ" class="headerlink" title="6.â€™+â€™ ä¸ â€˜~â€™ é€‰æ‹©å™¨æœ‰ä»€ä¹ˆä¸åŒ"></a><strong>6.â€™+â€™</strong> <strong>ä¸</strong> <strong>â€˜~â€™</strong> <strong>é€‰æ‹©å™¨æœ‰ä»€ä¹ˆä¸åŒ</strong></h2><p>~ æ˜¯åŒ¹é…å…ƒç´ ä¹‹åçš„é€‰æ‹©å™¨</p><p>+ æ˜¯åŒ¹é…ç›¸é‚»å…ƒç´ é€‰æ‹©å™¨</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æˆ‘æ˜¯div<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯p<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯p<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æˆ‘æ˜¯div<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯p<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯divä¸‹â¾¯çš„p<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯divä¸‹â¾¯çš„p<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>æˆ‘æ˜¯span<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><span class="language-css"><span class="hljs-selector-tag">div</span>+<span class="hljs-selector-tag">p</span> &#123;</span><span class="language-css"><span class="hljs-attribute">color</span>: red;</span><span class="language-css"> &#125;</span><span class="language-css"><span class="hljs-comment">/* ç¬¬â¼€ä¸ªpæ ‡ç­¾å˜çº¢â¾Šäº† */</span></span><span class="language-css"><span class="hljs-selector-tag">div</span>~<span class="hljs-selector-tag">p</span>&#123;</span><span class="language-css"><span class="hljs-attribute">color</span>:red;</span><span class="language-css"> &#125;</span><span class="language-css"><span class="hljs-comment">/* divåâ¾¯çš„pæ ‡ç­¾éƒ½å˜æˆçº¢â¾Šäº† */</span></span><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></code></pre></div><h2 id="7-è¯´æ˜text-align-å±…ä¸­çš„æ¡ä»¶"><a href="#7-è¯´æ˜text-align-å±…ä¸­çš„æ¡ä»¶" class="headerlink" title="7.è¯´æ˜text-align****å±…ä¸­çš„æ¡ä»¶"></a><strong>7.è¯´æ˜</strong>text-align****å±…ä¸­çš„æ¡ä»¶</h2><ul><li>text-align : ç›´æ¥ç¿»è¯‘è¿‡æ¥è®¾ç½®â½‚æœ¬çš„â½”å¹³å¯¹â»¬â½…å¼ (æ˜¯ç»§æ‰¿å±æ€§)(æ˜¯ç»§æ‰¿å±æ€§)</li><li>text-align å¹¶ä¸æ§åˆ¶å—å…ƒç´ â¾ƒâ¼°çš„å¯¹â»¬ï¼Œåªæ§åˆ¶å®ƒçš„â¾å†…å†…å®¹çš„å¯¹â»¬</li><li>MDNè§£é‡Š: å®šä¹‰â¾å†…å†…å®¹ï¼ˆä¾‹å¦‚â½‚å­—ï¼‰å¦‚ä½•ç›¸å¯¹å®ƒçš„å—â½—å…ƒç´ å¯¹â»¬(å¯ä»¥è®¾ç½®å›¾â½šå±…ä¸­)</li><li>W3Cå®˜â½…â½‚æ¡£è§£é‡Š: è®¾ç½®â¾å†…(inline-level)å…ƒç´ (æ²¡æœ‰å¡«æ»¡â½—å…ƒç´ )åœ¨å¿«çº§â½—å…ƒç´ çš„å¯¹â»¬â½…å¼</li></ul><h2 id="8-line-heightä¸ºä»€ä¹ˆå¯ä»¥è®©â½‚å­—å‚ç›´å±…ä¸­ï¼Ÿ"><a href="#8-line-heightä¸ºä»€ä¹ˆå¯ä»¥è®©â½‚å­—å‚ç›´å±…ä¸­ï¼Ÿ" class="headerlink" title="8. line-heightä¸ºä»€ä¹ˆå¯ä»¥è®©â½‚å­—å‚ç›´å±…ä¸­ï¼Ÿ"></a><strong>8. line-height</strong>ä¸ºä»€ä¹ˆå¯ä»¥è®©â½‚å­—å‚ç›´å±…ä¸­ï¼Ÿ</h2><p>line-height :ä¸¤â¾â½‚å­—åŸºçº¿( baseline )ä¹‹é—´çš„é—´è· åŸºçº¿( baseline`):ä¸â¼©å†™å­—âºŸxæœ€åº•éƒ¨å¯¹â»¬çš„çº¿</p><p>â¼€â¾â½‚æœ¬ ç­‰äº line-height</p><p>â¾â¾¼ - â½‚æœ¬â¾¼åº¦ = â¾è·</p><p>å±æ€§å€¼:</p><p>normal :å–å†³äºâ½¤æˆ·ç«¯ã€‚æ¡Œâ¾¯æµè§ˆå™¨ï¼ˆåŒ…æ‹¬Firefoxï¼‰ä½¿â½¤é»˜è®¤å€¼ï¼Œçº¦ä¸º1.2ï¼Œè¿™å–å†³äºå…ƒç´ çš„</p><p>font-family</p><p>&lt;æ•°å­—&gt; :è¯¥å±æ€§çš„åº”â½¤å€¼æ˜¯è¿™ä¸ªâ½†å•ä½æ•°å­—&lt;æ•°å­—&gt;ä¹˜ä»¥è¯¥å…ƒç´ çš„å­—ä½“â¼¤â¼© è¿™æ˜¯è®¾ç½®line</p><p>heightçš„æ¨èâ½…æ³•ï¼Œä¸ä¼šåœ¨ç»§æ‰¿æ—¶äº§â½£ä¸ç¡®å®šçš„ç»“æœ</p><p>&lt;â»“åº¦&gt; :æŒ‡å®š&lt;â»“åº¦&gt;â½¤äºè®¡ç®— line box çš„â¾¼åº¦ ä»¥ em ä¸ºå•ä½çš„å€¼å¯èƒ½ä¼šäº§â½£ä¸ç¡®å®šçš„ç»“æœ</p><p>&lt;ç™¾åˆ†â½&gt; :ä¸å…ƒç´ â¾ƒèº«çš„å­—ä½“â¼¤â¼©æœ‰å…³ã€‚è®¡ç®—å€¼æ˜¯ç»™å®šçš„ç™¾åˆ†â½å€¼ä¹˜ä»¥å…ƒç´ è®¡ç®—å‡ºçš„å­—ä½“â¼¤</p><p>â¼©ã€‚ç™¾åˆ†â½å€¼å¯èƒ½ä¼šå¸¦æ¥ä¸ç¡®å®šçš„ç»“æœ</p><p>height :å…ƒç´ çš„æ•´ä½“â¾¼åº¦ line-height :å…ƒç´ ä¸­æ¯â¼€â¾â½‚å­—æ‰€å æ®çš„â¾¼åº¦</p><p>å‡è®¾divä¸­åªæœ‰â¼€â¾â½‚å­—ï¼Œå¦‚ä½•è®©è¿™â¾â½‚å­—åœ¨divå†…éƒ¨å‚ç›´å±…ä¸­ è®© line-height ç­‰åŒäº height</p><h2 id="9-è¯´è¯´ç›’â¼¦æ¨¡å‹åŒ…å«å“ªäº›å†…å®¹ï¼Ÿ"><a href="#9-è¯´è¯´ç›’â¼¦æ¨¡å‹åŒ…å«å“ªäº›å†…å®¹ï¼Ÿ" class="headerlink" title="**9.**è¯´è¯´ç›’â¼¦æ¨¡å‹åŒ…å«å“ªäº›å†…å®¹ï¼Ÿ"></a>**9.**è¯´è¯´ç›’â¼¦æ¨¡å‹åŒ…å«å“ªäº›å†…å®¹ï¼Ÿ</h2><ul><li><p>å†…å®¹</p><p>â€‹         é€šè¿‡å®½åº¦å’Œâ¾¼åº¦è®¾ç½®</p></li><li><p>å†…è¾¹è·</p><p>â€‹        é€šè¿‡paddingè®¾ç½®</p></li><li><p>padding: </p><p>â€‹        padding-top padding-right padding-bottom padding-left;</p></li><li><p>è¾¹æ¡†</p><p>â€‹        é€šè¿‡borderè®¾ç½®</p><p>â€‹        border: border-width border-style border-color</p><ul><li><p>å¤–è¾¹è·</p><p> é€šè¿‡marginè®¾ç½®</p><p>margin: margin-top margin-right margin-bottom margin-left</p></li></ul></li></ul><h2 id="10-è¯´è¯´ä½ å¯¹margin-çš„ä¼ é€’å’ŒæŠ˜å çš„ç†è§£"><a href="#10-è¯´è¯´ä½ å¯¹margin-çš„ä¼ é€’å’ŒæŠ˜å çš„ç†è§£" class="headerlink" title="*10.è¯´è¯´ä½ å¯¹margin***çš„ä¼ é€’å’ŒæŠ˜å çš„ç†è§£"></a>*<em>10.<strong>è¯´è¯´ä½ å¯¹</strong></em><em>margin</em>***çš„ä¼ é€’å’ŒæŠ˜å çš„ç†è§£</h2><ul><li>marginçš„ä¼ é€’â¼€èˆ¬æ˜¯â½—â¼¦å—å…ƒç´ ä¹‹é—´,æœ‰margin-topä¼ é€’,margin-bottomä¼ é€’.<ul><li>margin-topä¼ é€’: å½“å—çº§å…ƒç´ çš„é¡¶éƒ¨çº¿å’Œâ½—å…ƒç´ çš„é¡¶éƒ¨çº¿é‡å ï¼Œé‚£ä¹ˆè¿™ä¸ªå—çº§å…ƒç´ çš„margin-topå€¼ä¼šä¼ é€’ç»™â½—å…ƒç´ </li><li>margin-bottomä¼ é€’:å½“å—çº§å…ƒç´ çš„åº•éƒ¨çº¿å’Œâ½—å…ƒç´ çš„åº•éƒ¨çº¿é‡å ï¼Œé‚£ä¹ˆè¿™ä¸ªå—çº§å…ƒç´ çš„margin</li></ul></li><li>bottomå€¼ä¼šä¼ é€’ç»™â½—å…ƒç´ </li><li>æŠ˜å : æŒ‡çš„æ˜¯ å‚ç›´â½…å‘ä¸Šç›¸é‚»çš„2ä¸ªmarginï¼ˆmargin-topã€margin-bottomï¼‰æœ‰å¯èƒ½ä¼šåˆå¹¶ä¸º1ä¸ªmargin.</li><li>å®ƒæœ‰ä¸¤ä¸ªå…„å¼Ÿå—çº§å…ƒç´ ä¹‹é—´çš„ä¸Šä¸‹marginçš„æŠ˜å ,ä¹Ÿæœ‰â½—â¼¦å—å…ƒç´ ä¹‹é—´çš„marginæŠ˜å </li></ul><h2 id="11-CSS-éšè—â»šâ¾¯ä¸­æŸä¸ªå…ƒç´ çš„â¼ç§â½…æ³•"><a href="#11-CSS-éšè—â»šâ¾¯ä¸­æŸä¸ªå…ƒç´ çš„â¼ç§â½…æ³•" class="headerlink" title="11.CSS éšè—â»šâ¾¯ä¸­æŸä¸ªå…ƒç´ çš„â¼ç§â½…æ³•"></a><strong>11.CSS</strong> <strong>éšè—â»šâ¾¯ä¸­æŸä¸ªå…ƒç´ çš„â¼ç§â½…æ³•</strong></h2><p>display: none</p><p>â€‹    é€šè¿‡ CSS æ“æ§ displayï¼Œç§»å‡ºâ½‚æ¡£æµ</p><p>opacity: 0</p><p>â€‹    é€æ˜åº¦ä¸º 0ï¼Œä»åœ¨â½‚æ¡£æµä¸­ï¼Œå½“ä½œâ½¤äºå…¶ä¸Šçš„äº‹ä»¶(å¦‚ç‚¹å‡»)ä»æœ‰æ•ˆ</p><p>visibility: hidden</p><p>â€‹    é€æ˜åº¦ä¸º 0ï¼Œä»åœ¨â½‚æ¡£æµä¸­ï¼Œ<strong>ä½†ä½œâ½¤äºå…¶ä¸Šçš„äº‹ä»¶</strong>**(<strong><strong>å¦‚ç‚¹å‡»</strong></strong>)**<strong>â½†æ•ˆ</strong>ï¼Œè¿™ä¹Ÿæ˜¯</p><p>visibility:hidden ä¸ opacity: 0 çš„åŒºåˆ«</p><p>â€‹    content-visibility</p><p>â€‹    ç§»å‡ºâ½‚æ¡£æµï¼Œä½†æ˜¯å†æ¬¡æ˜¾ç¤ºæ—¶æ¶ˆè€—æ€§èƒ½ä½</p><p>â€‹    ç»å¯¹å®šä½äºå½“å‰â»šâ¾¯çš„ä¸å¯â»…ä½ç½®    </p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-attribute">position</span>: absolute;<span class="hljs-attribute">top</span>: -<span class="hljs-number">9000px</span>;<span class="hljs-attribute">left</span>: -<span class="hljs-number">9000px</span>;</code></pre></div><h2 id="12-box-sizingæœ‰ä»€ä¹ˆä½œâ½¤ï¼Ÿcontent-boxå’Œ-border-boxçš„åŒºåˆ«"><a href="#12-box-sizingæœ‰ä»€ä¹ˆä½œâ½¤ï¼Ÿcontent-boxå’Œ-border-boxçš„åŒºåˆ«" class="headerlink" title="12.box-sizingæœ‰ä»€ä¹ˆä½œâ½¤ï¼Ÿcontent-boxå’Œ****border-boxçš„åŒºåˆ«"></a><strong>12.box-sizing</strong>æœ‰ä»€ä¹ˆä½œâ½¤ï¼Ÿ<strong><strong>content-box</strong></strong>å’Œ****border-boxçš„åŒºåˆ«</h2><p>box-sizingâ½¤æ¥è®¾ç½®ç›’â¼¦æ¨¡å‹ä¸­å®½â¾¼çš„è®¡ç®—â½…å¼ï¼š</p><p>â€‹    content-box: paddingã€borderéƒ½å¸ƒç½®åœ¨widthã€heightå¤–è¾¹</p><p>â€‹    border-box: paddingã€borderéƒ½å¸ƒç½®åœ¨widthã€heightâ¾¥è¾¹</p><h2 id="13-ä¸ºä»€ä¹ˆä¼šå‘â½£æ ·å¼æŠ–åŠ¨"><a href="#13-ä¸ºä»€ä¹ˆä¼šå‘â½£æ ·å¼æŠ–åŠ¨" class="headerlink" title="**13.**ä¸ºä»€ä¹ˆä¼šå‘â½£æ ·å¼æŠ–åŠ¨"></a>**13.**ä¸ºä»€ä¹ˆä¼šå‘â½£æ ·å¼æŠ–åŠ¨</h2><p>å› ä¸ºæ²¡æœ‰æŒ‡å®šå…ƒç´ å…·ä½“â¾¼åº¦å’Œå®½åº¦,â½å¦‚æ•°æ®è¿˜æ²¡æœ‰åŠ è½½è¿›æ¥æ—¶å…ƒç´ â¾¼åº¦æ˜¯ 100px(å‡è®¾è¿™â¾¥æ˜¯100px)</p><p>æ•°æ®åŠ è½½è¿›æ¥å,å› ä¸ºæœ‰äº†æ•°æ®,ç„¶åå…ƒç´ è¢«æ’‘â¼¤,æ‰€æœ‰å‡ºç°äº†æŠ–åŠ¨</p><h2 id="14-è¯´è¯´æµ®åŠ¨å¸¸â»…çš„è§„åˆ™ï¼Ÿ"><a href="#14-è¯´è¯´æµ®åŠ¨å¸¸â»…çš„è§„åˆ™ï¼Ÿ" class="headerlink" title="**14.**è¯´è¯´æµ®åŠ¨å¸¸â»…çš„è§„åˆ™ï¼Ÿ"></a>**14.**è¯´è¯´æµ®åŠ¨å¸¸â»…çš„è§„åˆ™ï¼Ÿ</h2><ul><li><p>å…ƒç´ â¼€æ—¦æµ®åŠ¨å, è„±ç¦»æ ‡å‡†æµ</p><p>â€‹    æœç€å‘å·¦æˆ–å‘å³â½…å‘ç§»åŠ¨ï¼Œç›´åˆ°â¾ƒâ¼°çš„è¾¹ç•Œç´§è´´ç€åŒ…å«å—ï¼ˆâ¼€èˆ¬æ˜¯â½—å…ƒç´ ï¼‰æˆ–è€…å…¶ä»–æµ®åŠ¨å…ƒç´ çš„è¾¹ç•Œä¸ºâ½Œ</p></li><li><p>å®šä½å…ƒç´ ä¼šå±‚å åœ¨æµ®åŠ¨å…ƒç´ ä¸Šâ¾¯</p><p>â€‹    å¦‚æœå…ƒç´ æ˜¯å‘å·¦ï¼ˆå³ï¼‰æµ®åŠ¨ï¼Œæµ®åŠ¨å…ƒç´ çš„å·¦ï¼ˆå³ï¼‰è¾¹ç•Œä¸èƒ½è¶…å‡ºåŒ…å«å—çš„å·¦ï¼ˆå³ï¼‰è¾¹ç•Œ</p></li><li><p>æµ®åŠ¨å…ƒç´ ä¹‹é—´ä¸èƒ½å±‚å </p><p>â€‹    å¦‚æœâ¼€ä¸ªå…ƒç´ æµ®åŠ¨ï¼Œå¦â¼€ä¸ªæµ®åŠ¨å…ƒç´ å·²ç»åœ¨é‚£ä¸ªä½ç½®äº†ï¼Œåæµ®åŠ¨çš„å…ƒç´ å°†ç´§è´´ç€å‰â¼€ä¸ªæµ®åŠ¨å…ƒç´ ï¼ˆå·¦æµ®æ‰¾å·¦æµ®ï¼Œå³æµ®æ‰¾å³æµ®ï¼‰</p><p>â€‹    å¦‚æœâ½”å¹³â½…å‘å‰©ä½™çš„ç©ºé—´ä¸å¤Ÿæ˜¾ç¤ºæµ®åŠ¨å…ƒç´ ï¼Œæµ®åŠ¨å…ƒç´ å°†å‘ä¸‹ç§»åŠ¨ï¼Œç›´åˆ°æœ‰å……â¾œçš„ç©ºé—´ä¸ºâ½Œ</p></li><li><p>æµ®åŠ¨å…ƒç´ ä¸èƒ½ä¸â¾å†…çº§å†…å®¹å±‚å ï¼Œâ¾å†…çº§å†…å®¹å°†ä¼šè¢«æµ®åŠ¨å…ƒç´ æ¨å‡º</p><p>â€‹    â½å¦‚â¾å†…çº§å…ƒç´ ã€inline-blockå…ƒç´ ã€å—çº§å…ƒç´ çš„â½‚å­—å†…å®¹</p><p>â€‹    â¾å†…çº§å…ƒç´ ã€inline-blockå…ƒç´ æµ®åŠ¨åï¼Œå…¶é¡¶éƒ¨å°†ä¸æ‰€åœ¨â¾çš„é¡¶éƒ¨å¯¹â»¬</p></li></ul><h2 id="15-ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨æœ‰â¼ç§â½…æ³•ï¼Ÿ"><a href="#15-ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨æœ‰â¼ç§â½…æ³•ï¼Ÿ" class="headerlink" title="**15.**ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨æœ‰â¼ç§â½…æ³•ï¼Ÿ"></a>**15.**ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨æœ‰â¼ç§â½…æ³•ï¼Ÿ</h2><p><strong>ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼š</strong></p><p>1ï¼‰ç”±äºæµ®åŠ¨å…ƒç´ è„±ç¦»äº†æ ‡å‡†æµï¼Œå˜æˆäº†æµ®åŠ¨å…ƒç´ ï¼Œä¸å†å‘â½—å…ƒç´ æ±‡æŠ¥â¾¼åº¦ã€‚æ‰€ä»¥â½—å…ƒç´ åœ¨è®¡ç®—â¾¼åº¦æ—¶</p><p>å¹¶æ²¡æœ‰å°†æµ®åŠ¨å…ƒç´ çš„â¾¼åº¦è®¡ç®—è¿›æ¥ï¼Œå› æ­¤å°±é€ æˆäº†â¾¼åº¦å¡Œé™·çš„é—®é¢˜ ã€‚è§£å†³â¾¼åº¦å¡Œé™·çš„é—®é¢˜å°±å«åšæ¸…é™¤æµ®åŠ¨ï¼ˆ3åˆ†ï¼‰</p><p>2ï¼‰æ¸…é™¤æµ®åŠ¨çš„â½¬çš„ï¼šæ˜¯ä¸ºäº†è®©â½—å…ƒç´ åœ¨è®¡ç®—â¾¼åº¦çš„æ—¶å€™æŠŠæµ®åŠ¨â¼¦å…ƒç´ çš„â¾¼åº¦è®¡ç®—è¿›å»</p><p><strong>æ¸…é™¤æµ®åŠ¨æœ‰â¼ç§â½…æ³•ï¼š</strong></p><p>ç»™â½—å…ƒç´ è®¾ç½®å›ºå®šâ¾¼åº¦ï¼Œæ‰©å±•æ€§ä¸å¥½ï¼Œä¸æ¨è</p><p>åœ¨â½—å…ƒç´ çš„æœ€åå¢åŠ â¼€ä¸ªç©ºçš„å—çº§â¼¦å…ƒç´ ï¼Œå¹¶è®¾ç½®è®©ä»–clear:both , ä½†æ˜¯å¢åŠ äº†â½†æ„ä¹‰çš„ç©ºæ ‡ç­¾ï¼Œ</p><p>è¿åäº†ç»“æ„ä¸æ ·å¼åˆ†ç¦»çš„åŸåˆ™</p><p>ç»™â½—å…ƒç´ æ·»åŠ â¼€ä¸ªä¼ªå…ƒç´ (æ¨è)</p><div class="code-wrapper"><pre><code class="hljs CSS"><span class="hljs-selector-class">.clear_fix</span><span class="hljs-selector-pseudo">::after</span> &#123;<span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-attribute">display</span>: block;<span class="hljs-attribute">clear</span>:both;<span class="hljs-attribute">visibility</span>: hidden; <span class="hljs-comment">/* æµè§ˆå™¨å…¼å®¹æ€§ */</span><span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* æµè§ˆå™¨å…¼å®¹æ€§ */</span>&#125;<span class="hljs-selector-class">.clear_fix</span> &#123; *zoom: <span class="hljs-number">1</span>; <span class="hljs-comment">/* IE6/7å…¼å®¹æ€§ */</span>&#125;</code></pre></div><p>overflflow:autoè§¦å‘BFCæ¥æ¸…é™¤æµ®åŠ¨ï¼ˆå‰æâ¾¼åº¦ä¸ºautoï¼‰</p><h2 id="16-ä¼ªç±»ä¸ä¼ªå…ƒç´ æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#16-ä¼ªç±»ä¸ä¼ªå…ƒç´ æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="16.ä¼ªç±»ä¸ä¼ªå…ƒç´ æœ‰ä»€ä¹ˆåŒºåˆ«?"></a><strong>16.<strong>ä¼ªç±»ä¸ä¼ªå…ƒç´ æœ‰ä»€ä¹ˆåŒºåˆ«</strong></strong>?</h2><p>ä¼ªç±»ä½¿â½¤å•å†’å·ï¼Œâ½½ä¼ªå…ƒç´ ä½¿â½¤åŒå†’å·ã€‚å¦‚ :hover æ˜¯ä¼ªç±»ï¼Œ ::before æ˜¯ä¼ªå…ƒç´ </p><p>ä¼ªå…ƒç´ ä¼šåœ¨â½‚æ¡£æµâ½£æˆâ¼€ä¸ªæ–°çš„å…ƒç´ ï¼Œå¹¶ä¸”å¯ä»¥ä½¿â½¤ content å±æ€§è®¾ç½®å†…å®¹</p><h2 id="17-ç»“æ„ä¼ªç±»-nth-child-n-å’Œnth-of-type-n-çš„åŒºåˆ«ï¼Ÿ"><a href="#17-ç»“æ„ä¼ªç±»-nth-child-n-å’Œnth-of-type-n-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="*17.ç»“æ„ä¼ªç±»*nth-child(n)å’Œnth-of-type(n)****çš„åŒºåˆ«ï¼Ÿ"></a>*<em>17.<strong>ç»“æ„ä¼ªç±»</strong></em>*nth-child(n)<strong><strong>å’Œ</strong></strong>nth-of-type(n)****çš„åŒºåˆ«ï¼Ÿ</h2><p>:nth-child</p><p>æ˜¯ç»“æ„ä¼ªç±»é€‰æ‹©å™¨ï¼Œé€‰ä¸­â½—å…ƒç´ çš„ç¬¬â¼ä¸ªâ¼¦å…ƒç´  , è®¡æ•°æ—¶ä¸å…ƒç´ çš„ç±»å‹â½†å…³ã€‚</p><p>:nth-of-type</p><p>æ˜¯ç»“æ„ä¼ªç±»é€‰æ‹©å™¨å’Œnth-childç±»ä¼¼ï¼Œä½†æ˜¯è®¡æ•°æ—¶åªè®¡ç®—åŒç§ç±»å‹çš„å…ƒç´ ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>react18 å­¦ä¹ ç¬”è®°</title>
    <link href="/2022/08/30/react18-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/08/30/react18-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="Reactå¼€å‘ä¾èµ–"><a href="#Reactå¼€å‘ä¾èµ–" class="headerlink" title="Reactå¼€å‘ä¾èµ–"></a>Reactå¼€å‘ä¾èµ–</h4><p>reactå¼€å‘å¿…é¡»ä¾èµ–ä¸‰ä¸ªåº“ï¼š</p><ul><li><p>react   åŒ…å«reactæ‰€æœ‰å¿…é¡»çš„æ ¸å¿ƒä»£ç </p></li><li><p>react-dom reactæ¸²æŸ“åœ¨ä¸åŒå¹³å°æ‰€éœ€è¦çš„æ ¸å¿ƒä»£ç </p></li><li><p>babel  å°†jsxè½¬æ¢æˆReactä»£ç çš„å·¥å…·</p><p>react åŒ…å«react webå’Œreact-nativeæ‰€æ‹¥æœ‰çš„æ ¸å¿ƒä»£ç </p><p>react-domé’ˆå¯¹webå’Œnativeå®Œæˆçš„äº‹æƒ…ä¸åŒ</p><p>â€‹    webç«¯react-domä¼šå°†jsxæœ€ç»ˆæ¸²æŸ“æˆçœŸå®çš„DOMï¼Œæ˜¾ç¤ºåœ¨æµè§ˆå™¨</p><p>â€‹    nativeç«¯ react-domä¼šå°†jsxæœ€ç»ˆæ¸²æŸ“æˆåŸç”Ÿçš„æ§ä»¶</p><p>babelæ˜¯å°†jsxä»£ç è½¬æˆreact.createElement</p></li></ul><h4 id="Reactç»„ä»¶åŒ–å¼€å‘"><a href="#Reactç»„ä»¶åŒ–å¼€å‘" class="headerlink" title="Reactç»„ä»¶åŒ–å¼€å‘"></a>Reactç»„ä»¶åŒ–å¼€å‘</h4><p>â€‹    reactä¸­æ•°æ®ä¾èµ–æ¥è‡ªä¸¤æ–¹é¢</p><p>â€‹        å‚ä¸ç•Œé¢æ›´æ–°çš„æ•°æ®   å½“æ•°æ®å˜é‡æ—¶ï¼Œéœ€è¦æ›´æ–°ç»„ä»¶æ¸²æŸ“çš„å†…å®¹</p><p>â€‹        ä¸å‚ä¸ç•Œé¢æ›´æ–°çš„æ•°æ®  å½“æ•°æ®å˜é‡æ—¶ï¼Œä¸éœ€è¦æ›´æ–°å°†ç»„å»ºæ¸²æŸ“çš„å†…å®¹ï¼Œå‚ä¸ç•Œé¢æ›´æ–°çš„æ•°æ®æˆ‘ä»¬ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºæ˜¯å‚ä¸æ•°æ®æµï¼Œè¿™ä¸ªæ•°æ®æ˜¯å®šä¹‰åœ¨å½“å‰å¯¹è±¡çš„stateä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ„é€ å‡½æ•°ä¸­ this.state = {å®šä¹‰çš„æ•°æ®}</p><p> å½“æˆ‘ä»¬çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ this.setState æ¥æ›´æ–°æ•°æ®ï¼Œå¹¶ä¸”é€šçŸ¥Reactè¿›è¡Œupdateæ“ä½œï¼›åœ¨è¿›è¡Œupdateæ“ä½œæ—¶ï¼Œå°±ä¼šé‡æ–°è°ƒç”¨renderå‡½æ•°ï¼Œå¹¶ä¸”ä½¿ç”¨æœ€æ–°çš„æ•°æ®ï¼Œæ¥æ¸²æŸ“ç•Œé¢</p><ul><li><p>æ ¹æ®ç»„ä»¶çš„å®šä¹‰æ–¹å¼ï¼Œå¯ä»¥åˆ†ä¸ºï¼šå‡½æ•°ç»„ä»¶(Functional Component )å’Œç±»ç»„ä»¶(Class Component)ï¼›</p></li><li><p>æ ¹æ®ç»„ä»¶å†…éƒ¨æ˜¯å¦æœ‰çŠ¶æ€éœ€è¦ç»´æŠ¤ï¼Œå¯ä»¥åˆ†æˆï¼šæ— çŠ¶æ€ç»„ä»¶(Stateless Component )å’Œæœ‰çŠ¶æ€ç»„ä»¶(Stateful Component)ï¼›</p></li><li><p>æ ¹æ®ç»„ä»¶çš„ä¸åŒèŒè´£ï¼Œå¯ä»¥åˆ†æˆï¼šå±•ç¤ºå‹ç»„ä»¶(Presentational Component)å’Œå®¹å™¨å‹ç»„ä»¶(Container Component)ï¼›</p></li><li><p>å‡½æ•°ç»„ä»¶ã€æ— çŠ¶æ€ç»„ä»¶ã€å±•ç¤ºå‹ç»„ä»¶ä¸»è¦å…³æ³¨UIçš„å±•ç¤ºï¼›</p></li><li><p>ç±»ç»„ä»¶ã€æœ‰çŠ¶æ€ç»„ä»¶ã€å®¹å™¨å‹ç»„ä»¶ä¸»è¦å…³æ³¨æ•°æ®é€»è¾‘</p></li></ul><h4 id="JSXçš„æ¡ä»¶æ¸²æŸ“"><a href="#JSXçš„æ¡ä»¶æ¸²æŸ“" class="headerlink" title="JSXçš„æ¡ä»¶æ¸²æŸ“"></a>JSXçš„æ¡ä»¶æ¸²æŸ“</h4><p>â€‹    åœ¨reactä¸­ï¼Œæ‰€æœ‰æ¡ä»¶åˆ¤æ–­éƒ½å’Œæ™®é€šçš„jsä»£ç ä¸€è‡´ï¼Œè€Œvueä¸­ä¼šä½¿ç”¨v-if/v-showç­‰æ¥æ§åˆ¶ï¼Œreactä¸­æ²¡æœ‰è¿™æ ·å°è£…å¥½çš„æŒ‡ä»¤</p><p>â€‹    reactå¸¸è§çš„æ¡ä»¶æ¸²æŸ“æ–¹å¼</p><ul><li><p>æ¡ä»¶åˆ¤æ–­è¯­å¥</p></li><li><p>ä¸‰å…ƒè¿ç®—ç¬¦</p></li><li><p>ä¸è¿ç®—ç¬¦&amp;&amp;</p></li><li><p>displayæ¥æ§åˆ¶</p><div class="code-wrapper"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;text/babel&quot;</span>&gt;    <span class="hljs-comment">// 1.å®šä¹‰Appæ ¹ç»„ä»¶</span>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;      <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">super</span>()        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;          <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Hello World&quot;</span>,          <span class="hljs-attr">isReady</span>: <span class="hljs-literal">false</span>,          <span class="hljs-attr">friend</span>: <span class="hljs-literal">undefined</span>        &#125;      &#125;      <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">const</span> &#123; isReady, friend &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>        <span class="hljs-comment">// 1.æ¡ä»¶åˆ¤æ–­æ–¹å¼ä¸€: ä½¿ç”¨ifè¿›è¡Œæ¡ä»¶åˆ¤æ–­</span>        <span class="hljs-keyword">let</span> showElement = <span class="hljs-literal">null</span>        <span class="hljs-keyword">if</span> (isReady) &#123;          showElement = <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å‡†å¤‡å¼€å§‹æ¯”èµ›å§<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span>        &#125; <span class="hljs-keyword">else</span> &#123;          showElement = <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>è¯·æå‰åšå¥½å‡†å¤‡!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>        &#125;        <span class="hljs-keyword">return</span> (          <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">            &#123;/* 1.æ–¹å¼ä¸€: æ ¹æ®æ¡ä»¶ç»™å˜é‡èµ‹å€¼ä¸åŒçš„å†…å®¹ */&#125;</span><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;showElement&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">            &#123;/* 2.æ–¹å¼äºŒ: ä¸‰å…ƒè¿ç®—ç¬¦ */&#125;</span><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123; isReady ? <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>å¼€å§‹æˆ˜æ–—!<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>: <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>èµ¶ç´§å‡†å¤‡<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span> &#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">            &#123;/* 3.æ–¹å¼ä¸‰: &amp;&amp;é€»è¾‘ä¸è¿ç®— */&#125;</span><span class="language-xml">            &#123;/* åœºæ™¯: å½“æŸä¸€ä¸ªå€¼, æœ‰å¯èƒ½ä¸ºundefinedæ—¶, ä½¿ç”¨&amp;&amp;è¿›è¡Œæ¡ä»¶åˆ¤æ–­ */&#125;</span><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123; friend &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;friend.name + &quot; &quot; + friend.desc&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> &#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>        )      &#125;    &#125;    <span class="hljs-comment">// 2.åˆ›å»ºrootå¹¶ä¸”æ¸²æŸ“Appç»„ä»¶</span>    <span class="hljs-keyword">const</span> root = <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">createRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#root&quot;</span>))    root.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span>)  &lt;/script&gt;</code></pre></div></li></ul><p>1.reactä¸­ï¼Œæ–¹æ³•ä¸­thisçš„é»˜è®¤æ˜¯æŒ‡å‘undefinedçš„ï¼Œ</p><p>  2.vscodeåˆ›å»ºç”¨æˆ·ä»£ç ç‰‡æ®µ<br>3.<br> <div class="code-wrapper"><pre><code class="hljs js">jsxå†™æ³¨é‡Š&#123;<span class="hljs-comment">/* */</span>&#125; <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;    <span class="hljs-keyword">return</span> (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        &#123;/*è¿™æ˜¯ä¸€æ®µæ³¨é‡Š*/&#125;</span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>    )  &#125;&#125;</code></pre></div></p><p>â€‹    4.</p><div class="code-wrapper"><pre><code class="hljs actionscript"><span class="hljs-comment">//è¿™ä¸‰ä¸ªå€¼æ— æ³•åœ¨jsxä¸­æ¸²æŸ“å‡ºæ¥</span>   test1:<span class="hljs-literal">undefined</span>   test2:<span class="hljs-literal">null</span>   text3:<span class="hljs-literal">false</span></code></pre></div><p>5.åœ¨jsxä¸­å¯¹è±¡ç±»å‹ä¸å¯ä»¥ä½œä¸ºå­å…ƒç´ ,è¿›è¡Œç›´æ¥å±•ç¤º</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;this.state.obj&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><p>6.jsxåµŒå…¥è¡¨è¾¾å¼<br>    è¿ç®—è¡¨è¾¾å¼<br>    ä¸‰å…ƒè¿ç®—ç¬¦<br>    æ‰§è¡Œä¸€ä¸ªå‡½æ•°</p><p>7.jsxä¸­çš„classç”¨className<br>8.jsxä¸­styleçš„å†™æ³•</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;color:</span>&quot;<span class="hljs-attr">red</span>&quot;,<span class="hljs-attr">fontSzie:</span>&quot;<span class="hljs-attr">24px</span>&quot;&#125;&#125;&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></code></pre></div><p>9.reactçš„äº‹ä»¶ç»‘å®š<br>    reactçš„äº‹ä»¶ç»‘å®šæ–¹æ³•ä¸­thisé»˜è®¤æ˜¯undefined<br>    thisçš„ç»‘å®šçš„ä¸‰ç§æ–¹å¼</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;    <span class="hljs-comment">// class fields</span>    name = <span class="hljs-string">&quot;App&quot;</span>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-comment">//ç±»ç»„ä»¶ç»§æ‰¿ä¸€å®šè¦åŠ super()å¹¶ä¸”å¿…é¡»å†™åœ¨æœ€ä¸Šé¢</span>      <span class="hljs-variable language_">super</span>()      <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;        <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Hello World&quot;</span>,        <span class="hljs-attr">counter</span>: <span class="hljs-number">100</span>      &#125;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">btn1Click</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">btn1Click</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)    &#125;    <span class="hljs-title function_">btn1Click</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;btn1Click&quot;</span>, <span class="hljs-variable language_">this</span>);      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">counter</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">counter</span> + <span class="hljs-number">1</span> &#125;)    &#125;    btn2Click = <span class="hljs-function">() =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;btn2Click&quot;</span>, <span class="hljs-variable language_">this</span>)      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">counter</span>: <span class="hljs-number">1000</span> &#125;)    &#125;    <span class="hljs-title function_">btn3Click</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;btn3Click&quot;</span>, <span class="hljs-variable language_">this</span>);      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">counter</span>: <span class="hljs-number">9999</span> &#125;)    &#125;    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-keyword">const</span> &#123; message &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>      <span class="hljs-keyword">return</span> (        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">          &#123;/* 1.thisç»‘å®šæ–¹å¼ä¸€: bindç»‘å®š */&#125;</span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.btn1Click&#125;</span>&gt;</span>æŒ‰é’®1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">          </span><span class="language-xml">          &#123;/* 2.thisç»‘å®šæ–¹å¼äºŒ: ES6 class fields */&#125;</span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.btn2Click&#125;</span>&gt;</span>æŒ‰é’®2<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml"></span><span class="language-xml">          &#123;/* 3.thisç»‘å®šæ–¹å¼ä¸‰: ç›´æ¥ä¼ å…¥ä¸€ä¸ªç®­å¤´å‡½æ•°(é‡è¦) */&#125;</span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> console.log(&quot;btn3Click&quot;)&#125;&gt;æŒ‰é’®3<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> this.btn3Click()&#125;&gt;æŒ‰é’®3<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml"></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å½“å‰è®¡æ•°: &#123;this.state.counter&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>      )    &#125;  &#125;  <span class="hljs-comment">// 2.åˆ›å»ºrootå¹¶ä¸”æ¸²æŸ“Appç»„ä»¶</span>  <span class="hljs-keyword">const</span> root = <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">createRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#root&quot;</span>))  root.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span>)</code></pre></div><p> 10.reactäº‹ä»¶çš„ä¼ å‚</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;(e)</span>=&gt;</span>&#123;         this.click3(e,item,name)       &#125;&#125;&gt;ç‚¹å‡»3<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></code></pre></div><p>â€‹        å¯ä»¥ç”¨æ¥ä¼ é€’event<br>â€‹<br> åœ¨æ‰§è¡Œäº‹ä»¶å‡½æ•°æ—¶ï¼Œæœ‰å¯èƒ½æˆ‘ä»¬éœ€è¦è·å–ä¸€äº›å‚æ•°ä¿¡æ¯ï¼šæ¯”å¦‚eventå¯¹è±¡ã€å…¶ä»–å‚æ•°<br> æƒ…å†µä¸€ï¼šè·å–eventå¯¹è±¡<br> å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦æ‹¿åˆ°eventå¯¹è±¡æ¥åšä¸€äº›äº‹æƒ…ï¼ˆæ¯”å¦‚é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼‰<br> å‡å¦‚æˆ‘ä»¬ç”¨ä¸åˆ°thisï¼Œé‚£ä¹ˆç›´æ¥ä¼ å…¥å‡½æ•°å°±å¯ä»¥è·å–åˆ°eventå¯¹è±¡ï¼›<br> æƒ…å†µäºŒï¼šè·å–æ›´å¤šå‚æ•°<br> æœ‰æ›´å¤šå‚æ•°æ—¶ï¼Œæˆ‘ä»¬æœ€å¥½çš„æ–¹å¼å°±æ˜¯ä¼ å…¥ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œä¸»åŠ¨æ‰§è¡Œçš„äº‹ä»¶å‡½æ•°ï¼Œå¹¶ä¸”ä¼ å…¥ç›¸å…³çš„å…¶ä»–å‚æ•°</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-keyword">const</span> &#123; message &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>      <span class="hljs-keyword">return</span> (        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">          &#123;/* 1.eventå‚æ•°çš„ä¼ é€’ */&#125;</span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.btnClick.bind(this)&#125;</span>&gt;</span>æŒ‰é’®1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;(event)</span> =&gt;</span> this.btnClick(event)&#125;&gt;æŒ‰é’®2<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">          </span><span class="language-xml">          &#123;/* 2.é¢å¤–çš„å‚æ•°ä¼ é€’ */&#125;</span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.btnClick.bind(this,</span> &quot;<span class="hljs-attr">kobe</span>&quot;, <span class="hljs-attr">30</span>)&#125;&gt;</span>æŒ‰é’®3(ä¸æ¨è)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;(event)</span> =&gt;</span> this.btnClick(event, &quot;why&quot;, 18)&#125;&gt;æŒ‰é’®4<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>      )    &#125;</code></pre></div><p> 11.reactçš„åˆ—è¡¨æ¸²æŸ“ä½¿ç”¨æœ€å¤šçš„æ˜¯ä½¿ç”¨map<br>     è¿‡æ»¤filter<br>     æˆªå–slice<br> 12.React.createElement() jsxæ˜¯ä»–çš„è¯­æ³•ç³–</p><p>â€‹    createElementéœ€è¦ä¼ é€’ä¸‰ä¸ªå‚æ•°</p><ul><li><p>type      å½“å‰ReactElementçš„ç±»å‹ï¼Œå¦‚æœæ˜¯æ ‡ç­¾å…ƒç´ ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨å­—ç¬¦ä¸²è¡¨ç¤ºdiv,å¦‚æœæ˜¯ç»„ä»¶å…ƒç´ å°±ç”¨ç»„ä»¶çš„åç§°</p></li><li><p>config    æ‰€æœ‰jsxä¸­çš„å±æ€§åœ¨configä¸­éƒ½æ˜¯å¯¹è±¡çš„å±æ€§å’Œå€¼çš„å½¢å¼å­˜åœ¨ï¼Œä¾‹å¦‚classNameä½œä¸ºclass</p></li><li><p>children  å­˜æ”¾åœ¨æ ‡ç­¾ä¸­çš„å†…å®¹éƒ½æ˜¯ä»¥childrenæ•°ç»„çš„å½¢å¼å­˜å‚¨</p><p><img src="https://img1.imgtp.com/2022/09/12/pgiZpbQL.png" alt="QQæˆªå›¾20220912114717.png"></p></li></ul><p> 13.render() å°†virtual Dom=&gt;Dom<br> 14.é¢‘ç¹çš„æ“ä½œDOMï¼Œä¼šäº§ç”Ÿå›æµå’Œé‡ç»˜<br> 15.React ç»„ä»¶åç§°é¦–å­—æ¯å¿…é¡»å¤§å†™ htmlæ ‡ç­¾å¿…é¡»å°å†™<br>     ç±»ç»„ä»¶éœ€è¦ç»§æ‰¿è‡ª React.Component<br>      ç±»ç»„ä»¶å¿…é¡»å®ç°renderå‡½æ•°<br> 16.å‡½æ•°å¼ç»„ä»¶<br>      æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿä¼šè¢«æ›´æ–°å¹¶æŒ‚è½½ï¼Œä½†æ˜¯æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼›<br>      æ²¡æœ‰this(ç»„ä»¶å®ä¾‹ï¼‰ï¼›<br>     æ²¡æœ‰å†…éƒ¨çŠ¶æ€ï¼ˆstateï¼‰<br> 17.renderå‡½æ•°ã€å‡½æ•°å¼ç»„ä»¶çš„è¿”å›ç±»å‹<br>         ç»„ä»¶ï¼Œhtmlå…ƒç´ <br>         æ•°ç»„ã€fragments<br>         Portals<br>         å­—ç¬¦ä¸²æˆ–è€…æ•°å€¼ç±»å‹<br>         Booleanï¼Œnull<br> 18.reactçš„ç”Ÿå‘½å‘¨æœŸ</p><p>ç”Ÿå‘½å‘¨æœŸå›¾è°±</p><img src="https://img1.imgtp.com/2022/09/12/X4cHBQk6.png" alt="QQæˆªå›¾20220912132938.png" style="zoom:200%;" /><img src="https://img1.imgtp.com/2022/09/12/ACO5RXp5.png" alt="QQæˆªå›¾20220912133029.png" style="zoom:200%;" /><p> å¸¸ç”¨çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°     </p><div class="code-wrapper"><pre><code class="hljs">    1.contructor()&#123;    &#125;     å¦‚æœä¸åˆå§‹åŒ– state æˆ–ä¸è¿›è¡Œæ–¹æ³•ç»‘å®šï¼Œåˆ™ä¸éœ€è¦ä¸º React ç»„ä»¶å®ç°æ„é€ å‡½æ•°ã€‚     constructorä¸­é€šå¸¸åªåšä¸¤ä»¶äº‹æƒ…ï¼š     é€šè¿‡ç»™ this.state èµ‹å€¼å¯¹è±¡æ¥åˆå§‹åŒ–å†…éƒ¨çš„stateï¼›     ä¸ºäº‹ä»¶ç»‘å®šå®ä¾‹ï¼ˆthisï¼‰ï¼›    2.componentDidMount()      componentDidMount() ä¼šåœ¨ç»„ä»¶æŒ‚è½½åï¼ˆæ’å…¥ DOM æ ‘ä¸­ï¼‰ç«‹å³è°ƒç”¨          å¯ä»¥è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œæ·»åŠ è®¢é˜…ï¼ŒDOMæ“ä½œ    3.componentDidUpdate(prevProps, prevState, snapshot)      ä¼šåœ¨æ›´è¡Œåç«‹å³è°ƒç”¨ï¼Œé¦–æ¬¡æ¸²æŸ“ä¸ä¼šæ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨setStateæ–¹æ³•ï¼Œä½†æ˜¯å¿…é¡»ç”¨äºæ¡ä»¶è¯­å¥ï¼Œå½“ç»„ä»¶æ›´æ–°åï¼Œå¯ä»¥åœ¨æ­¤å¤„å¯¹ DOM è¿›è¡Œæ“ä½œï¼Œå¦‚æœä½ å¯¹æ›´æ–°å‰åçš„ props è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¹Ÿå¯ä»¥é€‰æ‹©åœ¨æ­¤å¤„è¿›è¡Œç½‘ç»œè¯·æ±‚    4.componentWillUnmount()      å¯ä»¥ç”¨äºæ¸…æ¥štimer,å–æ¶ˆç½‘ç»œè¯·æ±‚ï¼Œå–æ¶ˆè®¢é˜…    5.ä¸å¸¸ç”¨çš„ç”Ÿå‘½å‘¨æœŸ      getDerivedStateFromPropsï¼šstate çš„å€¼åœ¨ä»»ä½•æ—¶å€™éƒ½ä¾èµ–äº propsæ—¶ä½¿ç”¨ï¼›è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡æ¥æ›´æ–°stateï¼›      getSnapshotBeforeUpdateï¼šåœ¨Reactæ›´æ–°DOMä¹‹å‰å›è°ƒçš„ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥è·å–DOMæ›´æ–°å‰çš„ä¸€äº›ä¿¡æ¯ï¼ˆæ¯”å¦‚è¯´æ»šåŠ¨ä½ç½®ï¼‰      shouldComponentUpdateï¼šå½“ props æˆ– state å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒshouldComponentUpdate() ä¼šåœ¨æ¸²æŸ“æ‰§è¡Œä¹‹å‰è¢«è°ƒç”¨ã€‚è¿”å›å€¼é»˜è®¤ä¸º trueã€‚é¦–æ¬¡æ¸²æŸ“æˆ–ä½¿ç”¨ forceUpdate() æ—¶ä¸ä¼šè°ƒç”¨è¯¥æ–¹æ³•ã€‚æ­¤æ–¹æ³•ä»…ä½œä¸ºæ€§èƒ½ä¼˜åŒ–çš„æ–¹å¼è€Œå­˜åœ¨ã€‚ä¸è¦ä¼å›¾ä¾é æ­¤æ–¹æ³•æ¥â€œé˜»æ­¢â€æ¸²æŸ“ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šäº§ç”Ÿ bugã€‚ä½ åº”è¯¥è€ƒè™‘ä½¿ç”¨å†…ç½®çš„ PureComponent ç»„ä»¶ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨ç¼–å†™ shouldComponentUpdate()ã€‚PureComponent ä¼šå¯¹ props å’Œ state è¿›è¡Œæµ…å±‚æ¯”è¾ƒï¼Œå¹¶å‡å°‘äº†è·³è¿‡å¿…è¦æ›´æ–°çš„å¯èƒ½æ€§ã€‚</code></pre></div><p>   19.ç»„ä»¶é€šä¿¡<br>         1.çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ® ä¼ é€’å‚æ•°æ˜¯å¸¸é‡éstringçš„æ—¶å€™è¦å°†å…¶å½“ä½œå˜é‡ç”¨{}</p><div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Children2</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;é‡Œæ–¯&quot;</span> <span class="hljs-attr">age</span>=<span class="hljs-string">&#123;55&#125;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Children2</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs">     2.å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå®šä¹‰å›è°ƒå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶è°ƒç”¨</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">import React, &#123; Component &#125; from &#x27;react&#x27;import AddCounter from &#x27;./AddCounter&#x27;import SubCounter from &#x27;./SubCounter&#x27;export class App extends Component &#123;  constructor() &#123;    super()    this.state = &#123;      counter: 100    &#125;  &#125;  changeCounter(count) &#123;    this.setState(&#123; counter: this.state.counter + count &#125;)  &#125;  render() &#123;    const &#123; counter &#125; = this.state    return (      &lt;div&gt;        &lt;h2&gt;å½“å‰è®¡æ•°: &#123;counter&#125;&lt;/h2&gt;        &lt;AddCounter addClick=&#123;(count) =&gt; this.changeCounter(count)&#125;/&gt;        &lt;SubCounter subClick=&#123;(count) =&gt; this.changeCounter(count)&#125;/&gt;      &lt;/div&gt;    )  &#125;&#125;export default App</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">import React, &#123; Component &#125; from &#x27;react&#x27;// import PropTypes from &quot;prop-types&quot;export class AddCounter extends Component &#123;  addCount(count) &#123;    this.props.addClick(count)  &#125;  render() &#123;    return (      &lt;div&gt;        &lt;button onClick=&#123;e =&gt; this.addCount(1)&#125;&gt;+1&lt;/button&gt;        &lt;button onClick=&#123;e =&gt; this.addCount(5)&#125;&gt;+5&lt;/button&gt;        &lt;button onClick=&#123;e =&gt; this.addCount(10)&#125;&gt;+10&lt;/button&gt;      &lt;/div&gt;    )  &#125;&#125;// AddCounter.propTypes = &#123;//   addClick: PropTypes.func// &#125;export default AddCounter</code></pre></div><div class="code-wrapper"><pre><code class="hljs">    3.è·¨ç»„ä»¶é€šä¿¡Contextï¼Œå¯ä»¥ä½¿ç”¨ç»„ä»¶çš„ç»„åˆæ¥æ›¿ä»£Context        </code></pre></div><div class="code-wrapper"><pre><code class="hljs arduino"><span class="hljs-keyword">import</span> React from <span class="hljs-string">&quot;react&quot;</span><span class="hljs-comment">// 1.åˆ›å»ºä¸€ä¸ªContextå¹¶ä¸”è®¾ç½®é»˜è®¤å€¼</span><span class="hljs-type">const</span> ThemeContext = React.<span class="hljs-built_in">createContext</span>(&#123; color: <span class="hljs-string">&quot;blue&quot;</span>, size: <span class="hljs-number">10</span> &#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ThemeContext</code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-comment">// 1.åˆ›å»ºä¸€ä¸ªContext</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">UserContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>()<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">UserContext</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs react">//App.js//å¤šä¸ªcontextä¼ é€’æ•°æ®çš„æ–¹å¼&lt;UserContext.Provider value=&#123;&#123;nickname: &quot;kobe&quot;, age: 30&#125;&#125;&gt;          &lt;ThemeContext.Provider value=&#123;&#123;color: &quot;red&quot;, size: &quot;30&quot;&#125;&#125;&gt;            &lt;Home &#123;...info&#125;/&gt;          &lt;/ThemeContext.Provider&gt; &lt;/UserContext.Provider&gt;</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">//ç±»ç»„ä»¶çš„æ¥å—æ–¹å¼import React, &#123; Component &#125; from &#x27;react&#x27;import ThemeContext from &#x27;./context/theme-context&#x27;export class Profile extends Component &#123;  render() &#123;    console.log(this.context)    return (      &lt;div&gt;Profile&lt;/div&gt;    )  &#125;&#125;Profile.contextType = ThemeContextexport default Profile</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">//å‡½æ•°å¼ç»„ä»¶çš„æ¥æ”¶æ–¹å¼import ThemeContext from &quot;./context/theme-context&quot;function HomeBanner() &#123;  return &lt;div&gt;    &#123;/* å‡½æ•°å¼ç»„ä»¶ä¸­ä½¿ç”¨Contextå…±äº«çš„æ•°æ® */&#125;    &lt;ThemeContext.Consumer&gt;      &#123;        value =&gt; &#123;          return &lt;h2&gt; Banner theme:&#123;value.color&#125;&lt;/h2&gt;        &#125;      &#125;    &lt;/ThemeContext.Consumer&gt;  &lt;/div&gt;&#125;export default HomeBanner</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">import React, &#123; Component &#125; from &#x27;react&#x27;import ThemeContext from &#x27;./context/theme-context&#x27;import UserContext from &#x27;./context/user-context&#x27;export class HomeInfo extends Component &#123;  //static contextType=ThemeContext è¿™ç§å†™æ³•ä¹Ÿå¯ä»¥  render() &#123;    // 4.ç¬¬å››æ­¥æ“ä½œ: è·å–æ•°æ®, å¹¶ä¸”ä½¿ç”¨æ•°æ®    console.log(this.context)    return (      &lt;div&gt;        &lt;h2&gt;HomeInfo: &#123;this.context.color&#125;&lt;/h2&gt;        &lt;UserContext.Consumer&gt;          &#123;            value =&gt; &#123;              return &lt;h2&gt;Info User: &#123;value.nickname&#125;&lt;/h2&gt;            &#125;          &#125;        &lt;/UserContext.Consumer&gt;      &lt;/div&gt;    )  &#125;&#125;// 3.ç¬¬ä¸‰æ­¥æ“ä½œ: è®¾ç½®ç»„ä»¶çš„contextTypeä¸ºæŸä¸€ä¸ªContextHomeInfo.contextType = ThemeContextHomeInfo.displayName = &#x27;MyDisplayName&#x27;;//è®¾ç½®åœ¨devtoolçš„æ˜¾ç¤ºåå­—export default HomeInfo</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">//å¤šä¸ªcontextçš„ä½¿ç”¨// Theme contextï¼Œé»˜è®¤çš„ theme æ˜¯ â€œlightâ€ å€¼const ThemeContext = React.createContext(&#x27;light&#x27;);// ç”¨æˆ·ç™»å½• contextconst UserContext = React.createContext(&#123;  name: &#x27;Guest&#x27;,&#125;);class App extends React.Component &#123;  render() &#123;    const &#123;signedInUser, theme&#125; = this.props;    // æä¾›åˆå§‹ context å€¼çš„ App ç»„ä»¶    return (      &lt;ThemeContext.Provider value=&#123;theme&#125;&gt;        &lt;UserContext.Provider value=&#123;signedInUser&#125;&gt;          &lt;Layout /&gt;        &lt;/UserContext.Provider&gt;      &lt;/ThemeContext.Provider&gt;    );  &#125;&#125;function Layout() &#123;  return (    &lt;div&gt;      &lt;Sidebar /&gt;      &lt;Content /&gt;    &lt;/div&gt;  );&#125;// ä¸€ä¸ªç»„ä»¶å¯èƒ½ä¼šæ¶ˆè´¹å¤šä¸ª contextfunction Content() &#123;  return (    &lt;ThemeContext.Consumer&gt;      &#123;theme =&gt; (        &lt;UserContext.Consumer&gt;          &#123;user =&gt; (            &lt;ProfilePage user=&#123;user&#125; theme=&#123;theme&#125; /&gt;          )&#125;        &lt;/UserContext.Consumer&gt;      )&#125;    &lt;/ThemeContext.Consumer&gt;  );&#125;</code></pre></div><p>**ä»€ä¹ˆæ—¶å€™ä½¿ç”¨Context.Consumerå‘¢ï¼Ÿ</p><p>.å½“ä½¿ç”¨valueçš„ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶æ—¶ï¼›</p><p>.å½“ç»„ä»¶ä¸­éœ€è¦ä½¿ç”¨å¤šä¸ªContextæ—¶ï¼›</p><p> 4.ä½¿ç”¨äº‹ä»¶æ€»çº¿<br>   20.å¯¹propsè¿›è¡Œç±»å‹æ£€æŸ¥ propTypes</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">PropTypes</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;prop-types&quot;</span><span class="hljs-title class_">Children2</span>.<span class="hljs-property">propTypes</span> = &#123;          <span class="hljs-comment">// å¿…å¡«å±æ€§</span>          <span class="hljs-attr">name</span>: <span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">string</span>.<span class="hljs-property">isRequired</span>,          <span class="hljs-attr">age</span>: <span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">number</span>,          <span class="hljs-attr">time</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">array</span>        &#125;;        <span class="hljs-comment">// å¯ä»¥å®šä¹‰é»˜è®¤Â·å€¼</span><span class="hljs-title class_">Children2</span>.<span class="hljs-property">defaultProps</span>=&#123;          <span class="hljs-attr">time</span>:[<span class="hljs-string">&quot;2022/5/11&quot;</span>,<span class="hljs-string">&quot;2022/5/6&quot;</span>]        &#125;</code></pre></div><p> 21.propsä¸ºä»€ä¹ˆä¸å†™ä¹Ÿæ˜¯å¯ä»¥çš„   </p><div class="code-wrapper"><pre><code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">()</span><span class="hljs-comment">&#123;</span></span><span class="hljs-comment"><span class="hljs-function">      super()</span></span><span class="hljs-comment"><span class="hljs-function">      this.state=&#123;&#125;</span></span><span class="hljs-function">    &#125;</span><span class="hljs-function"> å› ä¸º<span class="hljs-title">react</span>å†…éƒ¨ä¼šå¼ºåˆ¶æ€§ç»™å½“å‰å®ä¾‹å¤åˆ¶<span class="hljs-title">props</span></span><span class="hljs-function"> <span class="hljs-title">this</span>.<span class="hljs-title">instance</span>=<span class="hljs-title">element</span>.<span class="hljs-title">props</span></span></code></pre></div><p>22.ç»„ä»¶æ’æ§½çš„å®ç°</p><div class="code-wrapper"><pre><code class="hljs html"> //App.js<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>        &#123;/* 1.ä½¿ç”¨childrenå®ç°æ’æ§½ */&#125;        <span class="hljs-tag">&lt;<span class="hljs-name">NavBar</span>&gt;</span>          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å“ˆå“ˆå“ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>          <span class="hljs-tag">&lt;<span class="hljs-name">i</span>&gt;</span>æ–œä½“æ–‡æœ¬<span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">NavBar</span>&gt;</span>        &#123;/* 2.ä½¿ç”¨propså®ç°æ’æ§½ */&#125;        <span class="hljs-tag">&lt;<span class="hljs-name">NavBarTwo</span> </span><span class="hljs-tag">          <span class="hljs-attr">leftSlot</span>=<span class="hljs-string">&#123;btn&#125;</span></span><span class="hljs-tag">          <span class="hljs-attr">centerSlot</span>=<span class="hljs-string">&#123;</span>&lt;<span class="hljs-attr">h2</span>&gt;</span>å‘µå‘µå‘µ<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>&#125;          rightSlot=&#123;<span class="hljs-tag">&lt;<span class="hljs-name">i</span>&gt;</span>æ–œä½“2<span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>&#125;        /&gt;      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs react">//NavBar.jsexport class NavBar extends Component &#123;  render() &#123;    const &#123; children &#125; = this.props    console.log(children)    return (      &lt;div className=&#x27;nav-bar&#x27;&gt;        &lt;div className=&quot;left&quot;&gt;&#123;children[0]&#125;&lt;/div&gt;        &lt;div className=&quot;center&quot;&gt;&#123;children[1]&#125;&lt;/div&gt;        &lt;div className=&quot;right&quot;&gt;&#123;children[2]&#125;&lt;/div&gt;      &lt;/div&gt;    )  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">//NavBarTwo.jsimport React, &#123; Component &#125; from &#x27;react&#x27;export class NavBarTwo extends Component &#123;  render() &#123;    const &#123; leftSlot, centerSlot, rightSlot &#125; = this.props    return (      &lt;div className=&#x27;nav-bar&#x27;&gt;        &lt;div className=&quot;left&quot;&gt;&#123;leftSlot&#125;&lt;/div&gt;        &lt;div className=&quot;center&quot;&gt;&#123;centerSlot&#125;&lt;/div&gt;        &lt;div className=&quot;right&quot;&gt;&#123;rightSlot&#125;&lt;/div&gt;      &lt;/div&gt;    )  &#125;&#125;</code></pre></div><p>é€šè¿‡childrenå®ç°çš„æ–¹æ¡ˆè™½ç„¶å¯è¡Œï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå¼Šç«¯ï¼šé€šè¿‡ç´¢å¼•å€¼è·å–ä¼ å…¥çš„å…ƒç´ å¾ˆå®¹æ˜“å‡ºé”™ï¼Œä¸èƒ½ç²¾å‡†çš„è·å–ä¼ å…¥çš„åŸç”Ÿ</p><p>23.setState<br>   setStateæ˜¯å¼‚æ­¥æ›´æ–°ï¼Œå¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½<br>   å¦‚æœæ¯ä¸€æ¬¡è°ƒç”¨setStateéƒ½è¿›è¡Œä¸€æ¬¡æ›´æ–°ï¼Œé‚£ä¹ˆæ„å‘³ç€renderå‡½æ•°éœ€è¦é¢‘ç¹çš„è°ƒç”¨<br>   æœ€å¥½çš„åŠæ³•æ˜¯è·å–å¤šä¸ªæ›´æ–°ï¼Œä¹‹åè¿›è¡Œæ‰¹é‡æ›´æ–°<br>   å¦‚æœåŒæ­¥æ›´æ–°äº†state,ä½†æ˜¯è¿˜æ²¡æ‰§è¡Œrenderå‡½æ•°ï¼Œé‚£ä¹ˆstateå’Œpropsä¸èƒ½ä¿æŒåŒæ­¥<br>   stateå’Œpropsä¸èƒ½ä¿æŒä¸€è‡´æ€§ï¼Œä¼šåœ¨å¼€å‘ä¸­äº§ç”Ÿå¾ˆå¤šé—®é¢˜</p><p>   ä¸ºäº†æ‹¿åˆ°å¼‚æ­¥æ›´æ–°åçš„æ•°æ®</p><p>â€‹    setStateçš„ä¸‰ç§å†™æ³•</p><p>â€‹    </p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">changeText</span>(<span class="hljs-params"></span>) &#123;   <span class="hljs-comment">// 1.setStateæ›´å¤šç”¨æ³•</span>   <span class="hljs-comment">// 1.åŸºæœ¬ä½¿ç”¨</span>   <span class="hljs-comment">// this.setState(&#123;</span>   <span class="hljs-comment">//   message: &quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span>   <span class="hljs-comment">// &#125;)</span>   <span class="hljs-comment">// 2.setStateå¯ä»¥ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°,å›è°ƒ å‡½æ•°ä¸­æ¥æ”¶çš„ state å’Œ props éƒ½ä¿è¯ä¸ºæœ€æ–°ã€‚å›è°ƒå‡½æ•° çš„è¿”å›å€¼ä¼šä¸ state è¿›è¡Œæµ…åˆå¹¶ã€‚</span>   <span class="hljs-comment">// å¥½å¤„ä¸€: å¯ä»¥åœ¨å›è°ƒå‡½æ•°ä¸­ç¼–å†™æ–°çš„stateçš„é€»è¾‘</span>   <span class="hljs-comment">// å¥½å¤„äºŒ: å½“å‰çš„å›è°ƒå‡½æ•°ä¼šå°†ä¹‹å‰çš„stateå’Œpropsä¼ é€’è¿›æ¥</span>   <span class="hljs-comment">// this.setState((state, props) =&gt; &#123;</span>   <span class="hljs-comment">//   // 1.ç¼–å†™ä¸€äº›å¯¹æ–°çš„stateå¤„ç†é€»è¾‘</span>   <span class="hljs-comment">//   // 2.å¯ä»¥è·å–ä¹‹å‰çš„stateå’Œpropså€¼</span>   <span class="hljs-comment">//   console.log(this.state.message, this.props)</span>    <span class="hljs-comment">//è·å¾—æœ€æ–°çš„stateå’Œprops</span><span class="hljs-comment">//   console.log(state, props)</span>   <span class="hljs-comment">//   return &#123;</span>   <span class="hljs-comment">//     message: &quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span>   <span class="hljs-comment">//   &#125;</span>   <span class="hljs-comment">// &#125;)</span>   <span class="hljs-comment">// 3.setStateåœ¨Reactçš„äº‹ä»¶å¤„ç†ä¸­æ˜¯ä¸€ä¸ªå¼‚æ­¥è°ƒç”¨</span>   <span class="hljs-comment">// å¦‚æœå¸Œæœ›åœ¨æ•°æ®æ›´æ–°ä¹‹å(æ•°æ®åˆå¹¶), è·å–åˆ°å¯¹åº”çš„ç»“æœæ‰§è¡Œä¸€äº›é€»è¾‘ä»£ç </span>   <span class="hljs-comment">// é‚£ä¹ˆå¯ä»¥åœ¨setStateä¸­ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°: callback</span>   <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span> &#125;, <span class="hljs-function">() =&gt;</span> &#123;     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;++++++:&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">message</span>)   &#125;)   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;------:&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">message</span>) &#125;</code></pre></div><h5 id="setStateéƒ½æ˜¯å¼‚æ­¥çš„å—"><a href="#setStateéƒ½æ˜¯å¼‚æ­¥çš„å—" class="headerlink" title="setStateéƒ½æ˜¯å¼‚æ­¥çš„å—"></a>setStateéƒ½æ˜¯å¼‚æ­¥çš„å—</h5><p>åœ¨React18ä»¥å‰ï¼Œåœ¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæˆ–è€…Reactåˆæˆäº‹ä»¶ä¸­ï¼ŒsetStateæ˜¯å¼‚æ­¥çš„ï¼Œåœ¨setTimeoutä»¥åŠåŸç”Ÿäº‹ä»¶ä¸­æ˜¯åŒæ­¥çš„ï¼Œreact18ä»¥åæ‰€æœ‰éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå¦‚æœéœ€è¦åŒæ­¥æ“ä½œéœ€è¦ä½¿ç”¨flushSync()</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">// åœ¨react18ä¹‹å‰, setTimeoutä¸­setStateæ“ä½œ, æ˜¯åŒæ­¥æ“ä½œ</span>    <span class="hljs-comment">// åœ¨react18ä¹‹å, setTimeoutä¸­setStateå¼‚æ­¥æ“ä½œ(æ‰¹å¤„ç†)</span>    <span class="hljs-title function_">flushSync</span>(<span class="hljs-function">() =&gt;</span> &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;ä½ å¥½å•Š, æé“¶æ²³&quot;</span> &#125;)    &#125;)    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">message</span>)  &#125;, <span class="hljs-number">0</span>);</code></pre></div><p> 24.ç»„ä»¶åˆ›å»ºçš„æ—¶å€™ä¼šè¢«è°ƒç”¨ä¸€æ¬¡<br> 25.renderå‡½æ•°ï¼Œç»„ä»¶æ›´æ–°æ—¶è°ƒç”¨renderå‡½æ•°ä¼šè®©æ‰€æœ‰å­ç»„ä»¶éƒ½ä¼šè¿›è¡Œä¸€æ¬¡æ›´æ–°ã€‚ä½¿ç”¨shouldComponentUpdateè¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°å¯ä»¥æ§åˆ¶stateå’Œpropså‘ç”Ÿå˜åŒ–æ—¶æ˜¯å¦é‡æ–°è°ƒç”¨renderå‡½æ•°         </p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">shouldComponentUpdate</span>(<span class="hljs-params">nextProps,nextState</span>)&#123;    <span class="hljs-comment">//next...æ˜¯æœ€æ–°çš„æ•°æ®</span>       <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">num</span>!==nextState.<span class="hljs-property">num</span>)&#123;         <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>       &#125;       <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>     &#125;</code></pre></div><p>â€‹    åœ¨å¼€å‘ä¸­æ¯ä¸ªç»„ä»¶éƒ½å†™shouldComponentUpdateæ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥åœ¨ä½¿ç”¨PureComponent</p><div class="code-wrapper"><pre><code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Man</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">PureComponent</span></span></code></pre></div><p> 26.PureComponentä¸èƒ½ç”¨äºå‡½æ•°å¼ç»„ä»¶ï¼Œéœ€è¦ç”¨memo</p><p>â€‹     PureComponentå°±æ˜¯å¯¹ç»„ä»¶è¿›è¡Œä¼˜åŒ–ï¼Œé¿å…é¢‘ç¹çš„è°ƒç”¨renderå‡½æ•°è¿›è¡Œæ¸²æŸ“ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­è°ƒç”¨!shallowEqual(oldProps, newProps) || !shallowEqual(oldState, newState)ï¼Œè¿›è¡Œæµ…å±‚æ¯”è¾ƒ</p><p> 27.stateä¸­çš„å±æ€§çš„ä¸å¯å˜æ€§<br> 28.reactä¸å»ºè®®ç›´æ¥åœ¨æ“ä½œdomï¼Œå¯ä»¥ä½¿ç”¨ref<br>     ä½¿ç”¨refçš„ä¸‰ç§æ–¹å¼</p><div class="code-wrapper"><pre><code class="hljs react">import React,&#123;createRef&#125; from &quot;react&quot;;class RefDemo extends React.Component&#123;  constructor(props)&#123;    super(props)    this.state=&#123;&#125;    this.titleRef=createRef()    // ç¬¬ä¸‰ç§ä½¿ç”¨å‡½æ•°    this.textInput = null;  &#125;  componentDidMount()&#123;     &#125;  componentWillUnmount()&#123;      &#125;  changeRef1()&#123;    // æ–¹å¼ä¸€å·²ç»è¢«æ·˜æ±°äº†    this.refs.refTitle.innerHTML=&quot;hello ref&quot;  &#125;  changeRef2()&#123;    // å®˜æ–¹æ¨èä»¥è¿™ç§æ–¹å¼     this.titleRef.current.innerHTML=&quot;hello big&quot;    console.log(this.titleRef.current)  &#125;  focusTextInput()&#123;    this.textInput.focus()    console.log(this.textInput)  &#125;  render()&#123;    return (      &lt;div&gt;        &lt;h1 ref=&quot;refTitle&quot;&gt;hello react&lt;/h1&gt;        &lt;button onClick=&#123;()=&gt;this.changeRef1()&#125;&gt;æŒ‰é’®1&lt;/button&gt;        &lt;h1 ref=&#123;this.titleRef&#125;&gt;hello world&lt;/h1&gt;        &lt;button onClick=&#123;()=&gt;this.changeRef2()&#125;&gt;æŒ‰é’®2&lt;/button&gt;        &lt;button onClick=&#123;()=&gt;this.focusTextInput()&#125;&gt;focus&lt;/button&gt;        &lt;div&gt;&lt;input ref=&#123;element=&gt;this.textInput=element&#125; type=&quot;text&quot; /&gt;&lt;/div&gt;      &lt;/div&gt;    )  &#125;&#125;export default RefDemo</code></pre></div><p>å‡½æ•°å¼ç»„ä»¶ä¸­æ²¡æœ‰refå±æ€§ï¼Œè¦ä½¿ç”¨const textInput = useRef(null);<br>å¯ä»¥é€šè¿‡refè®¿é—®å­ç»„ä»¶çš„æ–¹æ³•å’Œå±æ€§å’Œvueä¸€æ ·</p><h4 id="keyçš„æ³¨æ„äº‹é¡¹"><a href="#keyçš„æ³¨æ„äº‹é¡¹" class="headerlink" title="keyçš„æ³¨æ„äº‹é¡¹"></a>keyçš„æ³¨æ„äº‹é¡¹</h4><p>keyå¿…é¡»å”¯ä¸€</p><p>keyä¸èƒ½å¤Ÿä½¿ç”¨éšæœºæ•°ï¼ˆå› ä¸ºéšæœºæ•°åœ¨ä¸‹ä¸€æ¬¡renderæ—¶ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªæ•°å­—ï¼‰</p><p>ä½¿ç”¨indexä½œä¸ºkey,å¯¹æ€§èƒ½æ²¡æœ‰ä¼˜åŒ–</p><p>26.å—æ§ç»„ä»¶</p><p>â€‹    å—æ§ç»„ä»¶å°±æ˜¯é€šè¿‡setStateæ¥æ§åˆ¶å€¼ï¼Œstateæˆä¸ºå”¯ä¸€çš„æ•°æ®æº</p><p>â€‹    </p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">inputChange</span>(<span class="hljs-params">event</span>) &#123;   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;inputChange:&quot;</span>, event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>)   <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">username</span>: event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span> &#125;) &#125; <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;   <span class="hljs-keyword">const</span> &#123; username &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>   <span class="hljs-keyword">return</span> (     <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">       &#123;/* å—æ§ç»„ä»¶ */&#125;</span><span class="language-xml">       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;username&#125;</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> this.inputChange(e)&#125;/&gt;</span><span class="language-xml"></span><span class="language-xml">       &#123;/* éå—æ§ç»„ä»¶ */&#125;</span><span class="language-xml">       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span></span><span class="language-xml">       <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>username: &#123;username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">     <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>   ) &#125;</code></pre></div><p>å½“typeä¸ºtext/textarea/selectçš„æ—¶å€™ç»‘å®šçš„æ˜¯value,éœ€è¦ä½¿ç”¨äº‹ä»¶onChange</p><p>å½“typeä¸ºcheckbox/radioçš„æ—¶å€™ï¼Œç»‘å®šçš„æ˜¯checkedï¼Œä½¿ç”¨onChangeäº‹ä»¶</p><div class="code-wrapper"><pre><code class="hljs lua">&lt;<span class="hljs-built_in">input</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;file&quot;</span> /&gt;å§‹ç»ˆæ˜¯éå—æ§ç»„ä»¶</code></pre></div><p>ä½¿ç”¨formè¿›è¡Œè¡¨å•æäº¤</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FlavorForm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;    <span class="hljs-variable language_">super</span>(props);    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;<span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;coconut&#x27;</span>&#125;;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleChange</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleChange</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);    <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSubmit</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSubmit</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);  &#125;  <span class="hljs-title function_">handleChange</span>(<span class="hljs-params">event</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;<span class="hljs-attr">value</span>: event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>&#125;);  &#125;  <span class="hljs-title function_">handleSubmit</span>(<span class="hljs-params">event</span>) &#123;    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;ä½ å–œæ¬¢çš„é£å‘³æ˜¯: &#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">value</span>);    event.<span class="hljs-title function_">preventDefault</span>();  &#125;  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">&#123;this.handleSubmit&#125;</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span></span><span class="language-xml">          é€‰æ‹©ä½ å–œæ¬¢çš„é£å‘³:</span><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;this.state.value&#125;</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;this.handleChange&#125;</span>&gt;</span></span><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;grapefruit&quot;</span>&gt;</span>è‘¡è„æŸš<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span></span><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;lime&quot;</span>&gt;</span>é…¸æ©™<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span></span><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;coconut&quot;</span>&gt;</span>æ¤°å­<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span></span><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;mango&quot;</span>&gt;</span>èŠ’æœ<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span></span><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;æäº¤&quot;</span> /&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>    );  &#125;&#125;</code></pre></div><p>å½“é’ˆå¯¹å¤šä¸ªè¾“å…¥çš„æ—¶å€™</p><p>å¯ä»¥ç»™æ¯ä¸ªinputç»‘å®šå”¯ä¸€çš„name,ç„¶ååˆ©ç”¨è®¡ç®—å±æ€§åæ¥è¿›è¡Œèµ‹å€¼æ“ä½œ</p><div class="code-wrapper"><pre><code class="hljs react">handleSubmitClick(event) &#123;    // 1.é˜»æ­¢é»˜è®¤çš„è¡Œä¸º    event.preventDefault()    // 2.è·å–åˆ°æ‰€æœ‰çš„è¡¨å•æ•°æ®, å¯¹æ•°æ®è¿›è¡Œç»„ä»¶    console.log(&quot;è·å–æ‰€æœ‰çš„è¾“å…¥å†…å®¹&quot;)    console.log(this.state.username, this.state.password)    // 3.ä»¥ç½‘ç»œè¯·æ±‚çš„æ–¹å¼, å°†æ•°æ®ä¼ é€’ç»™æœåŠ¡å™¨(ajax/fetch/axios)  &#125;  // handleUsernameChange(event) &#123;  //   this.setState(&#123; username: event.target.value &#125;)  // &#125;  // handlePasswordChange(event) &#123;  //   this.setState(&#123; password: event.target.value &#125;)  // &#125;  handleInputChange(event) &#123;    this.setState(&#123;      [event.target.name]: event.target.value    &#125;)  &#125;  render() &#123;    const &#123; username, password &#125; = this.state    return (      &lt;div&gt;        &lt;form onSubmit=&#123;e =&gt; this.handleSubmitClick(e)&#125;&gt;          &#123;/* 1.ç”¨æˆ·åå’Œå¯†ç  */&#125;          &lt;label htmlFor=&quot;username&quot;&gt;            ç”¨æˆ·:             &lt;input               id=&#x27;username&#x27;               type=&quot;text&quot;               name=&#x27;username&#x27;               value=&#123;username&#125;               onChange=&#123;e =&gt; this.handleInputChange(e)&#125;            /&gt;          &lt;/label&gt;          &lt;label htmlFor=&quot;password&quot;&gt;            å¯†ç :             &lt;input               id=&#x27;password&#x27;               type=&quot;password&quot;               name=&#x27;password&#x27;               value=&#123;password&#125;               onChange=&#123;e =&gt; this.handleInputChange(e)&#125;            /&gt;          &lt;/label&gt;          &lt;button type=&#x27;submit&#x27;&gt;æ³¨å†Œ&lt;/button&gt;        &lt;/form&gt;      &lt;/div&gt;    )  &#125;</code></pre></div><p>27.éå—æ§ç»„ä»¶</p><p>éå—æ§ç»„ä»¶å°±æ˜¯å°†è¡¨å•æ•°æ®äº¤ç»™DOMèŠ‚ç‚¹æ¥å¤„ç†ï¼Œ</p><div class="code-wrapper"><pre><code class="hljs react">class NameForm extends React.Component &#123;  constructor(props) &#123;    super(props);    this.handleSubmit = this.handleSubmit.bind(this);    this.input = React.createRef();  &#125;  handleSubmit(event) &#123;    alert(&#x27;A name was submitted: &#x27; + this.input.current.value);    event.preventDefault();  &#125;  render() &#123;ã€  //defaultValueæ˜¯é»˜è®¤å€¼    return (      &lt;form onSubmit=&#123;this.handleSubmit&#125;&gt;        &lt;label&gt;          Name:          &lt;input  defaultValue=&quot;Bob&quot; type=&quot;text&quot; ref=&#123;this.input&#125; /&gt;        &lt;/label&gt;        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;      &lt;/form&gt;    );  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs vim">&lt;<span class="hljs-built_in">input</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span>&gt; å’Œ &lt;<span class="hljs-built_in">input</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;radio&quot;</span>&gt; æ”¯æŒ defaultCheckedï¼Œ<span class="hljs-symbol">&lt;select&gt;</span> å’Œ <span class="hljs-symbol">&lt;textarea&gt;</span> æ”¯æŒ defaultValueã€‚</code></pre></div><p>28.é«˜é˜¶ç»„ä»¶</p><p>é«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé«˜é˜¶ç»„ä»¶çš„å‚æ•°æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ªç»„ä»¶ã€‚é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€å·§ã€‚HOC è‡ªèº«ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº React çš„ç»„åˆç‰¹æ€§è€Œå½¢æˆçš„è®¾è®¡æ¨¡å¼ã€‚HOC æ˜¯çº¯å‡½æ•°ï¼Œæ²¡æœ‰å‰¯ä½œç”¨ï¼Œé«˜é˜¶ç»„ä»¶é€‚ç”¨äºæŠ½å–å…¬å…±çš„é€»è¾‘</p><div class="code-wrapper"><pre><code class="hljs react">import &#123; PureComponent &#125; from &#x27;react&#x27;//propså¢å¼º// å®šä¹‰ç»„ä»¶: ç»™ä¸€äº›éœ€è¦ç‰¹æ®Šæ•°æ®çš„ç»„ä»¶, æ³¨å…¥propsfunction enhancedUserInfo(OriginComponent) &#123;  class NewComponent extends PureComponent &#123;    constructor(props) &#123;      super(props)      this.state = &#123;        userInfo: &#123;          name: &quot;coderwhy&quot;,          level: 99        &#125;      &#125;    &#125;    render() &#123;      return &lt;OriginComponent &#123;...this.props&#125; &#123;...this.state.userInfo&#125;/&gt;    &#125;  &#125;  return NewComponent&#125;export default enhancedUserInfo</code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨é«˜é˜¶å‡½æ•°æ¥åŠ«æŒç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸä¸­å®Œæˆè‡ªå·±çš„é€»è¾‘</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">PureComponent</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<span class="hljs-keyword">function</span> <span class="hljs-title function_">logRenderTime</span>(<span class="hljs-params">OriginComponent</span>) &#123;  <span class="hljs-keyword">return</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">extends</span> <span class="hljs-title class_">PureComponent</span> &#123;    <span class="hljs-title function_">UNSAFE_componentWillMount</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">beginTime</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>()      <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">endTime</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>()      <span class="hljs-keyword">const</span> interval = <span class="hljs-variable language_">this</span>.<span class="hljs-property">endTime</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">beginTime</span>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰<span class="hljs-subst">$&#123;OriginComponent.name&#125;</span>é¡µé¢èŠ±è´¹äº†<span class="hljs-subst">$&#123;interval&#125;</span>msæ¸²æŸ“å®Œæˆ!`</span>)    &#125;    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">OriginComponent</span> &#123;<span class="hljs-attr">...this.props</span>&#125;/&gt;</span></span>    &#125;  &#125;&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> logRenderTime</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">//æ¸²æŸ“é‰´æƒï¼Œå¯ä»¥åˆ¤æ–­ç”¨æˆ·æœ‰æ²¡æœ‰ç™»å½•ï¼Œå¦‚æœæ²¡æœ‰ç™»å½•åˆ™æ¸²æŸ“å…¶ä»–ç»„ä»¶function loginAuth(OriginComponent) &#123;  return props =&gt; &#123;    // ä»localStorageä¸­è·å–token    const token = localStorage.getItem(&quot;token&quot;)    if (token) &#123;      return &lt;OriginComponent &#123;...props&#125;/&gt;    &#125; else &#123;      return &lt;h2&gt;è¯·å…ˆç™»å½•, å†è¿›è¡Œè·³è½¬åˆ°å¯¹åº”çš„é¡µé¢ä¸­&lt;/h2&gt;    &#125;  &#125;&#125;export default loginAuth</code></pre></div><div class="code-wrapper"><pre><code class="hljs react">import ThemeContext from &quot;../context/theme_context&quot;//å’Œcontextç»“åˆfunction withTheme(OriginComponment) &#123;  return (props) =&gt; &#123;    return (      &lt;ThemeContext.Consumer&gt;        &#123;          value =&gt; &#123;            return &lt;OriginComponment &#123;...value&#125; &#123;...props&#125;/&gt;          &#125;        &#125;      &lt;/ThemeContext.Consumer&gt;    )  &#125;&#125;export default withTheme</code></pre></div><p>ä¸è¦åœ¨ render æ–¹æ³•ä¸­ä½¿ç”¨ HOC</p><p>HOCä¹Ÿæœ‰è‡ªå·±çš„ä¸€äº›ç¼ºé™·ï¼š</p><p> HOCéœ€è¦åœ¨åŸç»„ä»¶ä¸Šè¿›è¡ŒåŒ…è£¹æˆ–è€…åµŒå¥—ï¼Œå¦‚æœå¤§é‡ä½¿ç”¨HOCï¼Œå°†ä¼šäº§ç”Ÿéå¸¸å¤šçš„åµŒå¥—ï¼Œè¿™è®©è°ƒè¯•å˜å¾—éå¸¸å›°éš¾ï¼› HOCå¯ä»¥åŠ«æŒpropsï¼Œåœ¨ä¸éµå®ˆçº¦å®šçš„æƒ…å†µä¸‹ä¹Ÿå¯èƒ½é€ æˆå†²çªï¼›</p><p>Hooksçš„å‡ºç°ï¼Œæ˜¯å¼€åˆ›æ€§çš„ï¼Œå®ƒè§£å†³äº†å¾ˆå¤šReactä¹‹å‰çš„å­˜åœ¨çš„é—®é¢˜</p><p>æ¯”å¦‚thisæŒ‡å‘é—®é¢˜ã€æ¯”å¦‚hocçš„åµŒå¥—å¤æ‚åº¦é—®é¢˜ç­‰ç­‰</p><p>29.refçš„è½¬å‘ï¼Œè·å–å‡½æ•°å¼ç»„ä»¶å†…éƒ¨çš„ref å¯ä»¥ä½¿ç”¨forwardRefé«˜é˜¶å‡½æ•°<br>30.Portalsçš„ä½¿ç”¨ï¼Œç”¨äºå°†æ¸²æŸ“å…ƒç´ ç‹¬ç«‹äºçˆ¶ç»„ä»¶ï¼Œæ¸²æŸ“åˆ°å…¶ä»–å…ƒç´ ä¹‹ä¸Šã€‚ä½¿ç”¨React.createPortal(child,container)<br>31.fragmentçš„ä½¿ç”¨ï¼Œç›¸å½“äºvueçš„templateåœ¨å®é™…çš„domä¸­ä¸æ¸²æŸ“ï¼Œå¸¦keyçš„æ—¶å€™ä¸èƒ½ä½¿ç”¨çŸ­è¯­æ³•<br>    è¿˜å¯ä»¥ä½¿ç”¨çŸ­è¯­å‘    </p><div class="code-wrapper"><pre><code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Columns</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;  render() &#123;    <span class="hljs-keyword">return</span> (      &lt;&gt;        &lt;td&gt;<span class="hljs-type">Hello</span>&lt;/td&gt;        &lt;td&gt;<span class="hljs-type">World</span>&lt;/td&gt;      &lt;/&gt;    );  &#125;&#125;</code></pre></div><p> 32.StrictMode å¼€å¯reactçš„ä¸¥æ ¼æ¨¡å¼ï¼Œåªæœ‰å¼€å‘ç¯å¢ƒä¸‹èµ·ä½œç”¨</p><p>â€‹    StrictModeæ˜¯ç”¨æ¥çªæ˜¾åº”ç”¨ç¨‹åºä¸­çš„æ½œåœ¨é—®é¢˜çš„å·¥å…·</p><p>â€‹    å®ƒä¸ºå…¶åä»£å…ƒç´ è§¦å‘é¢å¤–çš„æ£€æŸ¥å’Œè­¦å‘Š</p><div class="code-wrapper"><pre><code class="hljs"> å¯ä»¥è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ ä½¿ç”¨è¿‡æ—¶çš„refçš„API æ£€æµ‹æ„å¤–çš„å‰¯ä½œç”¨ã€‚</code></pre></div><p>â€‹            ç»„ä»¶çš„constructorä¼šè°ƒç”¨ä¸¤æ¬¡</p><p>â€‹            ç”Ÿäº§ç¯å¢ƒç»ˆä¸æ‚”è°ƒç”¨ä¸¤æ¬¡</p><p>â€‹    jæ£€æµ‹ä½¿ç”¨åºŸå¼ƒçš„findDOMNodeæ–¹æ³•</p><div class="code-wrapper"><pre><code class="hljs"> æ£€æµ‹è¿‡æ—¶çš„context api </code></pre></div><p>â€‹            æ—©æœŸçš„Contextæ˜¯é€šè¿‡staticå±æ€§å£°æ˜Contextå¯¹è±¡å±æ€§ï¼Œé€šè¿‡getChildContextè¿”å›Contextå¯¹è±¡ç­‰æ–¹å¼æ¥ä½¿ç”¨Contextçš„</p><p> 33.reactä¸­çš„css<br>     1.å†…è”æ ·å¼</p><p>â€‹            style æ¥å—ä¸€ä¸ªé‡‡ç”¨å°é©¼å³°å‘½åå±æ€§çš„ JavaScript å¯¹è±¡ï¼Œï¼Œè€Œä¸æ˜¯ CSS å­—ç¬¦ä¸²</p><p>â€‹            å¹¶ä¸”å¯ä»¥å¼•ç”¨stateä¸­çš„çŠ¶æ€æ¥è®¾ç½®ç›¸å…³çš„æ ·å¼</p><p>â€‹            .å†…è”æ ·å¼, æ ·å¼ä¹‹é—´ä¸ä¼šæœ‰å†²çª</p><p>â€‹             å¯ä»¥åŠ¨æ€è·å–å½“å‰stateä¸­çš„çŠ¶æ€</p><p>â€‹             å†™æ³•ä¸Šéƒ½éœ€è¦ä½¿ç”¨é©¼å³°æ ‡è¯†</p><p>â€‹            æŸäº›æ ·å¼æ²¡æœ‰æç¤º</p><p>â€‹            å¤§é‡çš„æ ·å¼, ä»£ç æ··ä¹±</p><p>â€‹            æŸäº›æ ·å¼æ— æ³•ç¼–å†™(æ¯”å¦‚ä¼ªç±»/ä¼ªå…ƒç´ </p><div class="code-wrapper"><pre><code class="hljs"> 2.css modules     ä¸æ˜¯reactç‰¹æœ‰çš„å†³ç»æ–¹æ¡ˆï¼Œæ‰€æœ‰ç±»ä¼¼webpacké…ç½®ç¯å¢ƒéƒ½å¯ä»¥ä½¿ç”¨ï¼Œåœ¨reactä¸­å·²ç»é…ç½®ï¼Œåœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨éœ€è¦åœ¨webpack.config.jsä¸­module:true      è¦åˆ›å»ºxxx.moudle.cssæ–‡ä»¶      ä¸èƒ½ä½¿ç”¨è¿æ¥ç¬¦åˆ›å»ºç±»å(.home-title)ï¼Œjsä¸æ”¯æŒï¼Œéœ€è¦ä½¿ç”¨&#123;å¼•å…¥åå­—style.className&#125;æ¥ç¼–å†™      ä¸æ–¹ä¾¿æ›´æ”¹æ ·å¼.ä¸æ–¹ä¾¿åŠ¨æ€ä¿®æ”¹æŸäº›æ ·å¼ï¼Œä¾ç„¶éœ€è¦ä½¿ç”¨å†…è”æ ·å¼  3.css in js      å¸¸ç”¨çš„ css in jsåº“          styled-components              åœ¨å¤šäººåä½œä¸­ï¼Œcsså¿…å®šä¼šå‡ºç°å‘½åå†²çªï¼Œä¸vueçš„scopedè§£å†³æ–¹æ¡ˆä¸åŒï¼Œreactç”¨styled-                    componentsçš„ç»™ç±»ååŠ äº†éšæœºå­—ç¬¦çš„æ–¹å¼å®ç°äº†cssçš„ç§æœ‰åŒ–ï¼Œå®ƒä¹Ÿæ˜¯å…¨å±€çš„          styled-componentså…¶å®æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥ä¼ å…¥props          emotion          glamorous</code></pre></div><p>â€‹        styled-componentsçš„æœ¬è´¨æ˜¯é€šè¿‡å‡½æ•°çš„è°ƒç”¨ï¼Œæœ€ç»ˆåˆ›å»ºå‡ºä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶ä¼šè‡ªåŠ¨æ·»åŠ ä¸Šä¸€ä¸ªä¸é‡å¤çš„class</p><p>â€‹        styled-componentsä¼šç»™è¯¥classæ·»åŠ ç›¸å…³çš„æ ·å¼ï¼Œå®ƒæ”¯æŒcssé¢„å¤„ç†å™¨ä¸€æ ·åµŒå¥—ï¼Œæ”¯æŒç›´æ¥å­ä»£é€‰æ‹©å™¨æˆ–è€…åä»£é€‰æ‹©å™¨ï¼Œå¹¶ä¸”ç¼–å†™æ ·å¼ï¼Œå¯ä»¥é€šè¿‡&amp;ç¬¦å·è·å–å½“å‰å…ƒç´ ï¼Œç›´æ¥ä¼ªç±»é€‰æ‹©å™¨ï¼Œä¼ªå…ƒç´ ç­‰</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> styled <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;styled-components&quot;</span><span class="hljs-keyword">import</span> &#123;  primaryColor,  largeSize&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./style/variables&quot;</span><span class="hljs-comment">// 1.åŸºæœ¬ä½¿ç”¨</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">AppWrapper</span> = styled.<span class="hljs-property">div</span><span class="hljs-string">`</span><span class="hljs-string">  .footer &#123;</span><span class="hljs-string">    border: 1px solid orange;</span><span class="hljs-string">  &#125;</span><span class="hljs-string">// const obj = &#123;</span><span class="hljs-string">//   name: (props) =&gt; props.name || &quot;why&quot;</span><span class="hljs-string">// &#125;</span><span class="hljs-string">// 2.å­å…ƒç´ å•ç‹¬æŠ½å–åˆ°ä¸€ä¸ªæ ·å¼ç»„ä»¶</span><span class="hljs-string">// 3.å¯ä»¥æ¥å—å¤–éƒ¨ä¼ å…¥çš„props</span><span class="hljs-string">// 4.å¯ä»¥é€šè¿‡attrsç»™æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²ä¸­æä¾›çš„å±æ€§</span><span class="hljs-string">// 5.ä»ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­å¼•å…¥å˜é‡</span><span class="hljs-string">export const SectionWrapper = styled.div.attrs(props =&gt; (&#123;</span><span class="hljs-string">  tColor: props.color || &quot;blue&quot;</span><span class="hljs-string">&#125;))`</span>  <span class="hljs-attr">border</span>: 1px solid red;  .<span class="hljs-property">title</span> &#123;    font-<span class="hljs-attr">size</span>: $&#123;<span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> props.<span class="hljs-property">size</span>&#125;px;    <span class="hljs-attr">color</span>: $&#123;<span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> props.<span class="hljs-property">tColor</span>&#125;;    &amp;:hover &#123;      background-<span class="hljs-attr">color</span>: purple;    &#125;  &#125;  .<span class="hljs-property">content</span> &#123;    font-<span class="hljs-attr">size</span>: $&#123;largeSize&#125;px;    <span class="hljs-attr">color</span>: $&#123;primaryColor&#125;;  &#125;<span class="hljs-string">`</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> styled <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;styled-components&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-title class_">HYButton</span> = styled.<span class="hljs-property">button</span><span class="hljs-string">`</span><span class="hljs-string">  border: 1px solid red;</span><span class="hljs-string">  border-radius: 5px;</span><span class="hljs-string">`</span><span class="hljs-comment">// cssæ ·å¼çš„ç»§æ‰¿</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">HYButtonWrapper</span> = <span class="hljs-title function_">styled</span>(<span class="hljs-title class_">HYButton</span>)<span class="hljs-string">`</span><span class="hljs-string">  background-color: #0f0;</span><span class="hljs-string">  color: #fff;</span><span class="hljs-string">`</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">HomeWrapper</span> = styled.<span class="hljs-property">div</span><span class="hljs-string">`</span><span class="hljs-string">  .top &#123;</span><span class="hljs-string">    .banner &#123;</span><span class="hljs-string">      color: red;</span><span class="hljs-string">    &#125;</span><span class="hljs-string">  &#125;</span><span class="hljs-string">  .bottom &#123;</span><span class="hljs-string">    .header &#123;</span><span class="hljs-string">      color: <span class="hljs-subst">$&#123;props =&gt; props.theme.color&#125;</span>;</span><span class="hljs-string">      font-size: <span class="hljs-subst">$&#123;props =&gt; props.theme.size&#125;</span>;</span><span class="hljs-string">    &#125;</span><span class="hljs-string"></span><span class="hljs-string">    .product-list &#123;</span><span class="hljs-string">      .item &#123;</span><span class="hljs-string">        color: blue;</span><span class="hljs-string">      &#125;</span><span class="hljs-string">    &#125;</span><span class="hljs-string">  &#125;</span><span class="hljs-string">`</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs"> 4.æ™®é€šçš„cscä¼šç›¸äº’å±‚å ï¼Œéƒ½ä¼šåˆå¹¶åˆ°å…¨å±€çš„cssä¸­å»ï¼Œé­æˆå½±å“åˆ°å…¶ä»–æ¨¡å— 5.lessçš„ç¼–å†™æ–¹å¼  éœ€è¦é…ç½®webpack   éœ€è¦ä½¿ç”¨craco  ç›®å‰é’ˆå¯¹creat-react-app 5 çš„é…ç½® npm i @craco/craco@alpha</code></pre></div><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>   <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;craco start&quot;</span><span class="hljs-punctuation">,</span>   <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;craco build&quot;</span><span class="hljs-punctuation">,</span>   <span class="hljs-attr">&quot;test&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;craco test&quot;</span><span class="hljs-punctuation">,</span>   <span class="hljs-attr">&quot;eject&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;react-scripts eject&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span></code></pre></div><p>â€‹    </p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//craco.config.js</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">CracoLessPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;craco-less&#x27;</span>);<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;  <span class="hljs-attr">plugins</span>: [    &#123;      <span class="hljs-attr">plugin</span>: <span class="hljs-title class_">CracoLessPlugin</span>,      <span class="hljs-attr">options</span>: &#123;        <span class="hljs-attr">lessLoaderOptions</span>: &#123;          <span class="hljs-attr">lessOptions</span>: &#123;            <span class="hljs-attr">modifyVars</span>: &#123; <span class="hljs-string">&#x27;@primary-color&#x27;</span>: <span class="hljs-string">&#x27;#1DA57A&#x27;</span> &#125;,            <span class="hljs-attr">javascriptEnabled</span>: <span class="hljs-literal">true</span>,          &#125;,        &#125;,      &#125;,    &#125;,  ],&#125;;</code></pre></div><h4 id="Reactä¸­æ·»åŠ class"><a href="#Reactä¸­æ·»åŠ class" class="headerlink" title="Reactä¸­æ·»åŠ class"></a>Reactä¸­æ·»åŠ class</h4><p>å¯ä»¥å€ŸåŠ©ç¬¬ä¸‰æ–¹åº“classnames</p><p> 34.axiosä¸­ï¼Œaxios({})è¿™æ ·æ˜¯ä½¿ç”¨ä»–é»˜è®¤åˆ›å»ºçš„å®ä¾‹ï¼Œå¦‚æœè¦è‡ªå·±åˆ›å»ºä¸€ä¸ªå®ä¾‹è¦ä½¿ç”¨axios.create({})</p><h4 id="react-transition-group"><a href="#react-transition-group" class="headerlink" title="react-transition-group"></a>react-transition-group</h4><p>  è¿™ä¸ªåº“å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ–¹ä¾¿çš„å®ç°ç»„ä»¶çš„ å…¥åœº å’Œ ç¦»åœº åŠ¨ç”»ï¼Œä½¿ç”¨æ—¶éœ€è¦è¿›è¡Œé¢å¤–çš„å®‰è£…</p><div class="code-wrapper"><pre><code class="hljs sql">npm install react<span class="hljs-operator">-</span>transition<span class="hljs-operator">-</span><span class="hljs-keyword">group</span> <span class="hljs-comment">--save</span>yarn <span class="hljs-keyword">add</span> react<span class="hljs-operator">-</span>transition<span class="hljs-operator">-</span><span class="hljs-keyword">group</span></code></pre></div><p>react-transition-groupä¸»è¦åŒ…æ‹¬å››ä¸ªç»„ä»¶</p><p>Tansition</p><p>â€‹        è¯¥ç»„ä»¶æ˜¯ä¸€ä¸ªå’Œå¹³å°æ— å…³çš„ç»„ä»¶ï¼ˆä¸ä¸€å®šè¦ç»“åˆCSSï¼‰</p><p>â€‹        åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ç»“åˆCSSæ¥å®Œæˆæ ·å¼ï¼Œæ‰€ä»¥æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯CSSTransition</p><p>CSSTransition</p><p>â€‹        åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œé€šå¸¸ä½¿ç”¨CSSTransitionæ¥å®Œæˆè¿‡æ¸¡åŠ¨ç”»</p><p>â€‹        CSSTransitionæ˜¯åŸºäºTransitionç»„ä»¶æ„å»ºçš„</p><p>â€‹        CSSTransitionæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸‰ä¸ªçŠ¶æ€ï¼šappearã€enterã€exitï¼›</p><p>â€‹        å®ƒä»¬æœ‰ä¸‰ç§çŠ¶æ€ï¼Œéœ€è¦å®šä¹‰å¯¹åº”çš„CSSæ ·å¼ï¼š</p><p>â€‹        ç¬¬ä¸€ç±»ï¼Œå¼€å§‹çŠ¶æ€ï¼šå¯¹äºçš„ç±»æ˜¯-appearã€-enterã€exitï¼› </p><p>â€‹        ç¬¬äºŒç±»ï¼šæ‰§è¡ŒåŠ¨ç”»ï¼šå¯¹åº”çš„ç±»æ˜¯-appear-activeã€-enter-activeã€-exit-activeï¼› </p><p>â€‹        ç¬¬ä¸‰ç±»ï¼šæ‰§è¡Œç»“æŸï¼šå¯¹åº”çš„ç±»æ˜¯-appear-doneã€-enter-doneã€-exit-doneï¼›</p><p>â€‹        CSSTransitionå¸¸ç”¨å±æ€§</p><p>â€‹        in</p><p>â€‹        classNames</p><p>â€‹        timeout</p><p>â€‹        appear</p><p>â€‹        unmountOnExit</p><h6 id="é’©å­å‡½æ•°"><a href="#é’©å­å‡½æ•°" class="headerlink" title="é’©å­å‡½æ•°:"></a>é’©å­å‡½æ•°:</h6><p>â€‹                onEnter</p><p>â€‹                onEntering</p><p>â€‹                onEntered</p><div class="code-wrapper"><pre><code class="hljs react">import React, &#123; createRef, PureComponent &#125; from &#x27;react&#x27;import &#123; CSSTransition &#125; from &quot;react-transition-group&quot;import &quot;./style.css&quot;export class App extends PureComponent &#123;  constructor(props) &#123;    super(props)    this.state = &#123;      isShow: true    &#125;    this.sectionRef = createRef()  &#125;  render() &#123;    const &#123; isShow &#125; = this.state    return (      &lt;div&gt;        &lt;button onClick=&#123;e =&gt; this.setState(&#123;isShow: !isShow&#125;)&#125;&gt;åˆ‡æ¢&lt;/button&gt;        &#123;/* &#123; isShow &amp;&amp; &lt;h2&gt;å“ˆå“ˆå“ˆ&lt;/h2&gt; &#125; */&#125;        &lt;CSSTransition           nodeRef=&#123;this.sectionRef&#125;          in=&#123;isShow&#125;           unmountOnExit=&#123;true&#125;           classNames=&quot;why&quot;           timeout=&#123;2000&#125;          appear          onEnter=&#123;e =&gt; console.log(&quot;å¼€å§‹è¿›å…¥åŠ¨ç”»&quot;)&#125;          onEntering=&#123;e =&gt; console.log(&quot;æ‰§è¡Œè¿›å…¥åŠ¨ç”»&quot;)&#125;          onEntered=&#123;e =&gt; console.log(&quot;æ‰§è¡Œè¿›å…¥ç»“æŸ&quot;)&#125;          onExit=&#123;e =&gt; console.log(&quot;å¼€å§‹ç¦»å¼€åŠ¨ç”»&quot;)&#125;          onExiting=&#123;e =&gt; console.log(&quot;æ‰§è¡Œç¦»å¼€åŠ¨ç”»&quot;)&#125;          onExited=&#123;e =&gt; console.log(&quot;æ‰§è¡Œç¦»å¼€ç»“æŸ&quot;)&#125;        &gt;          &lt;div className=&#x27;section&#x27; ref=&#123;this.sectionRef&#125;&gt;            &lt;h2&gt;å“ˆå“ˆå“ˆ&lt;/h2&gt;            &lt;p&gt;æˆ‘æ˜¯å†…å®¹, å“ˆå“ˆå“ˆ&lt;/p&gt;          &lt;/div&gt;        &lt;/CSSTransition&gt;      &lt;/div&gt;    )  &#125;&#125;export default App</code></pre></div><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.why-appear</span>, <span class="hljs-selector-class">.why-enter</span> &#123;  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;&#125;<span class="hljs-selector-class">.why-appear-active</span>, <span class="hljs-selector-class">.why-enter-active</span> &#123;  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;  <span class="hljs-attribute">transition</span>: opacity <span class="hljs-number">2s</span> ease;&#125;<span class="hljs-comment">/* ç¦»å¼€åŠ¨ç”» */</span><span class="hljs-selector-class">.why-exit</span> &#123;  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;&#125;<span class="hljs-selector-class">.why-exit-active</span> &#123;  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;  <span class="hljs-attribute">transition</span>: opacity <span class="hljs-number">2s</span> ease;&#125;</code></pre></div><p>SwitchTransition</p><p>â€‹        ä¸¤ä¸ªç»„ä»¶æ˜¾ç¤ºå’Œåˆ‡æ¢æ—¶ï¼Œä½¿ç”¨è¯¥ç»„ä»¶</p><p>â€‹        SwitchTransitionä¸­ä¸»è¦æœ‰ä¸€ä¸ªå±æ€§ï¼šmodeï¼Œæœ‰ä¸¤ä¸ªå€¼</p><p>â€‹            in-outï¼šè¡¨ç¤ºæ–°ç»„ä»¶å…ˆè¿›å…¥ï¼Œæ—§ç»„ä»¶å†ç§»é™¤ï¼›</p><p>â€‹            out-inï¼šè¡¨ç¤ºå°±ç»„ä»¶å…ˆç§»é™¤ï¼Œæ–°ç»„å»ºå†è¿›å…¥</p><p>â€‹        SwitchTransitionç»„ä»¶é‡Œé¢è¦æœ‰CSSTransitionæˆ–è€…Transitionç»„ä»¶ï¼Œä¸èƒ½ç›´æ¥åŒ…è£¹ä½ æƒ³è¦åˆ‡æ¢çš„ç»„ä»¶</p><p>â€‹        SwitchTransitioné‡Œé¢çš„CSSTransitionæˆ–Transitionç»„ä»¶ä¸å†åƒä»¥å‰é‚£æ ·æ¥å—inå±æ€§æ¥åˆ¤æ–­å…ƒç´ æ˜¯ä½•ç§çŠ¶æ€ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ keyå±æ€§</p><div class="code-wrapper"><pre><code class="hljs react">import React, &#123; PureComponent &#125; from &#x27;react&#x27;import &#123; SwitchTransition, CSSTransition &#125; from &#x27;react-transition-group&#x27;import &quot;./style.css&quot;export class App extends PureComponent &#123;  constructor() &#123;    super()     this.state = &#123;      isLogin: true    &#125;  &#125;  render() &#123;    const &#123; isLogin &#125; = this.state    return (      &lt;div&gt;        &lt;SwitchTransition mode=&#x27;out-in&#x27;&gt;          &lt;CSSTransition            key=&#123;isLogin ? &quot;exit&quot;: &quot;login&quot;&#125;            classNames=&quot;login&quot;            timeout=&#123;1000&#125;          &gt;            &lt;button onClick=&#123;e =&gt; this.setState(&#123; isLogin: !isLogin &#125;)&#125;&gt;              &#123; isLogin ? &quot;é€€å‡º&quot;: &quot;ç™»å½•&quot; &#125;            &lt;/button&gt;          &lt;/CSSTransition&gt;        &lt;/SwitchTransition&gt;      &lt;/div&gt;    )  &#125;&#125;export default App</code></pre></div><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.login-enter</span> &#123;  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">100px</span>);  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;&#125;<span class="hljs-selector-class">.login-enter-active</span> &#123;  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>);  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">1s</span> ease;&#125;<span class="hljs-selector-class">.login-exit</span> &#123;  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>);  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;&#125;<span class="hljs-selector-class">.login-exit-active</span> &#123;  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">100px</span>);  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">1s</span> ease;&#125;</code></pre></div><p>TransitionGroup</p><p>â€‹        å°†å¤šä¸ªç»„ä»¶åŒ…è£¹åœ¨å…¶ä¸­ï¼Œä¸€èˆ¬ç”¨äºåˆ—è¡¨ä¸­çš„å…ƒç´ çš„åŠ¨ç”»</p><p>â€‹        â—¼ å½“æˆ‘ä»¬æœ‰ä¸€ç»„åŠ¨ç”»æ—¶ï¼Œéœ€è¦å°†è¿™äº›CSSTransitionæ”¾å…¥åˆ°ä¸€ä¸ªTransitionGroupä¸­æ¥å®ŒæˆåŠ¨ç”»ï¼š</p><div class="code-wrapper"><pre><code class="hljs react">&lt;TransitionGroup component=&quot;ul&quot;&gt;         &#123;           books.map((item, index) =&gt; &#123;             return (               &lt;CSSTransition key=&#123;item.id&#125; classNames=&quot;book&quot; timeout=&#123;1000&#125;&gt;                 &lt;li&gt;                   &lt;span&gt;&#123;item.name&#125;-&#123;item.price&#125;&lt;/span&gt;                   &lt;button onClick=&#123;e =&gt; this.removeBook(index)&#125;&gt;åˆ é™¤&lt;/button&gt;                 &lt;/li&gt;               &lt;/CSSTransition&gt;             )           &#125;)         &#125;       &lt;/TransitionGroup&gt;</code></pre></div><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.book-enter</span> &#123;  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">150px</span>);  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;&#125;<span class="hljs-selector-class">.book-enter-active</span> &#123;  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>);  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">1s</span> ease;&#125;<span class="hljs-selector-class">.book-exit</span> &#123;  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>);  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;&#125;<span class="hljs-selector-class">.book-exit-active</span> &#123;  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">150px</span>);  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">1s</span> ease;&#125;</code></pre></div><p>36.reactçº¯å‡½æ•°<br> 37.nodeä¸­å¯¹ES6æ¨¡å—åŒ–çš„æ”¯æŒ åœ¨13.2.0ä»¥åå¯¹es6çš„æ”¯æŒï¼Œéœ€è¦åœ¨package.jsonä¸­æ·»åŠ å±æ€§â€typeâ€:â€moduleâ€,å¯¼å…¥æ–‡ä»¶æ—¶è¦è·Ÿä¸Š.jsåç¼€å<br> 38.redux<br>     reduxä¸»è¦æ˜¯è´Ÿè´£çŠ¶æ€ç®¡ç†<br>     store:createStore(reducer,..)<br>     state:é€šè¿‡store.getState()æ¥è·å–å½“å‰state<br>     reactçš„ç»„æˆ<br>         action:æ˜¯ç”¨æ¥æ›´æ–°æ•°æ®ï¼Œæ‰€æœ‰çš„æ•°æ®å˜åŒ–ï¼Œå¿…é¡»é€šè¿‡dispatchæ¥æ´¾å‘actionæ¥æ›´æ–°ï¼Œactionå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå¯¹è±¡<br>         reducerï¼šæ˜¯å°†stateå’Œactionè¿æ¥èµ·æ¥ï¼Œreduceræ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œreduceræ˜¯å°†ä¼ å…¥çš„reducerå’Œactionæ•´å’Œæˆä¸ºä¸€ä¸ªæ–°çš„state<br>         dispatch:ç”¨æ¥æ´¾å‘action<br>     reduxçš„ä¸‰å¤§åŸåˆ™<br>         1.å•ä¸€æ•°æ®æº<br>         2.stateæ˜¯åªè¯»çš„<br>         3.ä½¿ç”¨çº¯å‡½æ•°æ¥æ‰§è¡Œä¿®æ”¹<br> 39.å•å‘æ•°æ®æµ<br> 40.reactåŠ¨ç”»ä¸­<TransitionGroup>ä¸­éœ€è¦å†ç”¨<cssTransition>åŒ…è£¹,å¦åˆ™ä¼šæŠ¥é”™<br> 41.react-router<br>     é»˜è®¤æ˜¯æ¨¡ç³ŠåŒ¹é…<br> 42.react-hook<br>     import React from â€œreactâ€//è¿™ä¸ªæ˜¯åœ¨å‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶éƒ½è¦å†™ï¼Œå› ä¸ºjsxæ˜¯React.createElement()çš„è¯­æ³•ç³–ï¼Œä¼šåœ¨å†…éƒ¨è°ƒç”¨<br>     useState()<br>     Hookçš„ä½¿ç”¨è§„åˆ™ï¼š<br>         åªèƒ½åœ¨å‡½æ•°æœ€å¤–å±‚è°ƒç”¨Hook,ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶åˆ¤æ–­æˆ–è€…å­å‡½æ•°ä¸­è°ƒç”¨<br>         åªèƒ½åœ¨Reactçš„å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨Hook,ä¸è¦å†å…¶ä»–jså‡½æ•°ä¸­ä½¿ç”¨</p><div class="code-wrapper"><pre><code class="hljs">  const [count, setCount] = useState(() =&gt; 10);//useStateå¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°</code></pre></div><p>  console.log(â€œCounterHookæ¸²æŸ“â€);</p><p>  function handleBtnClick() {<br>    // setCount(count + 10);</p><p>â€‹    setCount((prevCount) =&gt; prevCount + 10);//preCountæ˜¯ä¸Šä¸€ä¸ªcount<br>â€‹<br>â€‹    å¦‚æœä½ çš„æ›´æ–°å‡½æ•°è¿”å›å€¼ä¸å½“å‰ state å®Œå…¨ç›¸åŒï¼Œåˆ™éšåçš„é‡æ¸²æŸ“ä¼šè¢«å®Œå…¨è·³è¿‡ã€‚<br>â€‹    ä¸ class ç»„ä»¶ä¸­çš„ setState æ–¹æ³•ä¸åŒï¼ŒuseState ä¸ä¼šè‡ªåŠ¨åˆå¹¶æ›´æ–°å¯¹è±¡ã€‚ä½ å¯ä»¥ç”¨å‡½æ•°å¼çš„     setState ç»“åˆå±•å¼€è¿ç®—ç¬¦æ¥è¾¾åˆ°åˆå¹¶æ›´æ–°å¯¹è±¡çš„æ•ˆæœã€‚<br>â€‹    setState(prevState =&gt; {<br>â€‹      // ä¹Ÿå¯ä»¥ä½¿ç”¨ Object.assign<br>â€‹      return {â€¦prevState, â€¦updatedValues};<br>â€‹    });<br>â€‹    useReducer æ˜¯å¦ä¸€ç§å¯é€‰æ–¹æ¡ˆï¼Œå®ƒæ›´é€‚åˆç”¨äºç®¡ç†åŒ…å«å¤šä¸ªå­å€¼çš„ state å¯¹è±¡ã€‚</p><p> 43.useEffect()<br>     useEffect(() =&gt; {<br>    console.log(â€œè®¢é˜…ä¸€äº›äº‹ä»¶â€);</p><p>â€‹    return () =&gt; {<br>â€‹      console.log(â€œå–æ¶ˆè®¢é˜…äº‹ä»¶â€)<br>â€‹    }<br>  }, []);//é€šè¿‡è¿”å›ä¸€ä¸ªå‡½æ•°æ¥æ‰§è¡Œç±»ä¼¼componmentwillumnountæ¥æ¸…é™¤å‰¯ä½œç”¨ï¼Œ[]è¿™ä¸ªå¯ä»¥ä½œä¸ºä¼˜åŒ–ï¼Œåªæœ‰åœ¨ç»„ä»¶åˆ‡æ¢æ—¶æ‰æ‰§è¡Œï¼Œ[]åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œç›¸å½“äºæ˜¯componentDiMount,componentWillUnmount<br>  44.useEffectç¬¬äºŒä¸ªå‚æ•°<br>   useEffect(() =&gt; {<br>â€‹    console.log(â€œä¿®æ”¹DOMâ€, count);<br>  }, [count]);//useEffectå¯ä»¥è®©æŸä¸ªå±æ€§å‘ç”Ÿæ”¹å˜æ—¶æ‰æ‰§è¡Œï¼Œè¿™ä¸ªå±æ€§å¿…é¡»åœ¨useEffectçš„å›è°ƒå‡½æ•°ä¸­æœ‰ä½¿ç”¨åˆ°<br>  å¦‚æœæƒ³æ‰§è¡Œåªè¿è¡Œä¸€æ¬¡çš„ effectï¼ˆä»…åœ¨ç»„ä»¶æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œï¼‰ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ[]ï¼‰ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚è¿™å°±å‘Šè¯‰ React ä½ çš„ effect ä¸ä¾èµ–äº props æˆ– state ä¸­çš„ä»»ä½•å€¼ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œéƒ½ä¸éœ€è¦é‡å¤æ‰§è¡Œã€‚è¿™å¹¶ä¸å±äºç‰¹æ®Šæƒ…å†µ â€”â€” å®ƒä¾ç„¶éµå¾ªä¾èµ–æ•°ç»„çš„å·¥ä½œæ–¹å¼ã€‚</p><p>ä½¿ç”¨å¤šä¸ªuseEffectå¯ä»¥åˆ†å¼€ä½¿ç”¨ï¼Œæ‰§è¡Œçš„æ—¶å€™ä¼šæŒ¨ä¸ªæ‰§è¡Œ</p><h4 id="45-useContextçš„ä½¿ç”¨"><a href="#45-useContextçš„ä½¿ç”¨" class="headerlink" title="45.useContextçš„ä½¿ç”¨"></a>45.useContextçš„ä½¿ç”¨</h4><p>â€‹    useContextå¯ä»¥è®©å¤šä¸ªContextä¼ é€’ç»™å‡½æ•°å¼ç»„ä»¶çš„æ—¶å€™å‡å°‘consumerçš„åµŒå¥—</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> root = <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">createRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));root.<span class="hljs-title function_">render</span>(  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;&#123;name:</span> &quot;<span class="hljs-attr">why</span>&quot;, <span class="hljs-attr">level:</span> <span class="hljs-attr">99</span>&#125;&#125;&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">TokenContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;</span>&#x27;<span class="hljs-attr">coderwhy</span>&#x27;&#125;&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">TokenContext.Provider</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>);</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; memo, useContext &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">UserContext</span>, <span class="hljs-title class_">ThemeContext</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./context&quot;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">// ä½¿ç”¨Context</span>  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">UserContext</span>)  <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>)  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>User: &#123;user.name&#125;-&#123;user.level&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;color:</span> <span class="hljs-attr">theme.color</span>, <span class="hljs-attr">fontSize:</span> <span class="hljs-attr">theme.size</span>&#125;&#125;&gt;</span>Theme<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  )&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span></code></pre></div><h4 id="46-useCallbackçš„ä½¿ç”¨"><a href="#46-useCallbackçš„ä½¿ç”¨" class="headerlink" title="46.useCallbackçš„ä½¿ç”¨"></a>46.useCallbackçš„ä½¿ç”¨</h4><p>useReducerä¸æ˜¯reduxçš„æ›¿ä»£å“ï¼ŒuseReducerä»…ä»…æ˜¯useStateçš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆã€‚åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå¦‚æœstateçš„å¤„ç†é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡useReduceræ¥å¯¹å…¶è¿›è¡Œæ‹†åˆ†ï¼Œæˆ–è€…è¿™æ¬¡ä¿®æ”¹çš„stateéœ€è¦ä¾èµ–ä¹‹å‰çš„stateæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">reducer</span>(<span class="hljs-params">state, action</span>) &#123;  <span class="hljs-keyword">switch</span>(action.<span class="hljs-property">type</span>) &#123;    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;increment&quot;</span>:      <span class="hljs-keyword">return</span> &#123; ...state, <span class="hljs-attr">counter</span>: state.<span class="hljs-property">counter</span> + <span class="hljs-number">1</span> &#125;    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;decrement&quot;</span>:      <span class="hljs-keyword">return</span> &#123; ...state, <span class="hljs-attr">counter</span>: state.<span class="hljs-property">counter</span> - <span class="hljs-number">1</span> &#125;    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;add_number&quot;</span>:      <span class="hljs-keyword">return</span> &#123; ...state, <span class="hljs-attr">counter</span>: state.<span class="hljs-property">counter</span> + action.<span class="hljs-property">num</span> &#125;    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;sub_number&quot;</span>:      <span class="hljs-keyword">return</span> &#123; ...state, <span class="hljs-attr">counter</span>: state.<span class="hljs-property">counter</span> - action.<span class="hljs-property">num</span> &#125;    <span class="hljs-attr">default</span>:      <span class="hljs-keyword">return</span> state  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs html">const [state, dispatch] = useReducer(reducer, &#123; counter: 0, friends: [], user: &#123;&#125; &#125;)     <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> dispatch(&#123;type: &quot;increment&quot;&#125;)&#125;&gt;+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> dispatch(&#123;type: &quot;decrement&quot;&#125;)&#125;&gt;-1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> dispatch(&#123;type: &quot;add_number&quot;, num: 5&#125;)&#125;&gt;+5<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> dispatch(&#123;type: &quot;sub_number&quot;, num: 5&#125;)&#125;&gt;-5<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> dispatch(&#123;type: &quot;add_number&quot;, num: 100&#125;)&#125;&gt;+100<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></code></pre></div><h4 id="47-useMemoçš„ä½¿ç”¨"><a href="#47-useMemoçš„ä½¿ç”¨" class="headerlink" title="47.useMemoçš„ä½¿ç”¨"></a>47.useMemoçš„ä½¿ç”¨</h4><p>åœ¨è¿›è¡Œå¤§é‡çš„è®¡ç®—çš„æ—¶å€™ï¼Œä½¿ç”¨useMemoå¯ä»¥é¿å…é‡å¤çš„æ¸²æŸ“</p><p>å¯ä»¥å¯¹å­ç»„ä»¶ä¼ é€’ç›¸åŒå†…å®¹çš„å¯¹è±¡çš„æ—¶å€™é¿å…é‡æ–°æ¸²æŸ“</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; memo, useCallback &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">import</span> &#123; useMemo, useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">HelloWorld</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">props</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;HelloWorldè¢«æ¸²æŸ“~&quot;</span>)  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Hello World<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span>&#125;)<span class="hljs-keyword">function</span> <span class="hljs-title function_">calcNumTotal</span>(<span class="hljs-params">num</span>) &#123;  <span class="hljs-comment">// console.log(&quot;calcNumTotalçš„è®¡ç®—è¿‡ç¨‹è¢«è°ƒç”¨~&quot;)</span>  <span class="hljs-keyword">let</span> total = <span class="hljs-number">0</span>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= num; i++) &#123;    total += i  &#125;  <span class="hljs-keyword">return</span> total&#125;<span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)  <span class="hljs-comment">// const result = calcNumTotal(50)</span>  <span class="hljs-comment">// 1.ä¸ä¾èµ–ä»»ä½•çš„å€¼, è¿›è¡Œè®¡ç®—</span>  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">return</span> <span class="hljs-title function_">calcNumTotal</span>(<span class="hljs-number">50</span>)  &#125;, [])  <span class="hljs-comment">// 2.ä¾èµ–count</span>  <span class="hljs-comment">// const result = useMemo(() =&gt; &#123;</span>  <span class="hljs-comment">//   return calcNumTotal(count*2)</span>  <span class="hljs-comment">// &#125;, [count])</span>  <span class="hljs-comment">// 3.useMemoå’ŒuseCallbackçš„å¯¹æ¯”</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;&#125;  <span class="hljs-comment">// const increment = useCallback(fn, [])</span>  <span class="hljs-comment">// const increment2 = useMemo(() =&gt; fn, [])</span>  <span class="hljs-comment">// 4.ä½¿ç”¨useMemoå¯¹å­ç»„ä»¶æ¸²æŸ“è¿›è¡Œä¼˜åŒ–</span>  <span class="hljs-comment">// const info = &#123; name: &quot;why&quot;, age: 18 &#125;</span>  <span class="hljs-keyword">const</span> info = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> (&#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>&#125;), [])  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>è®¡ç®—ç»“æœ: &#123;result&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>è®¡æ•°å™¨: &#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> setCount(count+1)&#125;&gt;+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">HelloWorld</span> <span class="hljs-attr">result</span>=<span class="hljs-string">&#123;result&#125;</span> <span class="hljs-attr">info</span>=<span class="hljs-string">&#123;info&#125;</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  )&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span></code></pre></div><p>48.useCallbackæ˜¯é’ˆå¯¹å›è°ƒå‡½æ•°è¿›è¡Œä¼˜åŒ–ï¼ŒuseMemoæ˜¯å¯¹è¿”å›å€¼è¿›è¡Œä¼˜åŒ–ã€‚userCallbackå¯ä»¥ç”¨äºä¼ é€’ç»™è¢«pureComponentæˆ–è€…memoåŒ…è£¹çš„å­ç»„ä»¶çš„å‡½æ•°</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; memo, useState, useCallback, useRef &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-comment">// useCallbackæ€§èƒ½ä¼˜åŒ–çš„ç‚¹:</span><span class="hljs-comment">// 1.å½“éœ€è¦å°†ä¸€ä¸ªå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶æ—¶, æœ€å¥½ä½¿ç”¨useCallbackè¿›è¡Œä¼˜åŒ–, å°†ä¼˜åŒ–ä¹‹åçš„å‡½æ•°, ä¼ é€’ç»™å­ç»„ä»¶</span><span class="hljs-comment">//å¦‚æœæ²¡æœ‰ä½¿ç”¨usecallbackï¼Œå‡½æ•°å¼ç»„ä»¶åœ¨å‘ç”Ÿæ›´æ–°çš„æ—¶å€™ï¼Œæ‰€æœ‰ä»£ç éƒ½ä¼šé‡æ–°æ‰§è¡Œï¼Œä¼ é€’ç»™å­ç»„ä»¶çš„å‡½æ•°ä¼šé‡æ–°ç”Ÿæˆï¼Œå¦‚æœä½¿ç”¨usecallback,ä¼šæ ¹æ®ç¬¬äºŒä¸ªå‚æ•°æ•°ç»„ä¸­çš„å€¼ï¼Œæ˜¯å¦ç”Ÿæˆæ–°çš„å‡½æ•°ï¼Œä½¿å­ç»„ä»¶æ˜¯å¦é‡æ–°æ¸²æŸ“</span><span class="hljs-comment">// propsä¸­çš„å±æ€§å‘ç”Ÿæ”¹å˜æ—¶, ç»„ä»¶æœ¬èº«å°±ä¼šè¢«é‡æ–°æ¸²æŸ“ï¼Œ</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">HYHome</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">props</span>) &#123;  <span class="hljs-keyword">const</span> &#123; increment &#125; = props  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;HYHomeè¢«æ¸²æŸ“&quot;</span>)  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;increment&#125;</span>&gt;</span>increment+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">      &#123;/* 100ä¸ªå­ç»„ä»¶ */&#125;</span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  )&#125;)<span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)  <span class="hljs-keyword">const</span> [message, setMessage] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">&quot;hello&quot;</span>)  <span class="hljs-comment">// é—­åŒ…é™·é˜±: useCallback  è§£å†³é—­åŒ…é™·é˜±æ–¹å¼ä¸€ï¼Œä½†æ˜¯ä¼šç”Ÿæˆæ–°çš„å‡½æ•°</span>  <span class="hljs-comment">// const increment = useCallback(function foo() &#123;</span>  <span class="hljs-comment">//   console.log(&quot;increment&quot;)</span>  <span class="hljs-comment">//   setCount(count+1)</span>  <span class="hljs-comment">// &#125;, [count])</span>  <span class="hljs-comment">// è¿›ä¸€æ­¥çš„ä¼˜åŒ–: å½“countå‘ç”Ÿæ”¹å˜æ—¶, ä¹Ÿä½¿ç”¨åŒä¸€ä¸ªå‡½æ•°(äº†è§£)</span>  <span class="hljs-comment">// åšæ³•ä¸€: å°†countä¾èµ–ç§»é™¤æ‰, ç¼ºç‚¹: é—­åŒ…é™·é˜±,å› ä¸ºæ­¤æ—¶çš„fooå’ŒåŸæ¥çš„fooä¸æ˜¯åŒä¸€ä¸ªfoo,è€ŒåŸæ¥çš„fooä¾ç„¶ä½¿ç”¨ä¹‹å‰çš„count</span>  <span class="hljs-comment">// const increment = useCallback(function foo() &#123;</span>  <span class="hljs-comment">//   console.log(&quot;increment&quot;)</span>  <span class="hljs-comment">//   setCount(count+1)</span>  <span class="hljs-comment">// &#125;, [])</span>  <span class="hljs-comment">// åšæ³•äºŒ: useRef, åœ¨ç»„ä»¶å¤šæ¬¡æ¸²æŸ“æ—¶, è¿”å›çš„æ˜¯åŒä¸€ä¸ªå€¼</span>  <span class="hljs-keyword">const</span> countRef = <span class="hljs-title function_">useRef</span>()  countRef.<span class="hljs-property">current</span> = count  <span class="hljs-keyword">const</span> increment = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;increment&quot;</span>)    <span class="hljs-title function_">setCount</span>(countRef.<span class="hljs-property">current</span> + <span class="hljs-number">1</span>)  &#125;, [])  <span class="hljs-comment">// æ™®é€šçš„å‡½æ•°</span>  <span class="hljs-comment">// const increment = () =&gt; &#123;</span>  <span class="hljs-comment">//   setCount(count+1)</span>  <span class="hljs-comment">// &#125;</span>  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>è®¡æ•°: &#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;increment&#125;</span>&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">HYHome</span> <span class="hljs-attr">increment</span>=<span class="hljs-string">&#123;increment&#125;/</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>message:&#123;message&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> setMessage(Math.random())&#125;&gt;ä¿®æ”¹message<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  )&#125;)<span class="hljs-comment">// function foo(name) &#123;</span><span class="hljs-comment">//   function bar() &#123;</span><span class="hljs-comment">//     console.log(name)</span><span class="hljs-comment">//   &#125;</span><span class="hljs-comment">//   return bar</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// const bar1 = foo(&quot;why&quot;)</span><span class="hljs-comment">// bar1() // why</span><span class="hljs-comment">// bar1() // why</span><span class="hljs-comment">// const bar2 = foo(&quot;kobe&quot;)</span><span class="hljs-comment">// bar2() // kobe</span><span class="hljs-comment">// bar1() // why</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span></code></pre></div><p>useCallbackä¼šè¿”å›ä¸€ä¸ªå‡½æ•°çš„memoized(è®°å¿†çš„)ï¼Œåœ¨ä¾èµ–ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå¤šæ¬¡å®šä¹‰çš„æ—¶å€™ï¼Œè¿”å›çš„å€¼æ˜¯ç›¸åŒçš„ã€‚é€šå¸¸ä½¿ç”¨useCallbackçš„ç›®çš„æ˜¯ä¸å¸Œæœ›å­ç»„ä»¶è¿›è¡Œå¤šæ¬¡æ¸²æŸ“ï¼Œå¹¶ä¸æ˜¯ä¸ºäº†å‡½æ•°ç»§ç»­ç¼“å­˜</p><h4 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h4><p>useRefè¿”å›ä¸€ä¸ªrefå¯¹è±¡ï¼Œè¿”å›çš„refå¯¹è±¡å†ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¿æŒä¸å˜ï¼Œä¼šæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</p><p>useRefçš„ä¸¤ç§ç”¨æ³•ï¼š</p><p>â€‹    ç”¨æ³•ä¸€ï¼šå¼•å…¥DOM(æˆ–è€…ç»„ä»¶ï¼Œä½†æ˜¯éœ€è¦classç»„ä»¶)å…ƒç´ </p><p>â€‹    ç”¨æ³•äºŒï¼š ä¿å­˜ä¸€ä¸ªæ•°æ®ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå¯ä»¥ä¿æŒä¸å˜</p><p>49.Refsçš„è½¬å‘<br>      å°±æ˜¯çˆ¶ç»„ä»¶æƒ³è·å–åˆ°å­ç»„ä»¶çš„ref,åœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘refs<br>      å¯ä»¥ä½¿ç”¨React.forwardRef()<br>      const ref=useRef(initialValue)//åˆå§‹åŒ–å€¼åä¸ä¼šå‘ç”Ÿæ”¹å˜    </p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">RefHookDemo02</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);  <span class="hljs-keyword">const</span> numRef = <span class="hljs-title function_">useRef</span>(count);  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;    numRef.<span class="hljs-property">current</span> = count;  &#125;, [count])  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      &#123;/* <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>numRefä¸­çš„å€¼: &#123;numRef.current&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>countä¸­çš„å€¼: &#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span> */&#125;</span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>countä¸Šä¸€æ¬¡çš„å€¼: &#123;numRef.current&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>countè¿™ä¸€æ¬¡çš„å€¼: &#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> setCount(count + 10)&#125;&gt;+10<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  )&#125;<span class="hljs-comment">//useEffectå’ŒuseRefç»“åˆä½¿ç”¨å¯ä»¥ä¿®æ”¹numRef.current</span></code></pre></div><p>50.useImperativeHandleè¦å’ŒReact.forwardRef()ä¸€èµ·ä½¿ç”¨</p><p>é€šè¿‡forwardRefå¯ä»¥å°†refè½¬å‘åˆ°å­ç»„ä»¶ï¼Œè·å–åˆ°å­ç»„ä»¶å†…éƒ¨çš„ref,å­ç»„ä»¶æ‹¿åˆ°çˆ¶ç»„ä»¶åˆ›å»ºçš„refç»‘å®šåˆ°æŸä¸ªå…ƒç´ ä¸Šï¼ŒforwordRefä¼šå°†å­ç»„ä»¶çš„DOMæš´éœ²ç»™çˆ¶ç»„ä»¶ï¼Œçˆ¶ç»„ä»¶æ‹¿åˆ°DOMä¹‹åå¯ä»¥ä»»æ„æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨useImperativeHandleæš´éœ²å›ºå®šçš„æ“ä½œ</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; memo, useRef, forwardRef, useImperativeHandle &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">HelloWorld</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> inputRef = <span class="hljs-title function_">useRef</span>()  <span class="hljs-comment">// å­ç»„ä»¶å¯¹çˆ¶ç»„ä»¶ä¼ å…¥çš„refè¿›è¡Œå¤„ç†</span>  <span class="hljs-title function_">useImperativeHandle</span>(ref, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">return</span> &#123;      <span class="hljs-title function_">focus</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;focus&quot;</span>)        inputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>()      &#125;,      <span class="hljs-title function_">setValue</span>(<span class="hljs-params">value</span>) &#123;        inputRef.<span class="hljs-property">current</span>.<span class="hljs-property">value</span> = value      &#125;    &#125;  &#125;)  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;inputRef&#125;/</span>&gt;</span></span>&#125;))<span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> titleRef = <span class="hljs-title function_">useRef</span>()  <span class="hljs-keyword">const</span> inputRef = <span class="hljs-title function_">useRef</span>()  <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleDOM</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// console.log(inputRef.current)</span>    inputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>()    <span class="hljs-comment">// inputRef.current.value = &quot;&quot;</span>    inputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">setValue</span>(<span class="hljs-string">&quot;å“ˆå“ˆå“ˆ&quot;</span>)  &#125;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;titleRef&#125;</span>&gt;</span>å“ˆå“ˆå“ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">HelloWorld</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;inputRef&#125;/</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;handleDOM&#125;</span>&gt;</span>DOMæ“ä½œ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  )&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span></code></pre></div><p>51.è‡ªå®šä¹‰hookï¼šå°±æ˜¯å°†reactçš„hookå°è£…æˆå‡½æ•°<br>52.fiberçš„åŸç†<br>53.ä¸è¦åœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸­ä½¿ç”¨hook<br>54.ä½¿ç”¨normailze.csså¯¹é¡¹ç›®è¿›è¡Œåˆå§‹åŒ–<br>    ä½¿ç”¨@craco/cracoä¿®æ”¹react é…ç½®<br>        ä¿®æ”¹webpackçš„alias<br>    ä½¿ç”¨react-config-routerè¿›è¡Œè·¯ç”±é…ç½®<br>    ä½¿ç”¨styled-compomentsè¿›è¡Œå†™cssæ ·å¼<br>        background:url(${reuire()})//éœ€è¦ä½¿ç”¨requireæ¥å¼•å…¥å›¾ç‰‡<br>        æœç´¢æ¡†ä½¿ç”¨antDesign<br>        æ•°æ®éƒ½æ˜¯ç”¨reduxæ¥ç®¡ç†<br>        ç”¨redux-thunkè¿›è¡Œå¼‚æ­¥è¯·æ±‚<br>        é…ç½®redux-devtool<br>        å°†å„ä¸ªæ¨¡å—çš„reduxåˆ†å¼€å†™å†å„ä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶åè¿›è¡Œåˆå¹¶ï¼Œä½¿ç”¨combineReducers<br>        storeä½¿ç”¨Providerè¿›è¡Œä¼ é€’<br>        æ‰€æœ‰ç»„ä»¶ç”¨memo()åŒ…è£¹ç®¡ç†<br>        ä½¿ç”¨reduxçš„hook:useDispatch()<br>                       useSelector(state=&gt;({}),shallowEqual)<br>                       shallowEqual//è¿›è¡Œæµ…å±‚æ¯”è¾ƒ,åšä¼˜åŒ–<br>        Immutablejså¯ä»¥è§£å†³ä½¿ç”¨æ‹·è´æ¥å†³ç»æ•°æ®å¯å˜æ€§çš„é—®é¢˜ï¼Œå¸¦æ¥çš„æ€§èƒ½é—®é¢˜        </p><div class="code-wrapper"><pre><code class="hljs csharp"><span class="hljs-keyword">const</span> im=immutable<span class="hljs-keyword">const</span> info=&#123;&#125;<span class="hljs-keyword">const</span> imfoIM=im(info)imfoIm.<span class="hljs-keyword">set</span>()imfoIM.<span class="hljs-keyword">get</span>()imfoIm.list()imfoim.fromJS()<span class="hljs-comment">//æ·±å±‚æ¬¡è½¬æ¢</span></code></pre></div><p>â€‹        2.åªèƒ½å†reactå‡½æ•°ä¸­è°ƒç”¨æˆimmutableç±»å‹<br>â€‹            state.getIn([â€œaâ€,â€bâ€])//ç›¸å½“äºa.b<br>â€‹            styled-componentsçš„ä¼ å‚<br>â€‹            ä½¿ç”¨useCallbackå¯¹éœ€è¦ä¼ ç»™å­ç»„ä»¶çš„å‡½æ•°è¿›è¡ŒåŒ…è£¹ï¼Œå¯ä»¥æœ‰ç¼“å­˜ï¼Œå¹¶æé«˜æ€§èƒ½<br>â€‹<br>â€‹            ä½¿ç”¨ redux-immutableä¸­çš„commineReduceræ¥ä¼˜åŒ–combineReducer,æé«˜æ€§èƒ½</p><p>55 Hookçš„æœ¬è´¨å°±æ˜¯javascriptå‡½æ•°ï¼Œä»–è¦éµå¾ªä¸¤æ¡è§„åˆ™<br>    1.åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨hook<br>        ä¸è¦å†å¾ªç¯ï¼Œæ¡ä»¶æˆ–è€…åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨hook,ç¡®ä¿æ€»æ˜¯å†ä½ çš„reactå‡½æ•°çš„æœ€é¡¶å±‚å»è°ƒç”¨ä»–ä»¬<br>        éµå®ˆè¿™æ¡è§„åˆ™ï¼Œä½ å°±èƒ½ç¡®ä¿ Hook åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨ã€‚è¿™è®© React èƒ½å¤Ÿåœ¨å¤šæ¬¡çš„ useState å’Œ useEffect è°ƒç”¨ä¹‹é—´ä¿æŒ hook çŠ¶æ€çš„æ­£ç¡®<br>    2.åªèƒ½å†reactå‡½æ•°ä¸­è°ƒç”¨Hook<br>      ä¸è¦åœ¨æ™®é€šçš„javascriptä¸­è°ƒç”¨hook,å¯ä»¥åœ¨reatå‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨hook,ä¹Ÿå¯ä»¥åœ¨åœ¨å®šä¹‰hookä¸­è°ƒç”¨å…¶ä»–hook<br>56.è‡ªå®šä¹‰HOOKä¸€å®šè¦ä»¥useå¼€å¤´<br>57.åœ¨ä¸¤ä¸ªç»„ä»¶ä¸­ä½¿ç”¨ç›¸åŒçš„ Hook ä¼šå…±äº« state å—ï¼Ÿä¸ä¼šã€‚è‡ªå®šä¹‰ Hook æ˜¯ä¸€ç§é‡ç”¨çŠ¶æ€é€»è¾‘çš„æœºåˆ¶(ä¾‹å¦‚è®¾ç½®ä¸ºè®¢é˜…å¹¶å­˜å‚¨å½“å‰å€¼)ï¼Œæ‰€ä»¥æ¯æ¬¡ä½¿ç”¨è‡ªå®šä¹‰ Hook æ—¶ï¼Œå…¶ä¸­çš„æ‰€æœ‰ state å’Œå‰¯ä½œç”¨éƒ½æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚<br>58.è‡ªå®šä¹‰ Hook å¦‚ä½•è·å–ç‹¬ç«‹çš„ stateï¼Ÿæ¯æ¬¡è°ƒç”¨ Hookï¼Œå®ƒéƒ½ä¼šè·å–ç‹¬ç«‹çš„ state<br>    ç”±äºæˆ‘ä»¬ç›´æ¥è°ƒç”¨äº† useFriendStatusï¼Œä» React çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬çš„ç»„ä»¶åªæ˜¯è°ƒç”¨äº† useState å’Œ useEffect<br>59.æƒ°æ€§åˆå§‹åŒ–state</p><p><code>initialState</code> å‚æ•°åªä¼šåœ¨ç»„ä»¶çš„åˆå§‹æ¸²æŸ“ä¸­èµ·ä½œç”¨ï¼Œåç»­æ¸²æŸ“æ—¶ä¼šè¢«å¿½ç•¥ã€‚å¦‚æœåˆå§‹ state éœ€è¦é€šè¿‡å¤æ‚è®¡ç®—è·å¾—ï¼Œåˆ™å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­è®¡ç®—å¹¶è¿”å›åˆå§‹çš„ stateï¼Œæ­¤å‡½æ•°åªåœ¨åˆå§‹æ¸²æŸ“æ—¶è¢«è°ƒç”¨ï¼š</p><div class="code-wrapper"><pre><code class="hljs pf"><span class="hljs-keyword">const</span> [<span class="hljs-keyword">state</span>, <span class="hljs-built_in">set</span>State] = useState(() =&gt; &#123;  <span class="hljs-keyword">const</span> initialState = someExpensiveComputation(props);  return initialState;&#125;);</code></pre></div><h4 id="60-useEffectæ˜¯åœ¨æ¯ä¸€è½®æ¸²æŸ“ç»“æŸåæ‰§è¡Œ"><a href="#60-useEffectæ˜¯åœ¨æ¯ä¸€è½®æ¸²æŸ“ç»“æŸåæ‰§è¡Œ" class="headerlink" title="60.useEffectæ˜¯åœ¨æ¯ä¸€è½®æ¸²æŸ“ç»“æŸåæ‰§è¡Œ"></a>60.useEffectæ˜¯åœ¨æ¯ä¸€è½®æ¸²æŸ“ç»“æŸåæ‰§è¡Œ</h4><p>61.ç»„ä»¶å¸è½½æ—¶éœ€è¦æ¸…é™¤effectåˆ›å»ºçš„è®¢é˜…ï¼Œå®šæ—¶å™¨ç­‰ï¼ŒuseEffectå‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°</p><div class="code-wrapper"><pre><code class="hljs abnf">useEffect(() <span class="hljs-operator">=</span>&gt; &#123;  const subscription <span class="hljs-operator">=</span> props.source.subscribe()<span class="hljs-comment">;</span>  return () <span class="hljs-operator">=</span>&gt; &#123;    // æ¸…é™¤è®¢é˜…    subscription.unsubscribe()<span class="hljs-comment">;</span>  &#125;<span class="hljs-comment">;</span>&#125;)<span class="hljs-comment">;</span></code></pre></div><p>ä¸ºé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œæ¸…é™¤å‡½æ•°ä¼šåœ¨ç»„ä»¶å¸è½½ä¹‹å‰æ‰§è¡Œã€‚å¦å¤–ï¼Œå¦‚æœç»„ä»¶å¤šæ¬¡æ¸²æŸ“ï¼Œåˆ™ä¼šåœ¨å­å•Šä¸ªeffectä¹‹å‰ï¼Œä¸Šä¸€ä¸ªeffectå°±ä¼šè¢«æ¸…é™¤</p><h6 id="62-effectçš„æ‰§è¡Œæ—¶æœº"><a href="#62-effectçš„æ‰§è¡Œæ—¶æœº" class="headerlink" title="62.effectçš„æ‰§è¡Œæ—¶æœº"></a>62.effectçš„æ‰§è¡Œæ—¶æœº</h6><p>ä¸componentDidMount,cimponentDidUpadateä¸åŒçš„æ˜¯ï¼Œåœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸ç»˜åˆ¶ä¹‹åï¼Œ</p><p>ä¼ ç»™useEffectçš„å‡½æ•°ä¼šå»¶è¿Ÿè°ƒç”¨ï¼Œè¿™ä½¿å¾—å®ƒé€‚ç”¨äºè®¸å¤šå¸¸è§çš„å‰¯ä½œç”¨åœºæ™¯ï¼Œæ¯”å¦‚è®¾ç½®è®¢é˜…å’Œäº‹ä»¶å¤„ç†æƒ…å†µï¼Œå› æ­¤ä¸åº”åœ¨å‡½æ•°å€¼æ‰§è¡Œé˜»å¡æµè§ˆå™¨æ›´æ–°çš„æ“ä½œ</p><h6 id="63-useContext"><a href="#63-useContext" class="headerlink" title="63.useContext"></a>63.useContext</h6><div class="code-wrapper"><pre><code class="hljs reasonml">const MyContext= <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">React</span>.</span></span>create<span class="hljs-constructor">Context(<span class="hljs-params">value</span>)</span>const value = use<span class="hljs-constructor">Context(MyContext)</span>;</code></pre></div><p>myContextæ˜¯React.createContextçš„è¿”å›å€¼ï¼Œå¹¶è¿”å›è¯¥contextçš„å½“å‰å€¼ï¼Œå½“å‰çš„valueå€¼ç”±</p><p>ä»–çš„ä¸Šå±‚ç»„ä»¶è·ç¦»å½“å‰ç»„ä»¶æœ€è¿‘çš„&lt;MyContext.Provider&gt;çš„value propå†³å®šçš„</p><p>å½“Providerä¸­çš„valueå‘ç”Ÿæ›´æ–°çš„æ—¶å€™ï¼ŒuseContextå°±ä¼šå‡ºå‘é‡æ–°æ¸²æŸ“ï¼Œå³ä½¿ç»„ä»¶æ—¶ä½¿ç”¨React.emoåŒ…è£¹ï¼Œæˆ–è€…ä½¿ç”¨shouldComponentUpdatç”Ÿå‘½å‘¨æœŸï¼Œè¯¥ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“</p><p>åªè¦MyConetexté‡Œé¢çš„å€¼å‘ç”Ÿæ”¹å˜ï¼Œä½¿ç”¨äº†useContextçš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ï¼Œå¦‚æœé‡æ–°æ¸²æŸ“å¼€é”€å¤§ï¼Œå¯ä»¥ä½¿ç”¨memoizationæ¥ä¼˜åŒ–</p><p>useContext(MyContext)===&gt;classä¸­çš„static contextType=MyContextæˆ–è€…&lt;MyContext.Consumer&gt;</p><p><code>useContext(MyContext)</code> åªæ˜¯è®©ä½ èƒ½å¤Ÿ<em>è¯»å–</em> context çš„å€¼ä»¥åŠè®¢é˜… context çš„å˜åŒ–ã€‚ä½ ä»ç„¶éœ€è¦åœ¨ä¸Šå±‚ç»„ä»¶æ ‘ä¸­ä½¿ç”¨ <code>&lt;MyContext.Provider&gt;</code> æ¥ä¸ºä¸‹å±‚ç»„ä»¶<em>æä¾›</em> contextã€‚</p><h6 id="64-useReducer"><a href="#64-useReducer" class="headerlink" title="64.useReducer"></a>64.<code>useReducer</code></h6><div class="code-wrapper"><pre><code class="hljs pf"><span class="hljs-keyword">const</span> [<span class="hljs-keyword">state</span>, dispatch] = useReducer(reducer, initialArg, init);useStateçš„æ›¿ä»£æ–¹æ¡ˆåœ¨æŸäº›åœºåˆä¼šæ¯”useStateæ›´åŠ é€‚ç”¨ï¼Œä¾‹å¦‚ <span class="hljs-keyword">state</span> é€»è¾‘è¾ƒå¤æ‚ä¸”åŒ…å«å¤šä¸ªå­å€¼ï¼Œæˆ–è€…ä¸‹ä¸€ä¸ª <span class="hljs-keyword">state</span> ä¾èµ–äºä¹‹å‰çš„ <span class="hljs-keyword">state</span> ç­‰ã€‚å¹¶ä¸”ï¼Œä½¿ç”¨ useReducer è¿˜èƒ½ç»™é‚£äº›ä¼šè§¦å‘æ·±æ›´æ–°çš„ç»„ä»¶åšæ€§èƒ½ä¼˜åŒ–ï¼Œå› ä¸ºä½ å¯ä»¥å‘å­ç»„ä»¶ä¼ é€’ dispatch è€Œä¸æ˜¯å›è°ƒå‡½æ•° ã€‚</code></pre></div><div class="code-wrapper"><pre><code class="hljs pf"><span class="hljs-keyword">const</span> initialState = &#123;count: <span class="hljs-number">0</span>&#125;;function reducer(<span class="hljs-keyword">state</span>, action) &#123;  switch (action.type) &#123;    case &#x27;increment&#x27;:      return &#123;count: <span class="hljs-keyword">state</span>.count + <span class="hljs-number">1</span>&#125;;    case &#x27;decrement&#x27;:      return &#123;count: <span class="hljs-keyword">state</span>.count - <span class="hljs-number">1</span>&#125;;    <span class="hljs-keyword">default</span>:      throw new Error();  &#125;&#125;function Counter() &#123;  <span class="hljs-keyword">const</span> [<span class="hljs-keyword">state</span>, dispatch] = useReducer(reducer, initialState);  return (    <span class="hljs-variable">&lt;&gt;</span>      Count: &#123;<span class="hljs-keyword">state</span>.count&#125;      <span class="hljs-variable">&lt;button onClick=&#123;() =&gt;</span> dispatch(&#123;type: &#x27;decrement&#x27;&#125;)&#125;&gt;-&lt;/button&gt;      <span class="hljs-variable">&lt;button onClick=&#123;() =&gt;</span> dispatch(&#123;type: &#x27;increment&#x27;&#125;)&#125;&gt;+&lt;/button&gt;    &lt;/&gt;  );&#125;</code></pre></div><h4 id="æƒ°æ€§åˆå§‹åŒ–"><a href="#æƒ°æ€§åˆå§‹åŒ–" class="headerlink" title="æƒ°æ€§åˆå§‹åŒ–"></a>æƒ°æ€§åˆå§‹åŒ–</h4><p>useReducerçš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ ·åˆå§‹stateå°†è®¾ç½®ä¸ºä¼ å…¥å‡½æ•°çš„è¿”å›å€¼</p><p>å¯ä»¥é€šè¿‡å¤–éƒ¨æ¥ä¼ å…¥</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">initialCount</span>) &#123;  <span class="hljs-keyword">return</span> &#123;<span class="hljs-attr">count</span>: initialCount&#125;;&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">reducer</span>(<span class="hljs-params">state, action</span>) &#123;  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;increment&#x27;</span>:      <span class="hljs-keyword">return</span> &#123;<span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> + <span class="hljs-number">1</span>&#125;;    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;decrement&#x27;</span>:      <span class="hljs-keyword">return</span> &#123;<span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> - <span class="hljs-number">1</span>&#125;;    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;reset&#x27;</span>:      <span class="hljs-keyword">return</span> <span class="hljs-title function_">init</span>(action.<span class="hljs-property">payload</span>);    <span class="hljs-attr">default</span>:      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>();  &#125;&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params">&#123;initialCount&#125;</span>) &#123;  <span class="hljs-keyword">const</span> [state, dispatch] = <span class="hljs-title function_">useReducer</span>(reducer, initialCount, init);  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><span class="language-xml">      Count: &#123;state.count&#125;</span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatch(&#123;type: &#x27;reset&#x27;, payload: initialCount&#125;)&#125;&gt;</span><span class="language-xml">        Reset</span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatch(&#123;type: &#x27;decrement&#x27;&#125;)&#125;&gt;-<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatch(&#123;type: &#x27;increment&#x27;&#125;)&#125;&gt;+<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/&gt;</span></span>  );&#125;</code></pre></div><p>å¦‚æœ Reducer Hook çš„è¿”å›å€¼ä¸å½“å‰ state ç›¸åŒï¼ŒReact å°†è·³è¿‡å­ç»„ä»¶çš„æ¸²æŸ“åŠå‰¯ä½œç”¨çš„æ‰§è¡Œã€‚ï¼ˆReact ä½¿ç”¨ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#Description"><code>Object.is</code> æ¯”è¾ƒç®—æ³•</a> æ¥æ¯”è¾ƒ stateã€‚ï¼‰</p><p>å¦‚æœä½ åœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œäº†é«˜å¼€é”€çš„è®¡ç®—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>useMemo</code> æ¥è¿›è¡Œä¼˜åŒ–ã€‚</p><p>useReducerä¸å¯ä»¥ä½œä¸ºreduxçš„æ›¿ä»£æ–¹æ¡ˆï¼Œä¸å¯ä»¥è¿›è¡Œæ•°æ®å…±äº«</p><p>65.ä½¿ç”¨memoåŒ…è£¹å‡½æ•°ï¼Œå¯ä»¥è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œä¼šå¯¹propsè¿›è¡Œæµ…å±‚æ¯”è¾ƒï¼Œå¦‚æœpropsæ²¡æœ‰å‘ç”Ÿæ›´æ–°ï¼Œåˆ™ä¸ä¼šé‡æ–°æ¸²æŸ“</p><p>66.æ²¡æœ‰ä¼˜åŒ–ä»¥å‰ã€‚çˆ¶ç»„ä»¶å‘ç”Ÿæ”¹å˜å­ç»„ä»¶ä¹Ÿä¼šé‡æ–°æ¸²æŸ“</p><p>67.useCallback</p><p>è¿”å›ä¸€ä¸ª <a href="https://en.wikipedia.org/wiki/Memoization">memoized</a> å›è°ƒå‡½æ•°ã€‚</p><p>æŠŠå†…è”å›è°ƒå‡½æ•°åŠä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ <code>useCallback</code>ï¼Œå®ƒå°†è¿”å›è¯¥å›è°ƒå‡½æ•°çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥å›è°ƒå‡½æ•°ä»…åœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°ã€‚å½“ä½ æŠŠå›è°ƒå‡½æ•°ä¼ é€’ç»™ç»è¿‡ä¼˜åŒ–çš„å¹¶ä½¿ç”¨å¼•ç”¨ç›¸ç­‰æ€§å»é¿å…éå¿…è¦æ¸²æŸ“ï¼ˆä¾‹å¦‚ <code>shouldComponentUpdate</code>ï¼‰çš„å­ç»„ä»¶æ—¶ï¼Œå®ƒå°†éå¸¸æœ‰ç”¨ã€‚</p><p><img src="https://img1.imgtp.com/2022/09/12/JXSSiW1v.png" alt="QQæˆªå›¾20220620112711.png"></p><p><img src="https://img1.imgtp.com/2022/09/12/7N1MVzzM.png" alt="QQæˆªå›¾20220620112901.png"></p><p>68.useMeno</p><p>â€‹    <code>useCallback(fn, deps)</code> ç›¸å½“äº <code>useMemo(() =&gt; fn, deps)</code>ã€‚</p><p>useCallbackæ˜¯è¿”å›<a href="https://en.wikipedia.org/wiki/Memoization">memoized</a> å›è°ƒå‡½æ•°ã€‚useMenoæ˜¯è¿”å›ä¸€ä¸ªmemoizedå€¼</p><p>useMemoåªä¼šåœ¨ä¾èµ–é¡¹å‘ç”Ÿæ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®—æ‰§è¡Œï¼Œè¿”å›æ–°çš„å€¼ï¼Œé¿å…æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¿›è¡Œé«˜å¼€é”€çš„è®¡ç®—</p><p>è®°ä½ï¼Œä¼ å…¥ <code>useMemo</code> çš„å‡½æ•°ä¼šåœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œã€‚è¯·ä¸è¦åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨æ‰§è¡Œä¸æ¸²æŸ“æ— å…³çš„æ“ä½œï¼Œè¯¸å¦‚å‰¯ä½œç”¨è¿™ç±»çš„æ“ä½œå±äº <code>useEffect</code> çš„é€‚ç”¨èŒƒç•´ï¼Œè€Œä¸æ˜¯ <code>useMemo</code>ã€‚</p><p>å¦‚æœæ²¡æœ‰æä¾›ä¾èµ–é¡¹æ•°ç»„ï¼Œ<code>useMemo</code> åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šè®¡ç®—æ–°çš„å€¼</p><p><img src="https://img1.imgtp.com/2022/09/12/YMPGqZBu.png" alt="QQæˆªå›¾20220620131653.png"></p><p><img src="https://img1.imgtp.com/2022/09/12/9Z0ICdSV.png" alt="QQæˆªå›¾20220620131701.png"></p><p>69.useRef</p><p>useRefè¿”å›ä¸€ä¸ªrefå¯¹è±¡ï¼Œè¿”å›çš„refå¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¿æŒä¸å˜</p><p>æœ€å¸¸ç”¨çš„refæ˜¯ä¸¤ç§ç”¨æ³•</p><p>â€‹    1.å¼•å…¥DOM(æˆ–è€…æ˜¯classç»„ä»¶)å…ƒç´ ï¼Œä¸å¯ä»¥ç”¨åœ¨å‡½æ•°ç»„ä»¶ä¸­</p><p>â€‹    2.ä¿å­˜ä¸€ä¸ªæ•°æ®ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¯ä»¥ä¿æŒä¸å˜</p><p><img src="https://img1.imgtp.com/2022/09/12/dwdJVSSg.png" alt="QQæˆªå›¾20220620143141.png"></p><p><img src="https://img1.imgtp.com/2022/09/12/emUNGaLF.png" alt="QQæˆªå›¾20220620143158.png"></p><p>70.<code>useImperativeHandle</code></p><p>useImperativeHandleè¦å’ŒforwardRefç»“åˆä½¿ç”¨ï¼Œä½¿ç”¨useImperativeHandleå¯ä»¥ä½¿çˆ¶å…ƒç´ ä¸å¯ä»¥å¯¹å­ç»„ä»¶ä¸­çš„refè¿›è¡Œéšæ„æ“ä½œ</p><p><img src="https://img1.imgtp.com/2022/09/12/Ey8AqNSp.png" alt="QQæˆªå›¾20220620143648.png"></p><p><img src="https://img1.imgtp.com/2022/09/12/crDRrvA5.png" alt="QQæˆªå›¾20220620143735.png"></p><p>71.useLayoutEffect</p><p>â€‹    å’ŒuseEffectçš„åŒºåˆ«æ˜¯</p><p>â€‹    useEffectä¼šåœ¨æ¸²æŸ“çš„å†…å®¹æ›´æ–°åˆ°DOMä¹‹åå†æ‰§è¡Œï¼Œè€Œä¸ä¼šé˜»å¡DOMçš„æ›´æ–°</p><p>â€‹    useLayoutEffectä¼šåœ¨æ¸²æŸ“çš„å†…å®¹æ›´æ–°åˆ°DOMä¸Šä¹‹å‰æ‰§è¡Œï¼Œä¼šé˜»å¡DOMçš„æ›´æ–°</p><p>â€‹    <img src="https://img1.imgtp.com/2022/09/12/Zgl2puzy.png" alt="QQæˆªå›¾20220620144244.png"></p><p><img src="https://img1.imgtp.com/2022/09/12/a6VmoNdR.png" alt="QQæˆªå›¾20220620144253.png"></p><p>72.redux-thunk</p><p>â€‹     ä½¿ç”¨ä¸­é—´ä»¶ç›®çš„æ˜¯å†dispatchçš„actionå’Œreducerä¹‹é—´æ‰©å±•è‡ªå·±çš„ä»£ç ï¼Œä¾‹å¦‚æ—¥å¿—è®°å½•ï¼Œè°ƒç”¨å¼‚æ­¥æ¥å£ï¼Œæ·»åŠ ä»£ç è°ƒè¯•åŠŸèƒ½ç­‰ç­‰</p><p>â€‹    å¯ä»¥ä½¿ç”¨redux-thunkå‘é€å¼‚æ­¥è¯·æ±‚</p><p>â€‹    1.é€šå¸¸æƒ…å†µä¸‹ã€‚dispatch(action),actionnä½™å§šæ˜¯ä¸€ä¸ªjavascriptå¯¹è±¡</p><p>â€‹    2.redux-thunkå¯ä»¥è®©dispatch(actionå‡½æ•°)ï¼Œactionå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°</p><p>â€‹    3.è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šè¿”å›ä¸€ä¸ªå‡½æ•°å¹¶ç»™è¿™ä¸ªå‡½æ•°ä¼ ä¸€ä¸ªpatch,getStateå‡½æ•°</p><p>â€‹                dispatchå‡½æ•°ç”¨äºå†æ¬¡æ´¾å‘action</p><p>â€‹                getStateå‡½æ•°è·å–åˆ°ä¹‹å‰çš„çŠ¶æ€</p><p><img src="C:\Users\10152\Desktop\study\memo\React\QQæˆªå›¾20220620161818.png"></p><p><img src="https://img1.imgtp.com/2022/09/12/DaBjyVoU.png" alt="QQæˆªå›¾20220620162945.png"></p><h6 id="73-redux-devtools"><a href="#73-redux-devtools" class="headerlink" title="73.redux-devtools"></a>73.redux-devtools</h6><p>æ˜¯ç”¨æ¥å¯¹reduxä¸­çš„çŠ¶æ€è¿›è¡Œè·Ÿè¸ªè°ƒè¯•</p><p><img src="https://img1.imgtp.com/2022/09/12/QsLGVWW4.png" alt="QQæˆªå›¾20220620163435.png"></p><h5 id="74-combineReducers"><a href="#74-combineReducers" class="headerlink" title="74.combineReducers"></a>74.combineReducers</h5><p>reduxä¸­æä¾›äº†ä¸€ä¸ªå‡½æ•°combineReducersæ¥åˆå¹¶å¤šä¸ªreducer</p><p>combinerReducerçš„å®ç°</p><p>â€‹    å®ƒä¼šå°†reduceråˆå¹¶ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªcombationå‡½æ•°ç›¸å½“äºæ˜¯æ–°çš„reducer</p><p>â€‹    åœ¨æ‰§è¡Œcombinationå‡½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šé€šè¿‡åˆ¤æ–­å‰åè¿”å›çš„æ•°æ®æ˜¯å¦ç›¸åŒæ¥å†³å®šè¿”å›ä¹‹å‰çš„stateè¿˜æ˜¯æ–°çš„stateï¼›</p><p>   æ–°çš„stateä¼šè§¦å‘è®¢é˜…è€…å‘ç”Ÿå¯¹åº”çš„åˆ·æ–°ï¼Œè€Œæ—§çš„stateå¯ä»¥æœ‰æ•ˆçš„ç»„ç»‡è®¢é˜…è€…å‘ç”Ÿåˆ·æ–°ï¼›</p><p><img src="https://img1.imgtp.com/2022/09/12/lfwbA1yr.png" alt="QQæˆªå›¾20220620163958.png"></p><h5 id="75-useSelector"><a href="#75-useSelector" class="headerlink" title="75.useSelector()"></a>75.useSelector()</h5><div class="code-wrapper"><pre><code class="hljs pf">import React <span class="hljs-keyword">from</span> &#x27;react&#x27;import &#123; shallowEqual, useSelector &#125; <span class="hljs-keyword">from</span> &#x27;react-redux&#x27;export <span class="hljs-keyword">const</span> CounterComponent = () =&gt; &#123;  <span class="hljs-keyword">const</span> counter = useSelector((<span class="hljs-keyword">state</span>) =&gt; <span class="hljs-keyword">state</span>.counter,shallowEqual)  return <span class="hljs-variable">&lt;div&gt;</span>&#123;counter&#125;&lt;/div&gt;&#125;//åœ¨hookä¸­ä½¿ç”¨redux,ä½¿ç”¨useSlectoreæ¥è·å–<span class="hljs-keyword">state</span></code></pre></div><h5 id="76-useDispatch"><a href="#76-useDispatch" class="headerlink" title="76.useDispatch()"></a>76.<code>useDispatch()</code></h5><div class="code-wrapper"><pre><code class="hljs actionscript"><span class="hljs-keyword">const</span> dispatch = useDispatch()<span class="hljs-comment">//æ´¾å‘action</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs smali">export<span class="hljs-built_in"> const </span>Todos = () =&gt; &#123; <span class="hljs-built_in"> const </span>dispatch = useDispatch()  useEffect(() =&gt; &#123;    dispatch(fetchTodos())    // Safe to<span class="hljs-built_in"> add </span>dispatch to the dependencies<span class="hljs-built_in"> array</span><span class="hljs-built_in"></span>  &#125;, [dispatch])&#125;</code></pre></div><h5 id="77-useStore"><a href="#77-useStore" class="headerlink" title="77.useStore()"></a>77.<code>useStore()</code></h5><p>æ›¿ä»£createStore()</p>]]></content>
    
    
    <categories>
      
      <category>react</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>piniaç¬”è®°</title>
    <link href="/2022/08/23/pinia%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/08/23/pinia%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="Piniaå’ŒVuexçš„åŒºåˆ«"><a href="#Piniaå’ŒVuexçš„åŒºåˆ«" class="headerlink" title="Piniaå’ŒVuexçš„åŒºåˆ«"></a>Piniaå’ŒVuexçš„åŒºåˆ«</h4><p>Piniaä¸»è¦æ˜¯æ¥æ›¿ä»£Vuexçš„ï¼Œpiniaæœ‰æ›´åŠ ç®€å•çš„apiï¼Œæä¾›äº†composition api,å’Œtypesctriptä¸€èµ·ä½¿ç”¨æœ‰æ›´åŠ å¯é çš„ç±»å‹æ¨æ–­æ”¯æŒ</p><p>å’Œvuexç›¸æ¯”ï¼Œpiniaæœ‰å¾ˆå¤šä¼˜åŠ¿</p><p>ä¾‹å¦‚mutationä¸å†å­˜åœ¨</p><p>æ›´å¥½çš„typescriptæ”¯æŒï¼Œvuexä¹‹å‰å¯¹tsçš„æ”¯æŒå¾ˆä¸å‹å¥½</p><p>ä¸å†æœ‰modulesçš„åµŒå¥—è§£æ„ï¼Œä½ å¯ä»¥çµæ´»çš„ä½¿ç”¨æ¯ä¸€ä¸ªstoreï¼Œä»–ä»¬æ˜¯é€šè¿‡æ‰å¹³åŒ–çš„æ–¹å¼æ¥è¿›è¡Œç›¸äº’ä½¿ç”¨</p><p>ä¸å†æœ‰å‘½åç©ºé—´çš„æ¦‚å¿µï¼Œä¸éœ€è¦è®°ä½ä»–ä»¬çš„å¤æ‚å…³ç³»</p><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><div class="code-wrapper"><pre><code class="hljs mipsasm">yarn <span class="hljs-keyword">add </span>pinia<span class="hljs-comment"># or with npm</span>npm <span class="hljs-keyword">install </span>pinia</code></pre></div><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p>åœ¨vue3+viteä¸­çš„ä½¿ç”¨</p><p>stores/index.js</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; createPinia &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><span class="hljs-keyword">const</span> pinia = <span class="hljs-title function_">createPinia</span>()<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> pinia</code></pre></div><p>main.js</p><div class="code-wrapper"><pre><code class="hljs clean"><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><span class="hljs-keyword">import</span> pinia <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./stores&#x27;</span>createApp(App).use(pinia).mount(<span class="hljs-string">&#x27;#app&#x27;</span>)</code></pre></div><h4 id="è®¤è¯†Store"><a href="#è®¤è¯†Store" class="headerlink" title="è®¤è¯†Store"></a>è®¤è¯†Store</h4><h5 id="ä»€ä¹ˆæ˜¯store"><a href="#ä»€ä¹ˆæ˜¯store" class="headerlink" title="ä»€ä¹ˆæ˜¯store"></a>ä»€ä¹ˆæ˜¯store</h5><p>ä¸€ä¸ªstoreæ˜¯ä¸€ä¸ªå®ä½“ï¼Œä»–ä¼šæŒæœ‰ä¸ºç»‘å®šåˆ°ç»„ä»¶æ ‘çš„çŠ¶æ€å’Œä¸šåŠ¡é€»è¾‘ï¼Œæ¢å¥è¯è¯´ï¼Œ<strong>å®ƒæ‰˜ç®¡å…¨å±€çŠ¶æ€</strong>ã€‚å®ƒæœ‰ç‚¹åƒä¸€ä¸ªå§‹ç»ˆå­˜åœ¨å¹¶ä¸”æ¯ä¸ªäººéƒ½å¯ä»¥è¯»å–å’Œå†™å…¥çš„ç»„ä»¶ã€‚ä½ å¯ä»¥å®šä¹‰ä»»æ„ä¸ªstoreæ¥ç®¡ç†ä½ çš„çŠ¶æ€ã€‚</p><h5 id="storeæœ‰ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ"><a href="#storeæœ‰ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="storeæœ‰ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ"></a>storeæœ‰ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ</h5><p>stateï¼Œactionsï¼Œgettersï¼Œå¯¹åº”è€…æ•°ç»„çš„dataï¼Œcomputedï¼Œmethods</p><p>ä¸€æ—¦storeè¢«å®ä¾‹åŒ–ï¼Œä½ å°±å¯ä»¥ç›´æ¥åœ¨storeä¸Šè®¿é—®stateï¼Œgettersï¼Œactionsä¸­çš„ä»»æ„å±æ€§</p><h4 id="å®šä¹‰Store"><a href="#å®šä¹‰Store" class="headerlink" title="å®šä¹‰Store"></a>å®šä¹‰Store</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; defineStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><span class="hljs-keyword">const</span> useUser = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&quot;user&quot;</span>, &#123;  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123;    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>,    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,    <span class="hljs-attr">level</span>: <span class="hljs-number">100</span>  &#125;)&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useUser<span class="hljs-comment">//ä½¿ç”¨defineStoreæ¥å®šä¹‰store</span></code></pre></div><p>ä¸Vueçš„Option API ç±»å‹ç±»ä¼¼çš„å†™æ³•</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;counter&#x27;</span>, &#123;  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Eduardo&#x27;</span> &#125;),  <span class="hljs-attr">getters</span>: &#123;    <span class="hljs-attr">doubleCount</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span> * <span class="hljs-number">2</span>,  &#125;,  <span class="hljs-attr">actions</span>: &#123;    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++    &#125;,  &#125;,&#125;)</code></pre></div><p>è¿˜æœ‰ä¸€ç§å’Œsetupå‡½æ•°ç±»ä¼¼çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªå®šä¹‰å“åº”å¼å±æ€§å’Œæ–¹æ³•çš„å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æˆ‘ä»¬æƒ³è¦å…¬å¼€çš„å±æ€§å’Œæ–¹æ³•çš„å¯¹è±¡ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;counter&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<span class="hljs-comment">//state</span>  <span class="hljs-keyword">const</span> name = <span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;Eduardo&#x27;</span>)  <span class="hljs-keyword">const</span> doubleCount = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>)<span class="hljs-comment">//getters</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;    count.<span class="hljs-property">value</span>++  &#125;<span class="hljs-comment">//actions</span>  <span class="hljs-keyword">return</span> &#123; count, name, doubleCount, increment &#125;&#125;)</code></pre></div><p>åœ¨ç»„ä»¶ä¸­çš„ä½¿ç”¨</p><div class="code-wrapper"><pre><code class="hljs js">&lt;script setup&gt;  <span class="hljs-keyword">import</span> &#123; toRefs &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>  <span class="hljs-keyword">import</span> &#123; storeToRefs &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span>  <span class="hljs-keyword">import</span> useCounter <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/stores/counter&#x27;</span>;  <span class="hljs-keyword">const</span> counterStore = <span class="hljs-title function_">useCounter</span>()<span class="hljs-comment">//å¦‚æœéœ€è¦è§£æ„stateå¹¶ä¿æŒå“åº”æ€§ï¼Œå¯ä»¥ä½¿ç”¨toRefs/storeToRefs</span><span class="hljs-comment">// const &#123; count &#125; = toRefs(counterStore)</span>  <span class="hljs-keyword">const</span> &#123; count &#125; = <span class="hljs-title function_">storeToRefs</span>(counterStore)  <span class="hljs-keyword">function</span> <span class="hljs-title function_">incrementCount</span>(<span class="hljs-params"></span>) &#123;    counterStore.<span class="hljs-property">count</span>++  &#125;&lt;/script&gt;</code></pre></div><h4 id="stateçš„ä½¿ç”¨"><a href="#stateçš„ä½¿ç”¨" class="headerlink" title="stateçš„ä½¿ç”¨"></a><code>state</code>çš„ä½¿ç”¨</h4><div class="code-wrapper"><pre><code class="hljs axapta"><span class="hljs-keyword">const</span> store = useStore()store.<span class="hljs-keyword">count</span>++</code></pre></div><p>é‡ç½®state</p><div class="code-wrapper"><pre><code class="hljs autoit"><span class="hljs-keyword">const</span> store = useStore()store.$reset()</code></pre></div><div class="code-wrapper"><pre><code class="hljs pf"> // <span class="hljs-number">1</span>.ä¸€ä¸ªä¸ªä¿®æ”¹çŠ¶æ€     <span class="hljs-keyword">user</span>Store.name = <span class="hljs-string">&quot;kobe&quot;</span>     <span class="hljs-keyword">user</span>Store.age = <span class="hljs-number">20</span>     <span class="hljs-keyword">user</span>Store.level = <span class="hljs-number">200</span>    // <span class="hljs-number">2</span>.ä¸€æ¬¡æ€§ä¿®æ”¹å¤šä¸ªçŠ¶æ€     <span class="hljs-keyword">user</span>Store.<span class="hljs-variable">$patch</span>(&#123;       name: <span class="hljs-string">&quot;james&quot;</span>,       age: <span class="hljs-number">35</span>     &#125;)  //<span class="hljs-variable">$patch</span>è¿˜å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°  cartStore.<span class="hljs-variable">$patch</span>((<span class="hljs-keyword">state</span>) =&gt; &#123;  <span class="hljs-keyword">state</span>.items.push(&#123; name: &#x27;shoes&#x27;, quantity: <span class="hljs-number">1</span> &#125;)  <span class="hljs-keyword">state</span>.hasChanged = true&#125;)</code></pre></div><p>æ›¿æ¢state</p><p>ä½ ä¸èƒ½æ›¿æ¢æ•´ä¸ªstate,å¯ä»¥æ•´åˆå®ƒ</p><div class="code-wrapper"><pre><code class="hljs reasonml">store.<span class="hljs-constructor">$patch(&#123; <span class="hljs-params">count</span>: 24 &#125;)</span></code></pre></div><h4 id="Getters"><a href="#Getters" class="headerlink" title="Getters"></a>Getters</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-attr">getters</span>: &#123;    <span class="hljs-comment">// 1.åŸºæœ¬ä½¿ç”¨</span>    <span class="hljs-title function_">doubleCount</span>(<span class="hljs-params">state</span>) &#123;      <span class="hljs-keyword">return</span> state.<span class="hljs-property">count</span> * <span class="hljs-number">2</span>    &#125;,    <span class="hljs-comment">// 2.ä¸€ä¸ªgetterå¼•å…¥å¦å¤–ä¸€ä¸ªgetter</span>    <span class="hljs-title function_">doubleCountAddOne</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-comment">// thisæ˜¯storeå®ä¾‹</span>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">doubleCount</span> + <span class="hljs-number">1</span>    &#125;,    <span class="hljs-comment">// 3.gettersä¹Ÿæ”¯æŒè¿”å›ä¸€ä¸ªå‡½æ•°</span>    <span class="hljs-title function_">getFriendById</span>(<span class="hljs-params">state</span>) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; state.<span class="hljs-property">friends</span>.<span class="hljs-property">length</span>; i++) &#123;          <span class="hljs-keyword">const</span> friend = state.<span class="hljs-property">friends</span>[i]          <span class="hljs-keyword">if</span> (friend.<span class="hljs-property">id</span> === id) &#123;            <span class="hljs-keyword">return</span> friend          &#125;        &#125;      &#125;    &#125;,    <span class="hljs-comment">// 4.gettersä¸­ç”¨åˆ°åˆ«çš„storeä¸­çš„æ•°æ®</span>    <span class="hljs-title function_">showMessage</span>(<span class="hljs-params">state</span>) &#123;      <span class="hljs-comment">// 1.è·å–userä¿¡æ¯</span>      <span class="hljs-keyword">const</span> userStore = <span class="hljs-title function_">useUser</span>()      <span class="hljs-comment">// 2.è·å–è‡ªå·±çš„ä¿¡æ¯</span>      <span class="hljs-comment">// 3.æ‹¼æ¥ä¿¡æ¯</span>      <span class="hljs-keyword">return</span> <span class="hljs-string">`name:<span class="hljs-subst">$&#123;userStore.name&#125;</span>-count:<span class="hljs-subst">$&#123;state.count&#125;</span>`</span>    &#125;  &#125;,</code></pre></div><h4 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h4><p>actionsç›¸å½“äºæ˜¯methods</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;counter&#x27;</span>, &#123;  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123;    <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,  &#125;),  <span class="hljs-attr">actions</span>: &#123;    <span class="hljs-comment">// since we rely on `this`, we cannot use an arrow function</span>      <span class="hljs-comment">//è¿™é‡Œä¾èµ–this,æ‰€ä»¥ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°</span>    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++    &#125;,    <span class="hljs-title function_">randomizeCounter</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-number">100</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>())    &#125;,  &#125;,&#125;)</code></pre></div><p>åœ¨actionsä¸­å¯ä»¥å®šä¹‰å¼‚æ­¥å‡½æ•°</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; mande &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mande&#x27;</span><span class="hljs-keyword">const</span> api = <span class="hljs-title function_">mande</span>(<span class="hljs-string">&#x27;/api/users&#x27;</span>)<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUsers = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;users&#x27;</span>, &#123;  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123;    <span class="hljs-attr">userData</span>: <span class="hljs-literal">null</span>,    <span class="hljs-comment">// ...</span>  &#125;),  <span class="hljs-attr">actions</span>: &#123;    <span class="hljs-keyword">async</span> <span class="hljs-title function_">registerUser</span>(<span class="hljs-params">login, password</span>) &#123;      <span class="hljs-keyword">try</span> &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">userData</span> = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">post</span>(&#123; login, password &#125;)        <span class="hljs-title function_">showTooltip</span>(<span class="hljs-string">`Welcome back <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.userData.name&#125;</span>!`</span>)      &#125; <span class="hljs-keyword">catch</span> (error) &#123;        <span class="hljs-title function_">showTooltip</span>(error)        <span class="hljs-comment">// let the form component display the error</span>        <span class="hljs-keyword">return</span> error      &#125;    &#125;,  &#125;,&#125;)</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>vuex4.0</title>
    <link href="/2022/08/23/vuex4-0/"/>
    <url>/2022/08/23/vuex4-0/</url>
    
    <content type="html"><![CDATA[<h4 id="Vuex-æ˜¯ä»€ä¹ˆ"><a href="#Vuex-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Vuex æ˜¯ä»€ä¹ˆ"></a>Vuex æ˜¯ä»€ä¹ˆ</h4><p>Vuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„<strong>çŠ¶æ€ç®¡ç†æ¨¡å¼ + åº“</strong>ã€‚å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ã€‚</p><p><img src="https://vuex.vuejs.org/vuex.png"></p><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install vuex@next --save</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//store/index.js</span><span class="hljs-keyword">import</span> &#123; createStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-variable constant_">CHANGE_INFO</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./mutation_types&#x27;</span><span class="hljs-keyword">import</span> homeModule <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./modules/home&#x27;</span><span class="hljs-keyword">import</span> counterModule <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./modules/counter&#x27;</span><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(&#123;  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123;    <span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®</span>    <span class="hljs-comment">// counter: 100,</span>    <span class="hljs-attr">rootCounter</span>: <span class="hljs-number">100</span>,    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;coderwhy&quot;</span>,    <span class="hljs-attr">level</span>: <span class="hljs-number">100</span>,    <span class="hljs-attr">avatarURL</span>: <span class="hljs-string">&quot;http://xxxxxx&quot;</span>,    <span class="hljs-attr">friends</span>: [      &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">111</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,      &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">112</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;kobe&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> &#125;,      &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">113</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;james&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> &#125;    ],    <span class="hljs-comment">// æœåŠ¡å™¨æ•°æ®</span>    <span class="hljs-comment">// banners: [],</span>    <span class="hljs-comment">// recommends: []</span>  &#125;),  <span class="hljs-attr">getters</span>: &#123;    <span class="hljs-comment">// 1.åŸºæœ¬ä½¿ç”¨</span>    <span class="hljs-title function_">doubleCounter</span>(<span class="hljs-params">state</span>) &#123;      <span class="hljs-keyword">return</span> state.<span class="hljs-property">counter</span> * <span class="hljs-number">2</span>    &#125;,    <span class="hljs-title function_">totalAge</span>(<span class="hljs-params">state</span>) &#123;      <span class="hljs-keyword">return</span> state.<span class="hljs-property">friends</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">preValue, item</span>) =&gt;</span> &#123;        <span class="hljs-keyword">return</span> preValue + item.<span class="hljs-property">age</span>      &#125;, <span class="hljs-number">0</span>)    &#125;,    <span class="hljs-comment">// 2.åœ¨è¯¥getterså±æ€§ä¸­, è·å–å…¶ä»–çš„getters</span>    <span class="hljs-title function_">message</span>(<span class="hljs-params">state, getters</span>) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-string">`name:<span class="hljs-subst">$&#123;state.name&#125;</span> level:<span class="hljs-subst">$&#123;state.level&#125;</span> friendTotalAge:<span class="hljs-subst">$&#123;getters.totalAge&#125;</span>`</span>    &#125;,    <span class="hljs-comment">// 3.gettersæ˜¯å¯ä»¥è¿”å›ä¸€ä¸ªå‡½æ•°çš„, è°ƒç”¨è¿™ä¸ªå‡½æ•°å¯ä»¥ä¼ å…¥å‚æ•°(äº†è§£)</span>    <span class="hljs-title function_">getFriendById</span>(<span class="hljs-params">state</span>) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) &#123;        <span class="hljs-keyword">const</span> friend = state.<span class="hljs-property">friends</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === id)        <span class="hljs-keyword">return</span> friend      &#125;    &#125;  &#125;,  <span class="hljs-attr">mutations</span>: &#123;    <span class="hljs-title function_">increment</span>(<span class="hljs-params">state</span>) &#123;      state.<span class="hljs-property">counter</span>++    &#125;,    <span class="hljs-title function_">changeName</span>(<span class="hljs-params">state, payload</span>) &#123;      state.<span class="hljs-property">name</span> = payload    &#125;,    <span class="hljs-title function_">incrementLevel</span>(<span class="hljs-params">state</span>) &#123;      state.<span class="hljs-property">level</span>++    &#125;,     <span class="hljs-comment">//ä½¿ç”¨è®¡ç®—å±æ€§ï¼Œå°†å¸¸é‡ä½œä¸ºå‚æ•°å</span>    [<span class="hljs-variable constant_">CHANGE_INFO</span>](state, newInfo) &#123;      state.<span class="hljs-property">level</span> = newInfo.<span class="hljs-property">level</span>      state.<span class="hljs-property">name</span> = newInfo.<span class="hljs-property">name</span>      <span class="hljs-comment">// é‡è¦çš„åŸåˆ™: ä¸è¦åœ¨mutationæ–¹æ³•ä¸­æ‰§è¡Œå¼‚æ­¥æ“ä½œ</span>      <span class="hljs-comment">// fetch(&quot;xxxx&quot;).then(res =&gt; &#123;</span>      <span class="hljs-comment">//   res.json().then(res =&gt; &#123;</span>      <span class="hljs-comment">//     state.name = res.name</span>      <span class="hljs-comment">//   &#125;)</span>      <span class="hljs-comment">// &#125;)</span>    &#125;,    <span class="hljs-comment">// changeBanners(state, banners) &#123;</span>    <span class="hljs-comment">//   state.banners = banners</span>    <span class="hljs-comment">// &#125;,</span>    <span class="hljs-comment">// changeRecommends(state, recommends) &#123;</span>    <span class="hljs-comment">//   state.recommends = recommends</span>    <span class="hljs-comment">// &#125;</span>  &#125;,  <span class="hljs-attr">actions</span>: &#123;    <span class="hljs-title function_">incrementAction</span>(<span class="hljs-params">context</span>) &#123;      <span class="hljs-comment">// console.log(context.commit) // ç”¨äºæäº¤mutation</span>      <span class="hljs-comment">// console.log(context.getters) // getters</span>      <span class="hljs-comment">// console.log(context.state) // state</span>      context.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&quot;increment&quot;</span>)    &#125;,    <span class="hljs-title function_">changeNameAction</span>(<span class="hljs-params">context, payload</span>) &#123;      context.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&quot;changeName&quot;</span>, payload)    &#125;,    <span class="hljs-comment">// fetchHomeMultidataAction(context) &#123;</span>    <span class="hljs-comment">//   // 1.è¿”å›Promise, ç»™Promiseè®¾ç½®then</span>    <span class="hljs-comment">//   // fetch(&quot;http://123.207.32.32:8000/home/multidata&quot;).then(res =&gt; &#123;</span>    <span class="hljs-comment">//   //   res.json().then(data =&gt; &#123;</span>    <span class="hljs-comment">//   //     console.log(data)</span>    <span class="hljs-comment">//   //   &#125;)</span>    <span class="hljs-comment">//   // &#125;)</span>          <span class="hljs-comment">//   // 2.Promiseé“¾å¼è°ƒç”¨</span>    <span class="hljs-comment">//   // fetch(&quot;http://123.207.32.32:8000/home/multidata&quot;).then(res =&gt; &#123;</span>    <span class="hljs-comment">//   //   return res.json()</span>    <span class="hljs-comment">//   // &#125;).then(data =&gt; &#123;</span>    <span class="hljs-comment">//   //   console.log(data)</span>    <span class="hljs-comment">//   // &#125;)</span>    <span class="hljs-comment">//   return new Promise(async (resolve, reject) =&gt; &#123;</span>    <span class="hljs-comment">//     // 3.await/async</span>    <span class="hljs-comment">//     const res = await fetch(&quot;http://123.207.32.32:8000/home/multidata&quot;)</span>    <span class="hljs-comment">//     const data = await res.json()</span>            <span class="hljs-comment">//     // ä¿®æ”¹stateæ•°æ®</span>    <span class="hljs-comment">//     context.commit(&quot;changeBanners&quot;, data.data.banner.list)</span>    <span class="hljs-comment">//     context.commit(&quot;changeRecommends&quot;, data.data.recommend.list)</span>    <span class="hljs-comment">//     resolve(&quot;aaaaa&quot;)</span>    <span class="hljs-comment">//   &#125;)</span>    <span class="hljs-comment">// &#125;</span>  &#125;,  <span class="hljs-attr">modules</span>: &#123;    <span class="hljs-attr">home</span>: homeModule,    <span class="hljs-attr">counter</span>: counterModule  &#125;&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store</code></pre></div><div class="code-wrapper"><pre><code class="hljs clean"><span class="hljs-comment">//main.js</span><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span>createApp(App).use(store).mount(<span class="hljs-string">&#x27;#app&#x27;</span>)</code></pre></div><h4 id="State"><a href="#State" class="headerlink" title="State"></a>State</h4><p>stateä¸­ä¸»è¦æ˜¯ç®¡ç†å…¨å±€çš„çŠ¶æ€ï¼Œæ‰€æœ‰çŠ¶æ€éƒ½å­˜å‚¨åœ¨stateä¸­</p><div class="code-wrapper"><pre><code class="hljs pf">//<span class="hljs-keyword">state</span>è¦æ”¾åˆ°computedä¸­å»ä½¿ç”¨export <span class="hljs-keyword">default</span> &#123;   computed: &#123;     storeCounter() &#123;       return this.<span class="hljs-variable">$store</span>.<span class="hljs-keyword">state</span>.counter     &#125;   &#125; &#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//åœ¨setupä¸­ä½¿ç”¨state éœ€è¦ä½¿ç”¨useStore</span>&lt;script setup&gt;  <span class="hljs-keyword">import</span> &#123; toRefs &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>  <span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span>  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useStore</span>()  <span class="hljs-comment">// å¦‚æœå¯¹store.stateè¿›è¡Œè§£æ„æˆ–è€…èµ‹å€¼ç»™å¦å¤–ä¸€ä¸ªå˜é‡ï¼Œä¼šå˜æˆéå“åº”å¼çš„ï¼Œè¦ä½¿ç”¨toRefs</span>  <span class="hljs-keyword">const</span> &#123; counter &#125; = <span class="hljs-title function_">toRefs</span>(store.<span class="hljs-property">state</span>)    <span class="hljs-keyword">function</span> <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// store.state.counter++</span>    store.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&quot;increment&quot;</span>)  &#125;&lt;/script&gt;</code></pre></div><h5 id="mapState-è¾…åŠ©å‡½æ•°"><a href="#mapState-è¾…åŠ©å‡½æ•°" class="headerlink" title="mapState è¾…åŠ©å‡½æ•°"></a><code>mapState</code> è¾…åŠ©å‡½æ•°</h5><p><code>mapState</code> è¾…åŠ©å‡½æ•°å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆè®¡ç®—å±æ€§</p><div class="code-wrapper"><pre><code class="hljs pf">/ åœ¨å•ç‹¬æ„å»ºçš„ç‰ˆæœ¬ä¸­è¾…åŠ©å‡½æ•°ä¸º Vuex.mapStateimport &#123; mapState &#125; <span class="hljs-keyword">from</span> &#x27;vuex&#x27;export <span class="hljs-keyword">default</span> &#123;  // ...  computed: mapState(&#123;    // ç®­å¤´å‡½æ•°å¯ä½¿ä»£ç æ›´ç®€ç»ƒ    count: <span class="hljs-keyword">state</span> =&gt; <span class="hljs-keyword">state</span>.count,    // ä¼ å­—ç¬¦ä¸²å‚æ•° &#x27;count&#x27; ç­‰åŒäº `<span class="hljs-keyword">state</span> =&gt; <span class="hljs-keyword">state</span>.count`    countAlias: &#x27;count&#x27;,    // ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ `this` è·å–å±€éƒ¨çŠ¶æ€ï¼Œå¿…é¡»ä½¿ç”¨å¸¸è§„å‡½æ•°    countPlusLocalState (<span class="hljs-keyword">state</span>) &#123;      return <span class="hljs-keyword">state</span>.count + this.localCount    &#125;  &#125;)&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs awk">computed: mapState([  <span class="hljs-regexp">//</span> æ˜ å°„ this.count ä¸º store.state.count  <span class="hljs-string">&#x27;count&#x27;</span>])<span class="hljs-regexp">//</span>è¿˜å¯ä»¥ä¼ é€’æ•°ç»„</code></pre></div><div class="code-wrapper"><pre><code class="hljs awk">computed: &#123;  localComputed () &#123; <span class="hljs-regexp">/* ... */</span> &#125;,  <span class="hljs-regexp">//</span> ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°†æ­¤å¯¹è±¡æ··å…¥åˆ°å¤–éƒ¨å¯¹è±¡ä¸­  ...mapState(&#123;    <span class="hljs-regexp">//</span> ...  &#125;)&#125;</code></pre></div><p>//ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦å’Œå…¶ä»–computedåˆå¹¶</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-attr">computed</span>: &#123;     <span class="hljs-title function_">fullname</span>(<span class="hljs-params"></span>) &#123;       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;xxx&quot;</span>     &#125;,     <span class="hljs-comment">// name() &#123;</span>     <span class="hljs-comment">//   return this.$store.state.name</span>     <span class="hljs-comment">// &#125;,</span>     ...<span class="hljs-title function_">mapState</span>([<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;level&quot;</span>, <span class="hljs-string">&quot;avatarURL&quot;</span>]),     ...<span class="hljs-title function_">mapState</span>(&#123;       <span class="hljs-attr">sName</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">name</span>,       <span class="hljs-attr">sLevel</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">level</span>     &#125;)   &#125; &#125;</code></pre></div><h5 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h5><p>getterç±»ä¼¼äºvueçš„computed</p><p>Getter æ¥å— state ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(&#123;  <span class="hljs-attr">state</span>: &#123;    <span class="hljs-attr">todos</span>: [      &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;...&#x27;</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">true</span> &#125;,      &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;...&#x27;</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> &#125;    ]  &#125;,  <span class="hljs-attr">getters</span>: &#123;    doneTodos (state) &#123;      <span class="hljs-keyword">return</span> state.<span class="hljs-property">todos</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">done</span>)    &#125;  &#125;&#125;)</code></pre></div><h5 id="é€šè¿‡å±æ€§è®¿é—®"><a href="#é€šè¿‡å±æ€§è®¿é—®" class="headerlink" title="é€šè¿‡å±æ€§è®¿é—®"></a>é€šè¿‡å±æ€§è®¿é—®</h5><p>Getter ä¼šæš´éœ²ä¸º <code>store.getters</code> å¯¹è±¡ï¼Œä½ å¯ä»¥ä»¥å±æ€§çš„å½¢å¼è®¿é—®è¿™äº›å€¼ï¼š</p><div class="code-wrapper"><pre><code class="hljs xl"><span class="hljs-function"><span class="hljs-title">store</span>.getters.doneTodos // -&gt;</span> [&#123; id: <span class="hljs-number">1</span>, <span class="hljs-keyword">text</span>: <span class="hljs-string">&#x27;...&#x27;</span>, done: <span class="hljs-literal">true</span> &#125;]</code></pre></div><p>Getter ä¹Ÿå¯ä»¥æ¥å—å…¶ä»– getter ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼š</p><div class="code-wrapper"><pre><code class="hljs stylus">getters: &#123;  <span class="hljs-comment">// ...</span>  doneTodosCount (state, getters) &#123;    return getters<span class="hljs-selector-class">.doneTodos</span><span class="hljs-selector-class">.length</span>  &#125;&#125;store<span class="hljs-selector-class">.getters</span><span class="hljs-selector-class">.doneTodosCount</span> <span class="hljs-comment">// -&gt; 1</span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨å®ƒï¼š</p><div class="code-wrapper"><pre><code class="hljs kotlin">computed: &#123;  doneTodosCount () &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$store.getters.doneTodosCount  &#125;&#125;</code></pre></div><p>æ³¨æ„ï¼Œgetter åœ¨é€šè¿‡å±æ€§è®¿é—®æ—¶æ˜¯ä½œä¸º Vue çš„å“åº”å¼ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ç¼“å­˜å…¶ä¸­çš„ã€‚</p><h5 id="é€šè¿‡æ–¹æ³•è®¿é—®"><a href="#é€šè¿‡æ–¹æ³•è®¿é—®" class="headerlink" title="é€šè¿‡æ–¹æ³•è®¿é—®"></a>é€šè¿‡æ–¹æ³•è®¿é—®</h5><p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡è®© getter è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å®ç°ç»™ getter ä¼ å‚ã€‚åœ¨ä½ å¯¹ store é‡Œçš„æ•°ç»„è¿›è¡ŒæŸ¥è¯¢æ—¶éå¸¸æœ‰ç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs pf">getters: &#123;  // ...  getTodoById: (<span class="hljs-keyword">state</span>) =&gt; (id) =&gt; &#123;    return <span class="hljs-keyword">state</span>.todos.find(todo =&gt; todo.id === id)  &#125;&#125;store.getters.getTodoById(<span class="hljs-number">2</span>) // -&gt; &#123; id: <span class="hljs-number">2</span>, text: &#x27;...&#x27;, done: false &#125;</code></pre></div><p>æ³¨æ„ï¼Œgetter åœ¨é€šè¿‡æ–¹æ³•è®¿é—®æ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šå»è¿›è¡Œè°ƒç”¨ï¼Œè€Œä¸ä¼šç¼“å­˜ç»“æœ</p><h5 id="mapGetters-è¾…åŠ©å‡½æ•°"><a href="#mapGetters-è¾…åŠ©å‡½æ•°" class="headerlink" title="mapGetters è¾…åŠ©å‡½æ•°"></a><code>mapGetters</code> è¾…åŠ©å‡½æ•°</h5><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; mapGetters &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-comment">// ...</span>  <span class="hljs-attr">computed</span>: &#123;  <span class="hljs-comment">// ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°† getter æ··å…¥ computed å¯¹è±¡ä¸­</span>    ...<span class="hljs-title function_">mapGetters</span>([      <span class="hljs-string">&#x27;doneTodosCount&#x27;</span>,      <span class="hljs-string">&#x27;anotherGetter&#x27;</span>,      <span class="hljs-comment">// ...</span>    ])  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs awk">...mapGetters(&#123;  <span class="hljs-regexp">//</span> æŠŠ `this.doneCount` æ˜ å°„ä¸º `this.<span class="hljs-variable">$store</span>.getters.doneTodosCount`  doneCount: <span class="hljs-string">&#x27;doneTodosCount&#x27;</span>&#125;)<span class="hljs-regexp">//</span>è¿˜å¯ä»¥å–åˆ«å</code></pre></div><h5 id="åœ¨setupä¸­ä½¿ç”¨"><a href="#åœ¨setupä¸­ä½¿ç”¨" class="headerlink" title="åœ¨setupä¸­ä½¿ç”¨"></a>åœ¨setupä¸­ä½¿ç”¨</h5><div class="code-wrapper"><pre><code class="hljs js">&lt;script setup&gt;  <span class="hljs-keyword">import</span> &#123; computed, toRefs &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;  <span class="hljs-keyword">import</span> &#123; mapGetters, useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span>  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useStore</span>()  <span class="hljs-comment">// 1.ä½¿ç”¨mapGetters</span>  <span class="hljs-comment">// const &#123; message: messageFn &#125; = mapGetters([&quot;message&quot;])</span>  <span class="hljs-comment">// const message = computed(messageFn.bind(&#123; $store: store &#125;))</span>  <span class="hljs-comment">// 2.ç›´æ¥è§£æ„, å¹¶ä¸”åŒ…è£¹æˆref</span>  <span class="hljs-comment">// const &#123; message &#125; = toRefs(store.getters)</span>  <span class="hljs-comment">// 3.é’ˆå¯¹æŸä¸€ä¸ªgetterså±æ€§ä½¿ç”¨computed</span>  <span class="hljs-keyword">const</span> message = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> store.<span class="hljs-property">getters</span>.<span class="hljs-property">message</span>)  <span class="hljs-keyword">function</span> <span class="hljs-title function_">changeAge</span>(<span class="hljs-params"></span>) &#123;    store.<span class="hljs-property">state</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;kobe&quot;</span>  &#125;&lt;/script&gt;</code></pre></div><h4 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h4><p>æ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤ mutation</p><p>mutationçš„ä½¿ç”¨</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-variable constant_">CHANGE_INFO</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/store/mutation_types&quot;</span> <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;   <span class="hljs-attr">computed</span>: &#123;   &#125;,   <span class="hljs-attr">methods</span>: &#123;     <span class="hljs-title function_">changeName</span>(<span class="hljs-params"></span>) &#123;       <span class="hljs-comment">// this.$store.state.name = &quot;æé“¶æ²³&quot;</span>       <span class="hljs-comment">//ä¼ å‚æ–¹å¼</span>       <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&quot;changeName&quot;</span>, <span class="hljs-string">&quot;ç‹å°æ³¢&quot;</span>)     &#125;,     <span class="hljs-title function_">incrementLevel</span>(<span class="hljs-params"></span>) &#123;       <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&quot;incrementLevel&quot;</span>)     &#125;,     <span class="hljs-title function_">changeInfo</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-comment">//è¿™æ˜¯å®šä¹‰å¸¸é‡çš„æ–¹å¼</span>       <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-variable constant_">CHANGE_INFO</span>, &#123;         <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;ç‹äºŒ&quot;</span>,         <span class="hljs-attr">level</span>: <span class="hljs-number">200</span>       &#125;)     &#125;   &#125; &#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs pf">//åœ¨mutationä¸­commit<span class="hljs-keyword">const</span> store = createStore(&#123;  <span class="hljs-keyword">state</span>: () =&gt; (&#123;    name: <span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,  &#125;),  mutations: &#123;    updateMut(<span class="hljs-keyword">state</span>, playload) &#123;      <span class="hljs-keyword">state</span>.name = playload;    &#125;,    updateMut2(<span class="hljs-keyword">state</span>, playload) &#123;      store.commit(<span class="hljs-string">&quot;updateMut&quot;</span>, playload);    &#125;,  &#125;,&#125;);</code></pre></div><h5 id="Mutation-å¿…é¡»æ˜¯åŒæ­¥å‡½æ•°"><a href="#Mutation-å¿…é¡»æ˜¯åŒæ­¥å‡½æ•°" class="headerlink" title="Mutation å¿…é¡»æ˜¯åŒæ­¥å‡½æ•°"></a>Mutation å¿…é¡»æ˜¯åŒæ­¥å‡½æ•°</h5><div class="code-wrapper"><pre><code class="hljs pf">mutations: &#123;  someMutation (<span class="hljs-keyword">state</span>) &#123;    api.callAsyncMethod(() =&gt; &#123;      <span class="hljs-keyword">state</span>.count++    &#125;)  &#125;&#125;</code></pre></div><p>æˆ‘ä»¬æ­£åœ¨ debug ä¸€ä¸ª app å¹¶ä¸”è§‚å¯Ÿ devtool ä¸­çš„ mutation æ—¥å¿—ã€‚æ¯ä¸€æ¡ mutation è¢«è®°å½•ï¼Œdevtools éƒ½éœ€è¦æ•æ‰åˆ°å‰ä¸€çŠ¶æ€å’Œåä¸€çŠ¶æ€çš„å¿«ç…§ã€‚ç„¶è€Œï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ mutation ä¸­çš„å¼‚æ­¥å‡½æ•°ä¸­çš„å›è°ƒè®©è¿™ä¸å¯èƒ½å®Œæˆï¼šå› ä¸ºå½“ mutation è§¦å‘çš„æ—¶å€™ï¼Œå›è°ƒå‡½æ•°è¿˜æ²¡æœ‰è¢«è°ƒç”¨ï¼Œdevtools ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å›è°ƒå‡½æ•°å®é™…ä¸Šè¢«è°ƒç”¨â€”â€”å®è´¨ä¸Šä»»ä½•åœ¨å›è°ƒå‡½æ•°ä¸­è¿›è¡Œçš„çŠ¶æ€çš„æ”¹å˜éƒ½æ˜¯ä¸å¯è¿½è¸ªçš„ã€‚</p><h5 id="mapMutations"><a href="#mapMutations" class="headerlink" title="mapMutations"></a>mapMutations</h5><div class="code-wrapper"><pre><code class="hljs awk">methods: &#123;      btnClick() &#123;        console.log(<span class="hljs-string">&quot;btnClick&quot;</span>)      &#125;,      <span class="hljs-regexp">//</span> ...mapMutations([<span class="hljs-string">&quot;changeName&quot;</span>, <span class="hljs-string">&quot;incrementLevel&quot;</span>, CHANGE_INFO])  ä½¿ç”¨å¸¸é‡ï¼Œåœ¨templateä¸­è¦ä½¿ç”¨æ­£ç¡®çš„å‡½æ•°å    &#125;</code></pre></div><h4 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h4><p>Action ç±»ä¼¼äº mutationï¼Œä¸åŒåœ¨äºï¼š</p><ul><li>Action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚</li><li>Action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚</li></ul><p>Action é€šè¿‡ <code>store.dispatch</code> æ–¹æ³•è§¦å‘ï¼š</p><div class="code-wrapper"><pre><code class="hljs livecodeserver">store.<span class="hljs-built_in">dispatch</span>(<span class="hljs-string">&#x27;increment&#x27;</span>)</code></pre></div><div class="code-wrapper"><pre><code class="hljs csharp"><span class="hljs-comment">//åœ¨actionä¸­ä¹Ÿå¯ä»¥åˆ†å‘action</span>actions: &#123;  <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-title">actionA</span> (<span class="hljs-params">&#123; commit &#125;</span>)</span> &#123;    commit(<span class="hljs-string">&#x27;gotData&#x27;</span>, <span class="hljs-keyword">await</span> getData())  &#125;,  <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-title">actionB</span> (<span class="hljs-params">&#123; dispatch, commit &#125;</span>)</span> &#123;    <span class="hljs-keyword">await</span> dispatch(<span class="hljs-string">&#x27;actionA&#x27;</span>) <span class="hljs-comment">// ç­‰å¾… actionA å®Œæˆ</span>    commit(<span class="hljs-string">&#x27;gotOtherData&#x27;</span>, <span class="hljs-keyword">await</span> getOtherData())  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨methods: &#123;     <span class="hljs-regexp">//</span> counterBtnClick() &#123;     <span class="hljs-regexp">//</span>   this.<span class="hljs-variable">$store</span>.dispatch(<span class="hljs-string">&quot;incrementAction&quot;</span>)     <span class="hljs-regexp">//</span> &#125;,     <span class="hljs-regexp">//</span> nameBtnClick() &#123;     <span class="hljs-regexp">//</span>   this.<span class="hljs-variable">$store</span>.dispatch(<span class="hljs-string">&quot;changeNameAction&quot;</span>, <span class="hljs-string">&quot;aaa&quot;</span>)     <span class="hljs-regexp">//</span> &#125;     <span class="hljs-regexp">//</span> ...mapActions([<span class="hljs-string">&quot;incrementAction&quot;</span>, <span class="hljs-string">&quot;changeNameAction&quot;</span>])   &#125;</code></pre></div><h4 id="Modulesçš„ä½¿ç”¨"><a href="#Modulesçš„ä½¿ç”¨" class="headerlink" title="Modulesçš„ä½¿ç”¨"></a>Modulesçš„ä½¿ç”¨</h4><p>ç”±äºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚</p><p>ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒVuex å…è®¸æˆ‘ä»¬å°† store åˆ†å‰²æˆ<strong>æ¨¡å—ï¼ˆmoduleï¼‰</strong>ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationã€actionã€getterã€ç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—â€”â€”ä»ä¸Šè‡³ä¸‹è¿›è¡ŒåŒæ ·æ–¹å¼çš„åˆ†å‰²</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> moduleA = &#123;  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123; ... &#125;),  <span class="hljs-attr">mutations</span>: &#123; ... &#125;,  <span class="hljs-attr">actions</span>: &#123; ... &#125;,  <span class="hljs-attr">getters</span>: &#123; ... &#125;&#125;<span class="hljs-keyword">const</span> moduleB = &#123;  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123; ... &#125;),  <span class="hljs-attr">mutations</span>: &#123; ... &#125;,  <span class="hljs-attr">actions</span>: &#123; ... &#125;&#125;<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(&#123;  <span class="hljs-attr">modules</span>: &#123;    <span class="hljs-attr">a</span>: moduleA,    <span class="hljs-attr">b</span>: moduleB  &#125;&#125;)store.<span class="hljs-property">state</span>.<span class="hljs-property">a</span> <span class="hljs-comment">// -&gt; moduleA çš„çŠ¶æ€</span>store.<span class="hljs-property">state</span>.<span class="hljs-property">b</span> <span class="hljs-comment">// -&gt; moduleB çš„çŠ¶æ€</span></code></pre></div><p>å½“æ²¡æœ‰æ·»åŠ namaspacedé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨moduleçš„å€¼</p><div class="code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;home&quot;</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Home Page<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">    <span class="hljs-comment">&lt;!-- 1.ä½¿ç”¨stateæ—¶, æ˜¯éœ€è¦state.moduleName.xxx --&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Counteræ¨¡å—çš„counter: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">$store.state.counter.count</span> &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">    <span class="hljs-comment">&lt;!-- 2.ä½¿ç”¨gettersæ—¶, æ˜¯ç›´æ¥getters.xxx --&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Counteræ¨¡å—çš„doubleCounter: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">$store.getters.doubleCount</span> &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;incrementCount&quot;</span>&gt;</span>countæ¨¡å—+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span></span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-comment">// å‘Šè¯‰Vuexå‘èµ·ç½‘ç»œè¯·æ±‚</span></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useStore</span>()</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-comment">// æ´¾å‘äº‹ä»¶æ—¶, é»˜è®¤ä¹Ÿæ˜¯ä¸éœ€è¦è·Ÿæ¨¡å—åç§°</span></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-comment">// æäº¤mutationæ—¶, é»˜è®¤ä¹Ÿæ˜¯ä¸éœ€è¦è·Ÿæ¨¡å—åç§°</span></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">function</span> <span class="hljs-title function_">incrementCount</span>(<span class="hljs-params"></span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">    store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&quot;incrementCountAction&quot;</span>)</span></span><span class="language-javascript"><span class="language-xml">  &#125;</span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre></div><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ actionï¼Œå±€éƒ¨çŠ¶æ€é€šè¿‡ <code>context.state</code> æš´éœ²å‡ºæ¥ï¼Œæ ¹èŠ‚ç‚¹çŠ¶æ€åˆ™ä¸º <code>context.rootState</code>ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> moduleA = &#123;  <span class="hljs-comment">// ...</span>  <span class="hljs-attr">actions</span>: &#123;    incrementIfOddOnRootSum (&#123; state, commit, rootState &#125;) &#123;      <span class="hljs-keyword">if</span> ((state.<span class="hljs-property">count</span> + rootState.<span class="hljs-property">count</span>) % <span class="hljs-number">2</span> === <span class="hljs-number">1</span>) &#123;        <span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;increment&#x27;</span>)      &#125;    &#125;  &#125;&#125;</code></pre></div><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ getterï¼Œæ ¹èŠ‚ç‚¹çŠ¶æ€ä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°æš´éœ²å‡ºæ¥ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> moduleA = &#123;  <span class="hljs-comment">// ...</span>  <span class="hljs-attr">getters</span>: &#123;    sumWithRootCount (state, getters, rootState) &#123;      <span class="hljs-keyword">return</span> state.<span class="hljs-property">count</span> + rootState.<span class="hljs-property">count</span>    &#125;  &#125;&#125;</code></pre></div><h5 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h5><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…éƒ¨çš„ action å’Œ mutation ä»ç„¶æ˜¯æ³¨å†Œåœ¨<strong>å…¨å±€å‘½åç©ºé—´</strong>çš„â€”â€”è¿™æ ·ä½¿å¾—å¤šä¸ªæ¨¡å—èƒ½å¤Ÿå¯¹åŒä¸€ä¸ª action æˆ– mutation ä½œå‡ºå“åº”ã€‚Getter åŒæ ·ä¹Ÿé»˜è®¤æ³¨å†Œåœ¨å…¨å±€å‘½åç©ºé—´ï¼Œä½†æ˜¯ç›®å‰è¿™å¹¶éå‡ºäºåŠŸèƒ½ä¸Šçš„ç›®çš„ï¼ˆä»…ä»…æ˜¯ç»´æŒç°çŠ¶æ¥é¿å…éå…¼å®¹æ€§å˜æ›´ï¼‰ã€‚å¿…é¡»æ³¨æ„ï¼Œä¸è¦åœ¨ä¸åŒçš„ã€æ— å‘½åç©ºé—´çš„æ¨¡å—ä¸­å®šä¹‰ä¸¤ä¸ªç›¸åŒçš„ getter ä»è€Œå¯¼è‡´é”™è¯¯ã€‚</p><p>å¦‚æœå¸Œæœ›ä½ çš„æ¨¡å—å…·æœ‰æ›´é«˜çš„å°è£…åº¦å’Œå¤ç”¨æ€§ï¼Œä½ å¯ä»¥é€šè¿‡æ·»åŠ  <code>namespaced: true</code> çš„æ–¹å¼ä½¿å…¶æˆä¸ºå¸¦å‘½åç©ºé—´çš„æ¨¡å—ã€‚å½“æ¨¡å—è¢«æ³¨å†Œåï¼Œå®ƒçš„æ‰€æœ‰ getterã€action åŠ mutation éƒ½ä¼šè‡ªåŠ¨æ ¹æ®æ¨¡å—æ³¨å†Œçš„è·¯å¾„è°ƒæ•´å‘½åã€‚ä¾‹å¦‚ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(&#123;  <span class="hljs-attr">modules</span>: &#123;    <span class="hljs-attr">account</span>: &#123;      <span class="hljs-attr">namespaced</span>: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// æ¨¡å—å†…å®¹ï¼ˆmodule assetsï¼‰</span>      <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123; ... &#125;), <span class="hljs-comment">// æ¨¡å—å†…çš„çŠ¶æ€å·²ç»æ˜¯åµŒå¥—çš„äº†ï¼Œä½¿ç”¨ `namespaced` å±æ€§ä¸ä¼šå¯¹å…¶äº§ç”Ÿå½±å“</span>      <span class="hljs-attr">getters</span>: &#123;        isAdmin () &#123; ... &#125; <span class="hljs-comment">// -&gt; getters[&#x27;account/isAdmin&#x27;]</span>      &#125;,      <span class="hljs-attr">actions</span>: &#123;        login () &#123; ... &#125; <span class="hljs-comment">// -&gt; dispatch(&#x27;account/login&#x27;)</span>      &#125;,      <span class="hljs-attr">mutations</span>: &#123;        login () &#123; ... &#125; <span class="hljs-comment">// -&gt; commit(&#x27;account/login&#x27;)</span>      &#125;,      <span class="hljs-comment">// åµŒå¥—æ¨¡å—</span>      <span class="hljs-attr">modules</span>: &#123;        <span class="hljs-comment">// ç»§æ‰¿çˆ¶æ¨¡å—çš„å‘½åç©ºé—´</span>        <span class="hljs-attr">myPage</span>: &#123;          <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123; ... &#125;),          <span class="hljs-attr">getters</span>: &#123;            profile () &#123; ... &#125; <span class="hljs-comment">// -&gt; getters[&#x27;account/profile&#x27;]</span>          &#125;        &#125;,        <span class="hljs-comment">// è¿›ä¸€æ­¥åµŒå¥—å‘½åç©ºé—´</span>        <span class="hljs-attr">posts</span>: &#123;          <span class="hljs-attr">namespaced</span>: <span class="hljs-literal">true</span>,          <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123; ... &#125;),          <span class="hljs-attr">getters</span>: &#123;            popular () &#123; ... &#125; <span class="hljs-comment">// -&gt; getters[&#x27;account/posts/popular&#x27;]</span>          &#125;        &#125;      &#125;    &#125;  &#125;&#125;)</code></pre></div><div class="code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml">//åœ¨ç»„ä»¶ä¸­çš„å†™æ³•</span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;home&quot;</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Home Page<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">    <span class="hljs-comment">&lt;!-- 1.ä½¿ç”¨stateæ—¶, æ˜¯éœ€è¦state.moduleName.xxx --&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Counteræ¨¡å—çš„counter: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">$store.state.counter.count</span> &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">    <span class="hljs-comment">&lt;!-- 2.ä½¿ç”¨gettersæ—¶, æ˜¯ç›´æ¥getters.xxx --&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Counteræ¨¡å—çš„doubleCounter: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">$store.getters</span>[&quot;counter/doubleCount&quot;] &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;incrementCount&quot;</span>&gt;</span>countæ¨¡å—+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span></span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-comment">// å‘Šè¯‰Vuexå‘èµ·ç½‘ç»œè¯·æ±‚</span></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useStore</span>()</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-comment">// æ´¾å‘äº‹ä»¶æ—¶, é»˜è®¤ä¹Ÿæ˜¯ä¸éœ€è¦è·Ÿæ¨¡å—åç§°</span></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-comment">// æäº¤mutationæ—¶, é»˜è®¤ä¹Ÿæ˜¯ä¸éœ€è¦è·Ÿæ¨¡å—åç§°</span></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">function</span> <span class="hljs-title function_">incrementCount</span>(<span class="hljs-params"></span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">    store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&quot;counter/incrementCountAction&quot;</span>)<span class="hljs-comment">//æœ‰å‘½åç©ºé—´çš„å†™æ³•</span></span></span><span class="language-javascript"><span class="language-xml">  &#125;</span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre></div><p>å¯ç”¨äº†å‘½åç©ºé—´çš„ getter å’Œ action ä¼šæ”¶åˆ°å±€éƒ¨åŒ–çš„ <code>getter</code>ï¼Œ<code>dispatch</code> å’Œ <code>commit</code>ã€‚æ¢è¨€ä¹‹ï¼Œä½ åœ¨ä½¿ç”¨æ¨¡å—å†…å®¹ï¼ˆmodule assetsï¼‰æ—¶ä¸éœ€è¦åœ¨åŒä¸€æ¨¡å—å†…é¢å¤–æ·»åŠ ç©ºé—´åå‰ç¼€ã€‚æ›´æ”¹ <code>namespaced</code> å±æ€§åä¸éœ€è¦ä¿®æ”¹æ¨¡å—å†…çš„ä»£ç ã€‚</p><h5 id="åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹"><a href="#åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹" class="headerlink" title="åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹"></a>åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹</h5><p>å¦‚æœä½ å¸Œæœ›ä½¿ç”¨å…¨å±€ state å’Œ getterï¼Œ<code>rootState</code> å’Œ <code>rootGetters</code> ä¼šä½œä¸ºç¬¬ä¸‰å’Œç¬¬å››å‚æ•°ä¼ å…¥ getterï¼Œä¹Ÿä¼šé€šè¿‡ <code>context</code> å¯¹è±¡çš„å±æ€§ä¼ å…¥ actionã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-attr">modules</span>: &#123;  <span class="hljs-attr">foo</span>: &#123;    <span class="hljs-attr">namespaced</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">getters</span>: &#123;      <span class="hljs-comment">// åœ¨è¿™ä¸ªæ¨¡å—çš„ getter ä¸­ï¼Œ`getters` è¢«å±€éƒ¨åŒ–äº†</span>      <span class="hljs-comment">// ä½ å¯ä»¥ä½¿ç”¨ getter çš„ç¬¬å››ä¸ªå‚æ•°æ¥è°ƒç”¨ `rootGetters`</span>      someGetter (state, getters, rootState, rootGetters) &#123;        getters.<span class="hljs-property">someOtherGetter</span> <span class="hljs-comment">// -&gt; &#x27;foo/someOtherGetter&#x27;</span>        rootGetters.<span class="hljs-property">someOtherGetter</span> <span class="hljs-comment">// -&gt; &#x27;someOtherGetter&#x27;</span>        rootGetters[<span class="hljs-string">&#x27;bar/someOtherGetter&#x27;</span>] <span class="hljs-comment">// -&gt; &#x27;bar/someOtherGetter&#x27;</span>      &#125;,      <span class="hljs-attr">someOtherGetter</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> &#123; ... &#125;    &#125;,    <span class="hljs-attr">actions</span>: &#123;      <span class="hljs-comment">// åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œ dispatch å’Œ commit ä¹Ÿè¢«å±€éƒ¨åŒ–äº†</span>      <span class="hljs-comment">// ä»–ä»¬å¯ä»¥æ¥å— `root` å±æ€§ä»¥è®¿é—®æ ¹ dispatch æˆ– commit</span>      someAction (&#123; dispatch, commit, getters, rootGetters &#125;) &#123;        getters.<span class="hljs-property">someGetter</span> <span class="hljs-comment">// -&gt; &#x27;foo/someGetter&#x27;</span>        rootGetters.<span class="hljs-property">someGetter</span> <span class="hljs-comment">// -&gt; &#x27;someGetter&#x27;</span>        rootGetters[<span class="hljs-string">&#x27;bar/someGetter&#x27;</span>] <span class="hljs-comment">// -&gt; &#x27;bar/someGetter&#x27;</span>        <span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&#x27;someOtherAction&#x27;</span>) <span class="hljs-comment">// -&gt; &#x27;foo/someOtherAction&#x27;</span>        <span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&#x27;someOtherAction&#x27;</span>, <span class="hljs-literal">null</span>, &#123; <span class="hljs-attr">root</span>: <span class="hljs-literal">true</span> &#125;) <span class="hljs-comment">// -&gt; &#x27;someOtherAction&#x27;</span>        <span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;someMutation&#x27;</span>) <span class="hljs-comment">// -&gt; &#x27;foo/someMutation&#x27;</span>        <span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;someMutation&#x27;</span>, <span class="hljs-literal">null</span>, &#123; <span class="hljs-attr">root</span>: <span class="hljs-literal">true</span> &#125;) <span class="hljs-comment">// -&gt; &#x27;someMutation&#x27;</span>      &#125;,      someOtherAction (ctx, payload) &#123; ... &#125;    &#125;  &#125;&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>vue-routerç¬”è®°</title>
    <link href="/2022/08/20/vue-router%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/08/20/vue-router%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h4 id="è·¯ç”±å™¨ç»´æŠ¤ä¸€å¼ æ˜ å°„è¡¨ï¼Œæ˜ å°„è¡¨ä¼šå†³å®šæ•°æ®çš„æµå‘ï¼Œä¸€ä¸ªipåœ°å€å¯¹åº”çš„ä¸€å°æœåŠ¡å™¨çš„macåœ°å€ï¼Œä¸€å°æœåŠ¡å™¨åªæœ‰ä¸€ä¸ªmacåœ°å€"><a href="#è·¯ç”±å™¨ç»´æŠ¤ä¸€å¼ æ˜ å°„è¡¨ï¼Œæ˜ å°„è¡¨ä¼šå†³å®šæ•°æ®çš„æµå‘ï¼Œä¸€ä¸ªipåœ°å€å¯¹åº”çš„ä¸€å°æœåŠ¡å™¨çš„macåœ°å€ï¼Œä¸€å°æœåŠ¡å™¨åªæœ‰ä¸€ä¸ªmacåœ°å€" class="headerlink" title="è·¯ç”±å™¨ç»´æŠ¤ä¸€å¼ æ˜ å°„è¡¨ï¼Œæ˜ å°„è¡¨ä¼šå†³å®šæ•°æ®çš„æµå‘ï¼Œä¸€ä¸ªipåœ°å€å¯¹åº”çš„ä¸€å°æœåŠ¡å™¨çš„macåœ°å€ï¼Œä¸€å°æœåŠ¡å™¨åªæœ‰ä¸€ä¸ªmacåœ°å€"></a>è·¯ç”±å™¨ç»´æŠ¤ä¸€å¼ æ˜ å°„è¡¨ï¼Œæ˜ å°„è¡¨ä¼šå†³å®šæ•°æ®çš„æµå‘ï¼Œä¸€ä¸ªipåœ°å€å¯¹åº”çš„ä¸€å°æœåŠ¡å™¨çš„macåœ°å€ï¼Œä¸€å°æœåŠ¡å™¨åªæœ‰ä¸€ä¸ªmacåœ°å€</h4><h4 id="urlçš„hash"><a href="#urlçš„hash" class="headerlink" title="urlçš„hash"></a>urlçš„hash</h4><p>urlçš„hashä¹Ÿå°±æ˜¯é”šç‚¹(#),æœ¬è´¨ä¸Šå°±æ˜¯æ”¹å˜window.locationçš„hrefçš„å±æ€§</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡èµ‹å€¼location.hashæ¥æ”¹å˜href,ä½†æ˜¯ä¸åˆ·æ–°é¡µé¢</p><p>hashçš„ä¼˜åŠ¿å°±æ˜¯å…¼å®¹æ€§å¥½ï¼Œåœ¨IEä¸­å¯ä»¥è¿è¡Œï¼Œä½†æ˜¯å°±æ˜¯æœ‰ä¸ªç¼ºé™·ï¼Œ#ï¼Œæ˜¾å¾—ä¸åƒæ˜¯ä¸€ä¸ªçœŸå®çš„è·¯å¾„</p><div class="code-wrapper"><pre><code class="hljs js">&lt;body&gt;    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/home&quot;</span>&gt;</span>home<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/about&quot;</span>&gt;</span>about<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> app = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#app&quot;</span>);</span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;hashchange&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(location.<span class="hljs-property">hash</span>);</span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">switch</span> (location.<span class="hljs-property">hash</span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;#/home&quot;</span>:</span></span><span class="language-javascript"><span class="language-xml">            app.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;home&quot;</span>;</span></span><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">break</span>;</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;#/about&quot;</span>:</span></span><span class="language-javascript"><span class="language-xml">            app.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;about&quot;</span>;</span></span><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">break</span>;</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">default</span>:</span></span><span class="language-javascript"><span class="language-xml">            app.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;app&quot;</span>;</span></span><span class="language-javascript"><span class="language-xml">        &#125;</span></span><span class="language-javascript"><span class="language-xml">      &#125;);</span></span><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>  &lt;/body&gt;</code></pre></div><h4 id="html5-history-api"><a href="#html5-history-api" class="headerlink" title="html5 history api"></a>html5 history api</h4><p>historyæ˜¯html5æ–°å¢çš„api ä»–æœ‰å…­ç§æ¨¡å¼æ”¹å˜urlè€Œä¸åˆ·æ–°é¡µé¢</p><p>replaceState  æ›¿æ¢åŸæ¥çš„è·¯å¾„</p><p>pushState  ä½¿ç”¨æ–°çš„è·¯å¾„</p><p>popState è·¯å¾„å›é€€</p><p>go å‘å‰æˆ–è€…å‘åæ”¹å˜è·¯å¾„</p><p>forward å‘å‰æ”¹å˜è·¯å¾„</p><p>back å‘åæ”¹å˜è·¯å¾„</p><div class="code-wrapper"><pre><code class="hljs js">&lt;body&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;App&quot;</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/about&quot;</span>&gt;</span>about<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/home&quot;</span>&gt;</span>home<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;show&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> show = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByClassName</span>(<span class="hljs-string">&quot;show&quot;</span>)[<span class="hljs-number">0</span>];</span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> elea = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&quot;a&quot;</span>);</span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(elea);</span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;popstate&quot;</span>, historyChange);</span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;go&quot;</span>, historyChange);</span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> elea) &#123;</span></span><span class="language-javascript"><span class="language-xml">        item.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">          e.<span class="hljs-title function_">preventDefault</span>();</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">const</span> href = item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&quot;href&quot;</span>);</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(href);</span></span><span class="language-javascript"><span class="language-xml">          history.<span class="hljs-title function_">pushState</span>(&#123;&#125;, <span class="hljs-string">&quot;&quot;</span>, href);</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-title function_">historyChange</span>();</span></span><span class="language-javascript"><span class="language-xml">        &#125;);</span></span><span class="language-javascript"><span class="language-xml">      &#125;</span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">function</span> <span class="hljs-title function_">historyChange</span>(<span class="hljs-params"></span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">switch</span> (location.<span class="hljs-property">pathname</span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;/about&quot;</span>:</span></span><span class="language-javascript"><span class="language-xml">            show.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;about&quot;</span>;</span></span><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">break</span>;</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;/home&quot;</span>:</span></span><span class="language-javascript"><span class="language-xml">            show.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;home&quot;</span>;</span></span><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">break</span>;</span></span><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">default</span>:</span></span><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">break</span>;</span></span><span class="language-javascript"><span class="language-xml">        &#125;</span></span><span class="language-javascript"><span class="language-xml">      &#125;</span></span><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>&lt;/body&gt;</code></pre></div><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><div class="code-wrapper"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span> vue-router</code></pre></div><h5 id="ä½¿ç”¨æ­¥éª¤"><a href="#ä½¿ç”¨æ­¥éª¤" class="headerlink" title="ä½¿ç”¨æ­¥éª¤"></a>ä½¿ç”¨æ­¥éª¤</h5><p>router/index.js</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123;  createRouter,  createWebHashHistory,  createWebHistory,&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue-router&quot;</span>;<span class="hljs-comment">// import Home from &#x27;../Views/Home.vue&#x27;</span><span class="hljs-comment">// import About from &#x27;../Views/About.vue&#x27;</span><span class="hljs-comment">// è·¯ç”±çš„æ‡’åŠ è½½ ï¼Œå¯ä»¥è¿›è¡Œåˆ†åŒ…ï¼Œå‡å°‘æŠ¥çš„å¤§å°ï¼Œè¿›è¡ŒæŒ‰éœ€åŠ è½½   webpackChunkNameè®¾ç½®åŒ…çš„åå­—</span><span class="hljs-comment">// const Home = () =&gt; import(/* webpackChunkName: &#x27;home&#x27; */&quot;../Views/Home.vue&quot;)</span><span class="hljs-comment">// const About = () =&gt; import(/* webpackChunkName: &#x27;about&#x27; */&quot;../Views/About.vue&quot;)</span><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªè·¯ç”±: æ˜ å°„å…³ç³»</span><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>(&#123;  <span class="hljs-comment">// æŒ‡å®šé‡‡ç”¨çš„æ¨¡å¼: hash</span>  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHashHistory</span>(),  <span class="hljs-comment">// history: createWebHistory(),</span>  <span class="hljs-comment">// æ˜ å°„å…³ç³»</span>  <span class="hljs-attr">routes</span>: [    &#123;<span class="hljs-comment">//è®¾ç½®é»˜è®¤è·¯å¾„å¹¶è¿›è¡Œé‡å®šå‘</span>      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/&quot;</span>,      <span class="hljs-attr">redirect</span>: <span class="hljs-string">&quot;/home&quot;</span>,    &#125;,    &#123;      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;home&quot;</span>,<span class="hljs-comment">//è·¯ç”±è®°å½•ç‹¬ä¸€æ— äºŒçš„åç§°</span>      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/home&quot;</span>,      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/Home.vue&quot;</span>),<span class="hljs-comment">//ç»„ä»¶æ‡’åŠ è½½</span>      <span class="hljs-attr">meta</span>: &#123;<span class="hljs-comment">//è¿™æ˜¯è·¯ç”±å…ƒä¿¡æ¯ï¼Œä¸åœ¨urlä¸­æºå¸¦çš„ä¿¡æ¯</span>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>,        <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,      &#125;,       <span class="hljs-comment">//å­è·¯ç”±</span>      <span class="hljs-attr">children</span>: [        &#123;          <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/home&quot;</span>,          <span class="hljs-attr">redirect</span>: <span class="hljs-string">&quot;/home/recommend&quot;</span>,        &#125;,        &#123;          <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;recommend&quot;</span>, <span class="hljs-comment">// /home/recommend</span>          <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/HomeRecommend.vue&quot;</span>),        &#125;,        &#123;          <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;ranking&quot;</span>, <span class="hljs-comment">// /home/ranking</span>          <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/HomeRanking.vue&quot;</span>),        &#125;,      ],    &#125;,    &#123;      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;about&quot;</span>,      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/about&quot;</span>,      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/About.vue&quot;</span>),    &#125;,    &#123;      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/user/:id&quot;</span>,      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/User.vue&quot;</span>),    &#125;,    &#123;      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/order&quot;</span>,      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/Order.vue&quot;</span>),    &#125;,    &#123;      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/login&quot;</span>,      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/Login.vue&quot;</span>),    &#125;,    &#123;      <span class="hljs-comment">// abc/cba/nba  é…ç½®404é¡µé¢</span>      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/:pathMatch(.*)*&quot;</span>,      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/NotFound.vue&quot;</span>),    &#125;,  ],&#125;);<span class="hljs-comment">// 1.åŠ¨æ€ç®¡ç†è·¯ç”±</span><span class="hljs-keyword">let</span> isAdmin = <span class="hljs-literal">true</span>;<span class="hljs-keyword">if</span> (isAdmin) &#123;  <span class="hljs-comment">// ä¸€çº§è·¯ç”±</span>  router.<span class="hljs-title function_">addRoute</span>(&#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/admin&quot;</span>,    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/Admin.vue&quot;</span>),  &#125;);  <span class="hljs-comment">// æ·»åŠ vipé¡µé¢ &quot;home&quot;å¿…é¡»å”¯ä¸€</span>  router.<span class="hljs-title function_">addRoute</span>(<span class="hljs-string">&quot;home&quot;</span>, &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;vip&quot;</span>,    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;../Views/HomeVip.vue&quot;</span>),  &#125;);&#125;<span class="hljs-comment">// è·å–routerä¸­æ‰€æœ‰çš„æ˜ å°„è·¯ç”±å¯¹è±¡</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(router.<span class="hljs-title function_">getRoutes</span>());<span class="hljs-comment">// 2.è·¯ç”±å¯¼èˆªå®ˆå«</span><span class="hljs-comment">// è¿›è¡Œä»»ä½•çš„è·¯ç”±è·³è½¬ä¹‹å‰, ä¼ å…¥çš„beforeEachä¸­çš„å‡½æ•°éƒ½ä¼šè¢«å›è°ƒ</span><span class="hljs-comment">// éœ€æ±‚: è¿›å…¥åˆ°è®¢å•(order)é¡µé¢æ—¶, åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•(isLogin -&gt; localStorageä¿å­˜token)</span><span class="hljs-comment">// æƒ…å†µä¸€: ç”¨æˆ·æ²¡æœ‰ç™»å½•, é‚£ä¹ˆè·³è½¬åˆ°ç™»å½•é¡µé¢, è¿›è¡Œç™»å½•çš„æ“ä½œ</span><span class="hljs-comment">// æƒ…å†µäºŒ: ç”¨æˆ·å·²ç»ç™»å½•, é‚£ä¹ˆç›´æ¥è¿›å…¥åˆ°è®¢å•é¡µé¢</span>router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>) =&gt;</span> &#123;  <span class="hljs-comment">// 1.è¿›å…¥åˆ°ä»»ä½•åˆ«çš„é¡µé¢æ—¶, éƒ½è·³è½¬åˆ°loginé¡µé¢</span>  <span class="hljs-comment">// if (to.path !== &quot;/login&quot;) &#123;</span>  <span class="hljs-comment">//   return &quot;/login&quot;</span>  <span class="hljs-comment">// &#125;</span>  <span class="hljs-comment">// 2.è¿›å…¥åˆ°è®¢å•é¡µé¢æ—¶, åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•</span>  <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&quot;token&quot;</span>);  <span class="hljs-keyword">if</span> (to.<span class="hljs-property">path</span> === <span class="hljs-string">&quot;/order&quot;</span> &amp;&amp; !token) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;/login&quot;</span>;  &#125;&#125;);<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router;</code></pre></div><p>//main.js</p><div class="code-wrapper"><pre><code class="hljs stata"><span class="hljs-comment">// 5. åˆ›å»ºå¹¶æŒ‚è½½æ ¹å®ä¾‹</span><span class="hljs-keyword">const</span> <span class="hljs-keyword">app</span> = Vue.createApp(<span class="hljs-keyword">App</span>)<span class="hljs-comment">//ç¡®ä¿ _use_ è·¯ç”±å®ä¾‹ä½¿</span><span class="hljs-comment">//æ•´ä¸ªåº”ç”¨æ”¯æŒè·¯ç”±ã€‚æ³¨å†Œæ’ä»¶</span><span class="hljs-keyword">app</span>.<span class="hljs-keyword">use</span>(router)<span class="hljs-keyword">app</span>.mount(&#x27;#<span class="hljs-keyword">app</span>&#x27;)</code></pre></div><p>åœ¨ç»„å»ºä¸­ä½¿ç”¨</p><div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span>//home.vue<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;home-nav&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/home/recommend&quot;</span>&gt;</span>æ¨è<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/home/ranking&quot;</span>&gt;</span>æ’è¡Œ<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;logoutClick&quot;</span>&gt;</span>é€€å‡ºç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-comment">&lt;!-- å ä½ç»„ä»¶ --&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span></code></pre></div><h2 id="lt-router-link-gt-Props"><a href="#lt-router-link-gt-Props" class="headerlink" title="&lt;router-link&gt; Props"></a><code>&lt;router-link&gt;</code> Props</h2><p>è¡¨ç¤ºç›®æ ‡è·¯ç”±çš„é“¾æ¥ã€‚å½“è¢«ç‚¹å‡»åï¼Œå†…éƒ¨ä¼šç«‹åˆ»æŠŠ <code>to</code> çš„å€¼ä¼ åˆ° <code>router.push()</code>ï¼Œæ‰€ä»¥è¿™ä¸ªå€¼å¯ä»¥æ˜¯ä¸€ä¸ª <code>string</code> æˆ–è€…æ˜¯<a href="https://router.vuejs.org/zh/api/#routelocationraw">æè¿°ç›®æ ‡ä½ç½®çš„å¯¹è±¡</a>ã€‚</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- å­—ç¬¦ä¸² --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/home&quot;</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-comment">&lt;!-- æ¸²æŸ“ç»“æœ --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/home&quot;</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-comment">&lt;!-- ä½¿ç”¨ v-bind çš„ JS è¡¨è¾¾å¼ --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;&#x27;/home&#x27;&quot;</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-comment">&lt;!-- åŒä¸Š --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;&#123; path: &#x27;/home&#x27; &#125;&quot;</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-comment">&lt;!-- å‘½åçš„è·¯ç”± --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;&#123; name: &#x27;user&#x27;, params: &#123; userId: &#x27;123&#x27; &#125;&#125;&quot;</span>&gt;</span>User<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-comment">&lt;!-- å¸¦æŸ¥è¯¢å‚æ•°ï¼Œä¸‹é¢çš„ç»“æœä¸º `/register?plan=private` --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;&#123; path: &#x27;/register&#x27;, query: &#123; plan: &#x27;private&#x27; &#125;&#125;&quot;</span>&gt;</span>  Register<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></code></pre></div><h5 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h5><p>è®¾ç½® <code>replace</code> å±æ€§çš„è¯ï¼Œå½“ç‚¹å‡»æ—¶ï¼Œä¼šè°ƒç”¨ <code>router.replace()</code>ï¼Œè€Œä¸æ˜¯ <code>router.push()</code>ï¼Œæ‰€ä»¥å¯¼èˆªåä¸ä¼šç•™ä¸‹å†å²è®°å½•ã€‚</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/abc&quot;</span> <span class="hljs-attr">replace</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></code></pre></div><h5 id="active-class"><a href="#active-class" class="headerlink" title="active-class"></a>active-class</h5><p>é“¾æ¥æ¿€æ´»æ—¶ï¼Œåº”ç”¨äºæ¸²æŸ“çš„ <code>&lt;a&gt;</code> çš„ class</p><p><strong>é»˜è®¤å€¼</strong>ï¼š<code>&quot;router-link-active&quot;</code></p><div class="code-wrapper"><pre><code class="hljs routeros">&lt;router-link <span class="hljs-attribute">to</span>=<span class="hljs-string">&quot;/about&quot;</span> replace <span class="hljs-attribute">active-class</span>=<span class="hljs-string">&quot;active&quot;</span>&gt;å…³äº&lt;/router-link&gt;</code></pre></div><p>å¯ä»¥ä¿®æ”¹é»˜è®¤çš„classæˆ–è€…æ·»åŠ æ–°çš„class</p><h5 id="exact-active-class"><a href="#exact-active-class" class="headerlink" title="exact-active-class"></a>exact-active-class</h5><p>é“¾æ¥ç²¾å‡†æ¿€æ´»æ—¶ï¼Œåº”ç”¨äºæ¸²æŸ“çš„ <code>&lt;a&gt;</code> çš„ class</p><p><strong>é»˜è®¤å€¼</strong>ï¼š<code>&quot;router-link-exact-active&quot;</code></p><h4 id="å¸¦å‚æ•°çš„åŠ¨æ€è·¯ç”±åŒ¹é…"><a href="#å¸¦å‚æ•°çš„åŠ¨æ€è·¯ç”±åŒ¹é…" class="headerlink" title="å¸¦å‚æ•°çš„åŠ¨æ€è·¯ç”±åŒ¹é…"></a>å¸¦å‚æ•°çš„åŠ¨æ€è·¯ç”±åŒ¹é…</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">User</span> = &#123;  <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;&lt;div&gt;User&lt;/div&gt;&#x27;</span>,&#125;<span class="hljs-comment">// è¿™äº›éƒ½ä¼šä¼ é€’ç»™ `createRouter`</span><span class="hljs-keyword">const</span> routes = [  <span class="hljs-comment">// åŠ¨æ€å­—æ®µä»¥å†’å·å¼€å§‹</span>  &#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/users/:id&#x27;</span>, <span class="hljs-attr">component</span>: <span class="hljs-title class_">User</span> &#125;,]</code></pre></div><p>å‚æ•°å¯ä»¥è¢«å½“å‰è·¯ç”±çš„paramsè·å–</p><div class="code-wrapper"><pre><code class="hljs crmsh">const <span class="hljs-keyword">User</span> <span class="hljs-title">= &#123;</span><span class="hljs-title">  template</span>: &#x27;<span class="hljs-tag">&lt;div&gt;</span><span class="hljs-keyword">User</span> <span class="hljs-title">&#123;&#123; $route</span>.<span class="hljs-keyword">params</span>.id &#125;&#125;<span class="hljs-tag">&lt;/div&gt;</span>&#x27;,&#125;</code></pre></div><h5 id="ç›‘å¬å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–"><a href="#ç›‘å¬å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–" class="headerlink" title="ç›‘å¬å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–"></a>ç›‘å¬å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–</h5><p>ä½¿ç”¨å¸¦æœ‰å‚æ•°çš„è·¯ç”±æ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ç”¨æˆ·ä» <code>/users/johnny</code> å¯¼èˆªåˆ° <code>/users/jolyne</code> æ—¶ï¼Œ<strong>ç›¸åŒçš„ç»„ä»¶å®ä¾‹å°†è¢«é‡å¤ä½¿ç”¨</strong>ã€‚å› ä¸ºä¸¤ä¸ªè·¯ç”±éƒ½æ¸²æŸ“åŒä¸ªç»„ä»¶ï¼Œæ¯”èµ·é”€æ¯å†åˆ›å»ºï¼Œå¤ç”¨åˆ™æ˜¾å¾—æ›´åŠ é«˜æ•ˆã€‚<strong>ä¸è¿‡ï¼Œè¿™ä¹Ÿæ„å‘³ç€ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸ä¼šè¢«è°ƒç”¨</strong>ã€‚</p><p>è¦å¯¹åŒä¸€ä¸ªç»„ä»¶ä¸­å‚æ•°çš„å˜åŒ–åšå‡ºå“åº”çš„è¯ï¼Œä½ å¯ä»¥ç®€å•åœ° watch <code>$route</code> å¯¹è±¡ä¸Šçš„ä»»æ„å±æ€§ï¼Œåœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œå°±æ˜¯ <code>$route.params</code> ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">User</span> = &#123;  <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;...&#x27;</span>,  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">this</span>.$watch(      <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$route</span>.<span class="hljs-property">params</span>,      <span class="hljs-function">(<span class="hljs-params">toParams, previousParams</span>) =&gt;</span> &#123;        <span class="hljs-comment">// å¯¹è·¯ç”±å˜åŒ–åšå‡ºå“åº”...</span>      &#125;    )  &#125;,&#125;</code></pre></div><p>æˆ–è€…ï¼Œä½¿ç”¨ <code>beforeRouteUpdate</code> <a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html">å¯¼èˆªå®ˆå«</a>ï¼Œå®ƒä¹Ÿå¯ä»¥å–æ¶ˆå¯¼èˆªï¼š</p><div class="code-wrapper"><pre><code class="hljs csharp"><span class="hljs-keyword">const</span> User = &#123;  template: <span class="hljs-string">&#x27;...&#x27;</span>,  <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-title">beforeRouteUpdate</span>(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>)</span> &#123;    <span class="hljs-comment">// å¯¹è·¯ç”±å˜åŒ–åšå‡ºå“åº”...</span>    <span class="hljs-keyword">this</span>.userData = <span class="hljs-keyword">await</span> fetchUser(to.<span class="hljs-keyword">params</span>.id)  &#125;,&#125;</code></pre></div><h5 id="æ•è·æ‰€æœ‰è·¯ç”±æˆ–-404-Not-found-è·¯ç”±"><a href="#æ•è·æ‰€æœ‰è·¯ç”±æˆ–-404-Not-found-è·¯ç”±" class="headerlink" title="æ•è·æ‰€æœ‰è·¯ç”±æˆ– 404 Not found è·¯ç”±"></a><strong>æ•è·æ‰€æœ‰è·¯ç”±æˆ– 404 Not found è·¯ç”±</strong></h5><p>å¸¸è§„å‚æ•°åªåŒ¹é… url ç‰‡æ®µä¹‹é—´çš„å­—ç¬¦ï¼Œç”¨ <code>/</code> åˆ†éš”ã€‚å¦‚æœæˆ‘ä»¬æƒ³åŒ¹é…<strong>ä»»æ„è·¯å¾„</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ <em>è·¯å¾„å‚æ•°</em> æ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨ <em>è·¯å¾„å‚æ•°</em> åé¢çš„æ‹¬å·ä¸­åŠ å…¥ æ­£åˆ™è¡¨è¾¾å¼ :</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> routes = [  <span class="hljs-comment">// å°†åŒ¹é…æ‰€æœ‰å†…å®¹å¹¶å°†å…¶æ”¾åœ¨ `$route.params.pathMatch` ä¸‹</span>  &#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/:pathMatch(.*)*&#x27;</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;NotFound&#x27;</span>, <span class="hljs-attr">component</span>: <span class="hljs-title class_">NotFound</span> &#125;,  <span class="hljs-comment">// å°†åŒ¹é…ä»¥ `/user-` å¼€å¤´çš„æ‰€æœ‰å†…å®¹ï¼Œå¹¶å°†å…¶æ”¾åœ¨ `$route.params.afterUser` ä¸‹</span>  &#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/user-:afterUser(.*)&#x27;</span>, <span class="hljs-attr">component</span>: <span class="hljs-title class_">UserGeneric</span> &#125;,]</code></pre></div><p>åœ¨è¿™ä¸ªç‰¹å®šçš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬åœ¨æ‹¬å·ä¹‹é—´ä½¿ç”¨äº†<a href="https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#%E5%9C%A8%E5%8F%82%E6%95%B0%E4%B8%AD%E8%87%AA%E5%AE%9A%E4%B9%89%E6%AD%A3%E5%88%99">è‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼</a>ï¼Œå¹¶å°†<code>pathMatch</code> å‚æ•°æ ‡è®°ä¸º<a href="https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0">å¯é€‰å¯é‡å¤</a>ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†è®©æˆ‘ä»¬åœ¨éœ€è¦çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å°† <code>path</code> æ‹†åˆ†æˆä¸€ä¸ªæ•°ç»„ï¼Œç›´æ¥å¯¼èˆªåˆ°è·¯ç”±ï¼š</p><div class="code-wrapper"><pre><code class="hljs stylus">this.<span class="hljs-variable">$router</span><span class="hljs-selector-class">.push</span>(&#123;  name: <span class="hljs-string">&#x27;NotFound&#x27;</span>,  <span class="hljs-comment">// ä¿ç•™å½“å‰è·¯å¾„å¹¶åˆ é™¤ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œä»¥é¿å…ç›®æ ‡ URL ä»¥ `//` å¼€å¤´ã€‚</span>  params: &#123; pathMatch: this.<span class="hljs-variable">$route</span><span class="hljs-selector-class">.path</span><span class="hljs-selector-class">.substring</span>(<span class="hljs-number">1</span>)<span class="hljs-selector-class">.split</span>(<span class="hljs-string">&#x27;/&#x27;</span>) &#125;,  <span class="hljs-comment">// ä¿ç•™ç°æœ‰çš„æŸ¥è¯¢å’Œ hash å€¼ï¼Œå¦‚æœæœ‰çš„è¯</span>  query: this.<span class="hljs-variable">$route</span><span class="hljs-selector-class">.query</span>,  hash: this.<span class="hljs-variable">$route</span><span class="hljs-selector-class">.hash</span>,&#125;)</code></pre></div><div class="code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>NotFound: æ‚¨å½“å‰çš„è·¯å¾„</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">$route.params.pathMatch</span> &#125;&#125;</span><span class="language-xml">ä¸æ­£ç¡®, è¯·è¾“å…¥æ­£ç¡®çš„è·¯å¾„!<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span></code></pre></div><p>è¿™é‡Œè¿˜æœ‰å¦å¤–ä¸€ç§å†™æ³•ï¼š ï° æ³¨æ„ï¼šæˆ‘åœ¨/:pathMatch(.*)åé¢åˆåŠ äº†ä¸€ä¸ª *ï¼›</p><p>è¿™æ—¶å€™$route.params.pathMatchå°†æ˜¯æ•°ç»„</p><h4 id="ç¼–ç¨‹å¼å¯¼èˆª"><a href="#ç¼–ç¨‹å¼å¯¼èˆª" class="headerlink" title="ç¼–ç¨‹å¼å¯¼èˆª"></a>ç¼–ç¨‹å¼å¯¼èˆª</h4><p><strong>åœ¨ Vue å®ä¾‹ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ <code>$router</code> è®¿é—®è·¯ç”±å®ä¾‹ã€‚å› æ­¤ä½ å¯ä»¥è°ƒç”¨<code>this.$router.push</code></strong></p><p>æƒ³è¦å¯¼èˆªåˆ°ä¸åŒçš„ URLï¼Œå¯ä»¥ä½¿ç”¨ <code>router.push</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå‘ history æ ˆæ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ï¼Œæ‰€ä»¥ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨åé€€æŒ‰é’®æ—¶ï¼Œä¼šå›åˆ°ä¹‹å‰çš„ URL</p><p>å½“ä½ ç‚¹å‡» <code>&lt;router-link&gt;</code> æ—¶ï¼Œå†…éƒ¨ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥ç‚¹å‡» <code>&lt;router-link :to=&quot;...&quot;&gt;</code> ç›¸å½“äºè°ƒç”¨ <code>router.push(...)</code></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å­—ç¬¦ä¸²è·¯å¾„</span>router.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;/users/eduardo&#x27;</span>)<span class="hljs-comment">// å¸¦æœ‰è·¯å¾„çš„å¯¹è±¡</span>router.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/users/eduardo&#x27;</span> &#125;)<span class="hljs-comment">// å‘½åçš„è·¯ç”±ï¼Œå¹¶åŠ ä¸Šå‚æ•°ï¼Œè®©è·¯ç”±å»ºç«‹ url</span>router.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-attr">params</span>: &#123; <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;eduardo&#x27;</span> &#125; &#125;)<span class="hljs-comment">// å¸¦æŸ¥è¯¢å‚æ•°ï¼Œç»“æœæ˜¯ /register?plan=private</span>router.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/register&#x27;</span>, <span class="hljs-attr">query</span>: &#123; <span class="hljs-attr">plan</span>: <span class="hljs-string">&#x27;private&#x27;</span> &#125; &#125;)<span class="hljs-comment">// å¸¦ hashï¼Œç»“æœæ˜¯ /about#team</span>router.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/about&#x27;</span>, <span class="hljs-attr">hash</span>: <span class="hljs-string">&#x27;#team&#x27;</span> &#125;)</code></pre></div><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœæä¾›äº† <code>path</code>ï¼Œ<code>params</code> ä¼šè¢«å¿½ç•¥ï¼Œä¸Šè¿°ä¾‹å­ä¸­çš„ <code>query</code> å¹¶ä¸å±äºè¿™ç§æƒ…å†µã€‚å–è€Œä»£ä¹‹çš„æ˜¯ä¸‹é¢ä¾‹å­çš„åšæ³•ï¼Œä½ éœ€è¦æä¾›è·¯ç”±çš„ <code>name</code> æˆ–æ‰‹å†™å®Œæ•´çš„å¸¦æœ‰å‚æ•°çš„ <code>path</code> ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> username = <span class="hljs-string">&#x27;eduardo&#x27;</span><span class="hljs-comment">// æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å»ºç«‹ urlï¼Œä½†æˆ‘ä»¬å¿…é¡»è‡ªå·±å¤„ç†ç¼–ç </span>router.<span class="hljs-title function_">push</span>(<span class="hljs-string">`/user/<span class="hljs-subst">$&#123;username&#125;</span>`</span>) <span class="hljs-comment">// -&gt; /user/eduardo</span><span class="hljs-comment">// åŒæ ·</span>router.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">`/user/<span class="hljs-subst">$&#123;username&#125;</span>`</span> &#125;) <span class="hljs-comment">// -&gt; /user/eduardo</span><span class="hljs-comment">// å¦‚æœå¯èƒ½çš„è¯ï¼Œä½¿ç”¨ `name` å’Œ `params` ä»è‡ªåŠ¨ URL ç¼–ç ä¸­è·ç›Š</span>router.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-attr">params</span>: &#123; username &#125; &#125;) <span class="hljs-comment">// -&gt; /user/eduardo</span><span class="hljs-comment">// `params` ä¸èƒ½ä¸ `path` ä¸€èµ·ä½¿ç”¨</span>router.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-attr">params</span>: &#123; username &#125; &#125;) <span class="hljs-comment">// -&gt; /user</span></code></pre></div><p>å½“æŒ‡å®š <code>params</code> æ—¶ï¼Œå¯æä¾› <code>string</code> æˆ– <code>number</code> å‚æ•°ï¼ˆæˆ–è€…å¯¹äº<a href="https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#repeatable-params">å¯é‡å¤çš„å‚æ•°</a>å¯æä¾›ä¸€ä¸ªæ•°ç»„ï¼‰ã€‚<strong>ä»»ä½•å…¶ä»–ç±»å‹ï¼ˆå¦‚ <code>undefined</code>ã€<code>false</code> ç­‰ï¼‰éƒ½å°†è¢«è‡ªåŠ¨å­—ç¬¦ä¸²åŒ–</strong>ã€‚å¯¹äº<a href="https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#repeatable-params">å¯é€‰å‚æ•°</a>ï¼Œä½ å¯ä»¥æä¾›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼ˆ<code>&quot;&quot;</code>ï¼‰æ¥è·³è¿‡å®ƒã€‚</p><p>ç”±äºå±æ€§ <code>to</code> ä¸ <code>router.push</code> æ¥å—çš„å¯¹è±¡ç§ç±»ç›¸åŒï¼Œæ‰€ä»¥ä¸¤è€…çš„è§„åˆ™å®Œå…¨ç›¸åŒã€‚</p><p><code>router.push</code> å’Œæ‰€æœ‰å…¶ä»–å¯¼èˆªæ–¹æ³•éƒ½ä¼šè¿”å›ä¸€ä¸ª <em>Promise</em>ï¼Œè®©æˆ‘ä»¬å¯ä»¥ç­‰åˆ°å¯¼èˆªå®Œæˆåæ‰çŸ¥é“æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚æˆ‘ä»¬å°†åœ¨ <a href="https://router.vuejs.org/zh/guide/advanced/navigation-failures.html">Navigation Handling</a> ä¸­è¯¦ç»†ä»‹ç»ã€‚</p><h5 id="router-replace"><a href="#router-replace" class="headerlink" title="router.replace"></a>router.replace</h5><p>å®ƒåœ¨å¯¼èˆªæ—¶ä¸ä¼šå‘ history æ·»åŠ æ–°è®°å½•</p><div class="code-wrapper"><pre><code class="hljs php">router.<span class="hljs-title function_ invoke__">push</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/home&#x27;</span>, <span class="hljs-attr">replace</span>: <span class="hljs-literal">true</span> &#125;)<span class="hljs-comment">// ç›¸å½“äº</span>router.<span class="hljs-title function_ invoke__">replace</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/home&#x27;</span> &#125;)</code></pre></div><div class="code-wrapper"><pre><code class="hljs gcode"><span class="hljs-comment">// å‘å‰ç§»åŠ¨ä¸€æ¡è®°å½•ï¼Œä¸ router.forward() ç›¸åŒ</span>router.go<span class="hljs-comment">(1)</span><span class="hljs-comment">// è¿”å›ä¸€æ¡è®°å½•ï¼Œä¸ router.back() ç›¸åŒ</span>router.go<span class="hljs-comment">(-1)</span><span class="hljs-comment">// å‰è¿› 3 æ¡è®°å½•</span>router.go<span class="hljs-comment">(3)</span><span class="hljs-comment">// å¦‚æœæ²¡æœ‰é‚£ä¹ˆå¤šè®°å½•ï¼Œé™é»˜å¤±è´¥</span>router.go<span class="hljs-comment">(-100)</span>router.go<span class="hljs-comment">(100)</span></code></pre></div><h4 id="å‘½åè§†å›¾"><a href="#å‘½åè§†å›¾" class="headerlink" title="å‘½åè§†å›¾"></a>å‘½åè§†å›¾</h4><p>ç”¨äºç›¸åŒçš„pathä¹‹é—´çš„åˆ‡æ¢ç»„ä»¶ï¼Œæƒ³åŒæ—¶ (åŒçº§) å±•ç¤ºå¤šä¸ªè§†å›¾</p><p>ä½ å¯ä»¥åœ¨ç•Œé¢ä¸­æ‹¥æœ‰å¤šä¸ªå•ç‹¬å‘½åçš„è§†å›¾ï¼Œè€Œä¸æ˜¯åªæœ‰ä¸€ä¸ªå•ç‹¬çš„å‡ºå£ã€‚å¦‚æœ <code>router-view</code> æ²¡æœ‰è®¾ç½®åå­—ï¼Œé‚£ä¹ˆé»˜è®¤ä¸º <code>default</code></p><div class="code-wrapper"><pre><code class="hljs pgsql">&lt;router-<span class="hljs-keyword">view</span> <span class="hljs-keyword">class</span>=&quot;view left-sidebar&quot; <span class="hljs-type">name</span>=&quot;LeftSidebar&quot;&gt;&lt;/router-<span class="hljs-keyword">view</span>&gt;&lt;router-<span class="hljs-keyword">view</span> <span class="hljs-keyword">class</span>=&quot;view main-content&quot;&gt;&lt;/router-<span class="hljs-keyword">view</span>&gt;&lt;router-<span class="hljs-keyword">view</span> <span class="hljs-keyword">class</span>=&quot;view right-sidebar&quot; <span class="hljs-type">name</span>=&quot;RightSidebar&quot;&gt;&lt;/router-<span class="hljs-keyword">view</span>&gt;</code></pre></div><div class="code-wrapper"><pre><code class="hljs dts">const <span class="hljs-attr">router</span> <span class="hljs-operator">=</span> createRouter(<span class="hljs-punctuation">&#123;</span><span class="hljs-symbol">  history:</span> createWebHashHistory(),<span class="hljs-symbol">  routes:</span> [    <span class="hljs-punctuation">&#123;</span><span class="hljs-symbol">      path:</span> <span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-symbol">      components:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-symbol">        default:</span> Home,        <span class="hljs-comment">// LeftSidebar: LeftSidebar çš„ç¼©å†™</span>        LeftSidebar,        <span class="hljs-comment">// å®ƒä»¬ä¸ `&lt;router-view&gt;` ä¸Šçš„ `name` å±æ€§åŒ¹é…</span>        RightSidebar,      <span class="hljs-punctuation">&#125;</span>,    <span class="hljs-punctuation">&#125;</span>,  ],<span class="hljs-punctuation">&#125;</span>)</code></pre></div><h4 id="å¯¼èˆªå®ˆå«"><a href="#å¯¼èˆªå®ˆå«" class="headerlink" title="å¯¼èˆªå®ˆå«"></a>å¯¼èˆªå®ˆå«</h4><h5 id="å…¨å±€å‰ç½®å®ˆå«"><a href="#å…¨å±€å‰ç½®å®ˆå«" class="headerlink" title="å…¨å±€å‰ç½®å®ˆå«"></a>å…¨å±€å‰ç½®å®ˆå«</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>(&#123; ... &#125;)router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>) =&gt;</span> &#123;  <span class="hljs-comment">// ...</span>  <span class="hljs-comment">// è¿”å› false ä»¥å–æ¶ˆå¯¼èˆª</span>  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;)</code></pre></div><h5 id="è·¯ç”±ç‹¬äº«çš„å®ˆå«"><a href="#è·¯ç”±ç‹¬äº«çš„å®ˆå«" class="headerlink" title="è·¯ç”±ç‹¬äº«çš„å®ˆå«"></a>è·¯ç”±ç‹¬äº«çš„å®ˆå«</h5><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> routes = [  &#123;    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/users/:id&#x27;</span>,    <span class="hljs-attr">component</span>: <span class="hljs-title class_">UserDetails</span>,    <span class="hljs-attr">beforeEnter</span>: <span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>) =&gt;</span> &#123;      <span class="hljs-comment">// reject the navigation</span>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    &#125;,  &#125;,]</code></pre></div><h5 id="ç»„ä»¶å†…çš„å®ˆå«"><a href="#ç»„ä»¶å†…çš„å®ˆå«" class="headerlink" title="ç»„ä»¶å†…çš„å®ˆå«"></a>ç»„ä»¶å†…çš„å®ˆå«</h5><div class="code-wrapper"><pre><code class="hljs awk">const UserDetails = &#123;  template: `...`,  beforeRouteEnter(to, from) &#123;    <span class="hljs-regexp">//</span> åœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢«éªŒè¯å‰è°ƒç”¨    <span class="hljs-regexp">//</span> ä¸èƒ½è·å–ç»„ä»¶å®ä¾‹ `this` ï¼    <span class="hljs-regexp">//</span> å› ä¸ºå½“å®ˆå«æ‰§è¡Œæ—¶ï¼Œç»„ä»¶å®ä¾‹è¿˜æ²¡è¢«åˆ›å»ºï¼  &#125;,  beforeRouteUpdate(to, from) &#123;    <span class="hljs-regexp">//</span> åœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†æ˜¯è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨    <span class="hljs-regexp">//</span> ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªå¸¦æœ‰åŠ¨æ€å‚æ•°çš„è·¯å¾„ `<span class="hljs-regexp">/users/</span>:id`ï¼Œåœ¨ `<span class="hljs-regexp">/users/</span><span class="hljs-number">1</span>` å’Œ `<span class="hljs-regexp">/users/</span><span class="hljs-number">2</span>` ä¹‹é—´è·³è½¬çš„æ—¶å€™ï¼Œ    <span class="hljs-regexp">//</span> ç”±äºä¼šæ¸²æŸ“åŒæ ·çš„ `UserDetails` ç»„ä»¶ï¼Œå› æ­¤ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨ã€‚è€Œè¿™ä¸ªé’©å­å°±ä¼šåœ¨è¿™ä¸ªæƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚    <span class="hljs-regexp">//</span> å› ä¸ºåœ¨è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ—¶å€™ï¼Œç»„ä»¶å·²ç»æŒ‚è½½å¥½äº†ï¼Œå¯¼èˆªå®ˆå«å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`  &#125;,  beforeRouteLeave(to, from) &#123;    <span class="hljs-regexp">//</span> åœ¨å¯¼èˆªç¦»å¼€æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨    <span class="hljs-regexp">//</span> ä¸ `beforeRouteUpdate` ä¸€æ ·ï¼Œå®ƒå¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`  &#125;,&#125;</code></pre></div><h3 id="ä½¿ç”¨ç»„åˆ-API"><a href="#ä½¿ç”¨ç»„åˆ-API" class="headerlink" title="ä½¿ç”¨ç»„åˆ API#"></a>ä½¿ç”¨ç»„åˆ API<a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E4%BD%BF%E7%94%A8%E7%BB%84%E5%90%88-api">#</a></h3><p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨<a href="https://v3.vuejs.org/guide/composition-api-setup.html#setup">ç»„åˆ API å’Œ <code>setup</code> å‡½æ•°</a>æ¥ç¼–å†™ç»„ä»¶ï¼Œä½ å¯ä»¥é€šè¿‡ <code>onBeforeRouteUpdate</code> å’Œ <code>onBeforeRouteLeave</code> åˆ†åˆ«æ·»åŠ  update å’Œ leave å®ˆå«</p><h2 id="å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹"><a href="#å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹" class="headerlink" title="å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹#"></a>å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹<a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%AE%8C%E6%95%B4%E7%9A%84%E5%AF%BC%E8%88%AA%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B">#</a></h2><ol><li>å¯¼èˆªè¢«è§¦å‘ã€‚</li><li>åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ <code>beforeRouteLeave</code> å®ˆå«ã€‚</li><li>è°ƒç”¨å…¨å±€çš„ <code>beforeEach</code> å®ˆå«ã€‚</li><li>åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ <code>beforeRouteUpdate</code> å®ˆå«(2.2+)ã€‚</li><li>åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ <code>beforeEnter</code>ã€‚</li><li>è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚</li><li>åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ <code>beforeRouteEnter</code>ã€‚</li><li>è°ƒç”¨å…¨å±€çš„ <code>beforeResolve</code> å®ˆå«(2.5+)ã€‚</li><li>å¯¼èˆªè¢«ç¡®è®¤ã€‚</li><li>è°ƒç”¨å…¨å±€çš„ <code>afterEach</code> é’©å­ã€‚</li><li>è§¦å‘ DOM æ›´æ–°ã€‚</li><li>è°ƒç”¨ <code>beforeRouteEnter</code> å®ˆå«ä¸­ä¼ ç»™ <code>next</code> çš„å›è°ƒå‡½æ•°ï¼Œåˆ›å»ºå¥½çš„ç»„ä»¶å®ä¾‹ä¼šä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ä¼ å…¥ã€‚</li></ol><h4 id="Vue-Router-å’Œ-ç»„åˆå¼-API"><a href="#Vue-Router-å’Œ-ç»„åˆå¼-API" class="headerlink" title="Vue Router å’Œ ç»„åˆå¼ API"></a>Vue Router å’Œ ç»„åˆå¼ API</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; useRouter, useRoute &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()    <span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>()    <span class="hljs-keyword">function</span> <span class="hljs-title function_">pushWithQuery</span>(<span class="hljs-params">query</span>) &#123;      router.<span class="hljs-title function_">push</span>(&#123;        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;search&#x27;</span>,        <span class="hljs-attr">query</span>: &#123;          ...route.<span class="hljs-property">query</span>,        &#125;,      &#125;)    &#125;  &#125;,&#125;</code></pre></div><p>//useRouter=&gt;$router  useRoute=&gt;$route</p><h5 id="useLink"><a href="#useLink" class="headerlink" title="useLink"></a><code>useLink</code></h5><h4 id="åŠ¨æ€è·¯ç”±"><a href="#åŠ¨æ€è·¯ç”±" class="headerlink" title="åŠ¨æ€è·¯ç”±"></a>åŠ¨æ€è·¯ç”±</h4><p>åŠ¨æ€è·¯ç”±ä¸»è¦é€šè¿‡ä¸¤ä¸ªå‡½æ•°å®ç°ã€‚<code>router.addRoute()</code> å’Œ <code>router.removeRoute()</code>ã€‚å®ƒä»¬<strong>åª</strong>æ³¨å†Œä¸€ä¸ªæ–°çš„è·¯ç”±ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ–°å¢åŠ çš„è·¯ç”±ä¸å½“å‰ä½ç½®ç›¸åŒ¹é…ï¼Œå°±éœ€è¦ä½ ç”¨ <code>router.push()</code> æˆ– <code>router.replace()</code> æ¥<strong>æ‰‹åŠ¨å¯¼èˆª</strong>ï¼Œæ‰èƒ½æ˜¾ç¤ºè¯¥æ–°è·¯ç”±</p><h5 id="æ·»åŠ åµŒå¥—è·¯ç”±"><a href="#æ·»åŠ åµŒå¥—è·¯ç”±" class="headerlink" title="æ·»åŠ åµŒå¥—è·¯ç”±"></a>æ·»åŠ åµŒå¥—è·¯ç”±</h5><p>è¦å°†åµŒå¥—è·¯ç”±æ·»åŠ åˆ°ç°æœ‰çš„è·¯ç”±ä¸­ï¼Œå¯ä»¥å°†è·¯ç”±çš„ <em>name</em> ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ <code>router.addRoute()</code>ï¼Œè¿™å°†æœ‰æ•ˆåœ°æ·»åŠ è·¯ç”±ï¼Œå°±åƒé€šè¿‡ <code>children</code> æ·»åŠ çš„ä¸€æ ·ï¼š</p><div class="code-wrapper"><pre><code class="hljs reasonml">router.add<span class="hljs-constructor">Route(&#123; <span class="hljs-params">name</span>: &#x27;<span class="hljs-params">admin</span>&#x27;, <span class="hljs-params">path</span>: &#x27;<span class="hljs-operator">/</span><span class="hljs-params">admin</span>&#x27;, <span class="hljs-params">component</span>: Admin &#125;)</span>router.add<span class="hljs-constructor">Route(&#x27;<span class="hljs-params">admin</span>&#x27;, &#123; <span class="hljs-params">path</span>: &#x27;<span class="hljs-params">settings</span>&#x27;, <span class="hljs-params">component</span>: AdminSettings &#125;</span></code></pre></div><p>è¿™ç­‰æ•ˆäºï¼š</p><div class="code-wrapper"><pre><code class="hljs php">router.<span class="hljs-title function_ invoke__">addRoute</span>(&#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;admin&#x27;</span>,  <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/admin&#x27;</span>,  <span class="hljs-attr">component</span>: Admin,  <span class="hljs-attr">children</span>: [&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;settings&#x27;</span>, <span class="hljs-attr">component</span>: AdminSettings &#125;],&#125;)</code></pre></div><p>Vue Router æä¾›äº†ä¸¤ä¸ªåŠŸèƒ½æ¥æŸ¥çœ‹ç°æœ‰çš„è·¯ç”±ï¼š</p><ul><li><a href="https://router.vuejs.org/zh/api/#hasroute"><code>router.hasRoute()</code></a>ï¼šæ£€æŸ¥è·¯ç”±æ˜¯å¦å­˜åœ¨ã€‚</li><li><a href="https://router.vuejs.org/zh/api/#getroutes"><code>router.getRoutes()</code></a>ï¼šè·å–ä¸€ä¸ªåŒ…å«æ‰€æœ‰è·¯ç”±è®°å½•çš„æ•°ç»„</li></ul>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Vue3ç¬”è®°(äºŒ)</title>
    <link href="/2022/08/18/Vue3%E7%AC%94%E8%AE%B0-%E4%BA%8C/"/>
    <url>/2022/08/18/Vue3%E7%AC%94%E8%AE%B0-%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<h4 id="64-å¼‚æ­¥ç»„ä»¶"><a href="#64-å¼‚æ­¥ç»„ä»¶" class="headerlink" title="64.å¼‚æ­¥ç»„ä»¶"></a>64.å¼‚æ­¥ç»„ä»¶</h4><p>vue2ä¸­çš„å¼‚æ­¥ç»„ä»¶æ˜¯ä½¿ç”¨import().then()æ¥å®ç°çš„</p><p>vue3ä¸­æä¾›äº†å‡½æ•°defineAsyncComponentæ¥å®ç°å¼‚æ­¥ç»„ä»¶ï¼Œè¿™è¿™æ ·å¯ä»¥å¯¹ç»„ä»¶è¿›è¡Œåˆ†åŒ…å¤„ç†ï¼Œä¸ä¼šæ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯å•ç‹¬æ‰“åˆ°ä¸€ä¸ªåŒ…ä¸­</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//æ–¹æ³•ä¸€ å› ä¸ºè¿™ç§æ–¹å¼ä¹Ÿä¼šè¿”å›ä¸€ä¸ªpromise</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncCategory</span> = <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&quot;./views/Category.vue&quot;</span>))</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//æ–¹æ³•äºŒ</span><span class="hljs-keyword">import</span> &#123; defineAsyncComponent &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncComp</span> = <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;    <span class="hljs-comment">// ...ä»æœåŠ¡å™¨è·å–ç»„ä»¶</span>    <span class="hljs-title function_">resolve</span>(<span class="hljs-comment">/* è·å–åˆ°çš„ç»„ä»¶ */</span>)  &#125;)&#125;)<span class="hljs-comment">// ... åƒä½¿ç”¨å…¶ä»–ä¸€èˆ¬ç»„ä»¶ä¸€æ ·ä½¿ç”¨ `AsyncComp`</span></code></pre></div><p><code>defineAsyncComponent</code> æ–¹æ³•æ¥æ”¶ä¸€ä¸ªè¿”å› Promise çš„åŠ è½½å‡½æ•°ã€‚è¿™ä¸ª Promise çš„ <code>resolve</code> å›è°ƒæ–¹æ³•åº”è¯¥åœ¨ä»æœåŠ¡å™¨è·å¾—ç»„ä»¶å®šä¹‰æ—¶è°ƒç”¨ã€‚ä½ ä¹Ÿå¯ä»¥è°ƒç”¨ <code>reject(reason)</code> è¡¨æ˜åŠ è½½å¤±è´¥ã€‚</p><p>å…¨å±€æ³¨å†Œæ–¹å¼</p><div class="code-wrapper"><pre><code class="hljs js">app.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;MyComponent&#x27;</span>, <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">() =&gt;</span>  <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;./components/MyComponent.vue&#x27;</span>)))</code></pre></div><p>defineAsyncComponentçš„é«˜çº§é€‰é¡¹</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncComp</span> = <span class="hljs-title function_">defineAsyncComponent</span>(&#123;  <span class="hljs-comment">// åŠ è½½å‡½æ•°</span>  <span class="hljs-attr">loader</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;./Foo.vue&#x27;</span>),  <span class="hljs-comment">// åŠ è½½å¼‚æ­¥ç»„ä»¶æ—¶ä½¿ç”¨çš„ç»„ä»¶</span>  <span class="hljs-attr">loadingComponent</span>: <span class="hljs-title class_">LoadingComponent</span>,  <span class="hljs-comment">// å±•ç¤ºåŠ è½½ç»„ä»¶å‰çš„å»¶è¿Ÿæ—¶é—´ï¼Œé»˜è®¤ä¸º 200ms</span>  <span class="hljs-attr">delay</span>: <span class="hljs-number">200</span>,  <span class="hljs-comment">// åŠ è½½å¤±è´¥åå±•ç¤ºçš„ç»„ä»¶</span>  <span class="hljs-attr">errorComponent</span>: <span class="hljs-title class_">ErrorComponent</span>,  <span class="hljs-comment">// å¦‚æœæä¾›äº†ä¸€ä¸ª timeout æ—¶é—´é™åˆ¶ï¼Œå¹¶è¶…æ—¶äº†</span>  <span class="hljs-comment">// ä¹Ÿä¼šæ˜¾ç¤ºè¿™é‡Œé…ç½®çš„æŠ¥é”™ç»„ä»¶ï¼Œé»˜è®¤å€¼æ˜¯ï¼šInfinity</span>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>&#125;)</code></pre></div><h4 id="65-ç»„ä»¶ä¸­çš„v-model"><a href="#65-ç»„ä»¶ä¸­çš„v-model" class="headerlink" title="65.ç»„ä»¶ä¸­çš„v-model"></a>65.ç»„ä»¶ä¸­çš„v-model</h4><p>å¯ä»¥å¯¹ç»„ä»¶è¿›è¡ŒåŒå‘æ•°æ®ç»‘å®š</p><ol><li>å°†å†…éƒ¨åŸç”Ÿ <code>input</code> å…ƒç´ çš„ <code>value</code> attribute ç»‘å®šåˆ° <code>modelValue</code> prop</li><li>è¾“å…¥æ–°çš„å€¼æ—¶åœ¨ <code>input</code> å…ƒç´ ä¸Šè§¦å‘ <code>update:modelValue</code> äº‹ä»¶</li></ol><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//App.js</span>&lt;<span class="hljs-title class_">CustomInput</span>  :modelValue=<span class="hljs-string">&quot;searchText&quot;</span>  @<span class="hljs-attr">update</span>:modelValue=<span class="hljs-string">&quot;newValue =&gt; searchText = newValue&quot;</span>/&gt;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js">&lt;!-- <span class="hljs-title class_">CustomInput</span>.<span class="hljs-property">vue</span> --&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;modelValue&#x27;</span>],</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">emits</span>: [<span class="hljs-string">&#x27;update:modelValue&#x27;</span>]</span></span><span class="language-javascript"><span class="language-xml">&#125;</span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;modelValue&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">    @<span class="hljs-attr">input</span>=<span class="hljs-string">&quot;$emit(&#x27;update:modelValue&#x27;, $event.target.value)&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">  /&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span></code></pre></div><div class="code-wrapper"><pre><code class="hljs js">&lt;<span class="hljs-title class_">CustomInput</span> v-model=<span class="hljs-string">&quot;searchText&quot;</span> /&gt;<span class="hljs-comment">//è¿™æ˜¯ä¸Šé¢çš„ç®€å†™ v-modelå°±å¯ä»¥ä½¿ç”¨äº†</span></code></pre></div><p>æ–¹å¼äºŒã€‚ä½¿ç”¨computedæ¥å®ç°v-model</p><div class="code-wrapper"><pre><code class="hljs js">&lt;!-- <span class="hljs-title class_">CustomInput</span>.<span class="hljs-property">vue</span> --&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;modelValue&#x27;</span>],</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">emits</span>: [<span class="hljs-string">&#x27;update:modelValue&#x27;</span>],</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">computed</span>: &#123;</span></span><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">value</span>: &#123;</span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">modelValue</span></span></span><span class="language-javascript"><span class="language-xml">      &#125;,</span></span><span class="language-javascript"><span class="language-xml">      <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;update:modelValue&#x27;</span>, value)</span></span><span class="language-javascript"><span class="language-xml">      &#125;</span></span><span class="language-javascript"><span class="language-xml">    &#125;</span></span><span class="language-javascript"><span class="language-xml">  &#125;</span></span><span class="language-javascript"><span class="language-xml">&#125;</span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;value&quot;</span> /&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span></code></pre></div><p>v-modelçš„å‚æ•°æ˜¯å¯ä»¥ä¿®æ”¹çš„</p><div class="code-wrapper"><pre><code class="hljs js">&lt;<span class="hljs-title class_">MyComponent</span> v-<span class="hljs-attr">model</span>:title=<span class="hljs-string">&quot;bookTitle&quot;</span> /&gt;  <span class="hljs-comment">//åœ¨ç»„ä»¶ä¸­ä¿®æ”¹propsçš„å€¼è¿˜æœ‰emitsçš„å€¼ä¸ºtitleå’Œupdate:title</span></code></pre></div><h6 id="å¤šä¸ª-v-model-ç»‘å®š"><a href="#å¤šä¸ª-v-model-ç»‘å®š" class="headerlink" title="å¤šä¸ª v-model ç»‘å®š"></a>å¤šä¸ª <code>v-model</code> ç»‘å®š</h6><div class="code-wrapper"><pre><code class="hljs js">&lt;<span class="hljs-title class_">UserName</span>  v-<span class="hljs-attr">model</span>:first-name=<span class="hljs-string">&quot;first&quot;</span>  v-<span class="hljs-attr">model</span>:last-name=<span class="hljs-string">&quot;last&quot;</span>/&gt;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js">&lt;script&gt;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">props</span>: &#123;    <span class="hljs-attr">firstName</span>: <span class="hljs-title class_">String</span>,    <span class="hljs-attr">lastName</span>: <span class="hljs-title class_">String</span>  &#125;,  <span class="hljs-attr">emits</span>: [<span class="hljs-string">&#x27;update:firstName&#x27;</span>, <span class="hljs-string">&#x27;update:lastName&#x27;</span>]&#125;&lt;/script&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;firstName&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">    @<span class="hljs-attr">input</span>=<span class="hljs-string">&quot;$emit(&#x27;update:firstName&#x27;, $event.target.value)&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">  /&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;lastName&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">    @<span class="hljs-attr">input</span>=<span class="hljs-string">&quot;$emit(&#x27;update:lastName&#x27;, $event.target.value)&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">  /&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span></code></pre></div><h6 id="å¤„ç†-v-model-ä¿®é¥°ç¬¦"><a href="#å¤„ç†-v-model-ä¿®é¥°ç¬¦" class="headerlink" title="å¤„ç† v-model ä¿®é¥°ç¬¦"></a>å¤„ç† <code>v-model</code> ä¿®é¥°ç¬¦</h6><p>æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ä¿®é¥°ç¬¦ <code>capitalize</code>ï¼Œå®ƒä¼šè‡ªåŠ¨å°† <code>v-model</code> ç»‘å®šè¾“å…¥çš„å­—ç¬¦ä¸²å€¼ç¬¬ä¸€ä¸ªå­—æ¯è½¬ä¸ºå¤§å†™ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">&lt;<span class="hljs-title class_">MyComponent</span> v-model.<span class="hljs-property">capitalize</span>=<span class="hljs-string">&quot;myText&quot;</span> /&gt;</code></pre></div><p>ç»„ä»¶çš„ <code>v-model</code> ä¸Šæ‰€æ·»åŠ çš„ä¿®é¥°ç¬¦ï¼Œå¯ä»¥é€šè¿‡ <code>modelModifiers</code> prop åœ¨ç»„ä»¶å†…è®¿é—®åˆ°ã€‚åœ¨ä¸‹é¢çš„ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å£°æ˜äº† <code>modelModifiers</code> è¿™ä¸ª propï¼Œå®ƒçš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡</p><div class="code-wrapper"><pre><code class="hljs js">&lt;script&gt;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">props</span>: &#123;    <span class="hljs-attr">modelValue</span>: <span class="hljs-title class_">String</span>,    <span class="hljs-attr">modelModifiers</span>: &#123;      <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> (&#123;&#125;)    &#125;  &#125;,  <span class="hljs-attr">emits</span>: [<span class="hljs-string">&#x27;update:modelValue&#x27;</span>],  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">modelModifiers</span>) <span class="hljs-comment">// &#123; capitalize: true &#125;</span>  &#125;&#125;&lt;/script&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;modelValue&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">    @<span class="hljs-attr">input</span>=<span class="hljs-string">&quot;$emit(&#x27;update:modelValue&#x27;, $event.target.value)&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">  /&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span></code></pre></div><p>æ³¨æ„è¿™é‡Œç»„ä»¶çš„ <code>modelModifiers</code> prop åŒ…å«äº† <code>capitalize</code> ä¸”å…¶å€¼ä¸º <code>true</code>ï¼Œå› ä¸ºå®ƒåœ¨æ¨¡æ¿ä¸­çš„ <code>v-model</code> ç»‘å®šä¸Šè¢«ä½¿ç”¨äº†ã€‚</p><p>æœ‰äº† <code>modelModifiers</code> è¿™ä¸ª propï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åŸç”Ÿäº‹ä»¶ä¾¦å¬å‡½æ•°ä¸­æ£€æŸ¥å®ƒçš„å€¼ï¼Œç„¶åå†³å®šè§¦å‘çš„è‡ªå®šä¹‰äº‹ä»¶ä¸­è¦å‘çˆ¶ç»„ä»¶ä¼ é€’ä»€ä¹ˆå€¼ã€‚åœ¨ä¸‹é¢çš„ä»£ç é‡Œï¼Œæˆ‘ä»¬å°±æ˜¯åœ¨æ¯æ¬¡ <code>&lt;input&gt;</code> å…ƒç´ è§¦å‘ <code>input</code> äº‹ä»¶æ—¶å°†å€¼çš„é¦–å­—æ¯å¤§å†™ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">&lt;script&gt;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">props</span>: &#123;    <span class="hljs-attr">modelValue</span>: <span class="hljs-title class_">String</span>,    <span class="hljs-attr">modelModifiers</span>: &#123;      <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> (&#123;&#125;)    &#125;  &#125;,  <span class="hljs-attr">emits</span>: [<span class="hljs-string">&#x27;update:modelValue&#x27;</span>],  <span class="hljs-attr">methods</span>: &#123;    <span class="hljs-title function_">emitValue</span>(<span class="hljs-params">e</span>) &#123;      <span class="hljs-keyword">let</span> value = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">modelModifiers</span>.<span class="hljs-property">capitalize</span>) &#123;        value = value.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toUpperCase</span>() + value.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)      &#125;      <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;update:modelValue&#x27;</span>, value)    &#125;  &#125;&#125;&lt;/script&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;modelValue&quot;</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">&quot;emitValue&quot;</span> /&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span></code></pre></div><p>å¯¹äºåˆæœ‰å‚æ•°åˆæœ‰ä¿®é¥°ç¬¦çš„ <code>v-model</code> ç»‘å®šï¼Œç”Ÿæˆçš„ prop åå°†æ˜¯ <code>arg + &quot;Modifiers&quot;</code>ã€‚ä¸¾ä¾‹æ¥è¯´ï¼š</p><div class="code-wrapper"><pre><code class="hljs js">&lt;<span class="hljs-title class_">MyComponent</span> v-<span class="hljs-attr">model</span>:title.<span class="hljs-property">capitalize</span>=<span class="hljs-string">&quot;myText&quot;</span>&gt;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;titleModifiers&#x27;</span>],  <span class="hljs-attr">emits</span>: [<span class="hljs-string">&#x27;update:title&#x27;</span>],  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">titleModifiers</span>) <span class="hljs-comment">// &#123; capitalize: true &#125;</span>  &#125;&#125;</code></pre></div><h4 id="66-mixins"><a href="#66-mixins" class="headerlink" title="66.mixins"></a>66.mixins</h4><p>å±€éƒ¨æ··å…¥çš„å†™æ³•</p><div class="code-wrapper"><pre><code class="hljs angelscript"><span class="hljs-keyword">const</span> <span class="hljs-keyword">mixin</span> = &#123;  created() &#123;    console.log(<span class="hljs-number">1</span>)  &#125;&#125;createApp(&#123;  created() &#123;    console.log(<span class="hljs-number">2</span>)  &#125;,  mixins: [<span class="hljs-keyword">mixin</span>]&#125;)<span class="hljs-comment">// =&gt; 1</span><span class="hljs-comment">// =&gt; 2</span></code></pre></div><p>Mixin é’©å­çš„è°ƒç”¨é¡ºåºä¸æä¾›å®ƒä»¬çš„é€‰é¡¹é¡ºåºç›¸åŒï¼Œä¸”ä¼šåœ¨ç»„ä»¶è‡ªèº«çš„é’©å­å‰è¢«è°ƒç”¨</p><p>åœ¨ Vue 2 ä¸­ï¼Œmixins æ˜¯åˆ›å»ºå¯é‡ç”¨ç»„ä»¶é€»è¾‘çš„ä¸»è¦æ–¹å¼ã€‚å°½ç®¡åœ¨ Vue 3 ä¸­ä¿ç•™äº† mixins æ”¯æŒï¼Œä½†å¯¹äºç»„ä»¶é—´çš„é€»è¾‘å¤ç”¨ï¼Œ<a href="https://cn.vuejs.org/guide/reusability/composables.html">Composition API</a> æ˜¯ç°åœ¨æ›´æ¨èçš„æ–¹å¼ã€‚</p><p>app.mixin()å…¨å±€çš„æ··å…¥ ä½†æ˜¯vue3ä¸æ¨èä½¿ç”¨</p><h4 id="67-setup-å‡½æ•°"><a href="#67-setup-å‡½æ•°" class="headerlink" title="67.setup()å‡½æ•°"></a>67.setup()å‡½æ•°</h4><p>setupå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼šprops,context,åœ¨setupå‡½æ•°é‡Œé¢ä¸èƒ½ä½¿ç”¨this</p><p>contextå‚æ•°åŒ…å«3ä¸ªå±æ€§ï¼š</p><p>attrsï¼šæ‰€æœ‰épropsçš„attribute</p><p>slots:çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ’æ§½</p><p>emit</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props, context</span>) &#123;    <span class="hljs-comment">// é€ä¼  Attributesï¼ˆéå“åº”å¼çš„å¯¹è±¡ï¼Œç­‰ä»·äº $attrsï¼‰</span>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(context.<span class="hljs-property">attrs</span>)    <span class="hljs-comment">// æ’æ§½ï¼ˆéå“åº”å¼çš„å¯¹è±¡ï¼Œç­‰ä»·äº $slotsï¼‰</span>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(context.<span class="hljs-property">slots</span>)    <span class="hljs-comment">// è§¦å‘äº‹ä»¶ï¼ˆå‡½æ•°ï¼Œç­‰ä»·äº $emitï¼‰</span>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(context.<span class="hljs-property">emit</span>)    <span class="hljs-comment">// æš´éœ²å…¬å…±å±æ€§ï¼ˆå‡½æ•°ï¼‰</span>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(context.<span class="hljs-property">expose</span>)  &#125;&#125;</code></pre></div><p>contextæ˜¯éå“åº”æ€§çš„ï¼Œå¯ä»¥è¿›è¡Œè§£æ„</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props, &#123; attrs, slots, emit, expose &#125;</span>) &#123;    ...  &#125;&#125;</code></pre></div><p><code>attrs</code> å’Œ <code>slots</code> éƒ½æ˜¯æœ‰çŠ¶æ€çš„å¯¹è±¡ï¼Œå®ƒä»¬æ€»æ˜¯ä¼šéšç€ç»„ä»¶è‡ªèº«çš„æ›´æ–°è€Œæ›´æ–°ã€‚è¿™æ„å‘³ç€ä½ åº”å½“é¿å…è§£æ„å®ƒä»¬ï¼Œå¹¶å§‹ç»ˆé€šè¿‡ <code>attrs.x</code> æˆ– <code>slots.x</code> çš„å½¢å¼ä½¿ç”¨å…¶ä¸­çš„å±æ€§ã€‚æ­¤å¤–è¿˜éœ€æ³¨æ„ï¼Œå’Œ <code>props</code> ä¸åŒï¼Œ<code>attrs</code> å’Œ <code>slots</code> çš„å±æ€§éƒ½<strong>ä¸æ˜¯</strong>å“åº”å¼çš„ã€‚å¦‚æœä½ æƒ³è¦åŸºäº <code>attrs</code> æˆ– <code>slots</code> çš„æ”¹å˜æ¥æ‰§è¡Œå‰¯ä½œç”¨ï¼Œé‚£ä¹ˆä½ åº”è¯¥åœ¨ <code>onBeforeUpdate</code> ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­ç¼–å†™ç›¸å…³é€»è¾‘ã€‚</p><p>setupå¯ä»¥æœ‰è¿”å›å€¼ï¼Œå¯ä»¥åœ¨templateä¸­ä½¿ç”¨</p><p><code>setup</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç»„ä»¶çš„ <code>props</code>ã€‚å’Œæ ‡å‡†çš„ç»„ä»¶ä¸€è‡´ï¼Œä¸€ä¸ª <code>setup</code> å‡½æ•°çš„ <code>props</code> æ˜¯å“åº”å¼çš„ï¼Œå¹¶ä¸”ä¼šåœ¨ä¼ å…¥æ–°çš„ props æ—¶åŒæ­¥æ›´æ–°ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">props</span>: &#123;    <span class="hljs-attr">title</span>: <span class="hljs-title class_">String</span>  &#125;,  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props</span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(props.<span class="hljs-property">title</span>)  &#125;&#125;</code></pre></div><p>å¦‚æœè§£æ„propsä¼šä½¿æ•°æ®å¤±å»å“åº”æ€§ï¼Œå¦‚æœéœ€è¦ç»“æ„è¯·ä½¿ç”¨toRef()/toRefs()</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; toRefs, toRef &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props</span>) &#123;    <span class="hljs-comment">// å°† `props` è½¬ä¸ºä¸€ä¸ªå…¶ä¸­å…¨æ˜¯ ref çš„å¯¹è±¡ï¼Œç„¶åè§£æ„</span>    <span class="hljs-keyword">const</span> &#123; title &#125; = <span class="hljs-title function_">toRefs</span>(props)    <span class="hljs-comment">// `title` æ˜¯ä¸€ä¸ªè¿½è¸ªç€ `props.title` çš„ ref</span>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(title.<span class="hljs-property">value</span>)    <span class="hljs-comment">// æˆ–è€…ï¼Œå°† `props` çš„å•ä¸ªå±æ€§è½¬ä¸ºä¸€ä¸ª ref</span>    <span class="hljs-keyword">const</span> title = <span class="hljs-title function_">toRef</span>(props, <span class="hljs-string">&#x27;title&#x27;</span>)  &#125;&#125;</code></pre></div><p>è¯·æ³¨æ„åœ¨æ¨¡æ¿ä¸­è®¿é—®ä» <code>setup</code> è¿”å›çš„ <a href="https://cn.vuejs.org/api/reactivity-core.html#ref">ref</a> æ—¶ï¼Œå®ƒä¼š<a href="https://cn.vuejs.org/guide/essentials/reactivity-fundamentals.html#deep-reactivity">è‡ªåŠ¨æµ…å±‚è§£åŒ…</a>ï¼Œå› æ­¤ä½ æ— é¡»å†åœ¨æ¨¡æ¿ä¸­ä¸ºå®ƒå†™ <code>.value</code>ã€‚å½“é€šè¿‡ <code>this</code> è®¿é—®æ—¶ä¹Ÿä¼šåŒæ ·å¦‚æ­¤è§£åŒ…ã€‚</p><p><strong>TIP</strong></p><p><strong><code>setup()</code> è‡ªèº«å¹¶ä¸å«å¯¹ç»„ä»¶å®ä¾‹çš„è®¿é—®æƒï¼Œå³åœ¨ <code>setup()</code> ä¸­è®¿é—® <code>this</code> ä¼šæ˜¯ <code>undefined</code>ã€‚ä½ å¯ä»¥åœ¨é€‰é¡¹å¼ API ä¸­è®¿é—®ç»„åˆå¼ API æš´éœ²çš„å€¼ï¼Œä½†åè¿‡æ¥åˆ™ä¸è¡Œã€‚</strong></p><h5 id="æš´éœ²å…¬å…±å±æ€§"><a href="#æš´éœ²å…¬å…±å±æ€§" class="headerlink" title="æš´éœ²å…¬å…±å±æ€§"></a>æš´éœ²å…¬å…±å±æ€§</h5><p><code>expose</code> å‡½æ•°ç”¨äºæ˜¾å¼åœ°é™åˆ¶è¯¥ç»„ä»¶æš´éœ²å‡ºçš„å±æ€§ï¼Œå½“çˆ¶ç»„ä»¶é€šè¿‡<a href="https://cn.vuejs.org/guide/essentials/template-refs.html#ref-on-component">æ¨¡æ¿å¼•ç”¨</a>è®¿é—®è¯¥ç»„ä»¶çš„å®ä¾‹æ—¶ï¼Œå°†ä»…èƒ½è®¿é—® <code>expose</code> å‡½æ•°æš´éœ²å‡ºçš„å†…å®¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props, &#123; expose &#125;</span>) &#123;    <span class="hljs-comment">// è®©ç»„ä»¶å®ä¾‹å¤„äº â€œå…³é—­çŠ¶æ€â€</span>    <span class="hljs-comment">// å³ä¸å‘çˆ¶ç»„ä»¶æš´éœ²ä»»ä½•ä¸œè¥¿</span>    <span class="hljs-title function_">expose</span>()    <span class="hljs-keyword">const</span> publicCount = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)    <span class="hljs-keyword">const</span> privateCount = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)    <span class="hljs-comment">// æœ‰é€‰æ‹©åœ°æš´éœ²å±€éƒ¨çŠ¶æ€</span>    <span class="hljs-title function_">expose</span>(&#123; <span class="hljs-attr">count</span>: publicCount &#125;)  &#125;&#125;</code></pre></div><h5 id="ä¸æ¸²æŸ“å‡½æ•°ä¸€èµ·ä½¿ç”¨"><a href="#ä¸æ¸²æŸ“å‡½æ•°ä¸€èµ·ä½¿ç”¨" class="headerlink" title="ä¸æ¸²æŸ“å‡½æ•°ä¸€èµ·ä½¿ç”¨#"></a>ä¸æ¸²æŸ“å‡½æ•°ä¸€èµ·ä½¿ç”¨<a href="https://cn.vuejs.org/api/composition-api-setup.html#usage-with-render-functions">#</a></h5><p><code>setup</code> ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ª<a href="https://cn.vuejs.org/guide/extras/render-function.html">æ¸²æŸ“å‡½æ•°</a>ï¼Œæ­¤æ—¶åœ¨æ¸²æŸ“å‡½æ•°ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨åœ¨åŒä¸€ä½œç”¨åŸŸä¸‹å£°æ˜çš„å“åº”å¼çŠ¶æ€ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; h, ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-string">&#x27;div&#x27;</span>, count.<span class="hljs-property">value</span>)  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; h, ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props, &#123; expose &#125;</span>) &#123;    <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)    <span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"></span>) =&gt; ++count.<span class="hljs-property">value</span>    <span class="hljs-title function_">expose</span>(&#123;      increment    &#125;)    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-string">&#x27;div&#x27;</span>, count.<span class="hljs-property">value</span>)  &#125;&#125;</code></pre></div><h4 id="68-reactive-api"><a href="#68-reactive-api" class="headerlink" title="68. reactive api"></a>68. reactive api</h4><p>reactiveå¯ä»¥å°†å¯¹è±¡å˜æˆå“åº”å¼å¯¹è±¡  ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡çš„å“åº”å¼ä»£ç†</p><div class="code-wrapper"><pre><code class="hljs php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">account</span> = <span class="hljs-title function_ invoke__">reactive</span>(&#123;      <span class="hljs-attr">username</span>: <span class="hljs-string">&quot;coderwhy&quot;</span>,      <span class="hljs-attr">password</span>: <span class="hljs-string">&quot;1234567&quot;</span>    &#125;)</code></pre></div><p>reactiveè½¬æ¢æ˜¯æ·±å±‚çš„ï¼Œä»–ä¼šå½±å“æ‰€æœ‰çš„åµŒå¥—å±æ€§ï¼Œreactiveä¹Ÿä¼šæ·±å±‚çš„è§£åŒ…æ‰€æœ‰refå±æ€§ï¼ŒåŒæ—¶ä¿æŒå“åº”æ€§</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“è®¿é—®åˆ°æŸä¸ªå“åº”å¼æ•°ç»„æˆ– <code>Map</code> è¿™æ ·çš„åŸç”Ÿé›†åˆç±»å‹ä¸­çš„ ref å…ƒç´ æ—¶ï¼Œä¸ä¼šæ‰§è¡Œ ref çš„è§£åŒ…ã€‚æ„æ€æ˜¯</p><p>è‹¥è¦é¿å…æ·±å±‚å“åº”å¼è½¬æ¢ï¼Œåªæƒ³ä¿ç•™å¯¹è¿™ä¸ªå¯¹è±¡é¡¶å±‚æ¬¡è®¿é—®çš„å“åº”æ€§ï¼Œè¯·ä½¿ç”¨ <a href="https://cn.vuejs.org/api/reactivity-advanced.html#shallowreactive">shallowReactive()</a> ä½œæ›¿ä»£</p><p>è¿”å›çš„å¯¹è±¡ä»¥åŠå…¶ä¸­åµŒå¥—çš„å¯¹è±¡éƒ½ä¼šé€šè¿‡ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy">ES Proxy</a> åŒ…è£¹ï¼Œå› æ­¤<strong>ä¸ç­‰äº</strong>æºå¯¹è±¡ï¼Œå»ºè®®åªä½¿ç”¨å“åº”å¼ä»£ç†ï¼Œé¿å…ä½¿ç”¨åŸå§‹å¯¹è±¡ã€‚</p><p>ref çš„è§£åŒ…ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1</span>)<span class="hljs-keyword">const</span> obj = <span class="hljs-title function_">reactive</span>(&#123; count &#125;)<span class="hljs-comment">// ref ä¼šè¢«è§£åŒ…</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">count</span> === count.<span class="hljs-property">value</span>) <span class="hljs-comment">// true</span><span class="hljs-comment">// ä¼šæ›´æ–° `obj.count`</span>count.<span class="hljs-property">value</span>++<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count.<span class="hljs-property">value</span>) <span class="hljs-comment">// 2</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">count</span>) <span class="hljs-comment">// 2</span><span class="hljs-comment">// ä¹Ÿä¼šæ›´æ–° `count` ref</span>obj.<span class="hljs-property">count</span>++<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">count</span>) <span class="hljs-comment">// 3</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count.<span class="hljs-property">value</span>) <span class="hljs-comment">// 3</span></code></pre></div><p>æ³¨æ„å½“è®¿é—®åˆ°æŸä¸ªå“åº”å¼æ•°ç»„æˆ– <code>Map</code> è¿™æ ·çš„åŸç”Ÿé›†åˆç±»å‹ä¸­çš„ ref å…ƒç´ æ—¶ï¼Œ<strong>ä¸ä¼š</strong>æ‰§è¡Œ ref çš„è§£åŒ…ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> books = <span class="hljs-title function_">reactive</span>([<span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;Vue 3 Guide&#x27;</span>)])<span class="hljs-comment">// è¿™é‡Œéœ€è¦ .value</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(books[<span class="hljs-number">0</span>].<span class="hljs-property">value</span>)<span class="hljs-keyword">const</span> map = <span class="hljs-title function_">reactive</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-string">&#x27;count&#x27;</span>, <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)]]))<span class="hljs-comment">// è¿™é‡Œéœ€è¦ .value</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(map.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;count&#x27;</span>).<span class="hljs-property">value</span>)</code></pre></div><p>å°†ä¸€ä¸ª <a href="https://cn.vuejs.org/api/reactivity-core.html#ref">ref</a> èµ‹å€¼ç»™ä¸ºä¸€ä¸ª <code>reactive</code> å±æ€§æ—¶ï¼Œè¯¥ ref ä¼šè¢«è‡ªåŠ¨è§£åŒ…ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1</span>)<span class="hljs-keyword">const</span> obj = <span class="hljs-title function_">reactive</span>(&#123;&#125;)obj.<span class="hljs-property">count</span> = count<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">count</span>) <span class="hljs-comment">// 1</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">count</span> === count.<span class="hljs-property">value</span>) <span class="hljs-comment">// true</span></code></pre></div><h4 id="69-ref-api"><a href="#69-ref-api" class="headerlink" title="69.ref api"></a>69.ref api</h4><p>ref å¯ä»¥å®šä¹‰ä»»ä½•æ•°æ®ç±»å‹</p><p>refä¼šè¿”å›ä¸€ä¸ªå¯å˜çš„å“åº”å¼å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä½œä¸ºä¸€ä¸ªå“åº”å¼çš„å¼•ç”¨ç»´æŠ¤å®ƒå†…éƒ¨çš„å€¼,</p><div class="code-wrapper"><pre><code class="hljs pgsql">const <span class="hljs-keyword">info</span> = <span class="hljs-keyword">ref</span>(&#123;&#125;)console.log(<span class="hljs-keyword">info</span>.<span class="hljs-keyword">value</span>)</code></pre></div><p>åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨refçš„å€¼ï¼Œvueä¼šè‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬è¿›è¡Œè§£åŒ…ä¸éœ€è¦ä½¿ç”¨.value,ä½†æ˜¯åœ¨setupå‡½æ•°å†…éƒ¨ï¼Œè¿˜æ˜¯ä¸€ä¸ªrefå¼•ç”¨ï¼Œå¿…é¡»ä½¿ç”¨.valueçš„æ–¹å¼ã€‚åœ¨æ¨¡æ¿ä¸­çš„è§£åŒ…æ˜¯æµ…å±‚çš„è§£åŒ…</p><div class="code-wrapper"><pre><code class="hljs stylus"><span class="hljs-comment">// 2.å®šä¹‰ä»ç½‘ç»œä¸­è·å–çš„æ•°æ®ä¹Ÿæ˜¯ä½¿ç”¨ref</span>      <span class="hljs-comment">// const musics = reactive([])</span>      const musics = <span class="hljs-built_in">ref</span>(<span class="hljs-selector-attr">[]</span>)      <span class="hljs-built_in">onMounted</span>(() =&gt; &#123;        const serverMusics = <span class="hljs-selector-attr">[<span class="hljs-string">&quot;æµ·é˜”å¤©ç©º&quot;</span>, <span class="hljs-string">&quot;å°è‹¹æœ&quot;</span>, <span class="hljs-string">&quot;é‡ç‹¼&quot;</span>]</span>        musics<span class="hljs-selector-class">.value</span> = serverMusics      &#125;)</code></pre></div><h4 id="70-readonly"><a href="#70-readonly" class="headerlink" title="70.readonly()"></a>70.readonly()</h4><p>ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œæ— è®ºæ˜¯å“åº”å¼è¿˜æ˜¯æ™®é€šå¯¹è±¡ï¼Œè¿˜æ˜¯refå¯¹è±¡ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡çš„åªè¯»ä»£ç†</p><p>å¯ä»¥ç”¨äºç»™å­ç»„ä»¶ä¼ é€’æ•°æ®çš„æ—¶å€™ï¼Œä¸å…è®¸ä¿®æ”¹çˆ¶ç»„ä»¶ä¼ é€’çš„å€¼ï¼Œï¼Œreadonlyä»–ä¼šåŠ«æŒproxyä¸­çš„setæ–¹æ³•ï¼Œä¸å…è®¸ä¿®æ”¹</p><p>åªè¯»ä»£ç†æ˜¯æ·±å±‚çš„ï¼šå¯¹ä»»ä½•åµŒå¥—å±æ€§çš„è®¿é—®éƒ½å°†æ˜¯åªè¯»çš„ã€‚å®ƒçš„ ref è§£åŒ…è¡Œä¸ºä¸ <code>reactive()</code> ç›¸åŒï¼Œä½†è§£åŒ…å¾—åˆ°çš„å€¼æ˜¯åªè¯»çš„ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> original = <span class="hljs-title function_">reactive</span>(&#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;)<span class="hljs-keyword">const</span> copy = <span class="hljs-title function_">readonly</span>(original)<span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">// ç”¨æ¥åšå“åº”æ€§è¿½è¸ª</span>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy.<span class="hljs-property">count</span>)&#125;)<span class="hljs-comment">// æ›´æ”¹æºå±æ€§ä¼šè§¦å‘å…¶ä¾èµ–çš„ä¾¦å¬å™¨</span>original.<span class="hljs-property">count</span>++<span class="hljs-comment">// æ›´æ”¹è¯¥åªè¯»å‰¯æœ¬å°†ä¼šå¤±è´¥ï¼Œå¹¶ä¼šå¾—åˆ°ä¸€ä¸ªè­¦å‘Š</span>copy.<span class="hljs-property">count</span>++ <span class="hljs-comment">// warning!</span></code></pre></div><p>å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯readonlyè¿”å›çš„å¯¹è±¡çš„setteræ–¹æ³•è¢«åŠ«æŒäº†è€Œå·²</p><h4 id="71-reactiveåˆ¤æ–­çš„api"><a href="#71-reactiveåˆ¤æ–­çš„api" class="headerlink" title="71.reactiveåˆ¤æ–­çš„api"></a>71.reactiveåˆ¤æ–­çš„api</h4><h5 id="isProxy"><a href="#isProxy" class="headerlink" title="isProxy"></a>isProxy</h5><p>â€‹    æ£€æŸ¥å¯¹è±¡æ˜¯å¦æ˜¯ç”±reactiveæˆ–è€…readonlyåˆ›å»ºçš„proxy</p><h5 id="isReactive"><a href="#isReactive" class="headerlink" title="isReactive"></a>isReactive</h5><p>æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç”± <a href="https://cn.vuejs.org/api/reactivity-core.html#reactive"><code>reactive()</code></a> æˆ– <a href="https://cn.vuejs.org/api/reactivity-advanced.html#shallowreactive"><code>shallowReactive()</code></a> åˆ›å»ºçš„ä»£ç†</p><p>å¦‚æœè¯¥ä»£ç†æ˜¯readonlyåˆ›å»ºçš„ï¼Œä½†æ˜¯åŒ…è£¹äº†ç”±reactiveåˆ›å»ºçš„å¦å¤–ä¸€ä¸ªä»£ç†ï¼Œä»–ä¹Ÿä¼šè¿”å›true</p><h5 id="isReadonly"><a href="#isReadonly" class="headerlink" title="isReadonly"></a>isReadonly</h5><p>æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç”± <a href="https://cn.vuejs.org/api/reactivity-core.html#readonly"><code>readonly()</code></a> æˆ– <a href="https://cn.vuejs.org/api/reactivity-advanced.html#shallowreadonly"><code>shallowReadonly()</code></a> åˆ›å»ºçš„ä»£ç†ã€‚</p><h5 id="toRow"><a href="#toRow" class="headerlink" title="toRow"></a>toRow</h5><p> è¿”å› reactive æˆ– readonly ä»£ç†çš„åŸå§‹å¯¹è±¡ï¼ˆä¸å»ºè®®ä¿ç•™å¯¹åŸå§‹å¯¹è±¡çš„æŒä¹…å¼•ç”¨ã€‚è¯·è°¨æ…ä½¿ç”¨ï¼‰ã€‚</p><h5 id="shallowReactive"><a href="#shallowReactive" class="headerlink" title="shallowReactive"></a>shallowReactive</h5><p>åˆ›å»ºä¸€ä¸ªå“åº”å¼ä»£ç†ï¼Œå®ƒè·Ÿè¸ªå…¶è‡ªèº« property çš„å“åº”æ€§ï¼Œä½†ä¸æ‰§è¡ŒåµŒå¥—å¯¹è±¡çš„æ·±å±‚å“åº”å¼è½¬æ¢ (æ·±å±‚è¿˜æ˜¯åŸç”Ÿå¯¹è±¡)ã€‚</p><h5 id="shallowReadonly"><a href="#shallowReadonly" class="headerlink" title="shallowReadonly"></a>shallowReadonly</h5><p>åˆ›å»ºä¸€ä¸ª proxyï¼Œä½¿å…¶è‡ªèº«çš„ property ä¸ºåªè¯»ï¼Œä½†ä¸æ‰§è¡ŒåµŒå¥—å¯¹è±¡çš„æ·±åº¦åªè¯»è½¬æ¢ï¼ˆæ·±å±‚è¿˜æ˜¯å¯è¯»ã€å¯å†™çš„ï¼‰</p><h4 id="72-toRefs"><a href="#72-toRefs" class="headerlink" title="72 toRefs"></a>72 toRefs</h4><p>å¦‚æœä½¿ç”¨es6çš„è§£æ„è¯­æ³•å¯¹reactiveè¿”å›çš„å¯¹è±¡è¿›è¡Œè§£æ„ï¼Œè§£æ„åè·å¾—çš„å˜é‡ä¸æ˜¯å“åº”å¼çš„ï¼Œå¯ä»¥ä½¿ç”¨toRefså°†è§£æ„åçš„å€¼å˜æˆå“åº”å¼çš„</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> info = <span class="hljs-title function_">reactive</span>(&#123;         <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>,         <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,         <span class="hljs-attr">height</span>: <span class="hljs-number">1.88</span>       &#125;)       <span class="hljs-comment">// reactiveè¢«è§£æ„åä¼šå˜æˆæ™®é€šçš„å€¼, å¤±å»å“åº”å¼</span>       <span class="hljs-keyword">const</span> &#123; name, age &#125; = <span class="hljs-title function_">toRefs</span>(info)</code></pre></div><p><code>toRefs</code> åœ¨è°ƒç”¨æ—¶åªä¼šä¸ºæºå¯¹è±¡ä¸Šå¯ä»¥æšä¸¾çš„å±æ€§åˆ›å»º refã€‚å¦‚æœè¦ä¸ºå¯èƒ½è¿˜ä¸å­˜åœ¨çš„å±æ€§åˆ›å»º refï¼Œè¯·æ”¹ç”¨ <a href="https://cn.vuejs.org/api/reactivity-utilities.html#toref"><code>toRef</code></a>ã€‚</p><h4 id="73-toRef"><a href="#73-toRef" class="headerlink" title="73.toRef"></a>73.toRef</h4><p>å°†ä¸€ä¸ªreactiveå¯¹è±¡çš„å±æ€§å˜æˆå“åº”å¼çš„</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>(&#123;  <span class="hljs-attr">foo</span>: <span class="hljs-number">1</span>,  <span class="hljs-attr">bar</span>: <span class="hljs-number">2</span>&#125;)<span class="hljs-keyword">const</span> fooRef = <span class="hljs-title function_">toRef</span>(state, <span class="hljs-string">&#x27;foo&#x27;</span>)<span class="hljs-comment">// æ›´æ”¹è¯¥ ref ä¼šæ›´æ–°æºå±æ€§</span>fooRef.<span class="hljs-property">value</span>++<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state.<span class="hljs-property">foo</span>) <span class="hljs-comment">// 2</span><span class="hljs-comment">// æ›´æ”¹æºå±æ€§ä¹Ÿä¼šæ›´æ–°è¯¥ ref</span>state.<span class="hljs-property">foo</span>++<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fooRef.<span class="hljs-property">value</span>) <span class="hljs-comment">// 3</span></code></pre></div><p>è¯·æ³¨æ„ï¼Œè¿™ä¸åŒäºï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fooRef = <span class="hljs-title function_">ref</span>(state.<span class="hljs-property">foo</span>)</code></pre></div><p>ä¸Šé¢è¿™ä¸ª ref <strong>ä¸ä¼š</strong>å’Œ <code>state.foo</code> ä¿æŒåŒæ­¥ï¼Œå› ä¸ºè¿™ä¸ª <code>ref()</code> æ¥æ”¶åˆ°çš„æ˜¯ä¸€ä¸ªçº¯æ•°å€¼ã€‚</p><h4 id="74-refå…¶ä»–api"><a href="#74-refå…¶ä»–api" class="headerlink" title="74. refå…¶ä»–api"></a>74. refå…¶ä»–api</h4><h5 id="unref"><a href="#unref" class="headerlink" title="unref"></a>unref</h5><p>å¦‚æœæˆ‘ä»¬æƒ³è¦è·å–ä¸€ä¸ªrefå¼•ç”¨ä¸­çš„valueï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é€šè¿‡unrefæ–¹æ³•ï¼š ï° å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ª refï¼Œåˆ™è¿”å›å†…éƒ¨å€¼ï¼Œå¦åˆ™è¿”å›å‚æ•°æœ¬èº«ï¼› ï° è¿™æ˜¯ val = isRef(val) ? val.value : val çš„è¯­æ³•ç³–å‡½æ•°</p><h5 id="isRef"><a href="#isRef" class="headerlink" title="isRef"></a>isRef</h5><p>åˆ¤æ–­å€¼æ˜¯å¦æ˜¯ä¸€ä¸ªrefå¯¹è±¡ã€‚</p><h5 id="shallowRef"><a href="#shallowRef" class="headerlink" title="shallowRef"></a>shallowRef</h5><p>åˆ›å»ºä¸€ä¸ªæµ…å±‚çš„refå¯¹è±¡</p><h5 id="triggerRef"><a href="#triggerRef" class="headerlink" title="triggerRef"></a>triggerRef</h5><p>æ‰‹åŠ¨è§¦å‘å’Œ shallowRef ç›¸å…³è”çš„å‰¯ä½œç”¨ï¼š</p><h4 id="75-computed"><a href="#75-computed" class="headerlink" title="75.computed()"></a>75.computed()</h4><p>æ¥å—ä¸€ä¸ª getter å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåªè¯»çš„å“åº”å¼ <a href="https://cn.vuejs.org/api/reactivity-core.html#ref">ref</a> å¯¹è±¡ã€‚è¯¥ ref é€šè¿‡ <code>.value</code> æš´éœ² getter å‡½æ•°çš„è¿”å›å€¼ã€‚å®ƒä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªå¸¦æœ‰ <code>get</code> å’Œ <code>set</code> å‡½æ•°çš„å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå¯å†™çš„ ref å¯¹è±¡ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1</span>)<span class="hljs-keyword">const</span> plusOne = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> + <span class="hljs-number">1</span>)<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(plusOne.<span class="hljs-property">value</span>) <span class="hljs-comment">// 2</span>plusOne.<span class="hljs-property">value</span>++ <span class="hljs-comment">// é”™è¯¯</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1</span>)<span class="hljs-keyword">const</span> plusOne = <span class="hljs-title function_">computed</span>(&#123;  <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> + <span class="hljs-number">1</span>,  <span class="hljs-attr">set</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> &#123;    count.<span class="hljs-property">value</span> = val - <span class="hljs-number">1</span>  &#125;&#125;)plusOne.<span class="hljs-property">value</span> = <span class="hljs-number">1</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count.<span class="hljs-property">value</span>) <span class="hljs-comment">// 0</span></code></pre></div><h4 id="76-åœ¨setupä¸­è·å–ç»„ä»¶å®ä¾‹"><a href="#76-åœ¨setupä¸­è·å–ç»„ä»¶å®ä¾‹" class="headerlink" title="76.åœ¨setupä¸­è·å–ç»„ä»¶å®ä¾‹"></a>76.åœ¨setupä¸­è·å–ç»„ä»¶å®ä¾‹</h4><div class="code-wrapper"><pre><code class="hljs js">&lt;show-info ref=<span class="hljs-string">&quot;showInfoRef&quot;</span>&gt;&lt;/show-info&gt;<span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-keyword">const</span> showInfoRef=<span class="hljs-title function_">ref</span>()<span class="hljs-keyword">return</span> &#123;showInfoRef&#125;&#125;</code></pre></div><h4 id="77-åœ¨setupä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°"><a href="#77-åœ¨setupä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°" class="headerlink" title="77.åœ¨setupä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°"></a>77.åœ¨setupä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°</h4><p>onBeforeMount</p><p>onMounted</p><p>onBeforeUpdate</p><p>onUpdated</p><p>onBeforeUnmounted</p><p>onUnounted</p><p>onActivited</p><p>onDeactivited</p><h4 id="78-provide"><a href="#78-provide" class="headerlink" title="78.provide"></a>78.provide</h4><ul><li><p>ä¸æ³¨å†Œç”Ÿå‘½å‘¨æœŸé’©å­çš„ API ç±»ä¼¼ï¼Œ<code>provide()</code> å¿…é¡»åœ¨ç»„ä»¶çš„ <code>setup()</code> é˜¶æ®µåŒæ­¥è°ƒç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">&lt;script setup&gt;<span class="hljs-keyword">import</span> &#123; ref, provide &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">import</span> &#123; fooSymbol &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./injectionSymbols&#x27;</span><span class="hljs-comment">// æä¾›é™æ€å€¼</span><span class="hljs-title function_">provide</span>(<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>)<span class="hljs-comment">// æä¾›å“åº”å¼çš„å€¼</span><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<span class="hljs-title function_">provide</span>(<span class="hljs-string">&#x27;count&#x27;</span>, count)<span class="hljs-comment">// æä¾›æ—¶å°† Symbol ä½œä¸º key</span><span class="hljs-title function_">provide</span>(fooSymbol, count)&lt;/script&gt;</code></pre></div></li></ul><h4 id="79-inject"><a href="#79-inject" class="headerlink" title="79.inject()"></a>79.inject()</h4><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ³¨å…¥çš„ keyã€‚Vue ä¼šéå†çˆ¶ç»„ä»¶é“¾ï¼Œé€šè¿‡åŒ¹é… key æ¥ç¡®å®šæ‰€æä¾›çš„å€¼ã€‚å¦‚æœçˆ¶ç»„ä»¶é“¾ä¸Šå¤šä¸ªç»„ä»¶å¯¹åŒä¸€ä¸ª key æä¾›äº†å€¼ï¼Œé‚£ä¹ˆç¦»å¾—æ›´è¿‘çš„ç»„ä»¶å°†ä¼šâ€œè¦†ç›–â€é“¾ä¸Šæ›´è¿œçš„ç»„ä»¶æ‰€æä¾›çš„å€¼ã€‚å¦‚æœæ²¡æœ‰èƒ½é€šè¿‡ key åŒ¹é…åˆ°å€¼ï¼Œ<code>inject()</code> å°†è¿”å› <code>undefined</code>ï¼Œé™¤éæä¾›äº†ä¸€ä¸ªé»˜è®¤å€¼ã€‚</p><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå³åœ¨æ²¡æœ‰åŒ¹é…åˆ° key æ—¶ä½¿ç”¨çš„é»˜è®¤å€¼ã€‚å®ƒä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œç”¨æ¥è¿”å›æŸäº›åˆ›å»ºèµ·æ¥æ¯”è¾ƒå¤æ‚çš„å€¼ã€‚å¦‚æœé»˜è®¤å€¼æœ¬èº«å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆä½ å¿…é¡»å°† <code>false</code> ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥ï¼Œè¡¨æ˜è¿™ä¸ªå‡½æ•°å°±æ˜¯é»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ã€‚</p><p>ä¸æ³¨å†Œç”Ÿå‘½å‘¨æœŸé’©å­çš„ API ç±»ä¼¼ï¼Œ<code>inject()</code> å¿…é¡»åœ¨ç»„ä»¶çš„ <code>setup()</code> é˜¶æ®µåŒæ­¥è°ƒç”¨ã€‚</p><div class="code-wrapper"><pre><code class="hljs js">&lt;script setup&gt;<span class="hljs-keyword">import</span> &#123; inject &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">import</span> &#123; fooSymbol &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./injectionSymbols&#x27;</span><span class="hljs-comment">// æ³¨å…¥å€¼çš„é»˜è®¤æ–¹å¼</span><span class="hljs-keyword">const</span> foo = <span class="hljs-title function_">inject</span>(<span class="hljs-string">&#x27;foo&#x27;</span>)<span class="hljs-comment">// æ³¨å…¥å“åº”å¼çš„å€¼</span><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">inject</span>(<span class="hljs-string">&#x27;count&#x27;</span>)<span class="hljs-comment">// é€šè¿‡ Symbol ç±»å‹çš„ key æ³¨å…¥</span><span class="hljs-keyword">const</span> foo2 = <span class="hljs-title function_">inject</span>(fooSymbol)<span class="hljs-comment">// æ³¨å…¥ä¸€ä¸ªå€¼ï¼Œè‹¥ä¸ºç©ºåˆ™ä½¿ç”¨æä¾›çš„é»˜è®¤å€¼</span><span class="hljs-keyword">const</span> bar = <span class="hljs-title function_">inject</span>(<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;default value&#x27;</span>)<span class="hljs-comment">// æ³¨å…¥ä¸€ä¸ªå€¼ï¼Œè‹¥ä¸ºç©ºåˆ™ä½¿ç”¨æä¾›çš„å·¥å‚å‡½æ•°</span><span class="hljs-keyword">const</span> baz = <span class="hljs-title function_">inject</span>(<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>())<span class="hljs-comment">// æ³¨å…¥æ—¶ä¸ºäº†è¡¨æ˜æä¾›çš„é»˜è®¤å€¼æ˜¯ä¸ªå‡½æ•°ï¼Œéœ€è¦ä¼ å…¥ç¬¬ä¸‰ä¸ªå‚æ•°</span><span class="hljs-keyword">const</span> fn = <span class="hljs-title function_">inject</span>(<span class="hljs-string">&#x27;function&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;&#125;, <span class="hljs-literal">false</span>)&lt;/script&gt;</code></pre></div><h4 id="80-watch"><a href="#80-watch" class="headerlink" title="80.watch()"></a>80.watch()</h4><p>watchçš„apiå’Œoption APIä¸­çš„watchç±»ä¼¼</p><p>watchéœ€è¦ç›‘å¬ç‰¹å®šçš„æ•°æ®æºï¼Œå¹¶ä¸”æ‰§è¡Œå…¶å›è°ƒå‡½æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»–æ˜¯æƒ°æ€§çš„ï¼Œåœ¨åˆå§‹åŒ–æƒ…å†µä¸‹ä¸æ‰§è¡Œï¼Œåªæœ‰åœ¨æ•°æ®å˜åŒ–æ—¶æ‰æ‰§è¡Œ</p><p><code>watch()</code> é»˜è®¤æ˜¯æ‡’ä¾¦å¬çš„ï¼Œå³ä»…åœ¨ä¾¦å¬æºå‘ç”Ÿå˜åŒ–æ—¶æ‰æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</p><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¾¦å¬å™¨çš„<strong>æº</strong>ã€‚è¿™ä¸ªæ¥æºå¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå€¼</li><li>ä¸€ä¸ª ref</li><li>ä¸€ä¸ªå“åº”å¼å¯¹è±¡</li><li>â€¦æˆ–æ˜¯ç”±ä»¥ä¸Šç±»å‹çš„å€¼ç»„æˆçš„æ•°ç»„</li></ul><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯åœ¨å‘ç”Ÿå˜åŒ–æ—¶è¦è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ï¼šæ–°å€¼ã€æ—§å€¼ï¼Œä»¥åŠä¸€ä¸ªç”¨äºæ³¨å†Œå‰¯ä½œç”¨æ¸…ç†çš„å›è°ƒå‡½æ•°ã€‚è¯¥å›è°ƒå‡½æ•°ä¼šåœ¨å‰¯ä½œç”¨ä¸‹ä¸€æ¬¡é‡æ–°æ‰§è¡Œå‰è°ƒç”¨ï¼Œå¯ä»¥ç”¨æ¥æ¸…é™¤æ— æ•ˆçš„å‰¯ä½œç”¨ï¼Œä¾‹å¦‚ç­‰å¾…ä¸­çš„å¼‚æ­¥è¯·æ±‚ã€‚</p><p>å½“ä¾¦å¬å¤šä¸ªæ¥æºæ—¶ï¼Œå›è°ƒå‡½æ•°æ¥å—ä¸¤ä¸ªæ•°ç»„ï¼Œåˆ†åˆ«å¯¹åº”æ¥æºæ•°ç»„ä¸­çš„æ–°å€¼å’Œæ—§å€¼ã€‚</p><p>ç¬¬ä¸‰ä¸ªå¯é€‰çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ”¯æŒä»¥ä¸‹è¿™äº›é€‰é¡¹ï¼š</p><ul><li><p>**<code>immediate</code>**ï¼šåœ¨ä¾¦å¬å™¨åˆ›å»ºæ—¶ç«‹å³è§¦å‘å›è°ƒã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ—§å€¼æ˜¯ <code>undefined</code>ã€‚</p></li><li><p>**<code>deep</code>**ï¼šå¦‚æœæºæ˜¯å¯¹è±¡ï¼Œå¼ºåˆ¶æ·±åº¦éå†ï¼Œä»¥ä¾¿åœ¨æ·±å±‚çº§å˜æ›´æ—¶è§¦å‘å›è°ƒã€‚å‚è€ƒ<a href="https://cn.vuejs.org/guide/essentials/watchers.html#deep-watchers">æ·±å±‚ä¾¦å¬å™¨</a>ä¸€èŠ‚ã€‚</p></li><li><p>**<code>flush</code>**ï¼šè°ƒæ•´å›è°ƒå‡½æ•°çš„åˆ·æ–°æ—¶æœºã€‚å‚è€ƒ<a href="https://cn.vuejs.org/guide/essentials/watchers.html#callback-flush-timing">å›è°ƒçš„åˆ·æ–°æ—¶æœº</a>ä¸€èŠ‚ã€‚</p></li><li><p>**<code>onTrack / onTrigger</code>**ï¼šè°ƒè¯•ä¾¦å¬å™¨çš„ä¾èµ–,å‚è€ƒ<a href="https://cn.vuejs.org/guide/extras/reactivity-in-depth.html#watcher-debugging">è°ƒè¯•ä¾¦å¬å™¨</a>ä¸€èŠ‚ã€‚</p></li></ul><p>ä¸ <a href="https://cn.vuejs.org/api/reactivity-core.html#watcheffect"><code>watchEffect()</code></a> ç›¸æ¯”ï¼Œ<code>watch()</code> ä½¿æˆ‘ä»¬å¯ä»¥ï¼š</p><ul><li>æ‡’æ‰§è¡Œå‰¯ä½œç”¨ï¼›</li><li>æ›´åŠ æ˜ç¡®æ˜¯åº”è¯¥ç”±å“ªä¸ªçŠ¶æ€è§¦å‘ä¾¦å¬å™¨é‡æ–°æ‰§è¡Œï¼›</li><li>å¯ä»¥è®¿é—®æ‰€ä¾¦å¬çŠ¶æ€çš„å‰ä¸€ä¸ªå€¼å’Œå½“å‰å€¼ã€‚</li></ul><p>ä¾¦å¬ä¸€ä¸ª getter å‡½æ•°ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>(&#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;)<span class="hljs-title function_">watch</span>(  <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span>,  <span class="hljs-function">(<span class="hljs-params">count, prevCount</span>) =&gt;</span> &#123;    <span class="hljs-comment">/* ... */</span>  &#125;)</code></pre></div><p>ä¾¦å¬ä¸€ä¸ª refï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<span class="hljs-title function_">watch</span>(count, <span class="hljs-function">(<span class="hljs-params">count, prevCount</span>) =&gt;</span> &#123;  <span class="hljs-comment">/* ... */</span>&#125;)</code></pre></div><p>å½“ä¾¦å¬å¤šä¸ªæ¥æºæ—¶ï¼Œå›è°ƒå‡½æ•°æ¥å—ä¸¤ä¸ªæ•°ç»„ï¼Œåˆ†åˆ«å¯¹åº”æ¥æºæ•°ç»„ä¸­çš„æ–°å€¼å’Œæ—§å€¼ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">watch</span>([fooRef, barRef], <span class="hljs-function">(<span class="hljs-params">[foo, bar], [prevFoo, prevBar]</span>) =&gt;</span> &#123;  <span class="hljs-comment">/* ... */</span>&#125;)</code></pre></div><p>å½“ä½¿ç”¨ getter å‡½æ•°ä½œä¸ºæºæ—¶ï¼Œå›è°ƒåªåœ¨æ­¤å‡½æ•°çš„è¿”å›å€¼å˜åŒ–æ—¶æ‰ä¼šè§¦å‘ã€‚å¦‚æœä½ æƒ³è®©å›è°ƒåœ¨æ·±å±‚çº§å˜æ›´æ—¶ä¹Ÿèƒ½è§¦å‘ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>&#123; deep: true &#125;</code> å¼ºåˆ¶ä¾¦å¬å™¨è¿›å…¥æ·±å±‚çº§æ¨¡å¼ã€‚åœ¨æ·±å±‚çº§æ¨¡å¼æ—¶ï¼Œå¦‚æœå›è°ƒå‡½æ•°ç”±äºæ·±å±‚çº§çš„å˜æ›´è€Œè¢«è§¦å‘ï¼Œé‚£ä¹ˆæ–°å€¼å’Œæ—§å€¼å°†æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>(&#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;)<span class="hljs-title function_">watch</span>(  <span class="hljs-function">() =&gt;</span> state,  <span class="hljs-function">(<span class="hljs-params">newValue, oldValue</span>) =&gt;</span> &#123;    <span class="hljs-comment">// newValue === oldValue</span>  &#125;,  &#123; <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>,<span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span><span class="hljs-comment">//åœ¨åˆ›å»ºçš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ &#125;</span>)</code></pre></div><p>å½“ç›´æ¥ä¾¦å¬ä¸€ä¸ªå“åº”å¼å¯¹è±¡æ—¶ï¼Œä¾¦å¬å™¨ä¼šè‡ªåŠ¨å¯ç”¨æ·±å±‚æ¨¡å¼ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>(&#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;)<span class="hljs-title function_">watch</span>(state, <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-comment">/* æ·±å±‚çº§å˜æ›´çŠ¶æ€æ‰€è§¦å‘çš„å›è°ƒ */</span>&#125;)</code></pre></div><p><code>watch()</code> å’Œ <a href="https://cn.vuejs.org/api/reactivity-core.html#watcheffect"><code>watchEffect()</code></a> äº«æœ‰ç›¸åŒçš„åˆ·æ–°æ—¶æœºå’Œè°ƒè¯•é€‰é¡¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">watch</span>(source, callback, &#123;  <span class="hljs-attr">flush</span>: <span class="hljs-string">&#x27;post&#x27;</span>,  <span class="hljs-title function_">onTrack</span>(<span class="hljs-params">e</span>) &#123;    <span class="hljs-keyword">debugger</span>  &#125;&#125;)</code></pre></div><h4 id="81-watchEffect"><a href="#81-watchEffect" class="headerlink" title="81.watchEffect()"></a>81.watchEffect()</h4><p>ç«‹å³è¿è¡Œä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶å“åº”å¼åœ°è¿½è¸ªå…¶ä¾èµ–ï¼Œå¹¶åœ¨ä¾èµ–æ›´æ”¹æ—¶é‡æ–°æ‰§è¡Œã€‚</p><ul><li><p>ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯è¦è¿è¡Œçš„å‰¯ä½œç”¨å‡½æ•°ã€‚è¿™ä¸ªå‰¯ä½œç”¨å‡½æ•°çš„å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥æ³¨å†Œæ¸…ç†å›è°ƒã€‚æ¸…ç†å›è°ƒä¼šåœ¨è¯¥å‰¯ä½œç”¨ä¸‹ä¸€æ¬¡æ‰§è¡Œå‰è¢«è°ƒç”¨ï¼Œå¯ä»¥ç”¨æ¥æ¸…ç†æ— æ•ˆçš„å‰¯ä½œç”¨ï¼Œä¾‹å¦‚ç­‰å¾…ä¸­çš„å¼‚æ­¥è¯·æ±‚ (å‚è§ä¸‹é¢çš„ç¤ºä¾‹)ã€‚</p><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰çš„é€‰é¡¹ï¼Œå¯ä»¥ç”¨æ¥è°ƒæ•´å‰¯ä½œç”¨çš„åˆ·æ–°æ—¶æœºæˆ–è°ƒè¯•å‰¯ä½œç”¨çš„ä¾èµ–ã€‚</p><p>è¿”å›å€¼æ˜¯ä¸€ä¸ªç”¨æ¥åœæ­¢è¯¥å‰¯ä½œç”¨çš„å‡½æ•°ã€‚</p></li><li><p><strong>ç¤ºä¾‹</strong></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count.<span class="hljs-property">value</span>))<span class="hljs-comment">// -&gt; è¾“å‡º 0</span>count.<span class="hljs-property">value</span>++<span class="hljs-comment">// -&gt; è¾“å‡º 1</span></code></pre></div><p>å‰¯ä½œç”¨æ¸…é™¤ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-keyword">async</span> (onCleanup) =&gt; &#123;  <span class="hljs-keyword">const</span> &#123; response, cancel &#125; = <span class="hljs-title function_">doAsyncWork</span>(id.<span class="hljs-property">value</span>)  <span class="hljs-comment">// `cancel` ä¼šåœ¨ `id` æ›´æ”¹æ—¶è°ƒç”¨</span>  <span class="hljs-comment">// ä»¥ä¾¿å–æ¶ˆä¹‹å‰</span>  <span class="hljs-comment">// æœªå®Œæˆçš„è¯·æ±‚</span>  <span class="hljs-title function_">onCleanup</span>(cancel)  data.<span class="hljs-property">value</span> = <span class="hljs-keyword">await</span> response&#125;)</code></pre></div><p>åœæ­¢ä¾¦å¬å™¨ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> stop = <span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;&#125;)<span class="hljs-comment">// å½“ä¸å†éœ€è¦æ­¤ä¾¦å¬å™¨æ—¶:</span><span class="hljs-title function_">stop</span>()</code></pre></div><p>é€‰é¡¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;&#125;, &#123;  <span class="hljs-attr">flush</span>: <span class="hljs-string">&#x27;post&#x27;</span>,  <span class="hljs-title function_">onTrack</span>(<span class="hljs-params">e</span>) &#123;    <span class="hljs-keyword">debugger</span>  &#125;,  <span class="hljs-title function_">onTrigger</span>(<span class="hljs-params">e</span>) &#123;    <span class="hljs-keyword">debugger</span>  &#125;&#125;)</code></pre></div></li></ul><h4 id="82-hooksçš„å°è£…"><a href="#82-hooksçš„å°è£…" class="headerlink" title="82.hooksçš„å°è£…"></a>82.hooksçš„å°è£…</h4><p>å°è£…usetitle</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//useTitle.js</span><span class="hljs-keyword">import</span> &#123; ref, watch &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<span class="hljs-comment">//è¿™æ˜¯é—­åŒ…å‡½æ•°</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useTitle</span>(<span class="hljs-params">titleValue</span>) &#123;  <span class="hljs-comment">// document.title = title</span>  <span class="hljs-comment">// å®šä¹‰refçš„å¼•å…¥æ•°æ®</span>  <span class="hljs-keyword">const</span> title = <span class="hljs-title function_">ref</span>(titleValue)  <span class="hljs-comment">// ç›‘å¬titleçš„æ”¹å˜</span>  <span class="hljs-title function_">watch</span>(title, <span class="hljs-function">(<span class="hljs-params">newValue</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = newValue  &#125;, &#123;    <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>  &#125;)  <span class="hljs-comment">// è¿”å›refå€¼</span>  <span class="hljs-keyword">return</span> &#123;    title  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"> <span class="hljs-comment">//App.vue</span><span class="hljs-comment">// 2.ä¿®æ”¹æ ‡é¢˜</span>      <span class="hljs-keyword">const</span> &#123; title &#125; = <span class="hljs-title function_">useTitle</span>(<span class="hljs-string">&quot;é¦–é¡µ&quot;</span>)      <span class="hljs-comment">// 3.ç›‘å¬æŒ‰é’®çš„ç‚¹å‡»  è¿™æ ·ä¿®æ”¹çš„æ˜¯åŒä¸€ä¸ªå€¼ï¼Œä¸éœ€è¦é‡å¤çš„è°ƒç”¨usetitle(&quot;é¦–é¡µ-æµè¡Œ&quot;)</span>      <span class="hljs-keyword">function</span> <span class="hljs-title function_">popularClick</span>(<span class="hljs-params"></span>) &#123;        title.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;é¦–é¡µ-æµè¡Œ&quot;</span>      &#125;      <span class="hljs-keyword">function</span> <span class="hljs-title function_">hotClick</span>(<span class="hljs-params"></span>) &#123;        title.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;é¦–é¡µ-çƒ­é—¨&quot;</span>      &#125;      <span class="hljs-keyword">function</span> <span class="hljs-title function_">songClick</span>(<span class="hljs-params"></span>) &#123;        title.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;é¦–é¡µ-æ­Œå•&quot;</span>      &#125;</code></pre></div><h4 id="84-å•æ–‡ä»¶ç»„ä»¶-lt-script-setup-gt"><a href="#84-å•æ–‡ä»¶ç»„ä»¶-lt-script-setup-gt" class="headerlink" title="84.å•æ–‡ä»¶ç»„ä»¶ &lt;script setup&gt;"></a>84.å•æ–‡ä»¶ç»„ä»¶ <code>&lt;script setup&gt;</code></h4><script setup> æ˜¯åœ¨å•æ–‡ä»¶ç»„ä»¶ (SFC) ä¸­ä½¿ç”¨ç»„åˆå¼ API çš„ç¼–è¯‘æ—¶è¯­æ³•ç³–ã€‚- æ›´å°‘çš„æ ·æ¿å†…å®¹ï¼Œæ›´ç®€æ´çš„ä»£ç ã€‚- èƒ½å¤Ÿä½¿ç”¨çº¯ TypeScript å£°æ˜ props å’Œè‡ªå®šä¹‰äº‹ä»¶ã€‚- æ›´å¥½çš„è¿è¡Œæ—¶æ€§èƒ½ (å…¶æ¨¡æ¿ä¼šè¢«ç¼–è¯‘æˆåŒä¸€ä½œç”¨åŸŸå†…çš„æ¸²æŸ“å‡½æ•°ï¼Œé¿å…äº†æ¸²æŸ“ä¸Šä¸‹æ–‡ä»£ç†å¯¹è±¡)ã€‚- æ›´å¥½çš„ IDE ç±»å‹æ¨å¯¼æ€§èƒ½ (å‡å°‘äº†è¯­è¨€æœåŠ¡å™¨ä»ä»£ç ä¸­æŠ½å–ç±»å‹çš„å·¥ä½œ)ã€‚<div class="code-wrapper"><pre><code class="hljs js">&lt;script setup&gt;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;hello script setup&#x27;</span>)&lt;/script&gt;</code></pre></div>ä¸æ™®é€šçš„ `<script>` åªåœ¨ç»„ä»¶è¢«é¦–æ¬¡å¼•å…¥çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ä¸åŒï¼Œ`<script setup>` ä¸­çš„ä»£ç ä¼šåœ¨**æ¯æ¬¡ç»„ä»¶å®ä¾‹è¢«åˆ›å»ºçš„æ—¶å€™æ‰§è¡Œ**ã€‚å“åº”å¼æ•°æ®éœ€è¦ä½¿ç”¨refæˆ–è€…reactiveæ¥å®ç°##### é¡¶å±‚çš„ç»‘å®šä¼šè¢«æš´éœ²ç»™æ¨¡æ¿[#](https://cn.vuejs.org/api/sfc-script-setup.html#top-level-bindings-are-exposed-to-template)å½“ä½¿ç”¨ `<script setup>` çš„æ—¶å€™ï¼Œä»»ä½•åœ¨ `<script setup>` å£°æ˜çš„é¡¶å±‚çš„ç»‘å®š (åŒ…æ‹¬å˜é‡ï¼Œå‡½æ•°å£°æ˜ï¼Œä»¥åŠ import å¯¼å…¥çš„å†…å®¹) éƒ½èƒ½åœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨ï¼š<div class="code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-comment">// å˜é‡</span></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> msg = <span class="hljs-string">&#x27;Hello!&#x27;</span></span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-comment">// å‡½æ•°</span></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params"></span>) &#123;</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg)</span></span><span class="language-javascript"><span class="language-xml">&#125;</span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;log&quot;</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">msg</span> &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span></code></pre></div>import å¯¼å…¥çš„å†…å®¹ä¹Ÿä¼šä»¥åŒæ ·çš„æ–¹å¼æš´éœ²ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨æ¨¡æ¿è¡¨è¾¾å¼ä¸­ç›´æ¥ä½¿ç”¨å¯¼å…¥çš„ helper å‡½æ•°ï¼Œè€Œä¸éœ€è¦é€šè¿‡ `methods` é€‰é¡¹æ¥æš´éœ²å®ƒï¼š<div class="code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; capitalize &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./helpers&#x27;</span></span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><span class="language-xml"></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">capitalize</span>(<span class="hljs-name">&#x27;hello&#x27;</span>) &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span></code></pre></div>##### ç»„ä»¶çš„ä½¿ç”¨ç»„ä»¶ç›´æ¥å¯¼å…¥å³å¯ï¼Œä¸éœ€è¦æ³¨å†Œ<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./MyComponent.vue&#x27;</span></span><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div>##### **`defineProps()`**ï¼Œ`defineEmitsï¼ˆï¼‰`ç”¨äºåœ¨`<script setup>`ä¸­å®šä¹‰propså’Œemits<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript"></span><span class="language-javascript"><span class="hljs-comment">// å®šä¹‰props</span></span><span class="language-javascript"><span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>(&#123;</span><span class="language-javascript">  <span class="hljs-attr">name</span>: &#123;</span><span class="language-javascript">    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,</span><span class="language-javascript">    <span class="hljs-attr">default</span>: <span class="hljs-string">&quot;é»˜è®¤å€¼&quot;</span></span><span class="language-javascript">  &#125;,</span><span class="language-javascript">  <span class="hljs-attr">age</span>: &#123;</span><span class="language-javascript">    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><span class="language-javascript">    <span class="hljs-attr">default</span>: <span class="hljs-number">0</span></span><span class="language-javascript">  &#125;</span><span class="language-javascript">&#125;)</span><span class="language-javascript"></span><span class="language-javascript"><span class="hljs-comment">// ç»‘å®šå‡½æ•°, å¹¶ä¸”å‘å‡ºäº‹ä»¶</span></span><span class="language-javascript"><span class="hljs-keyword">const</span> emits = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">&quot;infoBtnClick&quot;</span>])</span><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">showInfoBtnClick</span>(<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">  <span class="hljs-title function_">emits</span>(<span class="hljs-string">&quot;infoBtnClick&quot;</span>, <span class="hljs-string">&quot;showInfoå†…éƒ¨å‘ç”Ÿäº†ç‚¹å‡»&quot;</span>)</span><span class="language-javascript">&#125;</span><span class="language-javascript"></span><span class="language-javascript"><span class="hljs-comment">// å®šä¹‰fooçš„å‡½æ•°</span></span><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;foo function&quot;</span>)</span><span class="language-javascript">&#125;</span><span class="language-javascript"><span class="hljs-title function_">defineExpose</span>(&#123;</span><span class="language-javascript">  foo</span><span class="language-javascript">&#125;)</span><span class="language-javascript"></span><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div>##### `defineExpose`ä½¿ç”¨ `<script setup>` çš„ç»„ä»¶æ˜¯**é»˜è®¤å…³é—­**çš„â€”â€”å³é€šè¿‡æ¨¡æ¿å¼•ç”¨æˆ–è€… `$parent` é“¾è·å–åˆ°çš„ç»„ä»¶çš„å…¬å¼€å®ä¾‹ï¼Œ**ä¸ä¼š**æš´éœ²ä»»ä½•åœ¨ `<script setup>` ä¸­å£°æ˜çš„ç»‘å®šã€‚å¯ä»¥é€šè¿‡ `defineExpose` ç¼–è¯‘å™¨å®æ¥æ˜¾å¼æŒ‡å®šåœ¨ `<script setup>` ç»„ä»¶ä¸­è¦æš´éœ²å‡ºå»çš„å±æ€§ï¼š<div class="code-wrapper"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> </span></span><span class="hljs-template-variable">&#123; ref &#125;</span><span class="language-xml"><span class="language-javascript"> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span></span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> b = <span class="hljs-title function_">ref</span>(<span class="hljs-number">2</span>)</span></span><span class="language-javascript"><span class="language-xml"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-title function_">defineExpose</span>(</span></span><span class="hljs-template-variable">&#123;</span><span class="hljs-template-variable">  a,</span><span class="hljs-template-variable">  b</span><span class="hljs-template-variable">&#125;</span><span class="language-xml">)</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>vue3ç¬”è®°</title>
    <link href="/2022/08/16/Vue3%E7%AC%94%E8%AE%B0(%E4%B8%80)/"/>
    <url>/2022/08/16/Vue3%E7%AC%94%E8%AE%B0(%E4%B8%80)/</url>
    
    <content type="html"><![CDATA[<h4 id="1-vueæ‰‹è„šæ¶ä»£ä»·è„šæœ¬-ä¸¤ç§æ–¹å¼"><a href="#1-vueæ‰‹è„šæ¶ä»£ä»·è„šæœ¬-ä¸¤ç§æ–¹å¼" class="headerlink" title="1.vueæ‰‹è„šæ¶ä»£ä»·è„šæœ¬  ä¸¤ç§æ–¹å¼"></a>1.vueæ‰‹è„šæ¶ä»£ä»·è„šæœ¬  ä¸¤ç§æ–¹å¼</h4><div class="code-wrapper"><pre><code class="hljs dsconfig"><span class="hljs-string">vue</span> <span class="hljs-string">create</span>  é¡¹ç›®å  æ„å»ºå·¥å…·æ˜¯<span class="hljs-string">webpack</span><span class="hljs-string">npm</span> <span class="hljs-string">init</span> <span class="hljs-string">vue</span>@<span class="hljs-string">latest</span>  <span class="hljs-string">1</span>.å®‰è£…ä¸€ä¸ªæœ¬åœ°å·¥å…·ï¼š<span class="hljs-built_in">create-vue</span>  <span class="hljs-string">2</span>.ä½¿ç”¨<span class="hljs-built_in">create-vueåˆ›å»ºä¸€ä¸ªvueé¡¹ç›®</span>  æ„å»ºå·¥å…·æ˜¯<span class="hljs-string">vite</span></code></pre></div><h4 id="2-attrs"><a href="#2-attrs" class="headerlink" title="2.$attrs"></a>2.$attrs</h4><h4 id="3-emits"><a href="#3-emits" class="headerlink" title="3.emits"></a>3.emits</h4><p>vue3ä¸­å¢åŠ äº†$emitäº‹ä»¶çš„å£°æ˜</p><h4 id="4-reactiveåªèƒ½ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå®šä¹‰å¤æ‚ç±»å‹çš„æ•°æ®ï¼Œäº‹å®ä¸Šç¼–å†™çš„dataå‡½æ•°åœ¨å†…éƒ¨ä¹Ÿæ˜¯è°ƒç”¨reactiveæ¥å®Œæˆå“åº”å¼çš„"><a href="#4-reactiveåªèƒ½ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå®šä¹‰å¤æ‚ç±»å‹çš„æ•°æ®ï¼Œäº‹å®ä¸Šç¼–å†™çš„dataå‡½æ•°åœ¨å†…éƒ¨ä¹Ÿæ˜¯è°ƒç”¨reactiveæ¥å®Œæˆå“åº”å¼çš„" class="headerlink" title="4.reactiveåªèƒ½ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå®šä¹‰å¤æ‚ç±»å‹çš„æ•°æ®ï¼Œäº‹å®ä¸Šç¼–å†™çš„dataå‡½æ•°åœ¨å†…éƒ¨ä¹Ÿæ˜¯è°ƒç”¨reactiveæ¥å®Œæˆå“åº”å¼çš„"></a>4.reactiveåªèƒ½ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå®šä¹‰å¤æ‚ç±»å‹çš„æ•°æ®ï¼Œäº‹å®ä¸Šç¼–å†™çš„dataå‡½æ•°åœ¨å†…éƒ¨ä¹Ÿæ˜¯è°ƒç”¨reactiveæ¥å®Œæˆå“åº”å¼çš„</h4><h4 id="5-refå‡½æ•°ï¼Œç”¨äºå®šä¹‰ç®€å•ç±»å‹çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å¤æ‚ç±»å‹çš„æ•°æ®ã€‚refä¼šè¿›è¡Œè‡ªåŠ¨è§£åŒ…ï¼Œrefçš„è§£åŒ…æ˜¯æµ…å±‚è§£åŒ…"><a href="#5-refå‡½æ•°ï¼Œç”¨äºå®šä¹‰ç®€å•ç±»å‹çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å¤æ‚ç±»å‹çš„æ•°æ®ã€‚refä¼šè¿›è¡Œè‡ªåŠ¨è§£åŒ…ï¼Œrefçš„è§£åŒ…æ˜¯æµ…å±‚è§£åŒ…" class="headerlink" title="5.refå‡½æ•°ï¼Œç”¨äºå®šä¹‰ç®€å•ç±»å‹çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å¤æ‚ç±»å‹çš„æ•°æ®ã€‚refä¼šè¿›è¡Œè‡ªåŠ¨è§£åŒ…ï¼Œrefçš„è§£åŒ…æ˜¯æµ…å±‚è§£åŒ…"></a>5.refå‡½æ•°ï¼Œç”¨äºå®šä¹‰ç®€å•ç±»å‹çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å¤æ‚ç±»å‹çš„æ•°æ®ã€‚refä¼šè¿›è¡Œè‡ªåŠ¨è§£åŒ…ï¼Œrefçš„è§£åŒ…æ˜¯æµ…å±‚è§£åŒ…</h4><p>ä½†æ˜¯åœ¨æ·±å±‚æ¬¡å¼•ç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ—¶å€™æ˜¯ç›´æ¥ä½¿ç”¨ï¼Œåœ¨è®¾ç½®çš„æ—¶å€™éœ€è¦ç”¨.value</p><h4 id="6-refå’Œreactiveçš„ä½¿ç”¨åœºæ™¯"><a href="#6-refå’Œreactiveçš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.refå’Œreactiveçš„ä½¿ç”¨åœºæ™¯"></a>6.refå’Œreactiveçš„ä½¿ç”¨åœºæ™¯</h4><p>â€‹        reactiveå¯ä»¥åº”ç”¨äºæœ¬åœ°çš„æ•°æ®ï¼Œå¤šä¸ªæ•°æ®ä¹‹é—´æ˜¯æœ‰è”ç³»çš„ï¼Œæ˜¯èšåˆæ•°æ®</p><p>â€‹        å…¶ä»–åœºæ™¯å¯ä»¥è¿ç”¨ref,å®šä¹‰ç½‘ç»œè¯·æ±‚ä¸­çš„æ•°æ®ä¹Ÿæ˜¯ç”¨ref</p><ol start="7"><li><h4 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a><code>readonly</code></h4></li></ol><p>â€‹    ä¸è¦è¿åå•é¡¹æ•°æ®æµï¼ŒæŠŠå“åº”å¼çš„reactiveæˆ–è€…refä¼ é€’ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶å¯ä»¥ä¿®æ”¹æ•°æ®ï¼Œä¸ºäº†ä¸è¦è®©å­ç»„ä»¶ä¿®æ”¹æ•°æ®ï¼Œå¯ä»¥å°†ä¼ å…¥çš„å“åº”å¼å˜æˆreadonly</p><div class="code-wrapper"><pre><code class="hljs axapta"><span class="hljs-keyword">const</span> obj1=<span class="hljs-keyword">readonly</span>(obj)<span class="hljs-comment">//å¯ä»¥å°†è¿™ä¸ªobj1ä¼ é€’è¿‡å»</span></code></pre></div><p>readonlyä¼šè¿”å›åŸå§‹å¯¹è±¡çš„åªè¯»ä»£ç†ï¼Œæœ¬è´¨ä¸Šæ˜¯åŠ«æŒproxyçš„setæ–¹æ³•ï¼Œä¸èƒ½è¿›è¡Œè®¾ç½®æ–°çš„å€¼</p><h4 id="8-isProxy"><a href="#8-isProxy" class="headerlink" title="8.isProxy"></a>8.isProxy</h4><p>åˆ¤æ–­æ˜¯å¦æ˜¯ç”±reactiveæˆ–è€…readonlyåˆ›å»ºçš„proxy</p><h4 id="9-isReactive"><a href="#9-isReactive" class="headerlink" title="9.isReactive"></a>9.isReactive</h4><p> æ£€æŸ¥å¯¹è±¡æ˜¯å¦æ˜¯ç”±reactiveåˆ›å»ºçš„å“åº”å¼ä»£ç†ï¼Œå¦‚æœè¯¥ä»£ç†æ˜¯ç”±readonlyåˆ›å»ºçš„ï¼Œä½†æ˜¯åŒ…è£¹reactive,ä¹Ÿæ˜¯true</p><h4 id="10-isReadonly"><a href="#10-isReadonly" class="headerlink" title="10.isReadonly"></a>10.isReadonly</h4><p> æ˜¯å¦æ˜¯readonly</p><h4 id="11-toRow"><a href="#11-toRow" class="headerlink" title="11.toRow"></a>11.toRow</h4><p>è¿”å›reactiveæˆ–è€…readonlyä»£ç†çš„åŸå§‹å¯¹è±¡</p><h4 id="12-shallowReactive"><a href="#12-shallowReactive" class="headerlink" title="12.shallowReactive"></a>12.shallowReactive</h4><p>  åˆ›å»ºä¸€ä¸ªå“åº”å¼ä»£ç†ï¼Œè·Ÿè¸ªæœ¬èº«çš„property,ä½†æ˜¯ä¸ä¼šæ‰§è¡ŒåµŒå¥—å¯¹è±¡çš„æ·±å±‚å“åº”å¼ä»£ç†</p><h4 id="13-shallowReadonly"><a href="#13-shallowReadonly" class="headerlink" title="13.shallowReadonly"></a>13.shallowReadonly</h4><p> åªè¯»çš„æµ…å±‚</p><h4 id="14-toRefs"><a href="#14-toRefs" class="headerlink" title="14.toRefs"></a>14.toRefs</h4><p> å°†å“åº”å¼å¯¹è±¡è½¬æ¢æˆæ™®é€šå¯¹è±¡ï¼Œé‡Œé¢çš„propertyè½¬æˆref,å¯ä»¥è¿›è¡Œè§£æ„æˆrefå“åº”å¼</p><div class="code-wrapper"><pre><code class="hljs reasonml">const &#123;a&#125;=<span class="hljs-keyword">to</span><span class="hljs-constructor">Refs(<span class="hljs-params">reactive</span>(&#123;<span class="hljs-params">a</span>:<span class="hljs-string">&quot;zjag&quot;</span>&#125;)</span>  <span class="hljs-comment">//å¯ä»¥ç”¨äºreactiveçš„è§£æ„</span></code></pre></div><p>reactiveé»˜è®¤æƒ…å†µä¸‹è§£æ„çš„å€¼æ²¡æœ‰å“åº”å¼</p><h4 id="15-setupçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#15-setupçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="15.setupçš„ç”Ÿå‘½å‘¨æœŸ"></a>15.setupçš„ç”Ÿå‘½å‘¨æœŸ</h4><h4 id="16-Provideå‡½æ•°"><a href="#16-Provideå‡½æ•°" class="headerlink" title="16.Provideå‡½æ•°"></a>16.Provideå‡½æ•°</h4><h4 id="17-è·¯ç”±é’©å­å‡½æ•°"><a href="#17-è·¯ç”±é’©å­å‡½æ•°" class="headerlink" title="17.è·¯ç”±é’©å­å‡½æ•°"></a>17.è·¯ç”±é’©å­å‡½æ•°</h4><h4 id="18-beforeEach"><a href="#18-beforeEach" class="headerlink" title="18.beforeEach"></a>18.beforeEach</h4><p> å…¨å±€çš„å‰ç½®å®ˆå«beforeEachæ˜¯ä¼šåœ¨å¯¼èˆªè§¦å‘çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œä»–åˆä¸¤ä¸ªå‚æ•°to,from,åˆè¿”å›å€¼ï¼Œè¿”å›falseåˆ™ä¼šå–æ¶ˆå½“å‰å¯¼èˆªï¼Œä¸è¿”å›æˆ–è€…è¿”å›undefinedåˆ™ä½¿ç”¨é»˜è®¤å¯¼èˆªï¼Œè¿”å›ä¸€ä¸ªè·¯ç”±åœ°å€ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯objectï¼ŒåŒ…æ‹¬è·¯ç”±ä¿¡æ¯</p><h4 id="19-ä»€ä¹ˆæ˜¯MVVMï¼Œå’ŒMVCçš„åŒºåˆ«"><a href="#19-ä»€ä¹ˆæ˜¯MVVMï¼Œå’ŒMVCçš„åŒºåˆ«" class="headerlink" title="19.ä»€ä¹ˆæ˜¯MVVMï¼Œå’ŒMVCçš„åŒºåˆ«"></a>19.ä»€ä¹ˆæ˜¯MVVMï¼Œå’ŒMVCçš„åŒºåˆ«</h4><p>20.dataå¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨vue2ä¸­ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨vue3ä¸­å¿…é¡»ä½¿ç”¨å‡½æ•°</p><p>21.ç®­å¤´å‡½æ•°ä¸èƒ½å®šä¹‰methodä¸­çš„å‡½æ•°ï¼Œå› ä¸ºç®­å¤´å‡½æ•°ä¸­Â·æ²¡æœ‰this,ç®­å¤´å‡½æ•°çš„thisæ˜¯ç”±ä¸Šå±‚ä½œç”¨åŸŸçš„thisæ¥å†³å®šçš„ï¼Œæ‰€ä»¥ä¸ä¼šæŒ‡å®šåˆ°å½“å‰ç»„ä»¶å®ä¾‹</p><p>22.åœ¨æºç ä¸­thisçš„æŒ‡å‘</p><p>23.v-once è¡¨ç¤ºå½“å‰å…ƒç´ æˆ–è€…ç»„ä»¶åªä¼šæ›´æ–°ä¸€æ¬¡ï¼Œå°±æ˜¯åˆå§‹åŒ–ä»¥åå°±ä¸ä¼šå†æ¬¡æ¸²æŸ“ï¼ŒåŒ…å«çš„å­ç»„ä»¶ä¹Ÿæ˜¯æ¸²æŸ“ä¹Ÿæ˜¯æ¸²æŸ“ä¸€æ¬¡ï¼Œåœ¨ç‰¹å®šå¤šçš„åœºåˆä½¿ç”¨å¯ä»¥æé«˜æ€§èƒ½</p><h4 id="24-v-text"><a href="#24-v-text" class="headerlink" title="24.v-text"></a>24.v-text</h4><div class="code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">count</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">&quot;count&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>  //äºŒè€…æ˜¯ç­‰ä»·çš„</span></code></pre></div><h4 id="25-v-html"><a href="#25-v-html" class="headerlink" title="25.v-html"></a>25.v-html</h4><p>å¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢æˆhtml</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å±•ç¤ºçš„å†…å®¹æœ¬èº«æ˜¯html çš„ï¼Œé‚£ä¹ˆvueå¹¶ä¸ä¼šå¯¹å…¶è¿›è¡Œç‰¹æ®Šçš„è§£æã€‚</p><p>å¦‚æœæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªå†…å®¹è¢«Vueå¯ä»¥è§£æå‡ºæ¥ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ v-html æ¥å±•ç¤º</p><div class="code-wrapper"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">v-html</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span> data() &#123;         <span class="hljs-keyword">return</span> &#123;          <span class="hljs-built_in"> count</span>: <span class="hljs-number">0</span>,           content: `<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: red; font-size: 30px;&quot;</span>&gt;</span>å“ˆå“ˆå“ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>`,         &#125;;       &#125;,</code></pre></div><h4 id="26-v-pre"><a href="#26-v-pre" class="headerlink" title="26.v-pre"></a>26.v-pre</h4><p>ç”¨äºè·³è¿‡å…ƒç´ å’Œä»–çš„å­å…ƒç´ çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œæ˜¾ç¤ºåŸå§‹çš„Mustachæ ‡ç­¾ï¼Œå°±æ˜¯ä¸ä¼šå¯¹å…¶è¿›è¡Œç¼–è¯‘</p><img src="https://img1.imgtp.com/2022/08/16/6QxUMw0k.png" alt="QQæˆªå›¾20220805010351.png" style="zoom:200%;" /><p><img src="https://img1.imgtp.com/2022/08/16/RQQz8CXr.png" alt="QQæˆªå›¾20220805010445.png"></p><h4 id="27-v-cloak"><a href="#27-v-cloak" class="headerlink" title="27.v-cloak"></a>27.v-cloak</h4><p>è¿™ä¸ªæŒ‡ä»¤ä¿æŒåœ¨å…ƒç´ ä¸Šç›´åˆ°å…³è”çš„ç»„ä»¶å®ä¾‹ç»“æŸç¼–è¯‘ï¼Œéœ€è¦å’Œcssç»“åˆä½¿ç”¨</p><img src="https://img1.imgtp.com/2022/08/16/0K3EfAAB.png" alt="å›¾ç‰‡1.png" style="zoom:200%;" /><h4 id="28-v-memo"><a href="#28-v-memo" class="headerlink" title="28.v-memo"></a>28.v-memo</h4><p>é€‚ç”¨äºæ€§èƒ½ä¼˜åŒ–ï¼Œåªæœ‰å¯¹åº”çš„æ•°ç»„ä¸­å±æ€§çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šé‡æ–°æ¸²æŸ“</p><img src="https://img1.imgtp.com/2022/08/16/JpOvHIxe.png" alt="QQæˆªå›¾20220805011104.png" style="zoom:200%;" /><h4 id="29-v-bind"><a href="#29-v-bind" class="headerlink" title="29.v-bind"></a>29.v-bind</h4><p> v-bindçš„ç®€å†™</p><h4 id="30-classç»‘å®šçš„è¯­æ³•"><a href="#30-classç»‘å®šçš„è¯­æ³•" class="headerlink" title="30.classç»‘å®šçš„è¯­æ³•"></a>30.classç»‘å®šçš„è¯­æ³•</h4><p>åŠ¨æ€ç»‘å®šçš„classå¯ä»¥å’Œæ™®é€šçš„classä¸€èµ·ä½¿ç”¨</p><p>:classå¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œå±æ€§ï¼Œå¯¹è±¡ï¼Œæ•°ç»„ï¼Œè®¡ç®—å±æ€§è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–æ˜¯ä½¿ç”¨æ–¹æ³•çš„è°ƒç”¨è¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ•°ç»„</p><h4 id="31-styleç»‘å®šçš„è¯­æ³•"><a href="#31-styleç»‘å®šçš„è¯­æ³•" class="headerlink" title="31.styleç»‘å®šçš„è¯­æ³•"></a>31.styleç»‘å®šçš„è¯­æ³•</h4><p><img src="https://img1.imgtp.com/2022/08/16/7GFaKEon.png" alt="QQæˆªå›¾20220805023313.png"></p><h4 id="32-name-â€valueâ€-åŠ¨æ€ç»‘å®šå±æ€§"><a href="#32-name-â€valueâ€-åŠ¨æ€ç»‘å®šå±æ€§" class="headerlink" title="32.:[name]=â€valueâ€  åŠ¨æ€ç»‘å®šå±æ€§"></a>32.:[name]=â€valueâ€  åŠ¨æ€ç»‘å®šå±æ€§</h4><h4 id="33-å¦‚ä¸‹"><a href="#33-å¦‚ä¸‹" class="headerlink" title="33.å¦‚ä¸‹"></a>33.å¦‚ä¸‹</h4> <div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">&quot;obj&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span> //ç»‘å®šå¯¹è±¡ å¯ä»¥å°†æ‰€æœ‰å¯¹è±¡çš„å±æ€§éå†ï¼Œç»‘å®šè¿‡å»</code></pre></div><h4 id="34-v-onäº‹ä»¶ç»‘å®š-ç®€å†™"><a href="#34-v-onäº‹ä»¶ç»‘å®š-ç®€å†™" class="headerlink" title="34.v-onäº‹ä»¶ç»‘å®š  @ç®€å†™"></a>34.v-onäº‹ä»¶ç»‘å®š  @ç®€å†™</h4><h4 id="35-v-onäº‹ä»¶çš„å‚æ•°ä¼ é€’"><a href="#35-v-onäº‹ä»¶çš„å‚æ•°ä¼ é€’" class="headerlink" title="35.v-onäº‹ä»¶çš„å‚æ•°ä¼ é€’"></a>35.v-onäº‹ä»¶çš„å‚æ•°ä¼ é€’</h4><p><img src="https://img1.imgtp.com/2022/08/16/gFZd2jBM.png" alt="QQæˆªå›¾20220806014535.png"></p><h4 id="36-v-onçš„ä¿®é¥°ç¬¦"><a href="#36-v-onçš„ä¿®é¥°ç¬¦" class="headerlink" title="36.v-onçš„ä¿®é¥°ç¬¦"></a>36.v-onçš„ä¿®é¥°ç¬¦</h4><p><strong>.stop - è°ƒç”¨ event.stopPropagation()ã€‚</strong></p><p><strong>.prevent - è°ƒç”¨ event.preventDefault()ã€‚</strong></p><p><strong>.capture - æ·»åŠ äº‹ä»¶ä¾¦å¬å™¨æ—¶ä½¿ç”¨ capture æ¨¡å¼ã€‚</strong></p><p><strong>.self - åªå½“äº‹ä»¶æ˜¯ä»ä¾¦å¬å™¨ç»‘å®šçš„å…ƒç´ æœ¬èº«è§¦å‘æ—¶æ‰è§¦å‘å›è°ƒã€‚</strong></p><p><strong>.{keyAlias} - ä»…å½“äº‹ä»¶æ˜¯ä»ç‰¹å®šé”®è§¦å‘æ—¶æ‰è§¦å‘å›è°ƒã€‚</strong></p><p><strong>.once - åªè§¦å‘ä¸€æ¬¡å›è°ƒã€‚</strong></p><p><strong>.left - åªå½“ç‚¹å‡»é¼ æ ‡å·¦é”®æ—¶è§¦å‘ã€‚</strong></p><p><strong>.right - åªå½“ç‚¹å‡»é¼ æ ‡å³é”®æ—¶è§¦å‘ã€‚</strong></p><p><strong>.middle - åªå½“ç‚¹å‡»é¼ æ ‡ä¸­é”®æ—¶è§¦å‘ã€‚</strong></p><p><strong>.passive - { passive: true } æ¨¡å¼æ·»åŠ ä¾¦å¬å™¨</strong></p><h4 id="37-v-if-v-else-v-else-if"><a href="#37-v-if-v-else-v-else-if" class="headerlink" title="37.v-if ,v-else, v-else-if"></a>37.v-if ,v-else, v-else-if</h4><p>v-ifçš„æ¸²æŸ“åŸç†</p><p>v-ifæ˜¯æƒ°æ€§çš„ï¼Œåªæœ‰åœ¨æ¡ä»¶åˆ¤æ–­ä¸ºtrueçš„æ—¶å€™ï¼Œæ‰ä¼šé‡æ–°æ¸²æŸ“ã€‚å½“ä¸ºfalseçš„æ—¶å€™ä¸ä¼šæ¸²æŸ“</p><h4 id="38-v-show"><a href="#38-v-show" class="headerlink" title="38.v-show"></a>38.v-show</h4><h4 id="39-templateå…ƒç´ "><a href="#39-templateå…ƒç´ " class="headerlink" title="39.templateå…ƒç´ "></a>39.templateå…ƒç´ </h4><p>templateå…ƒç´ å¯ä»¥åœ¨é¡µé¢ä¸­ä¸åšæ¸²æŸ“ï¼Œå¯ä»¥ç”¨äºåŒ…è£¹å…ƒç´ ï¼Œä½†æ˜¯ä¸ä¼šåœ¨é¡µé¢ä¸­æ¸²æŸ“</p><h4 id="40-v-forå’Œv-showçš„åŒºåˆ«"><a href="#40-v-forå’Œv-showçš„åŒºåˆ«" class="headerlink" title="40.v-forå’Œv-showçš„åŒºåˆ«"></a>40.v-forå’Œv-showçš„åŒºåˆ«</h4><p><strong>é¦–å…ˆï¼Œåœ¨ç”¨æ³•ä¸Šçš„åŒºåˆ«ï¼š</strong></p><p>v-showæ˜¯ä¸æ”¯æŒtemplateï¼›</p><p>v-showä¸å¯ä»¥å’Œv-elseä¸€èµ·ä½¿ç”¨ï¼›</p><p><strong>å…¶æ¬¡ï¼Œæœ¬è´¨çš„åŒºåˆ«ï¼š</strong></p><p>v-showå…ƒç´ æ— è®ºæ˜¯å¦éœ€è¦æ˜¾ç¤ºåˆ°æµè§ˆå™¨ä¸Šï¼Œå®ƒçš„DOMå®é™…éƒ½æ˜¯æœ‰å­˜åœ¨çš„ï¼Œåªæ˜¯é€šè¿‡CSSçš„displayå±æ€§æ¥è¿›è¡Œåˆ‡æ¢ï¼›</p><p>v-ifå½“æ¡ä»¶ä¸ºfalseæ—¶ï¼Œå…¶å¯¹åº”çš„åŸç”Ÿå‹æ ¹ä¸ä¼šè¢«æ¸²æŸ“åˆ°DOMä¸­ï¼›</p><p><strong>å¼€å‘ä¸­å¦‚ä½•è¿›è¡Œé€‰æ‹©å‘¢ï¼Ÿ</strong></p><p>å¦‚æœæˆ‘ä»¬çš„åŸç”Ÿéœ€è¦åœ¨æ˜¾ç¤ºå’Œéšè—ä¹‹é—´é¢‘ç¹çš„åˆ‡æ¢ï¼Œé‚£ä¹ˆä½¿ç”¨v-showï¼›</p><p>å¦‚æœä¸ä¼šé¢‘ç¹çš„å‘ç”Ÿåˆ‡æ¢ï¼Œé‚£ä¹ˆä½¿ç”¨v-ifï¼›</p><h4 id="41-v-for"><a href="#41-v-for" class="headerlink" title="41.v-for"></a>41.v-for</h4><p><img src="https://img1.imgtp.com/2022/08/16/Rt9R3gK5.png" alt="QQæˆªå›¾20220806191249.png"></p><h4 id="42-æ•°ç»„è·Ÿæ–°æ£€æµ‹"><a href="#42-æ•°ç»„è·Ÿæ–°æ£€æµ‹" class="headerlink" title="42.æ•°ç»„è·Ÿæ–°æ£€æµ‹"></a>42.æ•°ç»„è·Ÿæ–°æ£€æµ‹</h4><p>vueä¼šå¯¹ä»¥ä¸‹æ•°ç»„çš„æ–¹æ³•è¿›è¡ŒåŒ…è£¹ï¼Œæ‰€ä»¥é€šè¿‡è¿™äº›æ–¹æ³•å˜æ›´æ•°ç»„å¯ä»¥è§¦å‘é¡µé¢çš„æ›´æ–°</p><p><strong>push()</strong></p><p><strong>pop()</strong></p><p><strong>shift()</strong></p><p><strong>unshift()</strong></p><p><strong>splice()</strong></p><p><strong>sort()</strong></p><p><strong>reverse()</strong></p><p>è¿™äº›æ–¹æ³•éƒ½ä¼šç›´æ¥ä¿®æ”¹åŸæ¥çš„æ•°ç»„ï¼Œ</p><p>å¯¹äºä¸€äº›çº¯å‡½æ•°çš„æ•°ç»„æ–¹æ³•ï¼Œä»–ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ‰€ä»¥å¿…é¡»å°†è¿™ä¸ªæ–°çš„æ•°ç»„èµ‹å€¼ç»™åŸæ¥çš„å±æ€§</p><h4 id="43-v-forä¸­keyçš„ä½œç”¨"><a href="#43-v-forä¸­keyçš„ä½œç”¨" class="headerlink" title="43.v-forä¸­keyçš„ä½œç”¨"></a>43.v-forä¸­keyçš„ä½œç”¨</h4><p>keyå±æ€§ä¸»è¦é€‚ç”¨äºDiffç®—æ³•ä¸­ï¼Œåœ¨æ–°æ—§nodeå¯¹æ¯”æ—¶è¾¨è¯†vnode,å¦‚æœä¸ä½¿ç”¨key,vueä¼šä½¿ç”¨ä¸€ç§æœ€å¤§é™åº¦å‡å°‘åŠ¨æ€å…ƒç´ å¹¶ä¸”å°½å¯èƒ½çš„å°è¯•å°±åœ°å¤ç”¨æˆ–è€…ä¿®æ”¹ç›¸åŒç±»å‹çš„å…ƒç´ çš„ç®—æ³•</p><p>è€Œä½¿ç”¨äº†keyæ—¶ï¼Œä»–ä¼šåŸºäºkeyçš„å˜åŒ–é‡æ–°æ’åˆ—å…ƒç´ é¡ºåºï¼Œå¹¶ä¸”ä¼šç§»é™¤/é”€æ¯keyä¸å­˜åœ¨çš„å…ƒç´ </p><h4 id="44-ä»€ä¹ˆæ˜¯vnode"><a href="#44-ä»€ä¹ˆæ˜¯vnode" class="headerlink" title="44.ä»€ä¹ˆæ˜¯vnode"></a>44.ä»€ä¹ˆæ˜¯vnode</h4><p>vnode å…¨ç§°virual node å°±æ˜¯è™šæ‹ŸèŠ‚ç‚¹ï¼Œç»„ä»¶å’Œå…ƒç´ éƒ½ä¼šè¢«æŠ½è±¡æˆä¸€ä¸ªä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œvnodeæœ¬è´¨å°±æ˜¯ä¸€ä¸ªä¸ªå¯¹è±¡</p><h4 id="45-diffç®—æ³•"><a href="#45-diffç®—æ³•" class="headerlink" title="45.diffç®—æ³•"></a>45.diffç®—æ³•</h4><p>é’ˆå¯¹æœ‰keyçš„vnodeè¿›è¡Œdiffæ“ä½œæ—¶</p><p><strong>1.é¦–å…ˆä¼šå¯¹æ–°æ—§èŠ‚ç‚¹è¿›è¡Œéå†ï¼Œä»å¤´éƒ¨å¼€å§‹ï¼Œé‡åˆ°ç›¸åŒçš„èŠ‚ç‚¹åˆ™ç»§ç»­ï¼Œç›´åˆ°é‡åˆ°ä¸ç”¨çš„èŠ‚ç‚¹åˆ™è·³å‡º</strong></p><p><strong>2.ç„¶åå†ä»æ–°æ—§vnodeèŠ‚ç‚¹çš„å°¾éƒ¨å¼€å§‹éå†ï¼Œé‡åˆ°ç›¸åŒçš„èŠ‚ç‚¹åˆ™ç»§ç»­ï¼Œé‡åˆ°ä¸åŒçš„èŠ‚ç‚¹åˆ™ä¼šè·³å‡º</strong></p><p><strong>3.å¦‚æœæœ€åæ–°çš„èŠ‚ç‚¹æ›´å¤šï¼Œé‚£ä¹ˆå°±æ·»åŠ æ–°çš„èŠ‚ç‚¹</strong></p><p><strong>4.å¦‚æœæ—§çš„èŠ‚ç‚¹æ¯”è¾ƒå¤šï¼Œåˆ™ä¼šç§»é™¤æ—§çš„èŠ‚ç‚¹</strong></p><p><strong>5.å¦‚æœä¸­é—´å­˜åœ¨æ— åºçš„èŠ‚ç‚¹ï¼Œå°±é€šè¿‡keyå»ºç«‹æ‰€ç”¨é€”æœ€å¤§é™åº¦çš„å¤ç”¨æ—§èŠ‚ç‚¹</strong></p><h4 id="46-computed"><a href="#46-computed" class="headerlink" title="46.computed"></a>46.computed</h4><p>â€‹    computedæœ‰ç¼“å­˜ï¼Œåªæœ‰ä¾èµ–çš„å±æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ‰ä¼šé‡æ–°æ‰§è¡Œ</p><p>â€‹    computedå’Œmethodçš„åŒºåˆ«</p><p>â€‹            computedæ˜¯è®¡ç®—å±æ€§ï¼Œmethodæ˜¯æ–¹æ³•ï¼Œæ¯æ¬¡éƒ½ä¼šè°ƒç”¨ï¼Œcomputedåªæœ‰æ•°æ®å˜åŒ–æ—¶æ‰ä¼šè°ƒç”¨</p><p>â€‹    computedçš„get setå†™æ³•</p><p><img src="https://img1.imgtp.com/2022/08/16/u2w0mqRW.png" alt="QQæˆªå›¾20220806170911.png"></p><h4 id="47-watch"><a href="#47-watch" class="headerlink" title="47.watch"></a>47.watch</h4><p><img src="https://img1.imgtp.com/2022/08/16/c9HE9R2T.png" alt="QQæˆªå›¾20220807012240.png"></p><h2 id="å›è°ƒçš„è§¦å‘æ—¶æœº"><a href="#å›è°ƒçš„è§¦å‘æ—¶æœº" class="headerlink" title="å›è°ƒçš„è§¦å‘æ—¶æœº#"></a>å›è°ƒçš„è§¦å‘æ—¶æœº<a href="https://cn.vuejs.org/guide/essentials/watchers.html#callback-flush-timing">#</a></h2><p>å½“ä½ æ›´æ”¹äº†å“åº”å¼çŠ¶æ€ï¼Œå®ƒå¯èƒ½ä¼šåŒæ—¶è§¦å‘ Vue ç»„ä»¶æ›´æ–°å’Œä¾¦å¬å™¨å›è°ƒã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨æˆ·åˆ›å»ºçš„ä¾¦å¬å™¨å›è°ƒï¼Œéƒ½ä¼šåœ¨ Vue ç»„ä»¶æ›´æ–°<strong>ä¹‹å‰</strong>è¢«è°ƒç”¨ã€‚è¿™æ„å‘³ç€ä½ åœ¨ä¾¦å¬å™¨å›è°ƒä¸­è®¿é—®çš„ DOM å°†æ˜¯è¢« Vue æ›´æ–°ä¹‹å‰çš„çŠ¶æ€ã€‚</p><p>å¦‚æœæƒ³åœ¨ä¾¦å¬å™¨å›è°ƒä¸­èƒ½è®¿é—®è¢« Vue æ›´æ–°<strong>ä¹‹å</strong>çš„DOMï¼Œä½ éœ€è¦æŒ‡æ˜ <code>flush: &#39;post&#39;</code> é€‰é¡¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-comment">// ...</span>  <span class="hljs-attr">watch</span>: &#123;    <span class="hljs-attr">key</span>: &#123;      <span class="hljs-title function_">handler</span>(<span class="hljs-params"></span>) &#123;&#125;,      <span class="hljs-attr">flush</span>: <span class="hljs-string">&#x27;post&#x27;</span>    &#125;  &#125;&#125;</code></pre></div><h4 id="48-jsconfig-jsonä¸»è¦æ˜¯ç»™vscodeä¸­ç»™é¡¹ç›®æ›´å¥½çš„æç¤ºï¼Œæ²¡æœ‰ä¹Ÿæ²¡å…³ç³»"><a href="#48-jsconfig-jsonä¸»è¦æ˜¯ç»™vscodeä¸­ç»™é¡¹ç›®æ›´å¥½çš„æç¤ºï¼Œæ²¡æœ‰ä¹Ÿæ²¡å…³ç³»" class="headerlink" title="48.jsconfig.jsonä¸»è¦æ˜¯ç»™vscodeä¸­ç»™é¡¹ç›®æ›´å¥½çš„æç¤ºï¼Œæ²¡æœ‰ä¹Ÿæ²¡å…³ç³»"></a>48.jsconfig.jsonä¸»è¦æ˜¯ç»™vscodeä¸­ç»™é¡¹ç›®æ›´å¥½çš„æç¤ºï¼Œæ²¡æœ‰ä¹Ÿæ²¡å…³ç³»</h4><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//vue.config.js</span><span class="hljs-keyword">const</span> &#123; defineConfig &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@vue/cli-service&#x27;</span>)<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">defineConfig</span>(&#123;  <span class="hljs-attr">transpileDependencies</span>: <span class="hljs-literal">true</span>,  <span class="hljs-attr">configureWebpack</span>: &#123;    <span class="hljs-attr">resolve</span>: &#123;      <span class="hljs-comment">// é…ç½®è·¯å¾„åˆ«å</span>      <span class="hljs-comment">// @æ˜¯å·²ç»é…ç½®å¥½çš„è·¯å¾„åˆ«å: å¯¹åº”çš„æ˜¯srcè·¯å¾„</span>      <span class="hljs-attr">alias</span>: &#123;        <span class="hljs-string">&quot;utils&quot;</span>: <span class="hljs-string">&quot;@/utils&quot;</span>       &#125;    &#125;  &#125;&#125;)</code></pre></div><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-comment">//jsconfig.json</span><span class="hljs-punctuation">&#123;</span>  <span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;es5&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;esnext&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;baseUrl&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-comment">//å®šä¹‰æ ¹ç›®å½•</span>    <span class="hljs-attr">&quot;moduleResolution&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;node&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;paths&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>      <span class="hljs-attr">&quot;@/*&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>        <span class="hljs-string">&quot;src/*&quot;</span>      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>      <span class="hljs-comment">//webpacké…ç½®äº†åˆ«åï¼Œä¸ºäº†ç»™é¡¹ç›®ä¸­æ›´å¥½çš„æç¤ºï¼Œå¯ä»¥åœ¨è¿™é‡Œé…ç½®ï¼Œå¦åˆ™å†™çš„æ—¶å€™æ²¡æœ‰æç¤º</span>      <span class="hljs-attr">&quot;utils/*&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>        <span class="hljs-string">&quot;src/utils/*&quot;</span>      <span class="hljs-punctuation">]</span>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">&quot;lib&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>      <span class="hljs-string">&quot;esnext&quot;</span><span class="hljs-punctuation">,</span>      <span class="hljs-string">&quot;dom&quot;</span><span class="hljs-punctuation">,</span>      <span class="hljs-string">&quot;dom.iterable&quot;</span><span class="hljs-punctuation">,</span>      <span class="hljs-string">&quot;scripthost&quot;</span>    <span class="hljs-punctuation">]</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span></code></pre></div><h4 id="49-v-model"><a href="#49-v-model" class="headerlink" title="49.v-model"></a>49.v-model</h4><h4 id="50-ä½¿ç”¨æ‰‹è„šæ¶å¼€å‘"><a href="#50-ä½¿ç”¨æ‰‹è„šæ¶å¼€å‘" class="headerlink" title="50.ä½¿ç”¨æ‰‹è„šæ¶å¼€å‘"></a>50.ä½¿ç”¨æ‰‹è„šæ¶å¼€å‘</h4><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install @vue<span class="hljs-regexp">/cli -g   /</span>/å®‰è£…æ‰‹è„šæ¶<span class="hljs-built_in">npm</span> update @vue<span class="hljs-regexp">/cli -g /</span>/æ›´æ‰‹è„šæ¶Vue create é¡¹ç›®çš„åç§°è¿™ç§æ–¹å¼é‡‡ç”¨webpackä½œä¸ºæ„å»ºå·¥å…·ç°åœ¨å®˜æ–¹å·²ç»ä¸å†ä½œä¸ºæ¨èçš„æ‰‹è„šæ­å»ºå·¥å…·äº†å¼€å§‹ä½¿ç”¨<span class="hljs-built_in">npm</span> init vue@latest å‘½ä»¤  ä½¿ç”¨viteä½œä¸ºæ„å»ºå·¥å…·</code></pre></div><img src="https://img1.imgtp.com/2022/08/15/2VVktFIN.png" alt="å›¾ç‰‡1.png" style="zoom:200%;" /><img src="https://img1.imgtp.com/2022/08/15/QcWf8mgQ.png" alt="å›¾ç‰‡2.png" style="zoom:200%;" /><img src="https://img1.imgtp.com/2022/08/15/hS9wL3j1.png" alt="å›¾ç‰‡3.png" style="zoom:200%;" /><img src="https://img1.imgtp.com/2022/08/15/0QrTy1qq.png" alt="å›¾ç‰‡4.png" style="zoom:200%;" /><p><img src="https://img1.imgtp.com/2022/08/16/v3jDRHw7.png" alt="QQæˆªå›¾20220815210717.png"></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue/dist/vue.esm-bundler&quot;</span>;<span class="hljs-comment">// import App from &#x27;./App.vue&#x27;</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * å½“Appæ˜¯ä»¥å¯¹è±¡çš„å½¢å¼å†™çš„è¯å°±è¦ä½¿ç”¨ vue/dist/vue.esm-bundler</span><span class="hljs-comment"> * è¿™ä¸¤ç§æ–¹å¼çš„ä¸åŒï¼Œä½¿ç”¨å¯¹è±¡çš„æ–¹å¼ï¼Œæ˜¯å› ä¸ºå¦‚æœå¼•å…¥çš„æ˜¯vue,vueæ˜¯runtimeçš„ä»£ç ï¼Œï¼Œä¸ä¼šç¼–è¯‘templateæˆ</span><span class="hljs-comment"> * vnode,éœ€è¦ä½¿ç”¨vue/dist/vue.esm-bundler</span><span class="hljs-comment"> * é‡Œé¢åŒ…æ‹¬compiler+runtimeï¼Œå¯ä»¥å°†template-&gt;createVNode-&gt;Vnode-&gt;DOM,å¯¹è±¡çš„å†™æ³•æ˜¯ç”±</span><span class="hljs-comment"> * vue/dist/vue.esm-bundlerçš„æºç æ¥å®Œæˆçš„ï¼Œ.vueæ–‡ä»¶çš„å†™æ³•æ˜¯ç”±vue-loaderæ¥å®Œæˆtemplate-&gt;vnodeçš„è¿‡ç¨‹</span><span class="hljs-comment"> */</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span> = &#123;  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> &#123;&#125;;  &#125;,  <span class="hljs-attr">template</span>: <span class="hljs-string">`&lt;h1&gt;vue&lt;/h1&gt;`</span>,&#125;;<span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">mount</span>(<span class="hljs-string">&quot;#app&quot;</span>);</code></pre></div><h4 id="51-æ³¨å†Œç»„ä»¶çš„æ–¹å¼"><a href="#51-æ³¨å†Œç»„ä»¶çš„æ–¹å¼" class="headerlink" title="51.æ³¨å†Œç»„ä»¶çš„æ–¹å¼"></a>51.æ³¨å†Œç»„ä»¶çš„æ–¹å¼</h4><p>å…¨å±€ç»„ä»¶</p><p>å±€éƒ¨ç»„ä»¶</p><h4 id="52-çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®"><a href="#52-çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®" class="headerlink" title="52.çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®"></a>52.çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®</h4><p>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®æ˜¯é€šè¿‡propsæ¥å®Œæˆçš„</p><div class="code-wrapper"><pre><code class="hljs js">&lt;script&gt;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-comment">// å†™æ³•ä¸€</span>  <span class="hljs-comment">// props: [&quot;height&quot;, &quot;name&quot;, &quot;gender&quot;, &quot;width&quot;],</span>  <span class="hljs-comment">// å†™æ³•äºŒ</span>  <span class="hljs-comment">// props: &#123;</span>  <span class="hljs-comment">//   height: Object,</span>  <span class="hljs-comment">//   name: Number,</span>  <span class="hljs-comment">//   gender: String,</span>  <span class="hljs-comment">//   width: Number,</span>  <span class="hljs-comment">// &#125;,</span>  <span class="hljs-comment">// ç¬¬ä¸‰ç§å†™æ³•</span>  <span class="hljs-comment">// å½“é»˜è®¤å€¼æ˜¯å¯¹è±¡æˆ–è€…å‡½æ•°çš„æ—¶å€™ï¼Œå¿…é¡»è¿”å›ä¸€ä¸ªå‡½æ•°</span>  <span class="hljs-attr">props</span>: &#123;    <span class="hljs-attr">propsB</span>: &#123;      <span class="hljs-comment">// å½“propsæ˜¯ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œè¿™ä¸ªä¸æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªé»˜è®¤å€¼</span>      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Function</span>,      <span class="hljs-title function_">default</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;default&quot;</span>;      &#125;,    &#125;,    <span class="hljs-attr">h</span>: [<span class="hljs-title class_">Number</span>, <span class="hljs-title class_">String</span>], <span class="hljs-comment">//å¯ä»¥æ˜¯å¤šç§ç±»å‹</span>    <span class="hljs-attr">a</span>: &#123;      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,      <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//è¡¨ç¤ºæ˜¯å¿…å¡«å€¼</span>    &#125;,    <span class="hljs-attr">height</span>: &#123;      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,      <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> (&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;hhhh&quot;</span> &#125;),    &#125;,    <span class="hljs-attr">name</span>: &#123;      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,      <span class="hljs-attr">default</span>: <span class="hljs-string">&quot;æˆ‘æ˜¯string&quot;</span>,    &#125;,    <span class="hljs-attr">gender</span>: &#123;      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,      <span class="hljs-title function_">default</span>(<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">return</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];      &#125;,    &#125;,    <span class="hljs-attr">width</span>: &#123;      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,      <span class="hljs-attr">default</span>: <span class="hljs-number">88888</span>,    &#125;,  &#125;,&#125;;&lt;/script&gt;</code></pre></div><h5 id="propå¸¸è§çš„ä¸¤ç§ç”¨æ³•"><a href="#propå¸¸è§çš„ä¸¤ç§ç”¨æ³•" class="headerlink" title="propå¸¸è§çš„ä¸¤ç§ç”¨æ³•"></a>propå¸¸è§çš„ä¸¤ç§ç”¨æ³•</h5><p>å­—ç¬¦ä¸²æ•°ç»„ï¼Œå°±æ˜¯æ•°ç»„ä¸­çš„å­—ç¬¦ä¸²å°±æ˜¯attributeçš„åç§°ï¼Œä¼ é€’çš„æ•°æ®ç±»å‹æ—¶åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">show-info</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;why&quot;</span> <span class="hljs-attr">:age</span>=<span class="hljs-string">&quot;18&quot;</span> <span class="hljs-attr">:height</span>=<span class="hljs-string">&quot;1.88&quot;</span> </span><span class="hljs-tag">             <span class="hljs-attr">address</span>=<span class="hljs-string">&quot;å¹¿å·å¸‚&quot;</span> <span class="hljs-attr">abc</span>=<span class="hljs-string">&quot;cba&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;active&quot;</span> /&gt;</span>//ä¼ é€’çš„æ•°æ®ç±»å‹ä¸æ˜¯stringå€¼ï¼Œæ˜¯å…¶ä»–ç±»å‹æˆ–è€…æ˜¯å˜é‡ï¼Œå¿…é¡»ç”¨v-bind/:</code></pre></div><p>å¯¹è±¡ç±»å‹ï¼Œå¯¹è±¡ç±»å‹æˆ‘ä»¬å¯ä»¥æŒ‡å®šattributeåç§°æ—¶ï¼ŒæŒ‡å®šä¼ é€’ç±»å‹é»˜è®¤å€¼ï¼Œæ ¡éªŒç­‰</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">show-info</span> <span class="hljs-attr">:age</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">show-message</span>=<span class="hljs-string">&quot;å“ˆå“ˆå“ˆå“ˆ&quot;</span>/&gt;</span></code></pre></div><h5 id="propså…è®¸çš„æ•°æ®ç±»å‹"><a href="#propså…è®¸çš„æ•°æ®ç±»å‹" class="headerlink" title="propså…è®¸çš„æ•°æ®ç±»å‹"></a>propså…è®¸çš„æ•°æ®ç±»å‹</h5><p><code>String,Number,Boolean,Array,Object,Date,Function,Symbol</code></p><h5 id="propsçš„å‘½å"><a href="#propsçš„å‘½å" class="headerlink" title="propsçš„å‘½å"></a>propsçš„å‘½å</h5><p>htmlä¸­attributeåå¤§å°å†™ä¸æ•æ„Ÿï¼Œæ‰€ä»¥æµè§ˆå™¨ä¼šæŠŠæ‰€æœ‰å¤§å†™è§£é‡Šä¸ºå°å†™ï¼Œåœ¨æ¨¡æ¿ä¸­ä½¿ç”¨é©¼å³°è§„åˆ™ï¼Œçš„propåè¦å†™æˆçŸ­æ¨ªçº¿</p><h4 id="53-épropçš„attribute"><a href="#53-épropçš„attribute" class="headerlink" title="53.épropçš„attribute"></a>53.épropçš„attribute</h4><p>å½“æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªç»„ä»¶æŸä¸ªå±æ€§å€¼ï¼Œä½†æ˜¯è¿™ä¸ªå±æ€§å€¼æ²¡æœ‰å¯¹åº”çš„propså’Œemitsï¼Œå°±æ˜¯épropsçš„attributeï¼Œä¾‹å¦‚class,style,idç­‰ã€‚</p><p>å½“ç»„ä»¶æœ‰å•ä¸ªæ ¹èŠ‚ç‚¹æ—¶ï¼Œépropçš„attributeå°±ä¼šé»˜è®¤ç»‘å®šåˆ°æ ¹èŠ‚ç‚¹ä¸Š</p><p>å¦‚æœä¸å¸Œæœ›ç»‘å®šåˆ°æ ¹èŠ‚ç‚¹ï¼Œæƒ³è¦æ‰‹åŠ¨çš„ç»‘å®šèŠ‚ç‚¹ï¼Œå¯ä»¥åœ¨ç»„ä»¶ä¸­è®¾ç½®</p><div class="code-wrapper"><pre><code class="hljs vbnet"><span class="hljs-symbol">inheritAttr:</span><span class="hljs-literal">false</span></code></pre></div><p>å°±å¯ä»¥é€šè¿‡$attrsæ¥è®¿é—®æ‰€æœ‰çš„épropsçš„attribute</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;$attr.class&quot;</span>&gt;</span>hhhhhhhh<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><span class="language-javascript">    <span class="hljs-attr">inheritAttrs</span>:<span class="hljs-literal">false</span></span><span class="language-javascript">  &#125;</span></code></pre></div><p><strong>å¤šä¸ªæ ¹èŠ‚ç‚¹çš„attribute</strong></p><p>å¦‚æœæ˜¯å¤šä¸ªæ ¹èŠ‚ç‚¹çš„æƒ…å†µï¼Œå¤šä¸ªæ ¹èŠ‚ç‚¹çš„attributeå¦‚æœæ²¡æœ‰æ˜¾ç¤ºçš„ç»‘å®šï¼Œé‚£ä¹ˆä¼šæŠ¥è­¦å‘Šï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨çš„æŒ‡å®šè¦ç»‘å®šåˆ°å“ªä¸€ä¸ªå…ƒç´ ä¸Š</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">&quot;$attr&quot;</span>&gt;</span>hhhhhhhh<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>33333<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>4444<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><p><em>æ³¨æ„</em>templateæ¨¡æ¿ä¸­å…è®¸æœ‰å¤šä¸ªæ ¹èŠ‚ç‚¹</p><h4 id="54-å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä»ä¼ é€’æ•°æ®"><a href="#54-å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä»ä¼ é€’æ•°æ®" class="headerlink" title="54.å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä»ä¼ é€’æ•°æ®"></a>54.å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä»ä¼ é€’æ•°æ®</h4><div class="code-wrapper"><pre><code class="hljs html">//å­ç»„ä»¶<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;add&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;btnClick(1)&quot;</span>&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;btnClick(5)&quot;</span>&gt;</span>+5<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;btnClick(10)&quot;</span>&gt;</span>+10<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><span class="language-javascript">    <span class="hljs-comment">// 1.emitsæ•°ç»„è¯­æ³•</span></span><span class="language-javascript">    <span class="hljs-attr">emits</span>: [<span class="hljs-string">&quot;add&quot;</span>],</span><span class="language-javascript">    <span class="hljs-comment">// 2.emmitså¯¹è±¡è¯­æ³•</span></span><span class="language-javascript">    <span class="hljs-comment">// emits: &#123;</span></span><span class="language-javascript">    <span class="hljs-comment">//   add: function(count) &#123;</span></span><span class="language-javascript">    <span class="hljs-comment">//     if (count &lt;= 10) &#123;</span></span><span class="language-javascript">    <span class="hljs-comment">//       return true</span></span><span class="language-javascript">    <span class="hljs-comment">//     &#125;</span></span><span class="language-javascript">    <span class="hljs-comment">//     return false</span></span><span class="language-javascript">    <span class="hljs-comment">//   &#125;</span></span><span class="language-javascript">    <span class="hljs-comment">// &#125;,</span></span><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><span class="language-javascript">      <span class="hljs-title function_">btnClick</span>(<span class="hljs-params">count</span>) &#123;</span><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;btnClick:&quot;</span>, count)</span><span class="language-javascript">        <span class="hljs-comment">// è®©å­ç»„ä»¶å‘å‡ºå»ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶</span></span><span class="language-javascript">        <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå‚æ•°è‡ªå®šä¹‰çš„äº‹ä»¶åç§°</span></span><span class="language-javascript">        <span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ é€’çš„å‚æ•°</span></span><span class="language-javascript">        <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-number">100</span>)</span><span class="language-javascript">      &#125;</span><span class="language-javascript">    &#125;</span><span class="language-javascript">  &#125;</span><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs html">//app,vue<span class="hljs-tag">&lt;<span class="hljs-name">add-counter</span> @<span class="hljs-attr">add</span>=<span class="hljs-string">&quot;addBtnClick&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">add-counter</span>&gt;</span></code></pre></div><h4 id="55-æ’æ§½slot"><a href="#55-æ’æ§½slot" class="headerlink" title="55.æ’æ§½slot"></a>55.æ’æ§½slot</h4><p>æ’æ§½çš„ä½¿ç”¨è¿‡ç¨‹å…¶å®æ˜¯æŠ½å–å…±æ€§ã€é¢„ç•™ä¸åŒ</p><div class="code-wrapper"><pre><code class="hljs html">//show-message.vue//æ’æ§½çš„å®šä¹‰æ–¹å¼ï¼Œä½¿ç”¨<span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span>æ ‡ç­¾è¿›è¡Œå ä½ï¼Œå¯ä»¥å†™å…¥é»˜è®¤å€¼ï¼Œæ²¡æœ‰ä¼ é€’æ—¶å°±æ˜¯ç”¨é»˜è®¤å€¼<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯é»˜è®¤å†…å®¹, å“ˆå“ˆå“ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs html">//æ’æ§½çš„ä½¿ç”¨<span class="hljs-tag">&lt;<span class="hljs-name">show-message</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#&quot;</span>&gt;</span>ç™¾åº¦ä¸€ä¸‹<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">show-message</span>&gt;</span></code></pre></div><h4 id="56-å…·åæ’æ§½çš„ä½¿ç”¨"><a href="#56-å…·åæ’æ§½çš„ä½¿ç”¨" class="headerlink" title="56.å…·åæ’æ§½çš„ä½¿ç”¨"></a>56.å…·åæ’æ§½çš„ä½¿ç”¨</h4><p>å½“éœ€è¦æ’å…¥ä¸åŒçš„æ¨¡å—åˆ°ä¸åŒçš„slotçš„æ—¶å€™ï¼Œéœ€è¦å®šä¹‰å…·ä½“çš„åå­—ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸å¸¦åå­—æ—¶ï¼Œä¼šæœ‰é»˜è®¤çš„åå­—ã€‚</p><p>ä¸€ä¸ªä¸å¸¦ name çš„slotï¼Œä¼šå¸¦æœ‰éšå«çš„åå­— defaultï¼›</p><p>å…·åæ’æ§½ä½¿ç”¨çš„æ—¶å€™ç¼©å†™ï¼š</p><p>è·Ÿ v-on å’Œ v-bind ä¸€æ ·ï¼Œv-slot ä¹Ÿæœ‰ç¼©å†™ï¼› </p><p> å³æŠŠå‚æ•°ä¹‹å‰çš„æ‰€æœ‰å†…å®¹ (v-slot:) æ›¿æ¢ä¸ºå­—ç¬¦ #ï¼›</p><div class="code-wrapper"><pre><code class="hljs html">//nav-bar.vue<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-bar&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;left&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;left&quot;</span>&gt;</span>left<span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>center<span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;right&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;right&quot;</span>&gt;</span>right<span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;other&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;default&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs html">//App.vue<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">nav-bar</span>&gt;</span>  //ç®€å†™    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">left</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>&#123;&#123; leftText &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">center</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>//å®Œæ•´å†™æ³•    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot:right</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#&quot;</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">nav-bar</span>&gt;</span>  <span class="hljs-comment">&lt;!-- nav-baråªç»™ä¸€ä¸ªæ’æ§½ä¼ å…¥æ•°æ® --&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">nav-bar</span>&gt;</span>  //åŠ¨æ€æ’æ§½å    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot:</span>[<span class="hljs-attr">position</span>]&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#&quot;</span>&gt;</span>æ³¨å†Œ<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">nav-bar</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot; position = &#x27;left&#x27; &quot;</span>&gt;</span>å·¦è¾¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot; position = &#x27;center&#x27; &quot;</span>&gt;</span>ä¸­é—´<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot; position = &#x27;right&#x27; &quot;</span>&gt;</span>å³è¾¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">  <span class="hljs-keyword">import</span> <span class="hljs-title class_">NavBar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./NavBar.vue&#x27;</span></span><span class="language-javascript"></span><span class="language-javascript">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><span class="language-javascript">    <span class="hljs-attr">components</span>: &#123;</span><span class="language-javascript">      <span class="hljs-title class_">NavBar</span></span><span class="language-javascript">    &#125;,</span><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">      <span class="hljs-keyword">return</span> &#123;</span><span class="language-javascript">        <span class="hljs-attr">position</span>: <span class="hljs-string">&quot;center&quot;</span>,</span><span class="language-javascript">        <span class="hljs-attr">leftText</span>: <span class="hljs-string">&quot;è¿”å›&quot;</span></span><span class="language-javascript">      &#125;</span><span class="language-javascript">    &#125;</span><span class="language-javascript">  &#125;</span><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><h4 id="57-æ¸²æŸ“ä½œç”¨åŸŸ"><a href="#57-æ¸²æŸ“ä½œç”¨åŸŸ" class="headerlink" title="57.æ¸²æŸ“ä½œç”¨åŸŸ"></a>57.æ¸²æŸ“ä½œç”¨åŸŸ</h4><p>åœ¨vueæ¨¡æ¿ä¸­ï¼Œçˆ¶çº§æ¨¡æ¿çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯åœ¨çˆ¶çº§ä½œç”¨åŸŸä¸­ç¼–è¯‘å®Œæˆçš„</p><p>å­æ¨¡ç‰ˆä¸­æ‰€æœ‰å†…å®¹éƒ½æ˜¯åœ¨ä½œç”¨åŸŸä¸­ç¼–è¯‘å®Œæˆçš„ï¼Œæ‰€ä»¥å…·åæ’æ§½çš„ä½œç”¨åŸŸæ˜¯åœ¨çˆ¶çº§ï¼Œè€Œä½œç”¨åŸŸæ’æ§½çš„ä½œç”¨åŸŸæ˜¯åœ¨å­æ¨¡ç‰ˆä¸­</p><h4 id="58-ä½œç”¨åŸŸæ’æ§½"><a href="#58-ä½œç”¨åŸŸæ’æ§½" class="headerlink" title="58.ä½œç”¨åŸŸæ’æ§½"></a>58.ä½œç”¨åŸŸæ’æ§½</h4><p>ä½œç”¨åŸŸæ’æ§½å¯ä»¥é€šè¿‡æ’æ§½è®¿é—®å­ç»„ä»¶çš„å†…å®¹ï¼Œè€Œä¿®æ”¹æ¯ä¸ªå…·ä½“çš„æ ·å¼</p><div class="code-wrapper"><pre><code class="hljs html">//tabControll.vue<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;tab-control&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(item, index) in titles&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;tab-control-item&quot;</span></span><span class="hljs-tag">           <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;&#123; active: index === currentIndex &#125;&quot;</span></span><span class="hljs-tag">           @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;itemClick(index)&quot;</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">:item</span>=<span class="hljs-string">&quot;item&quot;</span> <span class="hljs-attr">abc</span>=<span class="hljs-string">&quot;cba&quot;</span>&gt;</span>          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;&#123; item &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>//è¿™æ˜¯é»˜è®¤å€¼        <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs html">//App.vue<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 1.tab-control --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">tab-control</span> <span class="hljs-attr">:titles</span>=<span class="hljs-string">&quot;[&#x27;è¡£æœ&#x27;, &#x27;é‹å­&#x27;, &#x27;è£¤å­&#x27;]&quot;</span> </span><span class="hljs-tag">                 @<span class="hljs-attr">tab-item-click</span>=<span class="hljs-string">&quot;tabItemClick&quot;</span>/&gt;</span>    <span class="hljs-comment">&lt;!-- &lt;tab-control :titles=&quot;[&#x27;æµè¡Œ&#x27;, &#x27;æœ€æ–°&#x27;, &#x27;ä¼˜é€‰&#x27;]&quot;/&gt; --&gt;</span>    <span class="hljs-comment">&lt;!-- 2.å±•ç¤ºå†…å®¹ --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;&#123; pageContents[currentIndex] &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 1.tab-control: button --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">tab-control</span> <span class="hljs-attr">:titles</span>=<span class="hljs-string">&quot;[&#x27;è¡£æœ&#x27;, &#x27;é‹å­&#x27;, &#x27;è£¤å­&#x27;]&quot;</span> </span><span class="hljs-tag">                 @<span class="hljs-attr">tab-item-click</span>=<span class="hljs-string">&quot;tabItemClick&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot:default</span>=<span class="hljs-string">&quot;props&quot;</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>&#123;&#123; props.item &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">tab-control</span>&gt;</span>        <span class="hljs-comment">&lt;!-- 2.tab-control: aå…ƒç´ (é‡è¦) --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">tab-control</span> <span class="hljs-attr">:titles</span>=<span class="hljs-string">&quot;[&#x27;è¡£æœ&#x27;, &#x27;é‹å­&#x27;, &#x27;è£¤å­&#x27;]&quot;</span> </span><span class="hljs-tag">                 @<span class="hljs-attr">tab-item-click</span>=<span class="hljs-string">&quot;tabItemClick&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">&quot;props&quot;</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#&quot;</span>&gt;</span>&#123;&#123; props.item &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">tab-control</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 3.ç‹¬å é»˜è®¤æ’æ§½çš„ç®€å†™(äº†è§£) --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">tab-control</span> <span class="hljs-attr">:titles</span>=<span class="hljs-string">&quot;[&#x27;è¡£æœ&#x27;, &#x27;é‹å­&#x27;, &#x27;è£¤å­&#x27;]&quot;</span> </span><span class="hljs-tag">                 @<span class="hljs-attr">tab-item-click</span>=<span class="hljs-string">&quot;tabItemClick&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot</span>=<span class="hljs-string">&quot;props&quot;</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>&#123;&#123; props.item &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">tab-control</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 4.å¦‚æœåªæœ‰ä¸€ä¸ªé»˜è®¤æ’æ§½, é‚£ä¹ˆtemplateå¯ä»¥çœç•¥ --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">tab-control</span> <span class="hljs-attr">:titles</span>=<span class="hljs-string">&quot;[&#x27;è¡£æœ&#x27;, &#x27;é‹å­&#x27;, &#x27;è£¤å­&#x27;]&quot;</span> </span><span class="hljs-tag">                 @<span class="hljs-attr">tab-item-click</span>=<span class="hljs-string">&quot;tabItemClick&quot;</span></span><span class="hljs-tag">                 <span class="hljs-attr">v-slot</span>=<span class="hljs-string">&quot;props&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>&#123;&#123; props.item &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">tab-control</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><h4 id="59-éçˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡"><a href="#59-éçˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡" class="headerlink" title="59.éçˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡"></a>59.éçˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡</h4><p>1.å…¨å±€çš„äº‹ä»¶æ€»çº¿</p><p>vue3ä¸­ç§»é™¤äº†$on,$off,$onceæ–¹æ³•ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨äº‹ä»¶æ€»çº¿ï¼Œå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œæˆ–è€…é€šè¿‡è‡ªå·±å†™çš„äº‹ä»¶æ€»çº¿æ–¹æ³•ã€‚äº‹ä»¶æ€»çº¿ä¸ç»å¯ä»¥ç”¨äºéçˆ¶å­ç»„ä»¶çš„é€šä¿¡ï¼Œä¹Ÿå¯ä»¥ç”¨äºä»»æ„ç»„ä»¶çš„é€šä¿¡</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//event-bus.js  äº‹ä»¶æ€»çº¿åˆå§‹åŒ–</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">HYEventBus</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;hy-event-store&#x27;</span><span class="hljs-keyword">const</span> eventBus = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HYEventBus</span>()<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> eventBus</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//App.vue   åœ¨createdå£°æ˜å‘¨æœŸä¸­ç›‘å¬äº‹ä»¶</span><span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-comment">// fetch()</span>      <span class="hljs-comment">// äº‹ä»¶ç›‘å¬</span>      eventBus.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;whyEvent&quot;</span>, <span class="hljs-function">(<span class="hljs-params">name, age, height</span>) =&gt;</span> &#123;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;whyEventäº‹ä»¶åœ¨appä¸­ç›‘å¬&quot;</span>, name, age, height)        <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">`name:<span class="hljs-subst">$&#123;name&#125;</span>, age:<span class="hljs-subst">$&#123;age&#125;</span>, height:<span class="hljs-subst">$&#123;height&#125;</span>`</span>      &#125;)    &#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//åœ¨Category.vueä¸­ createdä¸­ç›‘å¬ï¼Œåœ¨unmountedä¸­ç§»å‡ºäº‹ä»¶</span><span class="hljs-keyword">import</span> eventBus <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./utils/event-bus&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">methods</span>: &#123;    <span class="hljs-title function_">whyEventHandler</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;whyEventåœ¨categoryä¸­ç›‘å¬&quot;</span>)    &#125;  &#125;,  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;    eventBus.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;whyEvent&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">whyEventHandler</span>)  &#125;,  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;category unmounted&quot;</span>)    eventBus.<span class="hljs-title function_">off</span>(<span class="hljs-string">&quot;whyEvent&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">whyEventHandler</span>)  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//HomeBanner.vue  emitäº‹ä»¶</span><span class="hljs-keyword">import</span> eventBus <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./utils/event-bus&#x27;</span> <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;   <span class="hljs-attr">methods</span>: &#123;     <span class="hljs-title function_">bannerBtnClick</span>(<span class="hljs-params"></span>) &#123;       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;bannerBtnClick&quot;</span>)       eventBus.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;whyEvent&quot;</span>, <span class="hljs-string">&quot;why&quot;</span>, <span class="hljs-number">18</span>, <span class="hljs-number">1.88</span>)     &#125;   &#125; &#125;</code></pre></div><p>2.Provide/inject</p><p>provideå’Œinjectå¯ä»¥ç”¨äºè·¨ç»„ä»¶çš„é€šä¿¡</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//App.vue</span><span class="hljs-comment">// provideä¸€èˆ¬éƒ½æ˜¯å†™æˆå‡½æ•° ä¹Ÿå¯ä»¥å†™æˆå¯¹è±¡ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨dataä¸­çš„å±æ€§ï¼Œå¿…é¡»ä½¿ç”¨å‡½æ•°å½¢å¼</span>   <span class="hljs-title function_">provide</span>(<span class="hljs-params"></span>) &#123;     <span class="hljs-keyword">return</span> &#123;       <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;why&quot;</span>,       <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,       <span class="hljs-comment">//é»˜è®¤ä¸æ˜¯å“åº”å¼çš„ï¼Œå¦‚æœéœ€è¦å˜æˆå“åº”å¼çš„ï¼Œè¦ä½¿ç”¨computedï¼Œcomputedçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªrefå¯¹è±¡ï¼Œéœ€è¦ä½¿ç”¨.valueæ¥è·å–</span>       <span class="hljs-attr">message</span>: <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)<span class="hljs-comment">//è¦å†™ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°çš„thisæ˜¯ç”±ä¸Šå±‚ä½œç”¨åŸŸæ¥å†³å®šçš„</span>     &#125;   &#125; &#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs vue">&lt;template&gt;  &lt;div class=&quot;banner&quot;&gt;    &lt;h2&gt;HomeBanner: &#123;&#123; name &#125;&#125; - &#123;&#123; age &#125;&#125; - &#123;&#123;message.value&#125;&#125;&lt;/h2&gt;  &lt;/div&gt;&lt;/template&gt;&lt;script&gt;  export default &#123;    inject: [&quot;name&quot;, &quot;age&quot;, &quot;message&quot;]  &#125;&lt;/script&gt;</code></pre></div><h4 id="60-ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#60-ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="60.ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"></a>60.ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h4><p><img src="https://img1.imgtp.com/2022/08/17/Lqxt3NMi.png" alt="lifecycle.16e4c08e.png"></p><p>çˆ¶å­ç»„ä»¶çš„æŒ‚è½½è¿‡ç¨‹</p><p>çˆ¶ç»„ä»¶beforeCreate -&gt;çˆ¶ç»„ä»¶created-&gt;çˆ¶ç»„ä»¶beforemount-&gt;å­ç»„ä»¶beforeCreate-&gt;å­ç»„ä»¶created-&gt; å­ç»„ä»¶beforeMount-&gt;å­ç»„ä»¶mounted-&gt;çˆ¶ç»„ä»¶mounted</p><h4 id="61-refsçš„ä½¿ç”¨"><a href="#61-refsçš„ä½¿ç”¨" class="headerlink" title="61.$refsçš„ä½¿ç”¨"></a>61.$refsçš„ä½¿ç”¨</h4><p>é€šè¿‡$refså¯ä»¥è·å–åˆ°å­å…ƒç´ æˆ–è€…å­ç»„ä»¶</p><p>é€šè¿‡<code>this.$refs.refName</code>å¯ä»¥è·å–åˆ°å­ç»„ä»¶å®ä¾‹ï¼Œå­ç»„ä»¶å®ä¾‹æ˜¯ä¸€ä¸ªProxyä»£ç†ï¼Œvueç»„ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»ä¼¼äºä¸€ä¸ªclassï¼Œæ ¹æ®classåˆ›å»ºä¸€ä¸ªç»„ä»¶å®ä¾‹ï¼Œé€šè¿‡<code>this.$refs.refname.$el</code>å¯ä»¥è·å–åˆ°ç»„ä»¶DOMå…ƒç´ ã€‚ï¼Œ<code>this.$parent</code>è·å–åˆ°çˆ¶ç»„ä»¶å…ƒç´ ï¼Œ<code>this.$root</code>è·å–åˆ°æ ¹ç»„ä»¶å…ƒç´ ï¼Œ$refè¿˜å¯ä»¥è°ƒç”¨å­ç»„ä»¶çš„å±æ€§å’Œæ–¹æ³•åœ¨Vue3ä¸­å·²ç»ç§»é™¤äº†$childrençš„å±æ€§</p><p>å¦‚æœtemplateä¸­ç”±å¤šä¸ªæ ¹ï¼Œæ‹¿åˆ°çš„æ˜¯ç¬¬ä¸€ä¸ªnodeèŠ‚ç‚¹</p><p><img src="https://img1.imgtp.com/2022/08/17/RTih8iQq.png" alt="QQæˆªå›¾20220817150027.png"></p><h4 id="62-åŠ¨æ€ç»„ä»¶"><a href="#62-åŠ¨æ€ç»„ä»¶" class="headerlink" title="62.åŠ¨æ€ç»„ä»¶"></a>62.åŠ¨æ€ç»„ä»¶</h4><p>isä¸­çš„ç»„ä»¶åªèƒ½æ˜¯å±€éƒ¨å·²æ³¨å†Œçš„ç»„ä»¶å’Œå…¨å±€ç»„ä»¶</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;why&quot;</span> </span><span class="hljs-tag">                 <span class="hljs-attr">:age</span>=<span class="hljs-string">&quot;18&quot;</span></span><span class="hljs-tag">                 @<span class="hljs-attr">homeClick</span>=<span class="hljs-string">&quot;homeClick&quot;</span></span><span class="hljs-tag">                 <span class="hljs-attr">:is</span>=<span class="hljs-string">&quot;currentTab&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span></code></pre></div><h4 id="63-ç»„ä»¶ç¼“å­˜keep-alive"><a href="#63-ç»„ä»¶ç¼“å­˜keep-alive" class="headerlink" title="63.ç»„ä»¶ç¼“å­˜keep-alive"></a>63.ç»„ä»¶ç¼“å­˜keep-alive</h4><p>å¦‚æœç»„ä»¶é¢‘ç¹çš„åˆ‡æ¢ä¼šé€ æˆæ€§èƒ½æ¶ˆè€—å¢åŠ ï¼Œå¦‚æœéœ€è¦ä¿å­˜ç»„ä»¶åˆ‡æ¢ä¹‹å‰çš„çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨keep-aliveï¼Œä»–é€šå¸¸å’ŒComponentåŠ¨æ€ç»„ä»¶ä¸€èµ·ä½¿ç”¨</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;view&quot;</span>&gt;</span>      <span class="hljs-comment">&lt;!-- include: ç»„ä»¶çš„åç§°æ¥è‡ªäºç»„ä»¶å†…éƒ¨å®šä¹‰æ—¶nameé€‰é¡¹  --&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span> <span class="hljs-attr">include</span>=<span class="hljs-string">&quot;home,about&quot;</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">&quot;currentTab&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><h5 id="include-exclude"><a href="#include-exclude" class="headerlink" title="include/exclude"></a>include/exclude</h5><p><code>&lt;KeepAlive&gt;</code> é»˜è®¤ä¼šç¼“å­˜å†…éƒ¨çš„æ‰€æœ‰ç»„ä»¶å®ä¾‹ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>include</code> å’Œ <code>exclude</code> prop æ¥å®šåˆ¶è¯¥è¡Œä¸ºã€‚è¿™ä¸¤ä¸ª prop çš„å€¼éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªä»¥è‹±æ–‡é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ã€ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæˆ–æ˜¯åŒ…å«è¿™ä¸¤ç§ç±»å‹çš„ä¸€ä¸ªæ•°ç»„ï¼š</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- ä»¥è‹±æ–‡é€—å·åˆ†éš”çš„å­—ç¬¦ä¸² --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">include</span>=<span class="hljs-string">&quot;a,b&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">&quot;view&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span><span class="hljs-comment">&lt;!-- æ­£åˆ™è¡¨è¾¾å¼ (éœ€ä½¿ç”¨ `v-bind`) --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">:include</span>=<span class="hljs-string">&quot;/a|b/&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">&quot;view&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span><span class="hljs-comment">&lt;!-- æ•°ç»„ (éœ€ä½¿ç”¨ `v-bind`) --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">:include</span>=<span class="hljs-string">&quot;[&#x27;a&#x27;, &#x27;b&#x27;]&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">&quot;view&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span></code></pre></div><p>å®ƒä¼šæ ¹æ®ç»„ä»¶çš„ <a href="https://cn.vuejs.org/api/options-misc.html#name"><code>name</code></a> é€‰é¡¹è¿›è¡ŒåŒ¹é…ï¼Œæ‰€ä»¥ç»„ä»¶å¦‚æœæƒ³è¦æ¡ä»¶æ€§åœ°è¢« <code>KeepAlive</code> ç¼“å­˜ï¼Œå°±å¿…é¡»æ˜¾å¼å£°æ˜ä¸€ä¸ª <code>name</code> é€‰é¡¹</p><p><em>TIP</em></p><p><em>åœ¨ 3.2.34 æˆ–ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨ <code>&lt;script setup&gt;</code> çš„å•æ–‡ä»¶ç»„ä»¶ä¼šè‡ªåŠ¨æ ¹æ®æ–‡ä»¶åç”Ÿæˆå¯¹åº”çš„ <code>name</code> é€‰é¡¹ï¼Œæ— éœ€å†æ‰‹åŠ¨å£°æ˜ã€‚</em></p><h5 id="æœ€å¤§ç¼“å­˜å®ä¾‹æ•°-https-cn-vuejs-org-guide-built-ins-keep-alive-html-max-cached-instances"><a href="#æœ€å¤§ç¼“å­˜å®ä¾‹æ•°-https-cn-vuejs-org-guide-built-ins-keep-alive-html-max-cached-instances" class="headerlink" title="æœ€å¤§ç¼“å­˜å®ä¾‹æ•°[#](https://cn.vuejs.org/guide/built-ins/keep-alive.html#max-cached-instances"></a>æœ€å¤§ç¼“å­˜å®ä¾‹æ•°[#](<a href="https://cn.vuejs.org/guide/built-ins/keep-alive.html#max-cached-instances">https://cn.vuejs.org/guide/built-ins/keep-alive.html#max-cached-instances</a></h5><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥ <code>max</code> prop æ¥é™åˆ¶å¯è¢«ç¼“å­˜çš„æœ€å¤§ç»„ä»¶å®ä¾‹æ•°ã€‚<code>&lt;KeepAlive&gt;</code> çš„è¡Œä¸ºåœ¨æŒ‡å®šäº† <code>max</code> åç±»ä¼¼ä¸€ä¸ª <a href="https://en.wikipedia.org/wiki/Cache_replacement_policies#Least_recently_used_(LRU)">LRU ç¼“å­˜</a>ï¼šå¦‚æœç¼“å­˜çš„å®ä¾‹æ•°é‡å³å°†è¶…è¿‡æŒ‡å®šçš„é‚£ä¸ªæœ€å¤§æ•°é‡ï¼Œåˆ™æœ€ä¹…æ²¡æœ‰è¢«è®¿é—®çš„ç¼“å­˜å®ä¾‹å°†è¢«é”€æ¯ï¼Œä»¥ä¾¿ä¸ºæ–°çš„å®ä¾‹è…¾å‡ºç©ºé—´ã€‚</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">:max</span>=<span class="hljs-string">&quot;10&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">&quot;activeComponent&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span></code></pre></div><p>ç¼“å­˜å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸ</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">activated</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// åœ¨é¦–æ¬¡æŒ‚è½½ã€</span>    <span class="hljs-comment">// ä»¥åŠæ¯æ¬¡ä»ç¼“å­˜ä¸­è¢«é‡æ–°æ’å…¥çš„æ—¶å€™è°ƒç”¨</span>  &#125;,  <span class="hljs-title function_">deactivated</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// åœ¨ä» DOM ä¸Šç§»é™¤ã€è¿›å…¥ç¼“å­˜</span>    <span class="hljs-comment">// ä»¥åŠç»„ä»¶å¸è½½æ—¶è°ƒç”¨</span>  &#125;&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°å¯è¿‡æœŸçš„localstorageæ•°æ®(ä»…ä¾›å‚è€ƒ)</title>
    <link href="/2022/08/15/%E5%AE%9E%E7%8E%B0%E5%8F%AF%E8%BF%87%E6%9C%9F%E7%9A%84localstorage%E6%95%B0%E6%8D%AE/"/>
    <url>/2022/08/15/%E5%AE%9E%E7%8E%B0%E5%8F%AF%E8%BF%87%E6%9C%9F%E7%9A%84localstorage%E6%95%B0%E6%8D%AE/</url>
    
    <content type="html"><![CDATA[<p>localstorageç›¸å¯¹äºcookieä¸­çš„é—®é¢˜æ˜¯ä¸èƒ½è®¾ç½®è¿‡æœŸæ—¶é—´</p><p>æ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±å¯¹localStorageè¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œä½¿å¾—localstorageåœ¨é€‚å½“çš„æ—¶é—´å¤±æ•ˆ</p><h4 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&quot;key&quot;</span>, <span class="hljs-string">&quot;value&quot;</span>);<span class="hljs-keyword">const</span> timeout = <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span>;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">&quot;key&quot;</span>);&#125;, timeout);</code></pre></div><p>è¿™ç§æ–¹å¼éœ€è¦ç¼–å†™å¤šä¸ªå®šæ—¶å™¨ï¼Œç»´æŠ¤æˆæœ¬é«˜ï¼Œä¸åˆ©äºä»£ç çš„å¤ç”¨</p><h4 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h4><ol><li>ç”¨<strong>ã€ŒlocalStorageã€</strong>å­˜ä¸€ä»½{key(é”®): expire(è¿‡æœŸæ—¶é—´)}çš„æ˜ å°„è¡¨</li><li>é‡å†™<strong>ã€ŒlocalStorage APIã€</strong>, å¯¹æ–¹æ³•è¿›è¡ŒäºŒæ¬¡å°è£…</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> store = &#123;  <span class="hljs-title function_">setExpireMap</span>(<span class="hljs-params">key, expire</span>) &#123;    <span class="hljs-keyword">const</span> expireMap = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&quot;EXPIRE_MAP&quot;</span>) || &#123;&#125;;    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(      <span class="hljs-string">&quot;EXPIRE_MAP&quot;</span>,      <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;        ...expireMap,        [key]: expire,      &#125;)    );  &#125;,  <span class="hljs-title function_">setItem</span>(<span class="hljs-params">key, value, expire</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setExpireMap</span>(key, expire);    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, value);  &#125;,  <span class="hljs-title function_">getItem</span>(<span class="hljs-params">key</span>) &#123;    <span class="hljs-keyword">const</span> expireMap = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&quot;EXPIRE_MAP&quot;</span>))[key];    <span class="hljs-keyword">if</span> (expireMap &amp;&amp; expireMap &gt; <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);    &#125;    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key);    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  &#125;,&#125;;</code></pre></div><ul><li>å¯¹ <code>store</code> æ“ä½œæ—¶éœ€è¦ç»´æŠ¤2ä»½æ•°æ®, å¹¶ä¸”å ç”¨ç¼“å­˜ç©ºé—´</li><li>å¦‚æœ <code>EXPIRE_MAP</code> è¯¯åˆ é™¤å°†ä¼šå¯¼è‡´æ‰€æœ‰è¿‡æœŸæ—¶é—´å¤±æ•ˆ</li><li>å¯¹æ“ä½œè¿‡ç¨‹ç¼ºå°‘æ›´çµæ´»çš„æ§åˆ¶(æ¯”å¦‚æ“ä½œçŠ¶æ€, æ“ä½œå›è°ƒç­‰)</li></ul><h4 id="è§£æ³•ä¸‰"><a href="#è§£æ³•ä¸‰" class="headerlink" title="è§£æ³•ä¸‰"></a>è§£æ³•ä¸‰</h4><p>æƒ°æ€§åˆ é™¤ï¼Œåªæœ‰åœ¨ä¸‹ä¸€æ¬¡å–å€¼çš„æ—¶å€™æ‰åˆ é™¤</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> lsc = (<span class="hljs-keyword">function</span> (<span class="hljs-params">self</span>) &#123;    <span class="hljs-keyword">var</span> prefix = <span class="hljs-string">&#x27;one_more_lsc_&#x27;</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å¢åŠ ä¸€ä¸ªé”®å€¼å¯¹æ•°æ®</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key é”®</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> val å€¼</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> expires è¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºç§’</span><span class="hljs-comment">     */</span>    self.<span class="hljs-property">set</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">key, val, expires</span>) &#123;        key = prefix + key;        val = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<span class="hljs-string">&#x27;val&#x27;</span>: val, <span class="hljs-string">&#x27;expires&#x27;</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>() + expires * <span class="hljs-number">1000</span>&#125;);        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, val);    &#125;;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è¯»å–å¯¹åº”é”®çš„å€¼æ•°æ®</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key é”®</span><span class="hljs-comment">     * <span class="hljs-doctag">@returns</span> &#123;<span class="hljs-type">null|*</span>&#125; å¯¹åº”é”®çš„å€¼</span><span class="hljs-comment">     */</span>    self.<span class="hljs-property">get</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) &#123;        key = prefix + key;        <span class="hljs-keyword">var</span> val = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);        <span class="hljs-keyword">if</span> (!val) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;        &#125;        val = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(val);        <span class="hljs-keyword">if</span> (val.<span class="hljs-property">expires</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>()) &#123;            <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key);            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;        &#125;        <span class="hljs-keyword">return</span> val.<span class="hljs-property">val</span>;    &#125;;    <span class="hljs-keyword">return</span> self;&#125;(lsc || &#123;&#125;));</code></pre></div><p>ä¸Šè¿°ä»£ç é€šè¿‡æƒ°æ€§åˆ é™¤å·²ç»å®ç°äº†å¯è¿‡æœŸçš„localStorageç¼“å­˜ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ¯”è¾ƒæ˜æ˜¾çš„ç¼ºç‚¹ï¼šå¦‚æœä¸€ä¸ªkeyä¸€ç›´æ²¡æœ‰è¢«ç”¨åˆ°ï¼Œå³ä½¿å®ƒå·²ç»è¿‡æœŸäº†ä¹Ÿæ°¸è¿œå­˜æ”¾åœ¨localStorageã€‚ä¸ºäº†å¼¥è¡¥è¿™æ ·ç¼ºç‚¹ï¼Œæˆ‘ä»¬å¼•å…¥å¦ä¸€ç§æ¸…ç†è¿‡æœŸç¼“å­˜çš„ç­–ç•¥ã€‚</p><h4 id="è§£æ³•å››"><a href="#è§£æ³•å››" class="headerlink" title="è§£æ³•å››"></a>è§£æ³•å››</h4><h3 id="å®šæ—¶åˆ é™¤"><a href="#å®šæ—¶åˆ é™¤" class="headerlink" title="å®šæ—¶åˆ é™¤"></a>å®šæ—¶åˆ é™¤</h3><p>å®šæ—¶åˆ é™¤æ˜¯æŒ‡ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ¬¡åˆ é™¤æ“ä½œï¼Œå¹¶é€šè¿‡é™åˆ¶åˆ é™¤æ“ä½œæ‰§è¡Œçš„æ¬¡æ•°å’Œé¢‘ç‡ï¼Œæ¥å‡å°‘åˆ é™¤æ“ä½œå¯¹CPUçš„é•¿æœŸå ç”¨ã€‚å¦ä¸€æ–¹é¢å®šæ—¶åˆ é™¤ä¹Ÿæœ‰æ•ˆçš„å‡å°‘äº†å› æƒ°æ€§åˆ é™¤å¸¦æ¥çš„å¯¹localStorageç©ºé—´çš„æµªè´¹ã€‚</p><p>æ¯éš”ä¸€ç§’æ‰§è¡Œä¸€æ¬¡å®šæ—¶åˆ é™¤ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p><ol><li>éšæœºæµ‹è¯•20ä¸ªè®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyã€‚</li><li>åˆ é™¤æ‰€æœ‰å‘ç°çš„å·²è¿‡æœŸçš„keyã€‚</li><li>è‹¥åˆ é™¤çš„keyè¶…è¿‡5ä¸ªåˆ™é‡å¤<strong>æ­¥éª¤1</strong>ï¼Œç›´è‡³é‡å¤500æ¬¡ã€‚</li></ol><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> lsc = (<span class="hljs-keyword">function</span> (<span class="hljs-params">self</span>) &#123;    <span class="hljs-keyword">var</span> prefix = <span class="hljs-string">&#x27;one_more_lsc_&#x27;</span>    <span class="hljs-keyword">var</span> list = [];    <span class="hljs-comment">//åˆå§‹åŒ–list</span>    self.<span class="hljs-property">init</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">var</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>);        <span class="hljs-keyword">var</span> reg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;^&#x27;</span> + prefix);        <span class="hljs-keyword">var</span> temp = [];        <span class="hljs-comment">//éå†æ‰€æœ‰localStorageä¸­çš„æ‰€æœ‰key</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) &#123;        <span class="hljs-comment">//æ‰¾å‡ºå¯è¿‡æœŸç¼“å­˜çš„key</span>            <span class="hljs-keyword">if</span> (reg.<span class="hljs-title function_">test</span>(keys[i])) &#123;                temp.<span class="hljs-title function_">push</span>(keys[i]);            &#125;        &#125;        list = temp;    &#125;;    self.<span class="hljs-title function_">init</span>();    self.<span class="hljs-property">check</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;        <span class="hljs-keyword">if</span> (!list || list.<span class="hljs-property">length</span> == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">var</span> checkCount = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (checkCount &lt; <span class="hljs-number">500</span>) &#123;            <span class="hljs-keyword">var</span> expireCount = <span class="hljs-number">0</span>;            <span class="hljs-comment">//éšæœºæµ‹è¯•20ä¸ªè®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„key</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">20</span>; i++) &#123;                <span class="hljs-keyword">if</span> (list.<span class="hljs-property">length</span> == <span class="hljs-number">0</span>) &#123;                    <span class="hljs-keyword">break</span>;                &#125;                <span class="hljs-keyword">var</span> index = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * list.<span class="hljs-property">length</span>);                <span class="hljs-keyword">var</span> key = list[index];                <span class="hljs-keyword">var</span> val = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(list[index]);                <span class="hljs-comment">//ä»listä¸­åˆ é™¤è¢«æƒ°æ€§åˆ é™¤çš„key</span>                <span class="hljs-keyword">if</span> (!val) &#123;                    list.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);                    expireCount++;                    <span class="hljs-keyword">continue</span>;                &#125;                val = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(val);                <span class="hljs-comment">//åˆ é™¤æ‰€æœ‰å‘ç°çš„å·²è¿‡æœŸçš„key</span>                <span class="hljs-keyword">if</span> (val.<span class="hljs-property">expires</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>()) &#123;                    list.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);                    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key);                    expireCount++;                &#125;            &#125;            <span class="hljs-comment">//è‹¥åˆ é™¤çš„keyä¸è¶…è¿‡5ä¸ªåˆ™è·³å‡ºå¾ªç¯</span>            <span class="hljs-keyword">if</span> (expireCount &lt;= <span class="hljs-number">5</span> || list.<span class="hljs-property">length</span> == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">break</span>;            &#125;            checkCount++;        &#125;    &#125;    <span class="hljs-comment">//æ¯éš”ä¸€ç§’æ‰§è¡Œä¸€æ¬¡å®šæ—¶åˆ é™¤</span>    <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setInterval</span>(self.<span class="hljs-property">check</span>, <span class="hljs-number">1000</span>);    <span class="hljs-keyword">return</span> self;&#125;(lsc || &#123;&#125;));</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>javascript</category>
      
      <category>æœé›†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯ç³»ç»Ÿè¯¾ç¬”è®°</title>
    <link href="/2022/08/14/%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/08/14/%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre><code class="hljs stata">1.margin-leftçš„å€¼å¦‚æœæ˜¯ç™¾åˆ†æ¯”æ—¶ï¼Œç›¸å¯¹äºä»–çš„åŒ…å«å—çš„å®½åº¦çš„ç™¾åˆ†æ¯”ï¼Œå³ä»–çš„çˆ¶å…ƒç´ 2.æ€§èƒ½ä¼˜åŒ–ç‚¹ï¼šlink ref=`dns-prefetch`dnsé¢„è·å–ï¼Œåœ¨èµ„æºåŠ è½½ä¹‹å‰è·å–åˆ°çœŸå®çš„ipåœ°å€3.rgb Rçº¢ <span class="hljs-keyword">G</span>ç»¿ Bè“  \#ff0000 åå…­è¿›åˆ¶è¡¨ç¤ºæ³•  rgb(0ï¼Œ0ï¼Œ0) åè¿›åˆ¶è¡¨ç¤º4.image/vedioæ˜¯è¡Œå†…å¯æ›¿æ¢å…ƒç´ ï¼Œä¸æ˜¯è¡Œå†…å—çº§å…ƒç´ 5.<span class="hljs-keyword">line</span>-hightæ˜¯ç»§æ‰¿å±æ€§6.#è¡¨ç¤ºå¤šä¸ªå±æ€§æ˜¯ä»¥é€—å·åˆ†éš”7.+è¡¨ç¤ºå¤šä¸ªå±æ€§æ˜¯ä»¥ç©ºæ ¼åˆ†éš”8.text-align æ—¶å°†è¡Œå†…å…ƒç´ ç›¸å¯¹äºçˆ¶çº§å—å…ƒç´ è¿›è¡Œå±…ä¸­ä¾‹å¦‚img æ–‡æœ¬ <span class="hljs-keyword">input</span>ç­‰9.text-identå’Œwidthä»¥emä¸ºå•ä½çš„æ—¶å€™æ˜¯ç›¸å¯¹äºè‡ªèº«çš„ï¼Œfont-sizeå¯ä»¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ï¼Œå¦‚æœçˆ¶å…ƒç´ è®¾ç½®äº†font-sizeåˆ™ä¼šç»§æ‰¿ä¸‹æ¥å¹¶ç›¸å¯¹äºè‡ªèº«10.æ™®éå…„å¼Ÿé€‰æ‹©å™¨åªèƒ½é€‰ä¸­ä¸‹é¢çš„æ‰€æœ‰å…„å¼Ÿå…ƒç´ 11.scriptæ ‡ç­¾æ”¾åˆ°htmlçš„å¤´éƒ¨æ—¶è¦åŠ <span class="hljs-keyword">window</span>.onload12.ä¼ªç±»hover,link,visited,activeçš„æ‰§è¡Œé¡ºåº LVHA13.é™¤äº†aæ ‡ç­¾ï¼Œhoverå’Œactiveä¹Ÿå¯ä»¥ç”¨åœ¨å…¶ä»–å…ƒç´ ä¸Š14.aå…ƒç´ æ²¡æœ‰è®¾ç½®ä¼ªç±»ï¼Œé»˜è®¤æ‰€æœ‰ä¼ªç±»éƒ½æ˜¯ç›¸åŒçš„è®¾ç½®15.::first-<span class="hljs-keyword">line</span>é€‰ä¸­é¦–è¡Œå…ƒç´ ::first-letteré€‰ä¸­é¦–å­—æ¯å…ƒç´ ä¹‹é—´çš„é—´éš™é»˜è®¤æ˜¯æ¢è¡Œç¬¦ï¼Œå»æ‰æ¢è¡Œç¬¦å¯ä»¥::after&#123;content:url(<span class="hljs-string">&quot;./image/icon.svg&quot;</span>);<span class="hljs-comment">//å¯ä»¥è¿™æ ·æ¥æ·»åŠ å›¾ç‰‡</span>color:green&#125;&lt;p&gt;è¿™æ˜¯ä¸Šé¢ä»£ç çš„å®ç°&lt;<span class="hljs-keyword">br</span> /&gt;  æˆ‘ä»¬æœ‰ä¸€äº› &lt;span data-<span class="hljs-keyword">descr</span>=<span class="hljs-string">&quot;collection of words and punctuation&quot;</span>&gt;æ–‡å­—&lt;/span&gt; æœ‰ä¸€äº›  &lt;span data-<span class="hljs-keyword">descr</span>=<span class="hljs-string">&quot;small popups which also hide again&quot;</span>&gt;æç¤º&lt;/span&gt;ã€‚&lt;<span class="hljs-keyword">br</span> /&gt;  æŠŠé¼ æ ‡æ”¾ä¸Šå»&lt;span data-<span class="hljs-keyword">descr</span>=<span class="hljs-string">&quot;not to be taken literally&quot;</span>&gt;çœ‹çœ‹&lt;/span&gt;ã€‚&lt;/p&gt;<span class="hljs-comment">//è‡ªå®šä¹‰å±æ€§</span>::afterä¼ªå…ƒç´ ï¼Œattr()CSSè¡¨è¾¾å¼å’Œä¸€ä¸ªè‡ªå®šä¹‰æ•°æ®å±æ€§ data-<span class="hljs-keyword">descr</span> åˆ›å»ºä¸€ä¸ªçº¯CSS content: attr(data-<span class="hljs-keyword">descr</span>);   16.æ€ä¹ˆç”»0.5pxçš„çº¿ 17.å¸¸è§çš„ç»§æ‰¿å±æ€§ï¼šfont-size,font-weight,font-family,<span class="hljs-keyword">line</span>-height,color,text-alignä¸€èˆ¬å’Œæ–‡æœ¬æœ‰å…³çš„ 1.  cssçš„æƒé‡ important 10000 å†…è”é€‰æ‹©å™¨ 1000 idé€‰æ‹©å™¨ 100 ç±»é€‰æ‹©å™¨ï¼Œå±æ€§é€‰æ‹©å™¨ï¼Œä¼ªç±» 10 å…ƒç´ é€‰æ‹©å™¨ï¼Œä¼ªå…ƒç´  1 é€šé…é€‰æ‹©å™¨  019.imgï¼Œvedio,<span class="hljs-keyword">input</span>æ˜¯è¡Œå†…æ›¿æ¢å…ƒç´   å’Œå…¶ä»–è¡Œå†…å…ƒç´ åœ¨ä¸€è¡Œæ˜¾ç¤ºï¼Œå¯ä»¥è®¾ç½®å®½é«˜è¡Œå†…éæ›¿æ¢å…ƒç´ ä¸å¯ä»¥è®¾ç½®å®½é«˜20.ä¼ªå…ƒç´ æ˜¯è¡Œå†…éæ›¿æ¢å…ƒç´ ï¼Œä¸å¯ä»¥è®¾ç½®å®½é«˜ï¼Œå¿…é¡»è½¬æˆè¡Œå†…å—çº§å…ƒç´ å’Œå—çº§å…ƒç´ ï¼Œåœ¨ä½¿ç”¨ä¼ªå…ƒç´ è¿‡ç¨‹ä¸­å¿…é¡»åŠ content21.ä¸è¦åœ¨på…ƒç´ é‡Œé¢æ”¾å—å…ƒç´ 22.è¡Œå†…å…ƒç´ ä¸è¦æ”¾å—çº§å…ƒç´ ï¼Œåªèƒ½æ”¾è¡Œå†…å…ƒç´ 23.è®¾ç½®å…ƒç´ ä¸å¯è§çš„æ–¹å¼1.<span class="hljs-keyword">display</span>:none ä¸å æ®ä»»ä½•ç©ºé—´2.visibility:hiddenå æ®ç©ºé—´ä¸å¯è§3.è®¾ç½®é¢œè‰²é€æ˜åº¦4.background:transparentå¯ä»¥æ˜¯èƒŒæ™¯é¢œè‰²é€æ˜5.opacity:1,å¯ä»¥è®¾ç½®é€æ˜åº¦ï¼Œä½†æ˜¯ä¼šä½¿å­å…ƒç´ ä¹Ÿä¼šå˜é€æ˜ï¼Œå…·æœ‰ç©¿é€æ€§24.padding:10px 20px 30px å†™ä¸‰ä¸ªå€¼å¾—æ—¶å€™ï¼Œå·¦è¾¹æ²¡æœ‰å€¼ï¼Œç”¨å³è¾¹çš„æ›¿ä»£25.border-radiusç™¾åˆ†æ¯”åœ†è§’æ°´å¹³æ–¹å‘æ˜¯width+borderçš„ç™¾åˆ†æ¯”ï¼Œåœ†è§’å‚ç›´æ–¹å‘æ˜¯height+borderçš„ç™¾åˆ†æ¯”border-radius:50%æ˜¯ä¸ªåœ†ï¼Œè¶…è¿‡ç™¾åˆ†ä¹‹50%ä¹Ÿæ˜¯åœ†ï¼Œè¶…è¿‡50%ï¼Œæ— æ•ˆ26.marginmarginçš„ä¼ é€’ å·¦å³marginä¸ä¼ é€’margin-topçš„ä¼ é€’ å¦‚æœå—çº§å…ƒç´ é¡¶éƒ¨çº¿å’Œçˆ¶å…ƒç´ çš„é¡¶éƒ¨çº¿é‡å ï¼Œé‚£ä¹ˆè¿™ä¸ªå—çº§å…ƒç´ çš„margin-topå°±ä¼šä¼ é€’ç»™çˆ¶å…ƒç´ margin-bottomå¦‚æœå—çº§å…ƒç´ çš„åº•éƒ¨çº¿å’Œçˆ¶å…ƒç´ çš„åº•éƒ¨çº¿å‡ºç°é‡å ï¼Œä¸”çˆ¶å…ƒç´ é«˜åº¦ä¸ºautoæ—¶ï¼Œä¼šä¼ é€’è§£å†³ï¼š1.çˆ¶å…ƒç´ è®¾ç½®border 2.çˆ¶å…ƒç´ ä½¿ç”¨padding 3.è§¦å‘bfcä¸Šä¸‹marginçš„æŠ˜å  å…„å¼Ÿå—å…ƒç´ ä¸Šä¸‹ä¸¤ä¸ªmarginåˆå¹¶æˆä¸€ä¸ªmarginï¼ŒæŠ˜å åå–è¾ƒå¤§çš„å€¼ã€‚è§£å†³æ–¹æ³•åªè®¾ç½®ä¸€ä¸ªçˆ¶å­ä¹‹é—´æŠ˜å ï¼Œä¹Ÿä¼šå‡ºçº¿ç›¸åŒçš„æƒ…å†µ27.outline  å¤–è½®å»“ä¸å æ®ç©ºé—´ï¼Œé»˜è®¤æ˜¾ç¤ºåœ¨borderå¤–é¢ outlone:noneå¯ä»¥å»é™¤aå…ƒç´ ï¼Œ<span class="hljs-keyword">input</span>å…ƒç´ focusçŠ¶æ€ä¸‹çš„é»˜è®¤å¤–è½®å»“28.box-shadow:offset-x offset-y blur(æ¨¡ç³Šåº¦) å‘å¤–æ‰©æ•£çš„å€¼ color ï¼Œå¤šä¸ªé˜´å½±ä»¥é€—å·åˆ†éš”ï¼Œä¼šå åŠ 29.text-shadow:æ–‡å­—æ·»åŠ é˜´å½±27.è¡Œå†…éæ›¿æ¢å…ƒç´ çš„æ³¨æ„äº‹é¡¹1.ä¸å¯ä»¥è®¾ç½®widthå’Œheight2.è®¾ç½®margin-top.margin-bottomä¸ç”Ÿæ•ˆï¼Œmargi-leftå’Œmargin-rightç”Ÿæ•ˆ3.è®¾ç½®padding-top,padding-bottomä¼šä¸ç­‰é«˜ï¼Œä¸”ä¸å æ®ç©ºé—´ï¼Œè®¾ç½®padding-rightå’Œpadding-leftç”Ÿæ•ˆ4.è®¾ç½®borderå’Œpaddingç»™ç›¸åŒæ•ˆæœ28.html5è¯­ä¹‰åŒ–æ ‡ç­¾&lt;header&gt;&lt;nav&gt;&lt;section&gt;&lt;artical&gt;&lt;aside&gt;&lt;footer&gt;29.vedioå’Œaudioæ—¶è¡Œå†…æ›¿æ¢å…ƒç´    åœ¨é’ˆå¯¹ä¸åŒçš„æ’­æ”¾æ ¼å¼å†™æ³•   &lt;vedio src=<span class="hljs-string">&quot;&quot;</span>&gt;   &lt;source src=<span class="hljs-string">&quot;.../....mp4&quot;</span>&gt;&lt;/source&gt;   &lt;source src=<span class="hljs-string">&quot;.avi&quot;</span>&gt;&lt;/source&gt;   &lt;source src=<span class="hljs-string">&quot;&quot;</span>&gt;&lt;/source&gt;   &lt;p&gt;è¯¥æµè§ˆå™¨ä¸æ”¯æŒ&lt;/p&gt;   &lt;/vedio&gt;30.data-*è‡ªå®šä¹‰å±æ€§ï¼Œå¯ä»¥htmlå’Œjsä¸­è¿›è¡Œæ•°æ®ä¼ é€’31.white-space:normal|nowrap|pre|.....32.text-overflow:clip|esclip text-overflowå¿…é¡»åœ¨overflowä¸æ˜¯visibleæ‰ç”Ÿæ•ˆ33.csså‡½æ•°1.<span class="hljs-keyword">var</span> å®šä¹‰CSSå˜é‡å±æ€§åè¦ä»¥--å¼€å¤´html&#123;--main-color:#fffff&#125;div&#123;color:<span class="hljs-keyword">var</span>(--main-color)&#125;2.calc è®¡ç®—CSSå€¼ï¼Œ3.blur  é«˜æ–¯æ¨¡ç³Š--æ¯›ç»ç’ƒæ•ˆæœ  blur(radius)å¯ä»¥åº”ç”¨äºå›¾ç‰‡æˆ–è€…å…ƒç´ ï¼Œradiusæ¨¡ç³ŠåŠå¾„å¯ä»¥å’Œfilterä¸€èµ·ä½¿ç”¨ã€‚filter:blur(5px)ï¼Œä¼šä½¿æ‰€æœ‰å­å…ƒç´ éƒ½æœ‰é«˜æ–¯æ¨¡ç³Šå›¾ç‰‡çš„é«˜æ–¯æ¨¡ç³Šä¹Ÿå¯ä»¥åœ¨å›¾ç‰‡ä¸Šæ·»åŠ ä¸€ä¸ªé®ç›–å±‚ï¼Œç”¨å®šä½å…ƒç´ çˆ¶å…ƒç´ ï¼šposition:relative.cover&#123;position:absolutetop:0left:0right:0bottom:0background:rgba(0,0,0,.5)<span class="hljs-comment">//é€æ˜æ•ˆæœ</span>background-filter:blur(5px)<span class="hljs-comment">//é«˜æ–¯æ¨¡ç³Š</span>&#125;4.gradient é¢œè‰²æ¸å˜å‡½æ•° æ˜¯ä¸€ç§&lt;image&gt;cssæ•°æ®ç±»å‹çš„å­ç±»å‹ï¼Œç”¨äºå›¾ç‰‡é¢œè‰²çš„è¿‡åº¦è½¬å˜  liner-gradient çº¿æ€§æ¸å˜ background-image:linear-gradient(to right top ,red,blue)     34.backgroundèƒŒæ™¯è‰²å¯¹ä¹Ÿborder,paddingæœ‰æ•ˆ   colorå‰æ™¯è‰²å¯¹borderä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼Œborderæ²¡æœ‰è®¾ç½®é¢œè‰²æ—¶ï¼Œä¼šä½¿ç”¨colorçš„å€¼  35.æµè§ˆå™¨å‰ç¼€ï¼š-o-,-xv-,-ms-,-mso-,0moz-.-webkit-36.bfc å…„å¼Ÿå—å…ƒç´ marginæŠ˜å 35.åª’ä½“æŸ¥è¯¢36.csså•ä½em rempxvw/vh%37.lesså®šä¹‰å˜é‡ @mainColor:#ffffä½¿ç”¨å˜é‡ @mainColorå…¼å®¹css&amp;:hover &amp;::afterlessçš„è¿ç®—lessçš„æ··åˆ(Mixins)    .box2(@borderwidth:1px,@borderColor:red)&#123;    border:@borderwidth solid @borderColor    &#125;    .box-size&#123;    width:100px;    height:200px    &#125;.box&#123;<span class="hljs-comment">//æ··å…¥æ–¹å¼,å¯ä»¥ä¼ å‚</span>.box2(2px,green)width:.box-size[width]<span class="hljs-comment">//æ··å…¥å’Œæ˜ å°„ç»“åˆä½¿ç”¨</span>&amp;:extend(.box-size) <span class="hljs-comment">//ç»§æ‰¿</span>&#125;lesså†…ç½®å‡½æ•°.box&#123;color:color(red)<span class="hljs-comment">//å°†è½¬æ¢æˆ16è¿›åˆ¶</span>width:convert(100px,<span class="hljs-string">&quot;in&quot;</span>)å•ä½å‡†æ¢ï¼Œè½¬æˆè‹±å¯¸<span class="hljs-built_in">floor</span>()å‘ä¸‹å–æ•´<span class="hljs-built_in">ceil</span>()å‘ä¸Šå–æ•´&#125;lessçš„ä½œç”¨åŸŸï¼šæŸ¥æ‰¾ä¸€ä¸ªå˜é‡æ—¶ï¼Œä¼šåœ¨æœ¬åœ°å’Œæ··å…¥å…ˆæŸ¥æ‰¾ï¼Œç„¶åå†çˆ¶çº§æŸ¥æ‰¾lessçš„æ³¨é‡Šlessçš„å¯¼å…¥ import38.ç§»åŠ¨ç«¯é€‚é…   è§†å£viewport   å¸ƒå±€è§†å£   è§†è§‰è§†å£   ç†æƒ³è§†å£   &lt;<span class="hljs-keyword">meta</span> name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=980px&quot;</span>&gt;<span class="hljs-comment">//ä¿®æ”¹å¸ƒå±€è§†å£çš„å®½åº¦ï¼Œå¯¹pcç«¯æ— æ•ˆ</span>   &lt;<span class="hljs-keyword">meta</span> name=<span class="hljs-string">&quot;viewport&quot;</span> content=&quot;device-widthï¼Œinitial-<span class="hljs-keyword">scal</span>=1.0,user-scalable=<span class="hljs-keyword">no</span>   minimun-<span class="hljs-keyword">scal</span>=1.0,maximun-scale=1.0   &gt;39.cssçš„ç›¸å¯¹å•ä½em,æ˜¯ç›¸å¯¹äºè‡ªèº«çš„font-sizeæ¥è¿›è¡Œå®šä½çš„ï¼Œå¦‚æœè‡ªå·±å·²ç»å®šä¹‰äº†font-sizeçš„pxï¼Œåˆ™ç”¨è‡ªèº«çš„font-size,å¦åˆ™å°±ç»§æ‰¿è‡ªçˆ¶å…ƒç´ çš„font-sizeremæ˜¯åŸºäºæ ¹å…ƒç´ çš„å­—ä½“çš„å¤§å°vwæ˜¯è§†çª—å®½åº¦çš„1%vhæ˜¯è§†çª—é«˜åº¦çš„1%40.å†pcç«¯ï¼Œå¸ƒå±€è§†å£å’Œè§†è§‰è§†å£æ˜¯åŒä¸€ä¸ªï¼Œä¸ç”¨åŒºåˆ†é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªåœ¨PCç«¯çš„ç½‘é¡µåœ¨ç§»åŠ¨ç«¯ä¼šå¦‚ä½•æ˜¾ç¤ºå‘¢ï¼Ÿï° ç¬¬ä¸€ï¼Œå®ƒä¼šæŒ‰ç…§å®½åº¦ä¸º980pxæ¥å¸ƒå±€ä¸€ä¸ªé¡µé¢çš„ç›’å­å’Œå†…å®¹ï¼›ï° ç¬¬äºŒï¼Œä¸ºäº†æ˜¾ç¤ºå¯ä»¥å®Œæ•´çš„æ˜¾ç¤ºåœ¨é¡µé¢ä¸­ï¼Œå¯¹æ•´ä¸ªé¡µé¢è¿›è¡Œç¼©å°æˆ‘ä»¬ç›¸å¯¹äº980pxå¸ƒå±€çš„è¿™ä¸ªè§†å£ï¼Œç§°ä¹‹ä¸ºå¸ƒå±€è§†å£ï¼ˆlayout viewportï¼‰ï¼›ï° å¸ƒå±€è§†å£çš„é»˜è®¤å®½åº¦æ˜¯980pxï¼›è§†è§‰è§†å£ï¼ˆvisual viewportï¼‰ï° å¦‚æœé»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æŒ‰ç…§980pxæ˜¾ç¤ºå†…å®¹ï¼Œé‚£ä¹ˆå³ä¾§æœ‰ä¸€éƒ¨åˆ†åŒºåŸŸå°±ä¼šæ— æ³•æ˜¾ç¤ºï¼Œæ‰€ä»¥æ‰‹æœºç«¯æµè§ˆå™¨ä¼šé»˜è®¤å¯¹é¡µé¢è¿›è¡Œç¼©æ”¾ä»¥æ˜¾ç¤ºåˆ°ç”¨æˆ·çš„å¯è§åŒºåŸŸä¸­ï¼›ï° é‚£ä¹ˆæ˜¾ç¤ºåœ¨å¯è§åŒºåŸŸçš„è¿™ä¸ªè§†å£ï¼Œå°±æ˜¯è§†è§‰è§†å£ï¼ˆvisual viewportï¼‰41.é€‚é…æ–¹æ¡ˆ â€“ rem+åŠ¨æ€htmlçš„font-size   ä½¿ç”¨è¯¥æ–¹æ¡ˆæœ‰ä¸¤ä¸ªé—®é¢˜   ï° é—®é¢˜ä¸€ï¼šé’ˆå¯¹ä¸åŒçš„å±å¹•ï¼Œè®¾ç½®htmlä¸åŒçš„font-sizeï¼›    ï° é—®é¢˜äºŒï¼šå°†åŸæ¥è¦è®¾ç½®çš„å°ºå¯¸ï¼Œè½¬åŒ–æˆremå•ä½ï¼›    æ–¹æ¡ˆä¸€ï¼šåª’ä½“æŸ¥è¯¢    ï° å¯ä»¥é€šè¿‡åª’ä½“æŸ¥è¯¢æ¥è®¾ç½®ä¸åŒå°ºå¯¸èŒƒå›´å†…çš„å±å¹•htmlçš„font-sizeå°ºå¯¸ï¼›    ï° ç¼ºç‚¹ï¼š    âœ“ 1.æˆ‘ä»¬éœ€è¦é’ˆå¯¹ä¸åŒçš„å±å¹•ç¼–å†™å¤§é‡çš„åª’ä½“æŸ¥è¯¢ï¼›    âœ“ 2.å¦‚æœåŠ¨æ€æ”¹å˜å°ºå¯¸ï¼Œä¸ä¼šå®æ—¶çš„è¿›è¡Œæ›´æ–°ï¼›    â—¼ æ–¹æ¡ˆäºŒï¼šç¼–å†™jsä»£ç     ï° å¦‚æœå¸Œæœ›å®æ—¶æ”¹å˜å±å¹•å°ºå¯¸æ—¶ï¼Œfont-sizeä¹Ÿå¯ä»¥å®æ—¶æ›´æ”¹ï¼Œå¯ä»¥é€šè¿‡jsä»£ç ï¼›    ï° æ–¹æ³•ï¼š    âœ“ 1.æ ¹æ®htmlçš„å®½åº¦è®¡ç®—å‡ºfont-sizeçš„å¤§å°ï¼Œå¹¶ä¸”è®¾ç½®åˆ°htmlä¸Šï¼›    âœ“ 2.ç›‘å¬é¡µé¢çš„å®æ—¶æ”¹å˜ï¼Œå¹¶ä¸”é‡æ–°è®¾ç½®font-sizeçš„å¤§å°åˆ°htmlä¸Šï¼›        remçš„å•ä½æ¢ç®—æ–¹æ¡ˆä¸€ï¼šæ‰‹åŠ¨æ¢ç®—æ–¹æ¡ˆäºŒï¼šless/scsså‡½æ•°â—¼ æ–¹æ¡ˆå››ï¼šVSCodeæ’ä»¶ï° px to rem çš„æ’ä»¶ï¼Œåœ¨ç¼–å†™æ—¶è‡ªåŠ¨è½¬åŒ–â—¼ æ–¹æ¡ˆå››ï¼šVSCodeæ’ä»¶ï° px to rem çš„æ’ä»¶ï¼Œåœ¨ç¼–å†™æ—¶è‡ªåŠ¨è½¬åŒ–ä¸‰ï¼špostcss-pxtorem42ã€‚<span class="hljs-keyword">meta</span>æ ‡ç­¾çš„ä½œç”¨å¯ä»¥åœ¨headä¸­å®šä¹‰å…ƒä¿¡æ¯ï¼Œä¾‹å¦‚ï° æ¯”å¦‚æ ‡é¢˜titleã€æ ·å¼styleã€linkå¤–éƒ¨èµ„æºç­‰ï¼›    ï° <span class="hljs-keyword">meta</span>ç”¨äºå®šä¹‰é‚£äº›ä¸èƒ½ä½¿ç”¨å…¶ä»–å®šå…ƒç›¸å…³ï¼ˆ<span class="hljs-keyword">meta</span>-relatedï¼‰å…ƒç´ å®šä¹‰çš„ä»»ä½•å…ƒæ•°æ®ä¿¡æ¯ï¼›    <span class="hljs-keyword">meta</span> å…ƒç´ å®šä¹‰çš„å…ƒæ•°æ®çš„ç±»å‹åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š            ï° å¦‚æœè®¾ç½®äº† charset å±æ€§ï¼Œ<span class="hljs-keyword">meta</span> å…ƒç´ æ˜¯ä¸€ä¸ªå­—ç¬¦é›†å£°æ˜ï¼Œå‘Šè¯‰æ–‡æ¡£ä½¿ç”¨å“ªç§å­—ç¬¦ç¼–ç ã€‚            ï° å¦‚æœè®¾ç½®äº† http-equiv å±æ€§ï¼Œ<span class="hljs-keyword">meta</span> å…ƒç´ åˆ™æ˜¯ç¼–è¯‘æŒ‡ä»¤ã€‚            ï° å¦‚æœè®¾ç½®äº† name å±æ€§ï¼Œ<span class="hljs-keyword">meta</span> å…ƒç´ æä¾›çš„æ˜¯æ–‡æ¡£çº§åˆ«ï¼ˆdocument-levelï¼‰çš„å…ƒæ•°æ®ï¼Œåº”ç”¨äºæ•´ä¸ªé¡µé¢ã€‚            ä¾‹å¦‚ï¼šrobotsï¼Œauthorï¼Œ<span class="hljs-keyword">Copyright</span>ï¼Œdescriptionï¼Œkeywords             43.linkå›¾æ ‡ &lt;link rel=<span class="hljs-string">&quot;icon&quot;</span> href=<span class="hljs-string">&quot;https:;;;;&quot;</span> /&gt; ä¹Ÿå¯ä»¥ç›´æ¥å°†è¯¥favicon.icoç›´æ¥ç½®äºæ ¹ç›®å½•ä¸‹ï¼Œä¸éœ€è¦ä½¿ç”¨linkæ¥å¼•å…¥ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æµè§ˆå™¨éƒ½å¯ä»¥è¯†åˆ«   44.CSSæ ·å¼çš„å­—ç¬¦ç¼–ç  å¼€å‘ä¸­æ¨èåœ¨CSSçš„å¼€å¤´ç¼–å†™@charsetæŒ‡å®šç¼–ç ï¼š@import <span class="hljs-string">&quot;utf-8&quot;</span> 45.å…¨å±€å±æ€§data-* dataè®¾ç½®çš„å±æ€§å¯ä»¥åœ¨JavaScriptçš„DOMæ“ä½œä¸­é€šè¿‡datasetè½»æ¾è·å–åˆ°ï¼›é€šå¸¸ç”¨äºHTMLå’ŒJavaScriptæ•°æ®ä¹‹é—´çš„ä¼ é€’ï¼›46.<span class="hljs-string">&quot;&quot;</span>==null <span class="hljs-comment">//false</span>nullå’Œundefinedä¸èƒ½è½¬æ¢æˆä»»ä½•æ•°æ®ç±»å‹è¿›è¡Œæ¯”è¾ƒ47.<span class="hljs-keyword">const</span> obj=&#123;[Symbol.toPrimitive]()&#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;123&quot;</span>&#125;&#125;48.è½¬æ¢æˆbooleançš„æ–¹å¼Boolean(a)!!a49.switch case æ˜¯ä¸¥æ ¼åŒ¹é…===ï¼Œè¿˜è¦é˜²æ­¢caseç©¿é€50.npxnpx æ˜¯ npm v5.2.0 å¼•å…¥çš„ä¸€æ¡å‘½ä»¤ï¼ˆ npx ï¼‰ï¼Œæ˜¯ä¸€ä¸ª npm åŒ…æ‰§è¡Œå™¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ npx æ¥æ‰§è¡Œå„ç§å‘½ä»¤ã€‚ä¸»è¦æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼šä¸´æ—¶å®‰è£…å¯æ‰§è¡Œä¾èµ–åŒ…ï¼Œä¸ç”¨å…¨å±€å®‰è£…ï¼Œä¸ç”¨æ‹…å¿ƒé•¿æœŸçš„æ±¡æŸ“ã€‚å¯ä»¥æ‰§è¡Œä¾èµ–åŒ…ä¸­çš„å‘½ä»¤ï¼Œå®‰è£…å®Œæˆè‡ªåŠ¨è¿è¡Œã€‚è‡ªåŠ¨åŠ è½½ node_modules ä¸­ä¾èµ–åŒ…ï¼Œä¸ç”¨æŒ‡å®š <span class="hljs-variable">$PATH</span> ã€‚å¯ä»¥æŒ‡å®š node ç‰ˆæœ¬ã€å‘½ä»¤çš„ç‰ˆæœ¬ï¼Œè§£å†³äº†ä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒnpx æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼šåˆ° node_modules/.bin è·¯å¾„æ£€æŸ¥å¯¹åº”çš„å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œæ‰¾åˆ°ä¹‹åæ‰§è¡Œï¼›æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±å»ç¯å¢ƒå˜é‡ <span class="hljs-variable">$PATH</span> é‡Œé¢ï¼Œæ£€æŸ¥å¯¹åº”å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œæ‰¾åˆ°ä¹‹åæ‰§è¡Œ;è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼Œè‡ªåŠ¨ä¸‹è½½ä¸€ä¸ªä¸´æ—¶çš„ä¾èµ–åŒ…æœ€æ–°ç‰ˆæœ¬åœ¨ä¸€ä¸ªä¸´æ—¶ç›®å½•ï¼Œç„¶åå†è¿è¡Œå‘½ä»¤ï¼Œè¿è¡Œå®Œä¹‹ååˆ é™¤ï¼Œä¸æ±¡æŸ“å…¨å±€ç¯å¢ƒã€‚51.å‡½æ•°é»˜è®¤çš„è¿”å›å€¼æ˜¯undefined52.é€’å½’53.æ–æ³¢é‚£å¥‘æ•°åˆ—function fibonacci(<span class="hljs-keyword">n</span>)&#123;    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">n</span>===1||<span class="hljs-keyword">n</span>===2) <span class="hljs-keyword">return</span> 1    <span class="hljs-keyword">return</span> fibonacci(<span class="hljs-keyword">n</span>-1)+fibonacci(<span class="hljs-keyword">n</span>-2)  &#125;54.ç«‹å³æ‰§è¡Œå‡½æ•°1.ä¼šç«‹å³æ‰§è¡Œ2.å‡½æ•°æœ‰ç‹¬ç«‹çš„ä½œç”¨åŸŸï¼Œå¯ä»¥é¿å…å¤–ç•Œè®¿é—®æˆ–è€…ä¿®æ”¹å†…éƒ¨çš„å˜é‡ï¼Œ3.å¯ä»¥æœ‰å‚æ•°å’Œè¿”å›å€¼4.åŒ¿åå‡½æ•°å¤šç§å†™æ³•(function()&#123;&#125;)()            <span class="hljs-comment">// åŒ¿åå‡½æ•°å¤šç§å†™æ³•</span>            (function (fn) &#123;              console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;ç«‹å³æ‰§è¡Œå‡½æ•°&quot;</span>);            &#125;)();            <span class="hljs-comment">// + - ï¼éƒ½å¯ä»¥ï¼Œä½†æ˜¯ä¸è¦è¿™æ ·ç”¨</span>            +(function foo() &#123;              console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;ç«‹å³æ‰§è¡Œå‡½æ•°&quot;</span>);            &#125;)();5.åº”ç”¨ï¼šã€‚1.è§£å†³å‘½åå†²çªçš„é—®é¢˜ï¼Œé˜²æ­¢å…¨å±€å˜é‡çš„å‘½åå†²çª2.<span class="hljs-keyword">const</span> btnRtm1 = document.querySelectorAll(<span class="hljs-string">&quot;.btn&quot;</span>);<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = 0; i &lt; btnRtm.length; i++) &#123;  <span class="hljs-keyword">var</span> btn = btnRtm[i];  (function (<span class="hljs-keyword">m</span>) &#123;    btn.onclick = function () &#123;      console.<span class="hljs-built_in">log</span>(<span class="hljs-keyword">m</span>);    &#125;;  &#125;)(i);&#125;<span class="hljs-comment">// æ‰“å° 4 4 4 4 .....</span><span class="hljs-comment">// ç«‹å³æ‰§è¡Œå‡½æ•°å¯ä»¥è§£å†³ä¸Šè¿°é—®é¢˜è¿˜æœ‰forå¾ªç¯ä¸­æœ‰å¼‚æ­¥ä»£ç ä¾‹å¦‚setTimeoutï¼Œä¹Ÿå¯ä»¥ç”¨letè§£å†³</span><span class="hljs-comment">// å› ä¸ºåœ¨å¦‚ä¸‹ä»£ç ä¸­ï¼Œä½†æ‰§è¡Œonclickæ‰§è¡Œçš„æ—¶å€™ï¼Œæ­¤æ—¶forå¾ªç¯å·²ç»æ‰§è¡Œå®Œï¼Œiå·²ç»å˜æˆbtnRtm.length æ‰€ä»¥æ‰§è¡Œä»£ç æ°¸è¿œæ˜¯4 4 4 ï¼Œè€Œä½¿ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œä¼šæ¯æ¬¡å°†iä½œä¸ºå‚æ•°ä¼ å…¥ç«‹å³æ‰§è¡Œå‡½æ•°ä¸­ï¼Œå°½ç®¡iæ‰§è¡Œå®Œä¹‹åå·²ç»å˜æˆ4ï¼Œä½†æ˜¯må­˜å‚¨è¿™0 1 2 3 </span><span class="hljs-keyword">const</span> btnRtm = document.querySelectorAll(<span class="hljs-string">&quot;.btn&quot;</span>);<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = 0; i &lt; btnRtm.length; i++) &#123;  <span class="hljs-keyword">var</span> btn = btnRtm[i];  (function (<span class="hljs-keyword">m</span>) &#123;    btn.onclick = function () &#123;      console.<span class="hljs-built_in">log</span>(<span class="hljs-keyword">m</span>);    &#125;;  &#125;)(i);&#125;<span class="hljs-comment">// æ‰“å° 1 2 3 4....</span><span class="hljs-keyword">const</span> btnRtm3 = document.querySelectorAll(<span class="hljs-string">&quot;.btn&quot;</span>);<span class="hljs-keyword">for</span> (let i = 0; i &lt; btnRtm.length; i++) &#123;  <span class="hljs-keyword">var</span> btn = btnRtm[i];  btn.onclick = function () &#123;    console.<span class="hljs-built_in">log</span>(i);  &#125;;&#125;<span class="hljs-comment">// æ‰“å°1 2 3 4 .....</span>55.jsä»£ç è§„èŒƒ56.Objectçš„keyæ˜¯å­—ç¬¦ä¸²57.Objectå¯ä»¥ä½¿ç”¨deleteæ¥åˆ é™¤å±æ€§ï¼ŒObject.name/Object[<span class="hljs-string">&quot;name&quot;</span>]æ¥è·å–ï¼Œæˆ–è€…ä¿®æ”¹å±æ€§ï¼Œobj[name]æ˜¯è®¡ç®—å±æ€§ï¼Œnameæ˜¯ä¸€ä¸ªå˜é‡58.Object éå†å¯ä»¥ä½¿ç”¨forin,æˆ–è€…Object.keys()   59.æ ˆå†…å­˜å’Œå †å†…å­˜åŸå§‹æ•°æ®ç±»å‹æ˜¯åœ¨æ ˆå†…å­˜å¼•ç”¨ç±»å‹å®åœ¨å †å†…å­˜60.åŒ…è£…ç±»å‹ï¼Œ   å½“æœ‰åŒ…è£…ç±»å‹çš„åŸå§‹æ•°æ®ç±»å‹å¯ä»¥è°ƒç”¨æ–¹æ³•ï¼Œæ˜¯å› ä¸ºjså¼•æ“ä¼šå°†åŸå§‹ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»è°ƒç”¨å¯¹åº”çš„æ–¹æ³•   123..<span class="hljs-keyword">toString</span>(2)<span class="hljs-comment">//è½¬æ¢æˆäºŒè¿›åˆ¶</span>   toFixed(2)ä¿ç•™ä¸¤ä½å°æ•°ã€‚æ˜¯å››èˆäº”å…¥   parseInt===Number.parseInt     Stringç±»   length   str[0]   charAt(0)<span class="hljs-comment">//å­—ç¬¦ä½ç½®</span>   <span class="hljs-keyword">for</span>   <span class="hljs-keyword">for</span>...of   <span class="hljs-keyword">for</span>...<span class="hljs-keyword">in</span>   å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„   ä¾‹å¦‚ï¼š<span class="hljs-keyword">var</span> str = <span class="hljs-string">&quot;name&quot;</span>; str[0] = <span class="hljs-string">&quot;v&quot;</span>; console.<span class="hljs-built_in">log</span>(str);<span class="hljs-comment">//name</span>  <span class="hljs-keyword">var</span> str = str.toUpperCase();console.<span class="hljs-built_in">log</span>(str);<span class="hljs-comment">//è¿™æ˜¯æ–°çš„å­—ç¬¦ä¸²ï¼Œä¸æ˜¯åŸæ¥çš„</span>str.indexOf(searchString,fromIndex)<span class="hljs-comment">//è¿”å›å€¼æ˜¯ç´¢å¼•å€¼</span>str.includes()str.startsWidth(<span class="hljs-string">&quot;1&quot;</span>)<span class="hljs-comment">//æ˜¯å¦ä»¥1å¼€å¤´</span>str.endsWidth()str.<span class="hljs-keyword">replace</span>()str.slice()str.substring()str.<span class="hljs-built_in">substr</span>()å­—ç¬¦ä¸²æ‹¼æ¥+ï¼Œcocat()<span class="hljs-built_in">trim</span>()<span class="hljs-keyword">split</span>()<span class="hljs-keyword">replace</span>()æ›¿æ¢ï¼Œæ˜¯çº¯å‡½æ•°61.Arraysplice()<span class="hljs-comment">//æ·»åŠ ï¼Œåˆ é™¤ï¼Œæ›¿æ¢</span>poppushshiftunshiftarr.lengthå¯ä»¥è·å¾—æ•°ç»„çš„é•¿åº¦ï¼Œä¿®æ”¹æ•°ç»„çš„é•¿åº¦ï¼Œåˆ é™¤æ•°ç»„å¦‚æœarr.lengthä¸º6arr.length=2<span class="hljs-comment">//å¯ä»¥åˆ é™¤å‰©ä½™çš„å…ƒç´ </span>arr.length=0å¯ä»¥åˆ é™¤æ‰€æœ‰å…ƒç´ arr.length=8<span class="hljs-comment">//å¯ä»¥æ‰©å®¹</span>arr.slice()arr.join()arr.concat()arr.indexOf()arr.find(arr.find(callback[, thisArg]) callback(element,index,array) <span class="hljs-comment">//ä¼šè¿”å›åŒ¹é…åˆ°çš„å…ƒç´ ï¼ŒåŒ¹é…åˆ°å¤šä¸ªçš„æ—¶å€™ä¼šè¿”å›ç¬¬ä¸€ä¸ª   find æ–¹æ³•ä¸ä¼šæ”¹å˜æ•°ç»„</span>arr.findIndex( )<span class="hljs-comment">//å®ç°find</span>Array.prototype.myFind = function (callback, thisArg) &#123;  <span class="hljs-keyword">for</span> (let i = 0; i &lt; this.length; i++) &#123;    <span class="hljs-keyword">if</span> (callback.call(thisArg, this[i], i, this)) &#123;      <span class="hljs-keyword">return</span> this[i];    &#125;  &#125;&#125;;<span class="hljs-comment">//å®ç°forEach</span>Array.prototype.MyForEach = function (callback, thisArg) &#123;  <span class="hljs-keyword">for</span> (let i = 0; i &lt; this.length; i++) &#123;    callback.apply(thisArg, [this[i], i, this]);  &#125;&#125;;includes()arr.<span class="hljs-keyword">sort</span>()<span class="hljs-comment">// é»˜è®¤æ˜¯é™åº</span>arr.<span class="hljs-keyword">sort</span>((item1, item2) =&gt; &#123;  <span class="hljs-keyword">return</span> item1.age - item2.age;&#125;);console.<span class="hljs-built_in">log</span>(arr);<span class="hljs-comment">// å‡åº</span>arr.<span class="hljs-keyword">sort</span>((item1, item2) =&gt; &#123;  <span class="hljs-keyword">return</span> item2.age - item1.age;&#125;);console.<span class="hljs-built_in">log</span>(arr);arr.<span class="hljs-built_in">reverse</span>()arr.filter()Array.prototype.myfilter = function (callback, thisArg) &#123;  let newArr = [];  <span class="hljs-keyword">for</span> (let i = 0; i &lt; this.length; i++) &#123;    <span class="hljs-keyword">if</span> (callback.call(thisArg, this[i], i, this)) &#123;      newArr.push(this[i]);    &#125;  &#125;  <span class="hljs-keyword">return</span> newArr;&#125;;arr.map()arr.reduce()Dateç±»å‹new <span class="hljs-built_in">Date</span>()Date.now()<span class="hljs-comment">//å½“å‰äº‹ä»¶çš„æ—¶é—´æˆ³</span>date.getTime()<span class="hljs-comment">//å°†æ—¶é—´è½¬æ¢æˆæ—¶é—´æˆ³</span>date.valueOf()<span class="hljs-comment">//ä¹Ÿæ˜¯ä¸€æ ·</span>+date<span class="hljs-comment">//ä¹Ÿå¯ä»¥</span>å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ—¶é—´æˆ³<span class="hljs-keyword">var</span> dateString = <span class="hljs-string">&quot;2020-5-15&quot;</span>;console.<span class="hljs-built_in">log</span>(new <span class="hljs-built_in">Date</span>(dateString).getTime());console.<span class="hljs-built_in">log</span>(Date.<span class="hljs-keyword">parse</span>(dateString));==================================================================================Dom62.æ‰€æœ‰èŠ‚ç‚¹éƒ½ç»§æ‰¿è‡ªEventTarget63.documentå¯¹è±¡-å¯ä»¥è·å¾—æ•´ä¸ªç½‘é¡µnodeèŠ‚ç‚¹<span class="hljs-keyword">var</span> html=document.documnetElement<span class="hljs-keyword">var</span> body=documnet.bodybody,html,bodyéƒ½æ˜¯documnetçš„å±æ€§è·å–æ‰€æœ‰èŠ‚ç‚¹çš„å¯¼èˆª <span class="hljs-keyword">var</span> bodyEl=document.bodyè·å–æ‰€æœ‰å­èŠ‚ç‚¹ bodyEl.childNodes  æ¢è¡Œç¬¦ä¹Ÿå±äºtextèŠ‚ç‚¹ï¼Œæ³¨é‡Šæ˜¯commentèŠ‚ç‚¹è·å–ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ bodyEl.nextSiblingå‰å…„ç¬¬èŠ‚ç‚¹ preSibling</code></pre></div><p>æ‰“å°bodyçš„å­èŠ‚ç‚¹</p><p><img src="https://img1.imgtp.com/2022/08/14/ehewKeMN.png" alt="å±å¹•æˆªå›¾ 2022-05-18 100006.png"></p><p><img src="https://img1.imgtp.com/2022/08/14/B3g8Atxi.png" alt="å±å¹•æˆªå›¾ 2022-05-18 100042.png"></p><div class="code-wrapper"><pre><code class="hljs stata">64.è·å–å­å…ƒç´ bodyEl.children65.è·å–ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹  bodyEl.firstElementChild    bodyEl.children[0]  bodyEl.nextElementSibling66.Documentå’ŒElementçš„å…³ç³»   æ²¡æœ‰å…³ç³»ã€‚document.body,bodyæ˜¯ä»–çš„å±æ€§ï¼Œä¸æ˜¯ç»§æ‰¿ç±»ï¼Œbody:document.querySelectAll(<span class="hljs-string">&quot;body&quot;</span>) ,æ‰€ä»¥Documnetå’ŒElementä¸æ˜¯ç»§æ‰¿çš„å…³ç³»ï¼ŒELmentæ˜¯bodyçš„å€¼67.<span class="hljs-keyword">table</span>å’Œ<span class="hljs-keyword">form</span>ä¹‹é—´çš„å¯¼èˆª68.document.getElementById(<span class="hljs-string">&quot;&quot;</span>)   documnet.querySelector(<span class="hljs-string">&quot;&quot;</span>)   document.querySlectorAll(<span class="hljs-string">&quot;&quot;</span>)   document.getElementsByName(<span class="hljs-string">&quot;&quot;</span>)   document.getElementsByTagName(<span class="hljs-string">&quot;&quot;</span>)   document.getElementsByClassName(<span class="hljs-string">&quot;&quot;</span>)<span class="hljs-comment">//è¿™3ä¸ªæ˜¯å®æ—¶çš„</span>69.NodeListæ˜¯ç±»æ•°ç»„å¯¹è±¡ï¼Œä½†æ˜¯å¯ä»¥ç”¨<span class="hljs-keyword">forEach</span>,å¯ä»¥ç”¨Array.from()è½¬æ¢æˆarray70.èŠ‚ç‚¹ç±»å‹åˆ¤æ–­é€šè¿‡childNodesè·å–çš„èŠ‚ç‚¹åˆ¤æ–­èŠ‚ç‚¹ç±»å‹ç”¨nodeTypeå±æ€§ 1.å…ƒç´ èŠ‚ç‚¹ 3.æ–‡æœ¬ 8ï¼Œæ³¨é‡ŠèŠ‚ç‚¹71.nodeNameè·å–èŠ‚ç‚¹åç§°ï¼ŒtagNameå…ƒç´ å72.dataç”¨äºéå…ƒç´ èŠ‚ç‚¹è·å–æ•°æ® innerHTML è·å–å…ƒç´  textContentè·å–æ–‡æœ¬è®¾ç½®çš„æ—¶å€™ï¼ŒinnerHTMLå’ŒinnerContentéƒ½å¯ä»¥è®¾ç½®æ–‡æœ¬ï¼ŒinnerContentè®¾ç½®å…ƒç´ ä¸ä¼šè¢«è§£æä¸ºhtmlå…ƒç´ ï¼Œä¼šå½“ä½œæ™®é€šæ–‡æœ¬innerHTML å°†ä¼šåˆ é™¤æ‰€æœ‰è¯¥å…ƒç´ çš„åä»£å¹¶ä»¥ç»™å‡ºçš„ htmlString æ›¿ä»£ä¸æ˜¯è¿½åŠ 73.outerHTMLä¼šè·å–æœ¬èº«åŠå…¶å­å…ƒç´ 74.å¸¸è§å…¨å±€å±æ€§ id style title <span class="hljs-keyword">class</span> hidden:ç›¸å½“äºè®¾ç½®<span class="hljs-keyword">display</span>:none<span class="hljs-keyword">on</span>+äº‹ä»¶75.attributehtmlå®šä¹‰çš„æ˜¯æ ‡å‡†attributeè‡ªå®šä¹‰çš„å±æ€§æ˜¯éæ ‡å‡†attributeæ‰€æœ‰attributeéƒ½æ”¯æŒçš„æ–¹æ³•element.hasAttribute(<span class="hljs-keyword">e</span>)element.getAttribure(<span class="hljs-keyword">e</span>)element.setAttribute(<span class="hljs-keyword">e</span>)element.removeAttribute(<span class="hljs-keyword">e</span>)element.attributes-&gt;like arrayè¿™äº›å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œè€Œä¸”è¿”å›å€¼éƒ½æ˜¯string76.propertyå¯¹è±¡ä¸­çš„å±æ€§ç§°ä¸ºpropertyå…ƒç´ ä¸­çš„å±æ€§ç§°ä¸ºattributeæ ‡å‡†çš„attributeä¸­åœ¨å¯¹åº”çš„å¯¹è±¡æ¨¡å‹ä¸­éƒ½æœ‰å¯¹ç”¨çš„propertypropertyå’Œattributeä¼šç›¸äº’å½±å“ä½¿ç”¨ç‚¹è¯­æ³•ä¹Ÿå¯ä»¥è·å¾—å…ƒç´ çš„å±æ€§77.classNameå’ŒclassListclassListæ˜¯å¯è¿­ä»£å¯¹è±¡78.styleåœ¨jsä¸­è¦ä½¿ç”¨é©¼å³°å¤šä¸ªæ ·å¼å¯ä»¥ä½¿ç”¨style.cssText=<span class="hljs-string">&quot;&quot;</span>è¿™ä¸ªä¸ç”¨å†™é©¼å³°ï¼Œä½†æ˜¯ä¼šè¦†ç›–ï¼Œä¸æ¨è78.styleçš„è¯»å–getComputedStyle()ï¼Œele.styleåªèƒ½è¯»å–å†…è”æ ·å¼ï¼Œå°±æ˜¯ç›´æ¥åœ¨å…ƒç´ ä¸Šå®šä¹‰çš„æ ·å¼ï¼Œwidow.getComputedStyle(ele,[pseudoElt])å¯ä»¥è¯»å–æ‰€æœ‰çš„csså±æ€§ï¼ŒåŒ…æ‹¬å¤–éƒ¨æ ·å¼ï¼Œä½†æ˜¯getComputedStyleæ˜¯åªè¯»å±æ€§79.data-*80.<span class="hljs-keyword">var</span> el=document.createElement(<span class="hljs-string">&quot;element&quot;</span>)<span class="hljs-comment">//åˆ›å»ºå…ƒç´ </span>el.className=<span class="hljs-string">&quot;&quot;</span>el.classList.add(<span class="hljs-string">&quot;&quot;</span>)boxel.<span class="hljs-keyword">append</span>(el)<span class="hljs-comment">//å‘çˆ¶å…ƒç´ æ’å…¥åˆ›å»ºçš„å…ƒç´ ï¼Œé»˜è®¤æ˜¯æ’å…¥æœ€å</span>boxel.prepend(el)<span class="hljs-comment">//æ·»åŠ åˆ°çˆ¶å…ƒç´ çš„é‡Œé¢çš„æœ€å‰é¢</span>boxel.before(el)<span class="hljs-comment">//æ·»åŠ åˆ°å…ƒç´ çš„å‰é¢</span>boxel.after(el)<span class="hljs-comment">//æ·»åŠ åˆ°å…ƒç´ åé¢</span>boxel.replacewith(...node|string)<span class="hljs-comment">//æ›¿æ¢å…ƒç´ </span>appendChild,insertbeforeè¿™äº›æ–¹æ³•æ¯”è¾ƒæ—§äº†81.el.remove()<span class="hljs-comment">//å°†è‡ªå·±ç§»é™¤</span>82.å…‹éš†<span class="hljs-keyword">var</span> newEl=el.cloneNode()<span class="hljs-comment">//é»˜è®¤æ˜¯ä¸ä¼šå…‹éš†å­èŠ‚ç‚¹cloneNode(true)ä¼šå…‹éš†å­èŠ‚ç‚¹</span>83.è·å–å…ƒç´ çš„å®½é«˜ ele.width ele.height84.clientWidth:å…ƒç´ content+padding(ä¸åŒ…å«æ»šåŠ¨æ¡)clientTop:border-topçš„å®½åº¦ã€‚clientLeftoffsetWidth:å…ƒç´ çš„å®Œæ•´å®½åº¦content+border+paddingoffsetLeft è·ç¦»çˆ¶å…ƒç´ å·¦è¾¹çš„è·ç¦» offsetTopscrollHeight å…ƒç´ å¯æ»šåŠ¨çš„é«˜åº¦scrollTop æ»šåŠ¨æ¡æ»šåŠ¨çš„è·ç¦»85.<span class="hljs-keyword">window</span>çš„å¤§å°å’Œæ»šåŠ¨   <span class="hljs-keyword">window</span>.outerWidth<span class="hljs-comment">//</span>   <span class="hljs-keyword">window</span>.innerWidth<span class="hljs-comment">//çª—å£çš„å®½åº¦ï¼Œä¸åŒ…æ‹¬è°ƒè¯•çª—å£å’Œå·¥å…·æ </span>   document.doeumnetElement.offsetWidth document.doeumnetElement.offsetHeight   <span class="hljs-keyword">window</span>.scrollX  è·å–xè½´çš„æ»šåŠ¨ä½ç½® <span class="hljs-keyword">window</span>.scrollY Yè½´çš„æ»šåŠ¨ä½ç½®  ä¹Ÿå¯ä»¥ç”¨åˆ«åpagexOffset  pageYOffset   è®¾ç½®æ»šåŠ¨çš„ä½ç½® <span class="hljs-keyword">window</span>.scrollBy(x,y)<span class="hljs-comment">//åœ¨åŸæ¥çš„ä½ç½®åŸºç¡€ä¸Šå åŠ æ»šåŠ¨çš„ä½ç½®</span>   <span class="hljs-keyword">window</span>.scrollTo(x,y)<span class="hljs-comment">//æ»šåŠ¨åˆ°ç»å¯¹çš„ä½ç½®ï¼Œåˆ°äº†ä½ç½®ä¸ä¼šå˜</span>   <span class="hljs-keyword">window</span>.onscroll<span class="hljs-comment">//ç›‘å¬æ»šåŠ¨</span>   86.äº‹ä»¶<span class="hljs-keyword">on</span>+eventele.addEventListener(<span class="hljs-string">&quot;event&quot;</span>,callback)87.äº‹ä»¶æµäº‹ä»¶å†’æ³¡äº‹ä»¶æ•è·æ•è·é˜¶æ®µ-ã€‹ç›®æ ‡é˜¶æ®µ-ã€‹å†’æ³¡é˜¶æ®µ88.eventå¸¸è§å±æ€§æ–¹æ³•event.<span class="hljs-keyword">type</span>:äº‹ä»¶ç±»å‹event.target:ç›®æ ‡å…ƒç´ event.currentTarget:ç»‘å®šäº‹ä»¶çš„å…ƒç´ event.offsetXevent.clientXevent.pageXevent.screenXtargetå’ŒcurrentTargetçš„åŒºåˆ«targetäº‹ä»¶å‘ç”Ÿçš„å¯¹è±¡ï¼ŒcurrentTargetæ˜¯äº‹ä»¶ç»‘å®šçš„å¯¹è±¡ï¼Œå¦‚æœå¦‚æœç»‘å®šäº‹ä»¶çš„å…ƒç´ å’Œè§¦å‘äº‹ä»¶çš„å…ƒç´ ç›¸åŒæ—¶ï¼Œtarget===currentTargetevent.preventDefault()event.propagetion()<span class="hljs-keyword">on</span>+eventä¸­æ™®é€šå‡½æ•°ä¸­thisæŒ‡å‘ç»‘å®šäº‹ä»¶çš„å…ƒç´ ã€‚addEentListener()ä¹Ÿæ˜¯ä¸€æ ·89.EventTargetç±»æ‰€æœ‰èŠ‚ç‚¹ï¼Œå…ƒç´ éƒ½ç»§æ‰¿è‡ªeventtargetï¼Œ<span class="hljs-keyword">window</span>ä¹Ÿæ˜¯eventTarget.removeEventListener(event,callbackName,)eventTarget.dispatchEvent()90.äº‹ä»¶å§”æ‰˜91.import * from æ˜¯å¦åŒ…å«export defaultexport &#123;&#125;å’Œexport <span class="hljs-keyword">const</span> a ,export <span class="hljs-keyword">const</span> bæœ‰åŒºåˆ«å—92.&lt;div id=<span class="hljs-string">&quot;box&quot;</span>&gt;&lt;/div&gt;box.click()<span class="hljs-comment">//å¦‚æœæ˜¯idï¼Œä¹Ÿå¯ä»¥è¿™æ ·å†™ä½†æ˜¯ä¸æ¨è</span>92.å¸¸è§çš„é¼ æ ‡äº‹ä»¶onclick <span class="hljs-comment">//åªèƒ½æ¥å—eventä½œä¸ºå”¯ä¸€çš„å‚æ•°ï¼Œä¸”ä¸ç”¨å†è°ƒç”¨çš„æ—¶å€™å†™</span>oncontextmenuonmousedownonmouseuponmousemove93.mouseoverå’Œmouseenterçš„åŒºåˆ«mouseenterå’Œmouseleaveä¸æ”¯æŒå†’æ³¡è¿›å…¥å­å…ƒç´ ä¾ç„¶å±äºè¯¥å…ƒç´ åªä¼šè§¦å‘å­å…ƒç´ çš„mouseenterï¼Œçˆ¶å…ƒç´ æ²¡ååº”mouseoverå’Œmouseoutæ”¯æŒå†’æ³¡94.é”®ç›˜äº‹ä»¶onkeydownonkeypressonkeyupevent.code event.key95.onfocuså’Œonblur96.oninputå’Œonchange99.è¡¨å•äº‹ä»¶ onsubmit onreset100.onloadå’ŒDOMContentLoaded101.onresize102.å®šæ—¶å™¨setTimeoutå’ŒsetIntervalæ˜¯<span class="hljs-keyword">window</span>çš„æ–¹æ³•103.ontransitionedç›‘å¬åŠ¨ç”»çš„ç»“æŸåè°ƒç”¨104.<span class="hljs-keyword">tab</span>åˆ‡æ¢ä¸­åˆ‡æ¢.activeçš„æ–¹æ³•1.<span class="hljs-keyword">for</span>å¾ªç¯2.ä½¿ç”¨documnet.queryslector(<span class="hljs-string">&quot;.active&quot;</span>)ä¿®æ”¹3.ä½¿ç”¨åœ¨å¤–é¢è¿›è¡Œå˜é‡è®°å½•105.BOMæµè§ˆå™¨å¯¹è±¡æ¨¡å‹106.node:<span class="hljs-keyword">global</span>==lobalThis<span class="hljs-keyword">window</span>:<span class="hljs-keyword">window</span>==globalThisæ”¾åˆ°<span class="hljs-keyword">window</span>çš„å±æ€§å…¨å±€éƒ½å¯è®¿é—®ç”¨<span class="hljs-keyword">var</span>ç”³æ˜çš„å…¨å±€å¯¹è±¡éƒ½æ”¾åˆ°<span class="hljs-keyword">window</span>å¯¹åƒä¸­<span class="hljs-keyword">var</span> openWin=<span class="hljs-keyword">window</span>.<span class="hljs-keyword">open</span>(<span class="hljs-string">&quot;&quot;</span>)<span class="hljs-comment">//æ‰“å¼€ç½‘å€</span><span class="hljs-keyword">window</span>.<span class="hljs-keyword">close</span>()<span class="hljs-comment">//åªèƒ½å…³é—­é€šè¿‡open()æ‰“å¼€çš„æ–°çš„çª—å£</span>107.<span class="hljs-keyword">window</span>å¸¸è§äº‹ä»¶<span class="hljs-keyword">window</span>.onfocus<span class="hljs-keyword">window</span>.onblur<span class="hljs-keyword">window</span>.onhashchange108.locationå¯¹è±¡å±æ€§ï¼Œç”¨äºè¡¨ç¤º<span class="hljs-keyword">window</span>å½“å‰è¿æ¥urlä¿¡æ¯location.href<span class="hljs-comment">//å®Œæ•´url</span><span class="hljs-comment">//urlä¿¡æ¯</span>location.hostnamelocation.hostloaction.protocollocation.portlocation.pathnamelocation.hashloacation.<span class="hljs-keyword">search</span><span class="hljs-comment">//locationæ–¹æ³•</span>loacation.assign()<span class="hljs-comment">//æ‰“å¼€æ–°çš„ç½‘é¡µï¼Œæ˜¯åŠ å…¥å†å²è®°å½•ç«™ï¼Œå¯ä»¥è¿”å›</span>location.<span class="hljs-keyword">replace</span>()<span class="hljs-comment">//æ›¿ä»£å½“å‰url,ä¸å¯ä»¥è¿”å›</span>loaction.reload()<span class="hljs-comment">//é‡æ–°åŠ è½½</span>109.URLSearchParams<span class="hljs-keyword">var</span> searchParams=new URLSearchParams(str)<span class="hljs-built_in">get</span>(&quot;nameâ€œ)<span class="hljs-keyword">append</span>(<span class="hljs-string">&quot;address&quot;</span>,<span class="hljs-string">&quot;zzzz&quot;</span>)has()<span class="hljs-keyword">set</span>()URLSearchParamså¯ä»¥ä½¿ç”¨<span class="hljs-keyword">for</span>...ofä¸­æ–‡ä½¿ç”¨encodeURLComponmentå’ŒdecodeURLComponmentè¿›è¡Œç¼–è§£ç <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] of searchParams) &#123;&#125;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] of searchParams.entries()) &#123;&#125;110.history<span class="hljs-comment">//å±æ€§</span>history,lengthhistory.state<span class="hljs-comment">//ä¿®æ”¹history</span>history.pushState(&#123;name:<span class="hljs-string">&quot;mike&quot;</span>,age:18&#125;)hsitory.back()history.forword()history.go(-2)replacestate()111.json<span class="hljs-keyword">var</span> item=JSON.stringfy(item)<span class="hljs-keyword">var</span> item=JSON.<span class="hljs-keyword">parse</span>(item)jsonçš„æ–¹æ³•è¿˜å¯ä»¥å®ç°æ·±æ‹·è´<span class="hljs-keyword">var</span> obj=JSON.<span class="hljs-keyword">parse</span>(JSON.strigfy(obj1))112.protobuf113.&amp;gt; &amp;lt;114.&lt;button onclick=<span class="hljs-string">&quot;add()&quot;</span>&gt;æŒ‰é’®&lt;/button&gt;<span class="hljs-comment">//å†å…ƒç´ ä¸Šäº‹ä»¶çš„å†™æ³•</span>115.<span class="hljs-comment">/* è®¾ç½®å›¾ç‰‡æ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘ä¸Šè‡ªåŠ¨å±…ä¸­ï¼Œéšç€æµè§ˆå™¨å¤§å°çš„å˜åŒ– */</span>.img_center&#123;  position: relative;  transform: <span class="hljs-keyword">translate</span>(-50%,-%50);  left: 50%;  top:50%;&#125;</code></pre></div><p>116.</p><p><img src="https://img1.imgtp.com/2022/08/14/lwe19xZA.png" alt="å±å¹•æˆªå›¾ 2022-05-25 175414.png"></p><div class="code-wrapper"><pre><code class="hljs kotlin"><span class="hljs-number">117.</span><span class="hljs-keyword">this</span>çš„æŒ‡å‘<span class="hljs-number">1.</span><span class="hljs-keyword">this</span>çš„æŒ‡å‘æ˜¯ç”±å‡½æ•°è°ƒç”¨æ‰§è¡Œçš„æ—¶å€™å†³å®šçš„<span class="hljs-number">2.</span><span class="hljs-keyword">this</span>çš„ç»‘å®šåˆ†ä¸ºï¼šé»˜è®¤ç»‘å®šï¼šç‹¬ç«‹å‡½æ•°è°ƒç”¨<span class="hljs-keyword">this</span>æ˜¯æŒ‡å‘window,ä¾‹å¦‚fn()éšå¼ç»‘å®šï¼šå¯¹è±¡ä¸­<span class="hljs-keyword">this</span>çš„æŒ‡å‘æ˜¯æŒ‡å‘è°ƒç”¨çš„å¯¹è±¡ï¼Œä¾‹å¦‚obj.fn()æ˜¾ç¤ºç»‘å®š:é€šè¿‡call,apply,bindæ¥è¿›è¡Œæ˜¾ç¤ºç»‘å®šä¸‹ï¼Œ<span class="hljs-keyword">this</span>æŒ‡å‘ç»‘å®šçš„å¯¹è±¡newçš„ç»‘å®šï¼šé€šè¿‡newåˆ›å»ºçš„å¯¹è±¡ï¼Œ<span class="hljs-keyword">this</span>ä¼šæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡<span class="hljs-number">3.</span><span class="hljs-keyword">this</span>æŒ‡å‘çš„ä¼˜å…ˆçº§ï¼šnew&gt;æ˜¾ç¤ºç»‘å®š&gt;éšå¼ç»‘å®š&gt;é»˜è®¤ç»‘å®š<span class="hljs-number">4.</span>ç®­å¤´å‡½æ•°æ˜¯æ²¡æœ‰<span class="hljs-keyword">this</span>,argumentsï¼Œæ˜¯ç”±ä¸Šå±‚å‡½æ•°ä½œç”¨åŸŸæ¥å†³å®šï¼Œä¸€å±‚ä¸€å±‚ä½œç”¨åŸŸæ‰¾æ³¨æ„ï¼š<span class="hljs-keyword">var</span> name=<span class="hljs-string">&quot;mike&quot;</span><span class="hljs-keyword">var</span> obj=&#123;foo()&#123;<span class="hljs-keyword">return</span> ()=&gt;&#123;console.log(<span class="hljs-keyword">this</span>.name)&#125;&#125;&#125;<span class="hljs-comment">//thisä¼šå…ˆå»fooä¸­å»æ‰¾ï¼Œæ‰¾ä¸åˆ°å°±å»å…¨å±€ä½œç”¨åŸŸï¼Œå¯¹è±¡ä¸­æ²¡æœ‰ä½œç”¨åŸŸ</span>ä¸å¯ä»¥ä½¿ç”¨æ˜¾ç¤ºç»‘å®šæ”¹å˜<span class="hljs-keyword">this</span>çš„æŒ‡å‘<span class="hljs-number">5.</span>æ˜¾ç¤ºç»‘å®šä¸­å¦‚æœæŒ‡å‘çš„æ˜¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¦‚æœæœ‰åŒ…è£…ç±»å‹åˆ™è½¬æ¢æˆåŒ…è£…ç±»<span class="hljs-number">6.</span>setTimeoutä¸­çš„<span class="hljs-keyword">this</span>é»˜è®¤æŒ‡å‘window<span class="hljs-number">7.</span>forEachä¸­<span class="hljs-keyword">this</span>é»˜è®¤æŒ‡å‘windowï¼Œå¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°ä¿®æ”¹<span class="hljs-number">8.</span>äº‹ä»¶ç»‘å®šä¸­<span class="hljs-keyword">this</span>æŒ‡å‘ç»‘å®šçš„å…ƒç´ <span class="hljs-number">9.</span>newä¸å¯ä»¥å’Œapplyå’Œcallä¸€èµ·ä½¿ç”¨<span class="hljs-number">10.</span>bindçš„ä¼˜å…ˆçº§é«˜äºcall/apply<span class="hljs-number">11.</span>newçš„ä¼˜å…ˆçº§é«˜äºbind<span class="hljs-number">12.</span>é—´æ¥å‡½æ•°å¼•ç”¨ï¼š<span class="hljs-number">1.</span>(obj1.foo=obj2.foo)()è¿™æ ·ç›´æ¥è°ƒç”¨ï¼Œ<span class="hljs-keyword">this</span>æ˜¯é»˜è®¤ç»‘å®šæŒ‡å‘window<span class="hljs-number">2.</span>(b=person.sauName)()   <span class="hljs-comment">//window</span><span class="hljs-number">13.</span>foo.apply(<span class="hljs-literal">null</span>)/foo.apply(undefined)æŒ‡å‘window<span class="hljs-number">14.</span>ç®­å¤´å‡½æ•°å¯ä»¥æ›¿ä»£<span class="hljs-keyword">var</span> _this=<span class="hljs-keyword">this</span>æ¥æ›¿ä»£ï¼Œå¯ä»¥è·å¾—ä¸Šå±‚ä½œç”¨åŸŸ<span class="hljs-number">118.</span> Array.prototype.slice æ¥å°†ä¸€ä¸ªç±»ä¼¼äºæ•°ç»„çš„å¯¹è±¡ï¼ˆarray-like <span class="hljs-keyword">object</span>ï¼‰è½¬æ¢æˆä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼ŒAaary.prototye.slice.apply()/bind()<span class="hljs-number">119.</span>htmlè§£æè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°cssæ–‡ä»¶ä¼šä¸‹è½½ï¼Œä½†æ˜¯ä¸ä¼šé˜»æ­¢htmlçš„è§£æï¼Œä½†ä¼šé˜»å¡renderçš„æ¸²æŸ“è¿‡ç¨‹<span class="hljs-number">120.</span>å›æµå’Œé‡ç»˜<span class="hljs-number">121.</span>scriptdefer jsçš„ä¸‹è½½å’Œæ‰§è¡Œä¸é˜»å¡Dom treeçš„æ„å»ºdeferä»£ç æ‰§è¡Œçš„æ—¶å€™Domæ„å»ºå®Œæˆï¼Œdeferä¼šåœ¨DomContentLoadä»¥åæ‰§è¡Œå¤šä¸ªdeferé¡ºåºæ‰§è¡Œdeferæ¨èæ”¾åœ¨headä¸­deferä»…é€‚ç”¨äºå¤–éƒ¨è„šæœ¬ï¼Œå¯¹scriptçš„å†…å®¹ä¼šå¿½ç•¥async å¤šä¸ªasyncä¸èƒ½ä¿è¯é¡ºåºæ‰§è¡Œï¼Œä¸ä¼šç»„è®¾Domæ¸²æŸ“ã€‚ä¸èƒ½ä¿è¯DOMContentLoadedä¹‹å‰æˆ–è€…ä¹‹åæ‰§è¡Œè¡Œasyncç”¨äºç‹¬ç«‹è„šæœ¬ï¼Œæ²¡æœ‰å¤–éƒ¨ä¾èµ–<span class="hljs-number">122.</span>å‡½æ•°çš„æ‰§è¡Œæ˜¯åœ¨å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œ<span class="hljs-number">123.</span>å‡½æ•°çš„ä½œç”¨åŸŸé“¾å†å‡½æ•°åˆ›å»ºæ—¶å°±ç¡®å®šäº†ã€‚æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸé“¾</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/hbsvpJ1A.png" alt="å±å¹•æˆªå›¾ 2022-05-29 114030.png"></p><p>å½“æŸ¥æ‰¾å˜é‡çš„æ—¶å€™ï¼Œå‡½æ•°é¦–å…ˆä¼šåœ¨localä¸­å¯»æ‰¾ï¼Œæ‰¾ä¸åˆ°å†å»ä¸Šå±‚ä½œç”¨ä½œç”¨åŸŸå¯»æ‰¾ï¼Œè€Œè¿™ä¸ªå‡½æ•°çš„ä¸Šå±‚ä½œç”¨åŸŸæ˜¯Window</p><p><img src="https://img1.imgtp.com/2022/08/14/YJJTxHz8.png" alt="å±å¹•æˆªå›¾ 2022-05-29 120154.png"></p><p>124.åƒåœ¾å›æ”¶å™¨</p><p>â€‹        1..å¼•ç”¨è®¡æ•°</p><p>â€‹                    å½“ä¸€ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘å®ƒæ—¶ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨å°±+1</p><p>â€‹                    å½“ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ä¸º0æ—¶ï¼Œè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥é”€æ¯æ‰</p><p>â€‹                    è¿™ä¸ªç®—æ³•æœ‰ä¸€ä¸ªå›ç­”çš„å¼Šç«¯å°±æ˜¯ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨</p><p>â€‹        2.æ ‡è®°æ¸…é™¤</p><p>â€‹        3.æ ‡è®°æ•´ç†</p><p>â€‹        4.åˆ†ä»£æ”¶é›†</p><p>â€‹        5.å¢é‡æ”¶é›†</p><p>â€‹        6.é—²æ—¶æ”¶é›†</p><div class="code-wrapper"><pre><code class="hljs 130">125.é—­åŒ…1.ç‹­ä¹‰ï¼šå‡½æ•°å¼•ç”¨å¤–å±‚å‡½æ•°çš„è‡ªç”±å˜é‡å°±æ˜¯é—­åŒ…ã€‚2.é€šè¿‡è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå¤–éƒ¨å¯ä»¥é€šè¿‡è¿™ä¸ªå‡½æ•°è®¿é—®è¿™ä¸ªå‡½æ•°æ‰€åœ¨ä½œç”¨åŸŸé“¾çš„å˜é‡ï¼Œé—­åŒ…å¯ä»¥çªç ´ä½œç”¨åŸŸé“¾126.GUIçš„æ¸²æŸ“å’Œjsçš„æ‰§è¡Œæ˜¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œæ˜¯äº’æ–¥çš„127.foo.name,è·å–å‡½æ•°åfoo.length//è·å–è¡Œå‚ä¸ªæ•°ï¼Œä¸ä¼šæŠŠå‰©ä½™å‚æ•°å’Œé»˜è®¤å‚æ•°è®¡ç®—åœ¨å†…ï¼Œarguments//ç±»æ•°ç»„å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡è·å–å€¼ï¼Œæœ‰lengthå±æ€§ï¼Œæ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œä½†æ˜¯æœ¬èº«ä¸å¯ä»¥ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡Array.prototype.map.call(arguments)æ¥ä½¿ç”¨argumentè½¬array1.forå¾ªç¯ï¼Œå°†argumentä¸€ä¸ªä¸ªæ”¾åˆ°æ•°ç»„ä¸­2.Array.from(argumsnets)3.[...arguments]4.var arr=Array.prototype.slice.call/apply(arguments)//ä¼šæˆªå–æ•´æ®µï¼Œå¹¶è¿”å›æ–°çš„æ•°ç»„æˆ–è€…var arr=[].slice.call/apply(arguments)ç®­å¤´å‡½æ•°æ²¡æœ‰argments,ä¼šå»ä¸Šå±‚ä½œç”¨åŸŸå»æ‰¾arguments128.å‰©ä½™å‚æ•°   å‰©ä½™å‚æ•°å¿…é¡»æ”¾åˆ°æœ€å129.å‰©ä½™å‚æ•°å’Œargumentçš„åŒºåˆ«å‰©ä½™å‚æ•°æ˜¯æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰æ•°ç»„æ–¹æ³•ï¼Œargumentsæ˜¯ç±»æ•°ç»„å‰©ä½™å‚æ•°åªåŒ…å«æ²¡æœ‰å¯¹åº”å½¢å‚çš„å®å‚ï¼ŒargumentsåŒ…å«æ‰€æœ‰å‚æ•°130.çº¯å‡½æ•°ç›¸åŒçš„è¾“å…¥äº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Œä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨ä¸ä¾èµ–å¤–éƒ¨å˜é‡ç¡®å®šè¾“å‡ºä¸èƒ½ä¿®æ”¹å¤–éƒ¨å˜é‡ä½œç”¨ï¼šåªæ˜¯å•çº¯çš„å®ç°è‡ªå·±çš„ä¸šåŠ¡ï¼Œä¸éœ€è¦å…³æ³¨å¤–éƒ¨çš„æ•°æ®å˜åŒ–131.å‡½æ•°æŸ¯é‡ŒåŒ–å°±æ˜¯æŠŠæ¥å—å¤šä¸ªå‡½æ•°çš„å‡½æ•°å˜æˆè¿”å›æ¥å—å•ä¸€å‚æ•°çš„å‡½æ•°var foo=x=&gt;y=&gt;z=&gt;console.log(x+y+z)shiyo132.asyncé»˜è®¤ä¼šè¿”å›promiseasyncçš„è¿”å›å€¼ä¼šè¢«promiseåŒ…è£¹ï¼Œç›¸å½“äºPromise.resolve()await åé¢æ˜¯ä¸€ä¸ªpromsie,åˆ™ä¼šè¿”å›Promise.resolve(res)çš„å€¼å¦‚æœä¸æ˜¯promiseï¼Œåˆ™ç”¨Promise.resolve(res)åŒ…è£¹await ä½¿ç”¨trycatchæ•è·å¼‚å¸¸133.å°è£…è‡ªåŠ¨è½¬åŒ–æˆæŸ¯é‡ŒåŒ–å‡½æ•°134.ç»„åˆå‡½æ•°ç»„åˆå‡½æ•°çš„å°è£…135.Function.prototype.name   Function.prototype.length Function.prototype.displayName136.with(obj)&#123;console.log(message)//æ‰©å±•ä¸€ä¸ªè¯­å¥çš„ä½œç”¨åŸŸé“¾ï¼Œå®ƒé¦–å…ˆä¼šå»objé‡Œé¢å»æ‰¾ï¼Œæ‰¾ä¸åˆ°å†å»ä¸Šå±‚ä½œç”¨åŸŸæ‰¾ï¼Œä½†æ˜¯ä¸æ¨èä½¿ç”¨&#125;137.eval()138.ä¸¥æ ¼æ¨¡å¼å¼€å¯ä¸¥æ ¼æ¨¡å¼çš„æ–¹å¼classå’Œmoduleä¼šè‡ªåŠ¨å¼€å¯ä¸¥æ ¼æ¨¡å¼ä¸¥æ ¼æ¨¡å¼çš„é™åˆ¶1.æ— æ³•æ„å¤–åˆ›å»ºå…¨å±€å˜é‡2.å¼•èµ·é™é»˜æ¨¡å¼å¤±è´¥3.ä¸èƒ½ç”¨with4.thisé»˜è®¤æŒ‡å‘undefined,thisä¸ä¼šè£…æ¢æˆåŒ…è£…ç±»139.Object.defineProperty(obj,prop.descriptor)å±æ€§æè¿°ç¬¦çš„åˆ†ç±»1.æ•°æ®å±æ€§æè¿°ç¬¦ï¼šconfigurable:è¡¨ç¤ºè¿™ä¸ªå±æ€§æ˜¯å¦å¯åˆ é™¤,é»˜è®¤å€¼æ˜¯falseï¼Œä½¿ç”¨deleteä¸å«©åˆ é™¤ï¼Œå¦‚æœè®¾ç½®ä¸ºfalse,åˆ™ä¸å¯ä»¥é…ç½®äº†ï¼Œåç»­å…¶ä»–å±æ€§æè¿°ç¬¦ä¹Ÿä¸å¯ä»¥ä½¿ç”¨äº†ã€‚å°±æ˜¯Configurable:false,åç»­ä¸å¯ä»¥å¯¹è¿™ä¸ªå±æ€§ä½¿ç”¨Object.definePropertyé…ç½®ã€‚enumerable:æ˜¯å¦å¯ä»¥æšä¸¾å±æ€§ï¼Œfalse:forin,Object.keys()è¿™äº›éƒ½ä¸å¯ä»¥ç¾å‰§ï¼Œé»˜è®¤æ˜¯truewritable:æ˜¯å¦å¯ä»¥å†™å…¥ï¼Œé»˜è®¤æ˜¯å¯ä»¥å†™å…¥ï¼Œè®¾ç½®ä¸ºfalseæ˜¯åªè¯»å±æ€§value:&quot;mike&quot;,è®¾ç½®å±æ€§å€¼å¦‚æœä½¿ç”¨å­—é¢é‡åˆ›å»ºå¯¹è±¡ï¼Œåˆ™æ‰€æœ‰å±æ€§æè¿°ç¬¦éƒ½æ˜¯true,object.defineProperty()è®¾ç½®çš„å±æ€§çš„valueçš„ä¼˜å…ˆçº§ä¼šæ¯”å­—é¢é‡åˆ›å»ºçš„å±æ€§è®¾ç½®çš„å€¼é«˜2.å­˜å–å±æ€§æè¿°ç¬¦getsetwiritable,valueå’Œget,setä¸å¯ä»¥åŒæ—¶ä½¿ç”¨140.Object.defineProperties()//åŒæ—¶è®¾ç½®å¤šä¸ªå±æ€§æè¿°ç¬¦141.Object.getOwnPropertyDescriptor(obj, &quot;name1&quot;)//è·å–æŸä¸ªå±æ€§æè¿°ç¬¦142.Object.getOwnPropertyDescriptors(obj)//è·å–æ‰€æœ‰å±æ€§æè¿°ç¬¦143.Object.preventExtensions(obj);//ä¸å…è®¸æ‰©å±•å±æ€§144.object.seal(obj)//å¯†å°å¯¹è±¡ï¼Œä¸å…è®¸é…ç½®å’Œåˆ é™¤å±æ€§ï¼Œå¢åŠ æ–°çš„å±æ€§145.Object.freeze(obj)//ä¸èƒ½ä¿®è¯¥ç°æœ‰å±æ€§ï¼Œä¹Ÿä¸èƒ½å¢åŠ æ–°çš„å±æ€§146.åŸå‹å’ŒåŸå‹é“¾__proto__æ˜¯æµè§ˆå™¨åŠ ï¼Œéæ ‡å‡†çš„ï¼Œè¦çœ‹å„ä¸ªæµè§ˆå™¨å¦‚ä½•å®ç°ï¼Œå»ºè®®ä½¿ç”¨Object.getPrototypeOf(obj)æ¥è·å–å¯¹è±¡çš„åŸå‹__proto__éšå¼åŸå‹prototypeæ˜¾å¼åŸå‹æ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰éšå¼åŸå‹ï¼Œå‡½æ•°æœ‰éšå¼åŸå‹å’Œæ˜¾ç¤ºåŸå‹å½“å¯¹è±¡è·å–å€¼çš„æ—¶å€™p1.addresså¦‚æœå®ä¾‹å¯¹è±¡æ²¡æ²¡æœ‰è¿™ä¸ªå±æ€§åˆ™ä¼šåˆ°ä»–çš„åŸå‹ç»ƒä¸Šå»å¯»æ‰¾å½“å¯¹è±¡å±æ€§èµ‹å€¼çš„æ—¶å€™ï¼Œå¦‚æœè¯¥å±æ€§ä¸å­˜åœ¨åˆ™ä¼šåœ¨å½“å‰å¯¹è±¡ä¸­æ–°å»ºä¸€ä¸ªå±æ€§èµ‹å€¼ï¼Œä¸ä¼šä¿®æ”¹åŸå‹é“¾ä¸Šçš„å±æ€§çš„å€¼p1.address=&quot;us&quot;//è¿™æ ·ä¸ä¼šå¯¹åŸå‹é“¾ä¸Šçš„è¯¥å±æ€§è¿›è¡Œä¿®æ”¹å¦‚æœè¦å¯¹åŸå‹çš„å±æ€§è¿›è¡Œä¿®æ”¹ï¼šPerson.prototype.address=&quot;japan&quot;Person.prototype=&#123;message:&quot;ç« &quot;,info:&#123;&#125;,eating:function()&#123;&#125;,constructor:Person&#125;//ä¿®æ”¹Personçš„æ˜¾ç¤ºåŸå‹æŒ‡å‘æ–°çš„å¯¹è±¡p1.__proto_===Object.prototypeconstructoråº”è¯¥æ˜¯ä¸å¯ä»¥æšä¸¾çš„ï¼Œè¦ç”¨Object.deineProperty()æ¥ä¿®æ”¹å®šä¹‰åŸå‹é“¾ï¼šå®ä¾‹å¯¹è±¡åœ¨æŸ¥æ‰¾æŸä¸ªå±æ€§çš„æ—¶å€™ï¼Œä»–å…ˆå»è‡ªå·±å¯¹è±¡å¯»æ‰¾ï¼Œç„¶åå†å»åŸå‹é“¾é‡Œé¢å»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°nullä¸ºæ­¢147.é¢å‘å¯¹è±¡çš„ç‰¹æ€§:å°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€148.ä½¿ç”¨newå…³é”®å­—åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹1.åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡2.è®©è¿™ä¸ªå¯¹è±¡çš„[[prototype]]å±æ€§æŒ‡å‘è¯¥æ„é€ å‡½æ•°çš„prototypeå¯¹è±¡3.è®©æ„é€ å‡½æ•°çš„ä¸­çš„thisæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡4.æ‰§è¡Œè¯¥æ„é€ å‡½æ•°5.å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›ä¸€ä¸ªéç©ºå¯¹è±¡ï¼Œåˆ™è¿”å›æ–°åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡149.åŸå‹é“¾çš„ç»§æ‰¿1.Student.prototype=Person.prototype//è¿™ç§ç»§æ‰¿è™½ç„¶å¯ä»¥ç»§æ‰¿åˆ°Personçš„æ–¹æ³•ï¼Œä½†æ˜¯æ·»åŠ studentçš„æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šæ·»åŠ åˆ°PersonåŸå‹ä¸Šï¼Œå¯¹Personå’ŒStudentéƒ½ä¼šæœ‰å½±å“2.åŸå‹é“¾ç»§æ‰¿student.prototype=new Person()//æ”¹å–„ä¸Šé¢ä¸€ç§æ–¹æ³•ï¼Œä¸ä¼šå¯¹Person.prototypeä¸Šçš„æ–¹æ³•è¿›è¡Œå¹²æ‰°ä½†æ˜¯ï¼Œå¦‚æœæœ‰å’ŒPersonç›¸åŒçš„å±æ€§çš„æ—¶å€™ä¾‹å¦‚function Student(age,gender,name,weight)&#123;this.age=age;this.gender=gender;this.name=name;this.weight=weigth&#125;age,genderå±æ€§åœ¨pERsoné‡Œé¢ä¹Ÿæœ‰ï¼Œè¿™æ ·ä¼šæœ‰ä»£ç é‡å¤çš„é—®é¢˜ï¼Œä½†æ˜¯å¯ä»¥è·å–åˆ°è‡ªå·±çš„age,genderå¦‚æœä¸å†™ï¼Œè°ƒç”¨çš„æ—¶å€™æ˜¯è·å–åˆ°Personçš„ageå’Œgender,å¤šä¸ªå®ä¾‹å…±äº«ç›¸åŒçš„å±æ€§äº†3.å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿  function Student(age,gender,name,weight)&#123;  Person.call(this,age,gender)  this.name=name;this.weight=weigth  &#125;  ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥å®ç°å±æ€§çš„ç»§æ‰¿  å°†2ï¼Œ3æ–¹æ³•ç»“åˆèµ·æ¥å°±æ˜¯ç»„åˆç»§æ‰¿  student.prototype=new Person(age,gender)//ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•   function Student(age,gender,name,weight)&#123;  Person.call(this,age,gender)//è¿™æ ·æ²¡æœ‰è°ƒç”¨çˆ¶ç±»çš„constructor  this.name=name;this.weight=weigth  &#125;  ç¼ºç‚¹ï¼šnew studentçš„æ—¶å€™æ„é€ å‡½æ•°ä¼šè°ƒä¸¤æ¬¡ï¼Œä¸€æ¬¡Person,ä¸€æ¬¡studentï¼Œæ‹¥æœ‰ä¸¤ä»½çˆ¶ç±»å±æ€§ï¼Œçˆ¶ç±»çš„é™æ€å±æ€§å’Œé™æ€æ–¹æ³•ä¹Ÿæ²¡æœ‰ç»§æ‰¿  4.å¯„ç”Ÿç»„åˆç»§æ‰¿  function Student(age,gender,name,weight)&#123;  Person.call(this,age,gender)  this.name=name;this.weight=weigth  &#125;  inhert(Student,Person)  Object.assign(Student, Person);//ç»§æ‰¿é™æ€å±æ€§å’Œæ–¹æ³•(æˆ–è€…ç§°ä¸ºç±»æ–¹æ³•æˆ–è€…ç±»å±æ€§)150.åŸå‹å¼ç»§æ‰¿å‡½æ•°// ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¤„ç†Object.create()çš„å…¼å®¹æ€§é—®é¢˜        function createObject(o) &#123;          function F() &#123;&#125;          F.prototype = o;          return new F();        &#125;        // å°è£…å·¥å…·å‡½æ•°å®ç°ç»§æ‰¿        function inhert(Subtype, Supertype) &#123;        //Subtype.prototype.__proto__=Supertype.prototype        //Object.setPrototypeOf(Subtype.prototype,Supertype.prototype)          // Subtype.prototype = createObject(Supertype.prototype);          Subtype.prototype = Object.create(Supertype.prototype);//Object.create()ä¸ä¼šè°ƒç”¨constructor          Object.defineProperty(Subtype, &quot;constructor&quot;, &#123;            configurable: false,            enumerable: false,            value: Subtype,            writable: true,          &#125;);        &#125;    //å¯¹è±¡ä¹‹é—´çš„ç»§æ‰¿  function object(o)&#123;  var obj=&#123;&#125;  obj.__proto__=o.prototype//Object,setPrototypeOf(obj,o.prototype)  return obj  &#125;151.Objectæ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»152.obj.hasOwnProperty()ã€//åˆ¤æ–­æ˜¯å¦åœ¨è‡ªå·±èº«ä¸Š&quot;name&quot; in obj//åˆ¤æ–­å±æ€§æ˜¯å¦åœ¨objçš„é‡Œé¢æˆ–è€…åŸå‹é“¾ä¸Šfor in éå†åŸå‹é“¾å¯æšä¸¾å±æ€§å’Œæ–¹æ³•instanceOfPerson.protytype.isPrototypeOf(stu)//åˆ¤æ–­å®ä¾‹æ˜¯å¦åœ¨è«æ ¼åŸå‹é“¾ä¸Šï¼Œåˆ¤æ–­å¯¹è±¡ä¹‹é—´çš„ç»§æ‰¿153.å¯¹è±¡å…·å¤‡__proto__å±æ€§ã€‚å‡½æ•°æœ‰__proto__å’Œprototypeå±æ€§154.Person.run()//è¿™ä¸ªè°ƒç”¨çš„æ˜¯ç±»æ–¹æ³•ï¼Œprotoytypeä¸Šé¢çš„æ–¹æ³•æ˜¯å®ä¾‹æ–¹æ³•155.classå®šä¹‰ç±»classä¼šæœ‰é»˜è®¤çš„constructorclassæ˜¯çš„æ„é€ å‡½æ•°ã€åŸå‹é“¾çš„è¯­æ³•ç³–156.å¯¹è±¡ä¸­è®¿é—®å™¨çš„å†™æ³•var obj = &#123;  name: &quot;mike&quot;,&#125;;//å¯¹è±¡è®¿é—®å™¨çš„å†™æ³•ä¸€Object.defineProperty(obj, &quot;name&quot;, &#123;  configurable: true,  enumerable: true,  get() &#123;    return obj.name;  &#125;,  set(value) &#123;    obj.name = value;  &#125;,&#125;);//å¯¹è±¡è®¿é—®å™¨çš„å†™æ³•äºŒvar obj2 = &#123;  name: &quot;zhang&quot;,  get getName() &#123;    return this.name;  &#125;,  set setName(value) &#123;    this.name = value;  &#125;,&#125;;//ä¸‰class Person &#123;  constructor(name) &#123;    this._name = name;  &#125;  get name() &#123;    return this._name;  &#125;  set name(value) &#123;    this._name = value;  &#125;&#125;157.ç±»æ–¹æ³•/staticæ–¹æ³•ä¸­çš„thisæŒ‡å‘ç±»æœ¬èº«158.classçš„ç»§æ‰¿ extend159.é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§ï¼šå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€å¤šæ€çš„æ¡ä»¶ï¼š1ã€‚å¿…é¡»å®ç°ç»§æ‰¿  2.å¿…é¡»æœ‰çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡  3.jsä¸­å¯ä»¥è¯´åˆ°å¤„æ˜¯å¤šæ€160.å¯¹è±¡å­—é¢é‡å¢å¼ºï¼š1.å±æ€§çš„å¢å¼ºvar name=&quot;why&quot;var obj=&#123;name&#125;2.æ–¹æ³•çš„å¢å¼ºvar obj=&#123;eating()&#123;&#125;&#125;3.è®¡ç®—å±æ€§åobj=&#123;[name]:&#125;161.æ•°ç»„çš„è§£æ„å’Œå¯¹è±¡çš„è§£æ„const [name1,name2,name3]=arrconst &#123;age,name,color&#125;=objconst [name1,name2,...name3]=arr//å°†å‰©ä¸‹çš„å…ƒç´ æ”¾å…¥name3æ•°ç»„ä¸­const [name1,name2,name3=&quot;default&quot;]=arr//è®¾ç½®é»˜è®¤å€¼//å¯¹è±¡çš„è§£æ„æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œæ ¹æ®Keyæ¥è¿›è¡Œè§£æ„//å¯¹è±¡è§£æ„çš„é‡å‘½å  const &#123;age:age1,name:name1&#125;=obj//é‡å‘½åä¸ºage1,name1 //å¯¹è±¡è§£æ„é»˜è®¤å€¼é»˜è®¤å€¼ const &#123;age:age1=18,...other&#125;=obj1//å¯ä»¥ä½¿ç”¨å‰©ä½™è¿ç®—ç¬¦å’Œé»˜è®¤å€¼162.æ‰‹å†™apply,call,bind163.è¯æ³•ç¯å¢ƒè¯æ³•ç¯å¢ƒç”±ç¯å¢ƒè®°å½•å’Œå¤–éƒ¨è¯æ³•ç¯å¢ƒä¸¤éƒ¨åˆ†ç»„æˆä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡å…³è”ä¸¤ä¸ªç¯å¢ƒLexicalEnvironmentå’ŒVariableEnvirmentLexicalEnvironmentç”¨äºå¤„ç†letå’ŒconstVariableEnvirmentç”¨äºå¤„ç†var,function164.https://262.ecma-international.org/8.0/165.letå’Œconstlet/constä¸å¯ä»¥é‡å¤å£°æ˜constå£°æ˜çš„æ˜¯å¼•ç”¨ç±»å‹åˆ™å¯ä»¥ä¿®æ”¹constæŒ‡å‘çš„åœ°å€çš„å†…éƒ¨çš„å˜é‡ï¼Œä½†ä¸å¯ä»¥ä¿®æ”¹constçš„æŒ‡å‘let/constä¸ä¼šå‡ºç°å˜é‡æå‡ï¼Œå¿…é¡»å…ˆå£°æ˜å†ä½¿ç”¨ï¼Œå¦åˆ™ä¼šå‡ºç°æš‚æ—¶æ€§æ­»åŒºlet/constä¼šæå‰åˆ›å»ºå‡ºæ¥ï¼Œä½†æ˜¯ä¸å¯ä»¥è¢«è®¿é—®ï¼Œåªæœ‰èµ‹å€¼çš„æ—¶å€™æ‰å¯ä»¥è®¿é—®æš‚æ—¶æ€§æ­»åŒºå–å†³äºä»£ç æ‰§è¡Œçš„é¡ºåºï¼Œå’Œå®šä¹‰çš„ä½ç½®æ²¡æœ‰å…³ç³»varå®šä¹‰çš„å…¨å±€å˜é‡é»˜è®¤ä¼šæ·»åŠ åˆ°windowä¸Šã€‚è€Œlet/constä¸ä¼šå†windowæ·»åŠ ä»»ä½•å±æ€§var ä¼šè¢«æ·»åŠ åˆ° object environment recordè€Œconst /letä¼šè¢«æ·»åŠ åˆ°decaretive environment record166.å—çº§ä½œç”¨åŸŸlet/const/function/classå£°æ˜æ˜¯æœ‰å—çº§ä½œç”¨åŸŸçš„ï¼Œfoo()//åœ¨è¿™ä¹‹å‰ä¸å¯ä»¥è®¿é—®&#123;function foo()&#123;&#125;&#125;foo()//è¿™æ ·å¯ä»¥è®¿é—®æµè§ˆå™¨åšäº†ç‰¹æ®Šå¤„ç†ï¼Œå¯ä»¥è®©å—çº§ä½œç”¨åŸŸé‡Œé¢çš„å‡½æ•°åœ¨å—çº§ä½œç”¨åŸŸä¹‹åè¢«è®¿é—®167.ç«‹å³æ‰§è¡Œå‡½æ•°ä¼šå½¢æˆé—­åŒ…ï¼Œå½¢æˆè‡ªå·±çš„ä½œç”¨åŸŸ168.for(let i=0;i&lt;btnEls.length;i++)&#123;var btnEl=btnEls[i]btnEl.onclick=function()&#123;console.log(`ç‚¹å‡»äº†$&#123;i&#125;æŒ‰é’®`)&#125;&#125;//ä¼šå½¢æˆ4ä¸ªè¯æ³•ç¯å¢ƒï¼Œæ¯ä¸ªè¯æ³•ç¯å¢ƒéƒ½ä¼šä¿å­˜ç€è‡ªå·±çš„iï¼Œfunctionå¼•ç”¨å¤–å±‚çš„è¯æ³•ç¯å¢ƒï¼Œæ‰€ä»¥æ‰§è¡Œå®Œå¤–å±‚è¯æ³•ä¸ä¼šè¢«é”€æ¯ï¼Œå½“éœ€è¦içš„æ—¶å€™ï¼Œä¼šå¾€ä¸Šå±‚å¯»æ‰¾ï¼Œå› ä¸ºå½“å‰è¯æ³•ç¯å¢ƒä¸­ä¿å­˜ç€i</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/frDfleO9.png" alt="QQæˆªå›¾20220606172932.png"></p><p><img src="https://img1.imgtp.com/2022/08/14/3FHLdHM8.png" alt="QQæˆªå›¾2022060617452911.png"></p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-number">169.</span>æ¨¡æ¿å­—ç¬¦ä¸²<span class="hljs-number">1.</span>æ™®é€šæ¨¡æ¿å­—ç¬¦ä¸²<span class="hljs-number">2.</span>æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²<span class="hljs-number">170</span>,å‡½æ•°é»˜è®¤å€¼<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">arg1,arg2</span>)&#123;arg1=arg1?<span class="hljs-attr">arg1</span>:<span class="hljs-number">0</span>arg1=arg1||<span class="hljs-number">0</span>arg1=(arg===<span class="hljs-literal">null</span>)||(arg1===<span class="hljs-literal">undefined</span>)?<span class="hljs-number">0</span>:arg1<span class="hljs-comment">//es6</span>arg1=arg1??<span class="hljs-string">&quot;æˆ‘æ˜¯é»˜è®¤å€¼&quot;</span>&#125;<span class="hljs-title function_">foo</span>(<span class="hljs-params">arg1,arg2=<span class="hljs-string">&quot;why&quot;</span></span>)&#123;&#125;<span class="hljs-comment">//é»˜è®¤å‚æ•°æœ€å¥½æ”¾åé¢</span>å‰©ä½™å‚æ•°ä¹Ÿæ˜¯æ”¾åœ¨åé¢ï¼Œå¦‚æœä¸¤ä¸ªéƒ½æœ‰çš„è¯ï¼Œå‰©ä½™å‚æ•°æ”¾åé¢<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">&#123;name,age&#125;=&#123;name=<span class="hljs-string">&quot;why&quot;</span>,age=<span class="hljs-number">18</span>&#125;</span>)&#123;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name,age)<span class="hljs-comment">//å¯¹ä¼ å…¥çš„å¯¹è±¡è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œç»™é»˜è®¤å€¼</span>&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">&#123;name=<span class="hljs-string">&quot;why&quot;</span>,age=<span class="hljs-number">18</span>&#125;=&#123;&#125;</span>)&#123;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name,age)<span class="hljs-comment">//å¯¹è±¡å‚æ•°çš„è§£æ„èµ‹å€¼ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°</span>ä¸­æ²¡æœ‰è¯¥å€¼name,ageï¼Œåˆ™ç»™name,ageèµ‹å€¼&#125;é»˜è®¤å‚æ•°ä¸è®¡ç®—åœ¨argumentå†…<span class="hljs-number">171.</span>ç®­å¤´å‡½æ•°æ²¡æœ‰æ˜¾ç¤ºåŸå‹ï¼Œä¸å¯ä»¥ä½œä¸ºæ„é€ å‡½æ•°ï¼Œä¸èƒ½é€šè¿‡<span class="hljs-keyword">new</span>åˆ›å»º<span class="hljs-number">172.</span>å±•å¼€è¿ç®—ç¬¦<span class="hljs-keyword">var</span> obj=&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&quot;why&quot;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>&#125;<span class="hljs-title function_">foo</span>(...obj)<span class="hljs-comment">//è¿™æ ·æ¥ç”¨æ˜¯ä¸å¯ä»¥çš„ï¼Œå› ä¸ºå‡½æ•°å‚æ•°å¿…é¡»æ˜¯å¯è¿­ä»£å¯¹è±¡</span><span class="hljs-number">173.</span>æµ…æ‹·è´ï¼šå°±æ˜¯å°†å¯¹è±¡é‡Œé¢çš„å†…å®¹èµ‹å€¼åˆ°æ–°çš„å¯¹è±¡é‡Œé¢ï¼Œå¦‚æœå¯¹è±¡é‡Œé¢è¿˜æœ‰å¯¹è±¡ï¼Œåˆ™åªä¼šå¤åˆ¶å¯¹è±¡çš„å¼•ç”¨å°±æ˜¯æµ…æ‹·è´åªä¼šæ‹·è´ç¬¬ä¸€å±‚å¯¹è±¡æµ…æ‹·è´çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦å’Œ<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>()<span class="hljs-number">174.</span>ele.<span class="hljs-title function_">append</span>()å’Œele.<span class="hljs-title function_">appendChild</span>()çš„åŒºåˆ«appendå‚æ•°å¯ä»¥æ˜¯node/string appendChildåªèƒ½æ˜¯<span class="hljs-title class_">Node</span>,<span class="hljs-title function_">append</span>()æ²¡æœ‰è¿”å›å€¼ï¼ŒappendChildä¼šè¿”å›æ’å…¥å€¼æœ¬èº«ï¼Œappendå¯ä»¥è¿½åŠ å¤šä¸ªå­—ç¬¦ä¸²ã€nodeï¼Œè€ŒappendChildåªèƒ½åŠ ä¸€ä¸ªèŠ‚ç‚¹<span class="hljs-number">175.</span>æ•°å€¼çš„è¡¨ç¤º<span class="hljs-number">176.</span><span class="hljs-title class_">Symbol</span><span class="hljs-keyword">const</span> s1=<span class="hljs-title class_">Symbol</span>()<span class="hljs-keyword">const</span> obj=&#123;[s1]:<span class="hljs-string">&quot;aaaa&quot;</span>&#125;<span class="hljs-comment">//å¯¹è±¡ä¸­keyå¯ä»¥æ˜¯string/Symbol</span>ç”±<span class="hljs-title class_">Symbol</span>()ç”Ÿæˆæ˜¯ç‹¬ä¸€æ— äºŒçš„<span class="hljs-number">177.</span>setå­˜å‚¨ä»»ä½•ç±»å‹çš„å”¯ä¸€çš„å€¼<span class="hljs-keyword">const</span> set=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()set.<span class="hljs-title function_">add</span>(dd)set.<span class="hljs-title function_">has</span>(dd)set.<span class="hljs-property">size</span><span class="hljs-comment">//è·å–å…ƒç´ æ•°é‡</span>set.<span class="hljs-title function_">delete</span>(value)<span class="hljs-comment">//åˆ é™¤å…ƒç´ </span><span class="hljs-title function_">clear</span>(set)<span class="hljs-comment">//æ¸…ç©º</span>set.<span class="hljs-title function_">forEach</span>()<span class="hljs-comment">//å¯ä»¥ç”¨äºæ•°ç»„çš„éå†</span>set.<span class="hljs-title function_">keys</span>()set.<span class="hljs-title function_">values</span>()<span class="hljs-comment">//keys()å’Œvaluesçš„è¿”å›å€¼æ˜¯ç›¸åŒçš„</span>set.<span class="hljs-title function_">entry</span>()<span class="hljs-comment">//è¿”å›å€¼ä¸º[value,value]</span>forofæ•°ç»„å»é‡<span class="hljs-keyword">const</span> newArr=<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(arr))/[...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(arr)]<span class="hljs-title class_">Set</span>ä¸­<span class="hljs-title class_">NaN</span>===<span class="hljs-title class_">NaN</span><span class="hljs-number">178.</span><span class="hljs-title class_">WeakSet</span><span class="hljs-title class_">WeakSet</span>æ˜¯å¼±å¼•ç”¨ï¼Œå¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶weakSetåªèƒ½å­˜å‚¨å¯¹è±¡weakSetå¯¹å¯¹è±¡éƒ½æ˜¯å¼±å¼•ç”¨çš„ï¼Œæ‰€ä»¥ä¸å¯ä»¥éå†<span class="hljs-title class_">WeakSet</span>ä¸­ç”±<span class="hljs-title function_">has</span>(),<span class="hljs-title function_">add</span>(),<span class="hljs-title function_">delete</span>()å®ƒå’Œ <span class="hljs-title class_">Set</span> å¯¹è±¡çš„åŒºåˆ«æœ‰ä¸¤ç‚¹ï¼š    ä¸<span class="hljs-title class_">Set</span>ç›¸æ¯”ï¼Œ<span class="hljs-title class_">WeakSet</span> åªèƒ½æ˜¯å¯¹è±¡çš„é›†åˆï¼Œè€Œä¸èƒ½æ˜¯ä»»ä½•ç±»å‹çš„ä»»æ„å€¼ã€‚    <span class="hljs-title class_">WeakSet</span>æŒå¼±å¼•ç”¨ï¼šé›†åˆä¸­å¯¹è±¡çš„å¼•ç”¨ä¸ºå¼±å¼•ç”¨ã€‚ å¦‚æœæ²¡æœ‰å…¶ä»–çš„å¯¹<span class="hljs-title class_">WeakSet</span>ä¸­å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™äº›å¯¹è±¡ä¼šè¢«å½“æˆåƒåœ¾å›æ”¶æ‰ã€‚ è¿™ä¹Ÿæ„å‘³ç€ <span class="hljs-title class_">WeakSet</span> ä¸­æ²¡æœ‰å­˜å‚¨å½“å‰å¯¹è±¡çš„åˆ—è¡¨ã€‚ æ­£å› ä¸ºè¿™æ ·ï¼Œ<span class="hljs-title class_">WeakSet</span> æ˜¯ä¸å¯æšä¸¾çš„ã€‚</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/EzcYmE14.png" alt="QQæˆªå›¾20220608150415.png"></p><div class="code-wrapper"><pre><code class="hljs livescript"><span class="hljs-number">179.</span><span class="hljs-built_in">Map</span><span class="hljs-keyword">map</span>ä¹Ÿæ˜¯å¯è¿­ä»£å¯¹è±¡<span class="hljs-keyword">map</span>å¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®ç±»å‹ä½œä¸ºkey,è€Œ<span class="hljs-built_in">Object</span>åªå¯ä»¥ä½¿ç”¨stringã€symbolä½œä¸ºkey<span class="hljs-keyword">const</span> <span class="hljs-keyword">map</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()<span class="hljs-keyword">map</span>.set(info,<span class="hljs-string">&quot;999&quot;</span>)<span class="hljs-keyword">map</span>.<span class="hljs-keyword">delete</span>(info)<span class="hljs-keyword">map</span>.has(info)clear(<span class="hljs-keyword">map</span>)forEach<span class="hljs-keyword">map</span>.get(info)forof<span class="hljs-number">180.</span><span class="hljs-built_in">Map</span>å’Œ<span class="hljs-built_in">Object</span>çš„åŒºåˆ«<span class="hljs-number">181.</span><span class="hljs-built_in">WeakMap</span>keyåªèƒ½æ˜¯å¯¹è±¡ï¼Œå¯¹å¯¹è±¡çš„å¼•ç”¨æ˜¯å¼±å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å¼•ç”¨å¼•ç”¨è¯¥å¯¹è±¡ï¼Œä»–å°±ä¼šè¢«GCå›æ”¶weakMapçš„keyæ˜¯ä¸å¯ä»¥æšä¸¾çš„ï¼Œä¸å¯ä»¥éå†ä¸èƒ½ä½¿ç”¨forof,forEachè¿›è¡Œéå†<span class="hljs-keyword">delete</span>(key)get(key)has(key)set(key,value)weakMapå¯ä»¥è§£å†³<span class="hljs-built_in">Map</span>å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼çš„é—®é¢˜ï¼Œå› ä¸ºæ•°ç»„ä¼šä¸€å€¼å¼•ç”¨æ¯ä¸€ä¸ªkey,valueå‚è€ƒï¼šhttps:<span class="hljs-regexp">//developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakMap</span><span class="hljs-regexp">182.Array.prototype.includes(item)</span><span class="hljs-regexp">183.Math.pow()/**</span><span class="hljs-regexp">184.Object.values(obj)</span><span class="hljs-regexp">185.Object.keys(obj)</span><span class="hljs-regexp">186.Objectã€‚entries(obj)//</span>objå¯ä»¥æ˜¯å¯¹è±¡ï¼Œæ•°ç»„ï¼Œå­—ç¬¦ä¸²è·å–çš„æ•°ç»„å’Œforinéå†çš„é¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯ä¸ä¼šéå†åŸå‹é“¾ä¸Šçš„å±æ€§å’Œæ–¹æ³•<span class="hljs-number">187.</span><span class="hljs-built_in">String</span>.prototype.padStart(æ€»é•¿åº¦,å¡«å……å­—ç¬¦ä¸²)<span class="hljs-regexp">//å­—ç¬¦ä¸²å¡«å…… ä¼šè¿”å›æ–°çš„å­—ç¬¦ä¸²</span><span class="hljs-regexp">ä¾‹å¦‚éšè—åªæ˜¾ç¤ºèº«ä»½è¯çš„éƒ¨åˆ†æ•°å­—ï¼Œå…¶ä½™éƒ¨åˆ†å¡«å……*</span><span class="hljs-regexp">188.Object.getOwnPropertyDescriptors</span><span class="hljs-regexp">189.Array.prototype.flat(number)//</span>å°†å¤šç»´æ•°ç»„æ‰å¹³åŒ–<span class="hljs-number">190.</span><span class="hljs-built_in">Array</span>.prototype.flatMap(callback(currval,index,arr))<span class="hljs-regexp">//ç›¸å½“äºå…ˆä½¿ç”¨mapå†ä½¿ç”¨flat(1)è¿›è¡Œæ‰å¹³åŒ–</span><span class="hljs-regexp">191.æ•°ç»„æ‰å¹³åŒ–çš„æ–¹æ³•</span><span class="hljs-regexp">192.Object.fromEntries(entries)//</span>æŠŠentryè½¬æ¢æˆObjå°†queryStringè½¬æ¢æˆå¯¹è±¡</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/cVkjgfjQ.png" alt="QQæˆªå›¾20220608171027.png"></p><div class="code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-number">193.</span>ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ ??<span class="hljs-number">194.</span>str.trim()/trimStart()/trimRight()<span class="hljs-number">195.</span>å¯é€‰é“¾æ“ä½œç¬¦  ?.å¯ä»¥æ›¿ä»£<span class="hljs-keyword">if</span>(obj.friend&amp;&amp;obj.friend.running)&#123;obj.friend.running()&#125;obj?.friend?.running?.()<span class="hljs-number">196.</span>WeakRef//æš‚æ—¶ä¸å»ºè®®ä½¿ç”¨<span class="hljs-number">197.</span>é€»è¾‘èµ‹å€¼è¿ç®—ç¬¦message=message||&quot;é»˜è®¤å€¼&quot;=&gt;message||=&quot;é»˜è®¤å€¼&quot;message??=&quot;é»˜è®¤å€¼&quot;obj&amp;&amp;obj.friend&amp;&amp;obj.friend.running()<span class="hljs-number">198.</span>const <span class="hljs-built_in">new</span>=str.replaceAll()//æ›¿æ¢æ‰€æœ‰åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²  åŸå§‹å­—ç¬¦ä¸²ä¿æŒä¸å˜ã€‚<span class="hljs-number">199.</span>str.at(<span class="hljs-keyword">index</span>)<span class="hljs-number">200.</span><span class="hljs-keyword">Object</span>.hasOwn(obj,propKey)//å¯ä»¥æ›¿ä»£obj.hasOwnProperty(prop),å› ä¸ºhasOwnProperty()å¯èƒ½ä¼šè¢«ä½¿ç”¨è€…é‡å†™const <span class="hljs-keyword">info</span>=<span class="hljs-keyword">Object</span>.<span class="hljs-keyword">create</span>(<span class="hljs-keyword">null</span>)//è¿™æ ·åˆ›å»ºçš„å¯¹ä¸‹ä¸ªåŸå‹æŒ‡å‘<span class="hljs-keyword">null</span><span class="hljs-keyword">info</span>.name=&quot;why&quot;<span class="hljs-keyword">info</span>.hasOwnProperty(<span class="hljs-type">name</span>)//ç”±äºåŸå‹æŒ‡å‘<span class="hljs-keyword">null</span>,æ‰€ä»¥è·å–ä¸åˆ°hasOwnPropertyæ–¹æ³•éœ€è¦ä½¿ç”¨<span class="hljs-keyword">Object</span>.hasOwn()æ›¿ä»£<span class="hljs-number">201.</span><span class="hljs-keyword">Object</span>.<span class="hljs-keyword">create</span>()åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½¿ç”¨ç°æœ‰çš„å¯¹è±¡æ¥ææä¾›æ–°åˆ›å»ºå¯¹è±¡çš„__proto__<span class="hljs-keyword">Object</span>.<span class="hljs-keyword">create</span>(proto,[prppertiesObject])<span class="hljs-number">202.</span><span class="hljs-keyword">Class</span> Person&#123;height=<span class="hljs-number">1.88</span>//åœ¨è¿™é‡Œå†™çš„æ—¶å€™ï¼Œ<span class="hljs-built_in">new</span>åˆ›å»ºå¯¹è±¡æ—¶ä¹Ÿä¼šè¢«æ·»åŠ åˆ°æ–°çš„å¯¹è±¡é‡Œé¢ï¼Œå†<span class="hljs-keyword">class</span>å†…éƒ¨å¯ä»¥é€šè¿‡thisæ¥è®¿é—®constructor(<span class="hljs-type">name</span>,age)&#123;this.name=<span class="hljs-type">name</span>this.age=agethis.address=&quot;å¹¿å·å¸‚&quot;&#125;static &#123;//é™æ€ä»£ç å—&#125;&#125;<span class="hljs-number">203.</span>proxy<span class="hljs-keyword">Object</span>.defineProperty()çš„ç¼ºç‚¹ï¼Œä¸å¯ä»¥ç›‘å¬åˆ°å¯¹è±¡å±æ€§çš„æ–°å¢å’Œåˆ é™¤æ“ä½œï¼Œæ–°å¢çš„å±æ€§ä¹Ÿæ²¡åŠæ³•ç›‘å¬ï¼Œåªèƒ½ç›‘å¬å±æ€§ï¼Œä¸èƒ½ç›‘å¬æ•´ä¸ªå¯¹è±¡</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/EQg1fUBC.png" alt="QQæˆªå›¾20220609114316.png"></p><div class="code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Proxy</span>æ˜¯ç›‘å¬æ•´ä¸ªå¯¹è±¡ï¼Œä»–æœ‰<span class="hljs-number">13</span>ä¸ªæ•è·å™¨ï¼Œè¿™äº›æ•è·å™¨å¯ä»¥åŠ«æŒå¯¹è±¡çš„ä¸€äº›æ“ä½œç”¨proxyæ›¿ä»£objæ“ä½œ</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/aIkHlWXU.png" alt="QQæˆªå›¾20220609115247.png"></p><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-number">204.</span><span class="hljs-built_in">Reflect</span>çš„ä½œç”¨<span class="hljs-built_in">Reflect</span>æ˜¯ä¸ºäº†æ›¿ä»£<span class="hljs-built_in">Object</span>ä¸­çš„ä¸€äº›æ–¹æ³•</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/KQev7yPJ.png" alt="QQæˆªå›¾20220609153635.png"></p><p><img src="https://img1.imgtp.com/2022/08/14/0fcGhnc0.png" alt="QQæˆªå›¾20220609153658.png"></p><p><img src="https://img1.imgtp.com/2022/08/14/MDMfI710.png" alt="QQæˆªå›¾20220609153711.png"></p><div class="code-wrapper"><pre><code class="hljs stylus"><span class="hljs-number">205</span><span class="hljs-selector-class">.Reflect</span>.constructçš„ä½œç”¨Reflect<span class="hljs-selector-class">.construct</span>(target, argumentsList<span class="hljs-selector-attr">[, newTarget]</span>)</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/BXFFyjjm.png" alt="QQæˆªå›¾20220609155310.png"></p><p>â€‹    </p><div class="code-wrapper"><pre><code class="hljs scss"><span class="hljs-number">206</span><span class="hljs-selector-class">.new</span><span class="hljs-selector-class">.target</span>ä½œç”¨<span class="hljs-number">207</span><span class="hljs-selector-class">.promise</span>ä¸‰ç§çŠ¶æ€ï¼špendingfulfilledrejectedçŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¸å¯ä»¥æ›´æ”¹<span class="hljs-built_in">resolve</span>(value)<span class="hljs-comment">//valueä¼šä½œä¸ºthenæ–¹æ³•ä¸­çš„å›è°ƒå‡½æ•°çš„å‚æ•°</span><span class="hljs-number">1</span>.æ™®é€šå€¼åˆ™ä½œä¸ºå‚æ•°ç›´æ¥ä¼ è¿‡å»<span class="hljs-number">2</span>.å¦‚æœä¼ å…¥çš„æ˜¯promise,åˆ™ç”±promiseçš„ä¸­çš„Â·resolveå‚æ•°å†³å®š<span class="hljs-number">3</span><span class="hljs-selector-class">.thenable</span>å¯¹è±¡åˆ™ä¼šæ‰§è¡Œthenæ–¹æ³•å¹¶ä¸”ç”±thenæ–¹æ³•ä¸­çš„resloveçš„å‚æ•°å†³å®š<span class="hljs-built_in">then</span>()<span class="hljs-comment">//å¯ä»¥ä¼ ä¸¤ä¸ªå‚æ•°ï¼ŒæˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒ</span><span class="hljs-built_in">catch</span>()<span class="hljs-comment">//å¤±è´¥çš„å›è°ƒ</span><span class="hljs-number">208</span><span class="hljs-selector-class">.Window</span><span class="hljs-selector-class">.getComputedStyle</span>(ele,prop?)å’ŒElement<span class="hljs-selector-class">.getBoundingClientRect</span>()çš„åŒºåˆ«getComputedStyleæ˜¯å®šä¹‰åœ¨windowä¸Šçš„æ–¹æ³•ï¼ŒgetBoundingClientRectæ˜¯Elementçš„æ–¹æ³•ï¼ŒgetComputedStyleè¿”å›å€¼æ˜¯CSSå±æ€§å€¼ï¼Œè€ŒgetBoundingClientRectè¿”å›çš„æ˜¯å…·ä½“çš„ä½ç½®ä¿¡æ¯</code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/OJQOJUb1.png" alt="QQæˆªå›¾20220611104648.png"></p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-number">209.</span><span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">then</span>()<span class="hljs-comment">//è¿”å›å€¼æ˜¯ä¸€ä¸ªpromise,é“¾å¼è°ƒç”¨ä¸­ï¼Œthenä¼šç­‰å¾…ä¸Šä¸€ä¸ªthençš„è¿”å›å€¼promiseçš„çŠ¶æ€æ¥å†³å®š</span><span class="hljs-keyword">const</span> promise=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<span class="hljs-title function_">resolve</span>(<span class="hljs-number">111</span>)&#125;)promise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>&#123;<span class="hljs-keyword">return</span> res&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>&#123;&#125;)thençš„è¿”å›å€¼<span class="hljs-number">1.</span>æ™®é€šå€¼åˆ™ä¼šç›´æ¥åŒ…è£¹æˆpromiseè¿”å›<span class="hljs-number">2.</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span> åˆ™æœ‰è¿™ä¸ªpromiseçš„çŠ¶æ€æ¥å†³å®š<span class="hljs-number">3.</span>æœ‰thenableæ–¹æ³•çš„å¯¹è±¡ï¼Œåˆ™ç”±thenableæ–¹æ³•çš„çŠ¶æ€æ¥å†³å®šthenæŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œå°±å¤„äºrejectçŠ¶æ€ï¼Œåˆ™ä¼šè°ƒç”¨åé¢çš„<span class="hljs-keyword">catch</span>then <span class="hljs-keyword">return</span> æ—¶å¤„äºfulfilledthenæ²¡æœ‰è¿”å›å€¼åˆ™ä¸ä¼šç»§ç»­è°ƒç”¨then<span class="hljs-number">210.</span><span class="hljs-title class_">Promsie</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">catch</span>()<span class="hljs-keyword">catch</span> é‡Œé¢è°ƒç”¨<span class="hljs-keyword">return</span>çš„æ—¶å€™é»˜è®¤çŠ¶æ€æ˜¯fuifilled,ä»–çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªpromiseå’Œthenä¸€æ ·å¦‚æœå‘ç»§ç»­é“¾å¼è°ƒç”¨<span class="hljs-keyword">catch</span>ï¼Œéœ€è¦æŠ›å‡ºå¼‚å¸¸å½“promiseä¸­è°ƒç”¨rejectçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨æœ€è¿‘<span class="hljs-keyword">catch</span>æ²¡æœ‰è¿”å›å€¼æ—¶ä¸ä¼šç»§ç»­é“¾å¼è°ƒç”¨<span class="hljs-number">211.</span>ä¸­æ–­å‡½æ•°çš„æ‰§è¡Œ<span class="hljs-keyword">return</span><span class="hljs-keyword">throw</span>å‰ä¸¤ç§ä¼šç›´æ¥ç»“æŸå‡½æ•°çš„æ‰§è¡Œ<span class="hljs-keyword">yield</span></code></pre></div><p><img src="https://img1.imgtp.com/2022/08/14/ws0WolVm.png" alt="QQæˆªå›¾20220612095542.png"></p><p>212.Promise.prototype.finally(callback)    </p><p>â€‹        æ— è®ºPromiseå¯¹è±¡å˜æˆfulfilledè¿˜æ˜¯rejectedçŠ¶æ€ï¼Œæœ€ç»ˆéƒ½ä¼šæ‰§è¡Œ</p><p>â€‹        finallyæ–¹æ³•çš„å›è°ƒå‡½æ•°å‚æ•°æ˜¯ä¸æ¥å—å‚æ•°çš„</p><ol start="213"><li><p>Promise.resolve()ç›¸å½“äºnew Promsie()å¹¶ä¸”æ‰§è¡Œresolveæ–¹æ³•ã€‚</p><p>å°±æ˜¯å¸Œæœ›å°†å˜é‡è½¬æ¢æˆPromiseæ¥ä½¿ç”¨</p><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">&quot;why&quot;</span>)=<span class="hljs-function">=&gt;</span><span class="hljs-keyword">new</span> Promsise(<span class="hljs-function"><span class="hljs-params">(resolve)</span>=&gt;</span>resolve(<span class="hljs-string">&quot;why&quot;</span>))å‚æ•°å’Œresolveä¸€æ ·</code></pre></div></li><li><p>Promise.reject() rejectæ–¹æ³•ç±»ä¼¼äºresolveæ–¹æ³•ï¼Œåªæ˜¯ä¼šå°†Promiseå¯¹è±¡çš„çŠ¶æ€è®¾ç½®ä¸ºrejectçŠ¶æ€</p><div class="code-wrapper"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Promise</span>.</span></span>reject(<span class="hljs-string">&quot;why&quot;</span>)=&gt;<span class="hljs-keyword">new</span> <span class="hljs-constructor">Promise((<span class="hljs-params">_</span>,<span class="hljs-params">reject</span>)</span>=&gt;reject(<span class="hljs-string">&quot;why&quot;</span>))<span class="hljs-comment">//_ä¸ä¼ å¯ä»¥è¿™æ ·å†™</span><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Promsie</span>.</span></span>rejectæ— è®ºä¼ ä»€ä¹ˆå‚æ•°éƒ½æ˜¯rejected</code></pre></div></li><li><p>Promsie.all([])</p><div class="code-wrapper"><pre><code class="hljs arcade">ä»–çš„ä½œç”¨æ˜¯å°†å¯¹å„promise,æ”¾å…¥åˆ°æ•°ç»„ä¸­æ‰§è¡Œï¼Œ<span class="hljs-built_in">all</span>æ–¹æ³•çš„æœ€ç»ˆçŠ¶æ€æ˜¯ç”±æ•°ç»„ä¸­çš„æ‰€æœ‰promisekç»“æœå†³å®šçš„ï¼Œå¦‚æœPromiseæ‰€æœ‰çŠ¶æ€éƒ½æ˜¯fulfilledçŠ¶æ€åˆ™Pramise.<span class="hljs-built_in">all</span>çš„çŠ¶æ€ä¸ºfulfilledï¼Œå¹¶ä¸”å°†æ‰€æœ‰æ•°ç»„ä¸­çš„promiseçš„è¿”å›å€¼åšæˆä¸€ä¸ªæ•°ç»„è¿”å›å¦‚æœæ•°ç»„ä¸­å‡ºç°ä¸€ä¸ªpromiseçŠ¶æ€ä¸ºrejectedåˆ™<span class="hljs-built_in">all</span>çš„çŠ¶æ€ä¹Ÿä¼šå˜æˆrejected,å¹¶å°†ç¬¬ä¸€ä¸ªrejectçš„è¿”å›å€¼ä½œä¸ºå‚æ•°Promsie.<span class="hljs-built_in">all</span>([p1,p2,p3]).then(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>res).catch(<span class="hljs-function"><span class="hljs-params">err</span>=&gt;</span>err)</code></pre></div></li><li><p>Promise.allSettled([])</p><div class="code-wrapper"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Promsie</span>.</span></span>all<span class="hljs-constructor">Settled([<span class="hljs-params">p1</span>,<span class="hljs-params">p2</span>,<span class="hljs-params">p3</span>])</span>.<span class="hljs-keyword">then</span>(res=&gt;res)<span class="hljs-comment">//çŠ¶æ€éƒ½æ˜¯fulfilled,ä¼šè¿”å›ä¸€ä¸ª[&#123;stattus:fulfilled/rejected,value:&quot;&quot;&#125;]</span></code></pre></div></li><li><p>Promsie.race([])</p><div class="code-wrapper"><pre><code class="hljs cpp">receçš„çŠ¶æ€ç”±[]ä¸­çš„promiseé‚£ä¸ªå…ˆå®Œæˆçš„çŠ¶æ€æ¥å†³å®šçš„</code></pre></div></li><li><p>Promise.any([])</p></li></ol><div class="code-wrapper"><pre><code class="hljs cpp">åªè¦[]ä¸­çš„promiseä¸­çš„ç¬¬ä¸€ä¸ªå˜æˆfulfilledçš„çŠ¶æ€æ¥å†³å®šçš„ï¼Œè¿”å›å€¼ä¹Ÿæ˜¯è¿™ä¸ªpromiseè¿”å›å€¼å¦‚æœæ‰€æœ‰çš„promsieçŠ¶æ€éƒ½æ˜¯rejectedåˆ™ä¼šå˜æˆanyçš„çŠ¶æ€ä¼šå˜æˆrejectæœæ‰€æœ‰çš„Promiseéƒ½æ˜¯rejectçš„ï¼Œé‚£ä¹ˆä¼šæŠ¥ä¸€ä¸ªAggregateErrorçš„é”™è¯¯ã€‚</code></pre></div><p>219.è¿­ä»£å™¨</p><p>220.asyncå‡½æ•°çš„æ‰§è¡Œ</p><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-keyword">async</span>å‡½æ•° æ²¡æœ‰<span class="hljs-keyword">await</span>çš„è¯åˆ™å’Œæ™®é€šçš„å‡½æ•°æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½æ˜¯ä¼šåŒæ­¥æ‰§è¡Œè¿”å›å€¼å¦‚æœæ˜¯æ™®é€šå€¼åˆ™ä¼šè¢«<span class="hljs-built_in">Promise</span>.resolve()åŒ…è£¹è¿”å›å€¼æ˜¯promsieæ—¶ï¼Œä¼šæœ‰promiseçš„çŠ¶æ€æ¥å†³å®šè¿”å›å€¼æ˜¯thenableå¯¹è±¡ï¼Œåˆ™ç”±thenableçš„çŠ¶æ€æ¥å†³å®š<span class="hljs-keyword">async</span>å‡½æ•°çš„æ‰§è¡Œå‡½æ•°çš„æ‰§è¡Œå‡½æ•°æƒ³è¿”å›rejectçŠ¶æ€ï¼Œè°ƒç”¨<span class="hljs-keyword">catch</span>,å¯ä»¥ä½¿ç”¨è¿”å›ä¸€ä¸ªpromsie é‡Œé¢ç”¨reject(),thenableä¹Ÿæ˜¯ä¸€æ ·ï¼Œæˆ–è€…ä½¿ç”¨<span class="hljs-built_in">Promise</span>.reject()è¿˜å¯ä»¥ç”¨<span class="hljs-keyword">throw</span> æ¥æŠ›å‡ºå¼‚å¸¸<span class="hljs-keyword">async</span>çš„å¼‚å¸¸ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯ä¼šä½œä¸º<span class="hljs-built_in">Promise</span>.rejectæ¥ä¼ é€’<span class="hljs-keyword">await</span>å…³é”®å­— åªèƒ½åœ¨<span class="hljs-keyword">async</span>é‡Œé¢ä½¿ç”¨<span class="hljs-keyword">await</span> ä¹‹åçš„ä»£ç ç›¸å½“äºPromsie.<span class="hljs-keyword">then</span>(),<span class="hljs-keyword">await</span>è¦æ•è·é”™è¯¯éœ€è¦ä½¿ç”¨<span class="hljs-keyword">try</span>...<span class="hljs-keyword">catch</span><span class="hljs-keyword">await</span> åé¢è·Ÿçš„ä»£ç æ˜¯<span class="hljs-built_in">Promise</span>.resolveåŒ…è£¹ï¼Œä¼šç­‰å¾…promiseçš„è¿”å›å€¼<span class="hljs-keyword">await</span>ä¼šé˜»å¡ä»£ç çš„æ‰§è¡Œï¼Œç­‰å¾…promiseè¿”å›å€¼ï¼Œ<span class="hljs-keyword">await</span>ä¹‹å‰éƒ½æ˜¯åŒæ­¥çš„</code></pre></div><p>221.æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯</p><p>â€‹        å®ä»»åŠ¡é˜Ÿåˆ—(marcotask queue)ï¼š</p><div class="code-wrapper"><pre><code class="hljs coffeescript">ajax,<span class="hljs-built_in">setTimeout</span>,<span class="hljs-built_in">setInterval</span>,DOMç›‘å¬ï¼ŒUI Renderingç­‰</code></pre></div><p>â€‹        å¾®ä»»åŠ¡é˜Ÿåˆ—(microtask queue)</p><div class="code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">Promise</span>çš„<span class="hljs-keyword">then</span>å›è°ƒï¼ŒMutation Obderver API queueMicrotask <span class="hljs-keyword">async</span> <span class="hljs-keyword">await</span></code></pre></div><p>â€‹    æ‰§è¡Œå®ä»»åŠ¡ä¹‹å‰ï¼Œä¼šå…ˆæ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œå…ˆæ‰§è¡Œå¾®ä»»åŠ¡</p><p>222.é”™è¯¯å¤„ç†æ–¹æ¡ˆ</p><p>â€‹        throw ä¼šä¸­æ–­åé¢ä»£ç çš„æ‰§è¡Œ</p><div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">throw</span> <span class="hljs-title class_">String</span>/<span class="hljs-built_in">number</span>/<span class="hljs-built_in">boolean</span>/<span class="hljs-title class_">Object</span></code></pre></div><p>â€‹        å¼‚å¸¸çš„æ•è·</p><p>â€‹        try..catch..finally</p><p>223.cookieå­˜å‚¨æ˜¯ç”±æµè§ˆå™¨è‡ªåŠ¨åšçš„ï¼Œæºå¸¦cookieä¹Ÿæ˜¯ç”±æµè§ˆå™¨åšçš„</p><p>224.Storage</p><p>â€‹        localStorageåœ¨é¡µé¢å…³é—­å¹¶é‡æ–°æ‰“å¼€æ—¶ä¸ä¼šè¢«æ¸…é™¤ï¼ŒsessionStroageä¼šè¢«æ¸…é™¤</p><p>â€‹        åœ¨é¡µé¢å†…å‘ç”Ÿè·³è½¬ä¸æ‰“å¼€æ–°é¡µé¢æ—¶ï¼ŒsessionStorageå’ŒlocalStorageéƒ½ä¼šè¢«ä¿ç•™</p><p>â€‹        åœ¨é¡µé¢å¤–å‘ç”Ÿè·³è½¬æ‰“å¼€æ–°çš„é¡µé¢æ—¶ï¼ŒsessionStorageä¸ä¿å­˜ï¼ŒlocalStorageä¼šä¿å­˜</p><p>â€‹        sessionStorageåªä¼šåœ¨æœ¬æ¬¡ä¼šè¯ä¸­å­˜å‚¨ï¼Œä¸ä¼šåœ¨æ–°é¡µé¢ä¸­è·å–</p><p>225.cacheå·¥å…·çš„å°è£…</p><p>226.æ­£åˆ™è¡¨è¾¾å¼</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> re1=<span class="hljs-keyword">new</span> <span class="hljs-title class_">REgExp</span>(pattern,<span class="hljs-string">&quot;ig&quot;</span>)<span class="hljs-comment">//new åˆ›å»º</span><span class="hljs-keyword">const</span> re2=<span class="hljs-regexp">/aaaa/ig</span> <span class="hljs-comment">//å­—é¢é‡å†™æ³•</span>message.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-regexp">/abc/ig</span>,<span class="hljs-string">&quot;cba&quot;</span>)message.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-regexp">/\d+/ig</span>,<span class="hljs-string">&quot;cba&quot;</span>)message.<span class="hljs-title function_">test</span>(<span class="hljs-regexp">/^abc$/ig</span>)<span class="hljs-comment">//è¿”å›å€¼æ˜¯booleanå€¼</span>message.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/abc/ig</span>)<span class="hljs-comment">//è¿”å›åŒ¹é…åˆ°çš„å€¼çš„æ•°ç»„ç»“åˆ</span>message.<span class="hljs-title function_">matchAll</span>(<span class="hljs-regexp">/abc/ig</span>)<span class="hljs-comment">//å¿…é¡»åŠ g,è¿”å›å€¼æ˜¯è¿­ä»£å™¨</span>message.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/abc/ig</span>)message.<span class="hljs-title function_">search</span>(<span class="hljs-regexp">/abc/i</span>)<span class="hljs-comment">//è¿”å›ç´¢å¼•ï¼Œæ²¡æœ‰åˆ™è¿”å›-1</span>å¸¸è§ä¿®é¥°ç¬¦g åŒ¹é…å…¨éƒ¨i å¿½ç•¥å¤§å°å†™m å¤šè¡ŒåŒ¹é…è§„åˆ™\d digit ä¸€ä¸ªæ•°å­—<span class="hljs-number">0</span>-<span class="hljs-number">9</span>\s space ä¸€ä¸ªç©ºæ ¼å­—ç¬¦ï¼Œæ¢è¡Œç¬¦,\t,\n\w word ä¸€ä¸ªæ‹‰ä¸å­—æ¯æˆ–è€…æ•°å­—ï¼Œä¸‹åˆ’çº¿.  åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œé™¤äº†æ¢è¡Œç¬¦åå‘ç±»\D éæ•°å­— é™¤\dä»¥å¤–å­—ç¬¦ å¦‚å­—æ¯\S éç©ºæ ¼ \W éå•å­—å­—ç¬¦è½¬ä¹‰/\./ig å¯¹.è¿›è¡Œè½¬ä¹‰[,],\,^,$,.,|,?,*,+,(,),/  å¸¸è§çš„éœ€è¦è¿›è¡Œè½¬ä¹‰<span class="hljs-keyword">const</span> jsfile=<span class="hljs-regexp">/\.jsx?$/</span>  ?è¡¨ç¤ºå‰é¢çš„å­—ç¬¦å¯é€‰é›†åˆåŒ¹é…åˆ°å¤šä¸ªå­—ç¬¦ä¸­çš„å…¶ä¸­ä¹‹ä¸€.ç”¨[]/[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]/,<span class="hljs-regexp">/[156]/</span><span class="hljs-keyword">const</span> phone=<span class="hljs-regexp">/^1[3-9]\d&#123;9&#125;$/</span> <span class="hljs-comment">//åŒ¹é…ç”µè¯å·ç </span>æ’é™¤èŒƒå›´[^...]ï¼Œä¸åŒ¹é…æ‹¬å·é‡Œé¢çš„é‡è¯/a&#123;<span class="hljs-number">5</span>&#125;/ åŒ¹é…<span class="hljs-number">5</span>ä¸ªa /a&#123;<span class="hljs-number">3</span>,<span class="hljs-number">5</span>&#125;/åŒ¹é…<span class="hljs-number">3</span>-<span class="hljs-number">5</span>ä¸ªaç¼©å†™+:ä¸€ä¸ªæˆ–è€…å¤šä¸ª,&#123;<span class="hljs-number">1</span>,&#125;?:<span class="hljs-number">0</span>æˆ–è€…<span class="hljs-number">1</span>ä¸ª &#123;<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&#125;*:<span class="hljs-number">0</span>ä¸ªæˆ–è€…å¤šä¸ª &#123;<span class="hljs-number">0</span>,&#125;<span class="hljs-keyword">const</span> tag=<span class="hljs-regexp">/&lt;\/?[a-z][a-z0-9]*\/?/ig</span>  åŒ¹é…å¤šä¸ªå…ƒç´ æ ‡ç­¾è´ªå©ªæ¨¡å¼å’Œæƒ°æ€§æ¨¡å¼<span class="hljs-keyword">const</span> name=<span class="hljs-regexp">/ã€Š.+?ã€‹/g</span> æƒ°æ€§æ¨¡å¼<span class="hljs-keyword">const</span> name=<span class="hljs-regexp">/ã€Š.+ã€‹/g</span> è´ªå©ªæ¨¡å¼æ•è·ç»„<span class="hljs-keyword">const</span> name=<span class="hljs-regexp">/ã€Š(.+?)ã€‹/g</span>str.<span class="hljs-title function_">matchAll</span>(name)æœªå­¦å®Œ<span class="hljs-number">227.</span>http è¶…æ–‡æœ¬ä¼ è¾“åè®®  é»˜è®¤ç«¯å£æ˜¯<span class="hljs-number">80</span>ç«¯å£ï¼Œæ˜¯åº”ç”¨å±‚åè®®<span class="hljs-number">228.</span><span class="hljs-variable constant_">HTTP</span>ç»„æˆä¸€æ¬¡è¯·æ±‚åŒ…æ‹¬requestå’Œresponse<span class="hljs-number">229.</span>httpç‰ˆæœ¬<span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.0</span><span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span> æ·»åŠ äº†æŒä¹…åŒ–è¿æ¥<span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">2.0</span><span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">3.0</span><span class="hljs-number">230.</span><span class="hljs-variable constant_">HTTP</span>çš„è¯·æ±‚æ–¹å¼<span class="hljs-variable constant_">GET</span><span class="hljs-variable constant_">HEAD</span><span class="hljs-comment">//å’Œgetç›¸ä¼¼,ä½†æ˜¯æ²¡æœ‰å“åº”ä½“ï¼Œä¾‹å¦‚å‡†å¤‡ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶å‰ï¼Œå…ˆè·å–æ–‡ä»¶çš„å¤§å°ï¼Œå†å†³å®šæ˜¯å¦è¿›è¡Œä¸‹è½½</span><span class="hljs-variable constant_">POST</span><span class="hljs-comment">//å°†å®ä½“æäº¤åˆ°æŒ‡å®šçš„èµ„æº</span><span class="hljs-variable constant_">PUT</span><span class="hljs-comment">//æ›¿æ¢æ‰€æœ‰æ•°æ®</span><span class="hljs-variable constant_">DELETE</span><span class="hljs-variable constant_">PATCH</span><span class="hljs-comment">//å¯¹éƒ¨åˆ†æ•°æ®è¿›è¡Œä¿®æ”¹</span><span class="hljs-variable constant_">CONNECT</span><span class="hljs-variable constant_">TRACE</span><span class="hljs-number">231.</span>request headercontent-typeæ˜¯è¯·æ±‚æºå¸¦çš„æ•°æ®ç±»å‹application/x-www-form-urlencoded è¡¨ç¤ºè¢«ç¼–ç æˆä»¥&amp;åˆ†éš”name=why&amp;age=<span class="hljs-number">18</span>application/json è¡¨ç¤ºæ˜¯ä¸€ç§jsonç±»å‹text/plain è¡¨ç¤ºæ–‡æœ¬ç±»å‹application/xmlmultipart/form-data <span class="hljs-comment">//è¡¨ç¤ºæ–‡ä»¶ä¸Šä¼  ï¼Œå¾ˆå¤šæµè§ˆå™¨ä¼šè‡ªåŠ¨è®¾ç½®</span>content-length æ–‡ä»¶é•¿åº¦ ä¸éœ€è¦è®¾ç½®keep-alive http/<span class="hljs-number">1.1</span> é»˜è®¤ä¸º<span class="hljs-literal">true</span>accept-<span class="hljs-attr">encoding</span>:å‘ŠçŸ¥æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯æ”¯æŒçš„æ–‡ä»¶å‹ç¼©æ ¼å¼ï¼Œæ¯”å¦‚jsæ–‡ä»¶å¯ä»¥ä½¿ç”¨gzipå‹ç¼©å¯¹åº”.<span class="hljs-property">gz</span>æ–‡ä»¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è§£å‹ï¼Œè¿™ä¸ªå±æ€§ä¸ç”¨é…ï¼Œæµè§ˆå™¨ä¼šé…ï¼Œåœ¨webpackä¸­å¯ä»¥æ‰“åŒ…æˆgzipæ–‡ä»¶<span class="hljs-attr">accept</span>:å‘Šè¯‰æµè§ˆå™¨ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ¥å—çš„æ–‡ä»¶çš„æ ¼å¼ç±»å‹ é»˜è®¤æ˜¯ä»»ä½•æ ¼å¼éƒ½æ¥å—user-<span class="hljs-attr">agent</span>:å®¢æˆ·ç«¯ç›¸å…³çš„ä¿¡æ¯<span class="hljs-number">232.</span>http response status<span class="hljs-number">200</span> ok <span class="hljs-number">201</span> create postè¯·æ±‚ï¼Œåˆ›å»ºæ–°çš„èµ„æº<span class="hljs-number">301</span> æ°¸ä¹…é‡å®šå‘<span class="hljs-number">400</span> bad request å®¢æˆ·ç«¯çš„é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•æˆ–è€…ä¸è¿›è¡Œå¤„ç†<span class="hljs-number">401</span> unauthorized æœªæˆæƒ ä¸€èˆ¬æ˜¯æ²¡æœ‰ç™»å½•çš„æƒ…å†µä¸‹ æ²¡æœ‰cookie,tokenæˆ–è€…è¿‡æœŸ<span class="hljs-number">403</span> forbidden æ²¡æœ‰æƒé™<span class="hljs-number">404</span> <span class="hljs-title class_">NOt</span> found ä¸€èˆ¬æ˜¯æ¥å£ä¸å­˜åœ¨ï¼Œurlé”™è¯¯<span class="hljs-number">500</span> æœåŠ¡å™¨æœªçŸ¥é”™è¯¯<span class="hljs-number">503</span> æš‚æ—¶æ— æ³•è®¿é—®<span class="hljs-number">400</span>ã€<span class="hljs-number">403</span>éƒ½æ˜¯æµè§ˆå™¨è¿”å›çš„æœ‰äº›å¼€å‘æ‰€æœ‰è¿”å›çš„statuséƒ½æ˜¯<span class="hljs-number">200</span>ï¼Œåœ¨æ•°æ®é‡Œé¢æ¥è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯<span class="hljs-number">233.</span>xhr<span class="hljs-keyword">const</span> xhr=<span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()xhr.<span class="hljs-property">onload</span>=<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-comment">//xhr.response   ä¸€èˆ¬ä½¿ç”¨è¿™ä¸ª</span><span class="hljs-comment">//xhr.responseText</span><span class="hljs-comment">//xhr.responseXML</span>&#125;xhr.<span class="hljs-property">responseType</span>=<span class="hljs-string">&quot;json&quot;</span><span class="hljs-comment">//é»˜è®¤æ˜¯text,ä¸€èˆ¬æ˜¯json</span>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;get&quot;</span>,url)<span class="hljs-comment">//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚ç±»å‹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯urlï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ˜¯å¦åŒæ­¥ï¼Œé»˜è®¤æ˜¯å¼‚æ­¥</span><span class="hljs-comment">//è®¾ç½®è¿‡æœŸæ—¶é—´</span>xhr.<span class="hljs-property">timeout</span>=<span class="hljs-number">3000</span>xhr.<span class="hljs-property">ontimeout</span>=<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;xhr.<span class="hljs-title function_">abort</span>()<span class="hljs-comment">//å–æ¶ˆè¯·æ±‚</span><span class="hljs-comment">//å‘é€ç½‘ç»œè¯·æ±‚</span>xhr.<span class="hljs-title function_">send</span>()<span class="hljs-number">234.</span>ajaxçš„å°è£…<span class="hljs-number">235.</span><span class="hljs-title class_">Fetch</span> è¿”å›å€¼æ˜¯promiseæ–‡ä»¶ä¸Šä¼ åœ°å€<span class="hljs-attr">http</span>:<span class="hljs-comment">//123.207.32.32:1888/02_param/upload</span><span class="hljs-number">236.</span>gitgit add .git commit -m <span class="hljs-string">&quot;æäº¤æè¿°&quot;</span>git pushgit pull origin master <span class="hljs-comment">//ä»è¿œç¨‹çš„æŸä¸ªåˆ†æ”¯è·å–</span>git branch --set-upstream-to=origin/master  <span class="hljs-comment">//è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯å°±å¯ä»¥åªå†™ git pulläº†</span>git merge --allow-unrelated-histories  <span class="hljs-comment">//å¼ºåˆ¶åˆå¹¶</span>git statusgit clone url<span class="hljs-comment">//å…‹éš†ä»£ç </span>pushåˆ°è¿œç¨‹ä»“åº“git pushgit push origin masterfetchä»£ç git fetch git fetch origin masterè·å–åˆ°ä»£ç åé»˜è®¤å¹¶æ²¡æœ‰åˆå¹¶ï¼Œéœ€è¦mergegit mergeget merge origin/masterä¹Ÿå¯ä»¥ä½¿ç”¨git pullç›¸å½“äºgit fetch+git <span class="hljs-title function_">merge</span>(rebase)é“¾æ¥è¿œç¨‹ä»“åº“geit remote add origin ....git push origin master <span class="hljs-comment">//ç¬¬ä¸€æ¬¡å›¾é€ä¼šæ¨é€åˆ°mainåˆ†æ”¯  ç¬¬äºŒæ¬¡æ¨é€ä¼šè¢«æ¨é€åˆ°master</span>git push origin <span class="hljs-attr">master</span>:maingit push origin <span class="hljs-attr">head</span>:main  headé»˜è®¤æŒ‡å‘mainå¦‚æœè¦push masteré»˜è®¤è¦è¿™ä¹ˆå†™git push origin <span class="hljs-attr">master</span>:main  å¦‚æœæƒ³å†™git pushå°±è¦è¿™ä¹ˆå†™é…ç½®git push æŒ‡å‘ä¸Šæ¸¸è·¯å¾„masterï¼Œå°±æ˜¯é…ç½®å¥½çš„git branch --set-upstream-to=origin/masterè°ƒç”¨git push å°±ä¼špushåˆ°master,ä½†æ˜¯è¿™æ ·æ¯ä¸ªåˆ†æ”¯éƒ½æ˜¯pushåˆ°mastergit config push.<span class="hljs-property">default</span> upstream  [--<span class="hljs-variable language_">global</span>]<span class="hljs-comment">//åŠ ä¸Šglobalå¯ä»¥å…¨å±€ä½¿ç”¨ï¼Œå¦åˆ™å°±æ˜¯å½“å‰é¡¹ç›®ä½¿ç”¨</span>git config push.<span class="hljs-property">default</span> current  <span class="hljs-comment">//è¿™ä¸ªä¼šå…ˆå»ä»“åº“æ‰¾æœ‰æ²¡æœ‰å’Œæœ¬åœ°ç›¸åŒçš„åˆ†æ”¯ï¼Œå¦‚æœæ²¡æœ‰å°±åœ¨è¿œç¨‹åˆ›å»ºä¸€ä¸ªæ–°çš„å’Œæœ¬åœ°ç›¸åŒçš„åˆ†æ”¯</span>push.<span class="hljs-property">default</span> é»˜è®¤æ˜¯simple å°±æ˜¯pushç›¸åŒçš„åˆ†æ”¯git tag æ‰“æ ‡ç­¾git tag v1<span class="hljs-number">.0</span><span class="hljs-number">.0</span>git tag -a v1<span class="hljs-number">.0</span><span class="hljs-number">.1</span> -m <span class="hljs-string">&quot;æ³¨é‡Š&quot;</span>é»˜è®¤æƒ…å†µå­git tag ä¸ä¼špushåˆ°æœåŠ¡å™¨git push origin v1<span class="hljs-number">.0</span><span class="hljs-number">.0</span>  æ¨é€åˆ°è¿œç¨‹git push origin --tags æŠŠæ‰€æœ‰tagéƒ½æ¨é€ä¸Šå»git tag -d tagname  <span class="hljs-comment">//åˆ é™¤æœ¬åœ°çš„tag</span>git oush origin&lt;åœ¨æœ¬åœ°å®šä¹‰çš„è¿œç¨‹çš„åå­—ï¼Œé»˜è®¤æ˜¯origin&gt; -dæˆ–è€…--<span class="hljs-keyword">delete</span> v1<span class="hljs-number">.0</span><span class="hljs-number">.0</span>git checkpout v1<span class="hljs-number">.0</span><span class="hljs-number">.0</span> è·³è½¬åˆ°ç›®æ ‡tag, å›åˆ°tagç‰ˆæœ¬ä»£ç  ä¸èƒ½å†å½“å‰tagä¿®æ”¹ä»£ç ï¼Œéœ€è¦æ ¹æ®å½“å‰çš„tag,åˆ›å»ºæ–°çš„åˆ†æ”¯æ¥ä¿®æ”¹git cat-file -p 00d2  <span class="hljs-comment">//æŸ¥çœ‹.git/objects/00/d2..... å°±å¯ä»¥çœ‹åˆ°æ–‡ä»¶çš„å†…å®¹</span>git cat-file -t 00d2 <span class="hljs-comment">//æŸ¥çœ‹æ–‡ä»¶å†…å®¹</span><span class="hljs-comment">//blod è¡¨ç¤ºæ–‡ä»¶è¿˜æ²¡æäº¤çš„æ–‡ä»¶</span><span class="hljs-comment">//commit è¡¨ç¤ºå·²ç»æäº¤</span><span class="hljs-comment">//tag è¡¨ç¤ºæ˜¯tag</span></code></pre></div><p>237.Gitåˆ†æ”¯</p><p>åˆ›å»ºæ–°çš„åˆ†æ”¯å…¶å®åˆ›å»ºä¸€ä¸ªæ–°çš„å¯ç§»åŠ¨çš„æŒ‡é’ˆ</p><p>git branch åˆ†æ”¯  åˆ›å»ºåˆ†æ”¯</p><p>git checkout åˆ†æ”¯ åˆ‡æ¢åˆ†æ”¯</p><p>git æ€ä¹ˆç›´åˆ°æŒ‡å‘é‚£ä¸ªåˆ†æ”¯ ä¹Ÿæ˜¯ä½¿ç”¨HEADçš„æŒ‡é’ˆ </p><p>git checkout åˆ†æ”¯  å°±æ˜¯å°†headæŒ‡é’ˆæŒ‡å‘å®ƒ</p><p>å…ˆä½¿ç”¨ git branch åˆ†æ”¯ åˆ›å»ºåˆ†æ”¯ ç„¶åå†ä½¿ç”¨ git checkout åˆ†æ”¯ å°†åˆ‡æ¢åˆ†æ”¯æŒ‡é’ˆæŒ‡å‘è¯¥åˆ†æ”¯</p><p>git checkout -b <newbranchname>   //åˆ›å»ºæ–°çš„åˆ†æ”¯å¹¶ä¸”åˆ‡æ¢åˆ†æ”¯</p><p> 238.git flow </p><p>åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆä¼šåˆ›å»ºmasterä¸»åˆ†æ”¯ç”¨äºçº¿ä¸Šå‘å¸ƒï¼Œå¯ä»¥æ‰“ä¸Štagä½œä¸ºç‰ˆæœ¬ï¼Œå¦‚æœçº¿ä¸Šå‡ºç°bug,åˆ™ä»masterå¼€è¾Ÿåˆ†æ”¯ï¼Œè¿›è¡Œä»£ç çš„ä¿®å¤ï¼Œç„¶ååˆå¹¶åˆ°masteråˆ†æ”¯ï¼Œå’Œdevelopåˆ†æ”¯ã€‚developåˆ†æ”¯ç”¨äºå¼€å‘ï¼Œéœ€è¦ä¸Šçº¿æ—¶ä¼šå¼€è¾Ÿreleaseåˆ†æ”¯ç”¨äºæµ‹è¯•ï¼Œå¹¶ä¸”ä¿®å¤æµ‹è¯•é‡åˆ°çš„bug,å®Œæˆæµ‹è¯•åå°±å¯ä»¥åˆå¹¶åˆ°masterå’Œdevelop,å¦‚æœéœ€è¦å¼€å‘æ–°çš„åŠŸèƒ½ï¼Œåˆ™éœ€è¦ä»developå¼€è¾Ÿæ–°åˆ†æ”¯è¿›è¡Œå¼€å‘</p><p>239.gitçš„è¿œç¨‹åˆ†æ”¯</p><p>git remote add origin url</p><p>git fetch origin main  //æŠŠmainåˆ†æ”¯æ‹‰å–</p><p>git branch â€“set-upstream-to=origin/main  //è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯</p><p>=========================================================</p><p>get merge//é»˜è®¤åˆå¹¶upstream   åˆå¹¶å¿…é¡»è¦æœ‰å…±åŒçš„ç¥–å…ˆ</p><p>è¿œç¨‹åˆ†æ”¯æ˜¯ä¹Ÿæ˜¯ä¸€ç§åˆ†æ”¯ç»“æ„ï¼š  ä»¥ remote/branchå¼å‘½åçš„</p><p>240.è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯</p><p>å½“å…‹éš†ä¸€ä¸ªä»“åº“æ—¶ï¼Œå®ƒé€šå¸¸ä¼šè‡ªåŠ¨åœ°åˆ›å»ºä¸€ä¸ªè·Ÿè¸ª origin/master çš„ master åˆ†æ”¯</p><p>å¦‚æœä½ æ„¿æ„çš„è¯å¯ä»¥è®¾ç½®å…¶ä»–çš„è·Ÿè¸ªåˆ†æ”¯ï¼Œå¯ä»¥é€šè¿‡è¿è¡Œ git checkout â€“track origin/åˆ†æ”¯å</p><p> å¦‚æœä½ å°è¯•æ£€å‡ºçš„åˆ†æ”¯ (a) ä¸å­˜åœ¨ä¸” (b) åˆšå¥½åªæœ‰ä¸€ä¸ªåå­—ä¸ä¹‹åŒ¹é…çš„è¿œç¨‹åˆ†æ”¯ï¼Œé‚£ä¹ˆ Git å°±ä¼šä¸ºä½ åˆ›å»ºä¸€ä¸ªè·Ÿè¸ªåˆ†æ”¯</p><div class="code-wrapper"><pre><code class="hljs vim">git checkout --track <span class="hljs-symbol">&lt;remote&gt;</span>/<span class="hljs-symbol">&lt;branch&gt;</span>  ç›¸å½“äºgit branch --<span class="hljs-keyword">set</span>-upstream-<span class="hljs-keyword">to</span>=origin/main  è·Ÿè¸ªorigin/main  å¹¶ä¸”åˆ›å»ºå’Œåˆ‡æ¢mianåˆ†æ”¯git checkout <span class="hljs-symbol">&lt;branch&gt;</span>  ä¸Šé¢çš„ç®€å†™ä»–ä¼šå…ˆæ£€æŸ¥è¿œç¨‹æœ‰æ²¡æœ‰è¿™ä¸ªåˆ†æ”¯ï¼Œç„¶ååœ¨è·Ÿè¸ªè¿™ä¸ªåˆ†æ”¯ï¼Œå¹¶ä¸”åœ¨æœ¬åœ°åˆ›å»ºè¿™ä¸ªåˆ†æ”¯ï¼Œåœ¨åˆ‡æ¢åˆ°è¿™ä¸ªåˆ†æ”¯</code></pre></div><p>241.git checkout -b  develop</p><p>â€‹        git push origin develop</p><p>å¦‚æœéœ€è¦åˆ›å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶ä¸”æ¨é€åˆ°è¿œç¨‹ï¼Œè¿œç¨‹ä¹Ÿä¼šåˆ›å»ºç›¸åŒçš„åˆ†æ”¯</p><p>242.git branch -d  åˆ†æ”¯     åˆ é™¤æœ¬åœ°åˆ†æ”¯</p><p>243.åˆ é™¤è¿œç¨‹åˆ†æ”¯</p><div class="code-wrapper"><pre><code class="hljs maxima">git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> --<span class="hljs-built_in">delete</span> &lt;branch&gt;</code></pre></div><p>244.æŸ¥çœ‹git log</p><div class="code-wrapper"><pre><code class="hljs applescript">git <span class="hljs-built_in">log</span> <span class="hljs-comment">--pretty=oneline</span></code></pre></div><p>245 git rebase</p><div class="code-wrapper"><pre><code class="hljs crmsh">git checkout featuregit rebase <span class="hljs-keyword">master</span><span class="hljs-title">git</span> checkout <span class="hljs-keyword">master</span><span class="hljs-title">git</span> merge  feature//æ°¸è¿œä¸è¦åœ¨ä¸»åˆ†æ”¯ä¸Šrebase</code></pre></div><p>246.git rebaseçš„åŸç†</p><p>247.rebaseå’Œmergeçš„åŒºåˆ«</p><p>mergeä¼šè®°å½•gitçš„æ‰€æœ‰å†å²ï¼Œé‚£ä¹ˆåˆ†æ”¯çš„å†å²é”™ç»¼å¤æ‚ï¼Œä¹Ÿä¼šå…¨éƒ¨è®°å½•ä¸‹æ¥</p><p>rebaseç”¨äºç®€åŒ–å†å²è®°å½•ï¼Œå°†ä¸¤ä¸ªåˆ†æ”¯çš„å†å²ç®€åŒ–ï¼Œæ•´ä¸ªå†å²æ›´åŠ ç®€æ´</p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
      <category>å‰ç«¯ç³»ç»Ÿè¯¾ç¬”è®°</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>vue2å’Œvue3çš„åŒºåˆ«(vue2å‘vue3è¿ç§»)(ä¸€)</title>
    <link href="/2022/08/12/VUE3%E5%92%8CVUE2%E7%9A%84%E5%8C%BA%E5%88%AB(%E4%B8%80)/"/>
    <url>/2022/08/12/VUE3%E5%92%8CVUE2%E7%9A%84%E5%8C%BA%E5%88%AB(%E4%B8%80)/</url>
    
    <content type="html"><![CDATA[<ol><li><h3 id="vue2çš„æºç ä½¿ç”¨Flowè¿›è¡Œç±»å‹æ£€æµ‹çš„ï¼Œvue3ä½¿ç”¨Typescriptè¿›è¡Œé‡æ„ï¼Œæ¯”vue2æ›´å¥½çš„å¯¹typescriptè¿›è¡Œæ”¯æŒã€‚"><a href="#vue2çš„æºç ä½¿ç”¨Flowè¿›è¡Œç±»å‹æ£€æµ‹çš„ï¼Œvue3ä½¿ç”¨Typescriptè¿›è¡Œé‡æ„ï¼Œæ¯”vue2æ›´å¥½çš„å¯¹typescriptè¿›è¡Œæ”¯æŒã€‚" class="headerlink" title="vue2çš„æºç ä½¿ç”¨Flowè¿›è¡Œç±»å‹æ£€æµ‹çš„ï¼Œvue3ä½¿ç”¨Typescriptè¿›è¡Œé‡æ„ï¼Œæ¯”vue2æ›´å¥½çš„å¯¹typescriptè¿›è¡Œæ”¯æŒã€‚"></a>vue2çš„æºç ä½¿ç”¨Flowè¿›è¡Œç±»å‹æ£€æµ‹çš„ï¼Œvue3ä½¿ç”¨Typescriptè¿›è¡Œé‡æ„ï¼Œæ¯”vue2æ›´å¥½çš„å¯¹typescriptè¿›è¡Œæ”¯æŒã€‚</h3></li><li><h3 id="vue3ä¸­ä½¿ç”¨Proxyæ¥å®ç°å¯¹æ•°æ®åŠ«æŒï¼Œvue2ä¸­ä½¿ç”¨Object-definePropertyæ¥åŠ«æŒæ•°æ®çš„getterå’Œsetteræ–¹æ³•çš„ï¼Œè¿™è¿™ç§æ–¹å¼å­˜åœ¨ç¼ºç‚¹å°±æ˜¯åœ¨ç»™å¯¹è±¡æ·»åŠ å’Œåˆ é™¤å±æ€§çš„æ—¶å€™ï¼Œæ˜¯æ— æ³•åŠ«æŒå’Œç›‘å¬çš„ã€‚æ‰€ä»¥å¿…é¡»ä½¿ç”¨-setå’Œ-deleteæ–¹æ³•ã€‚"><a href="#vue3ä¸­ä½¿ç”¨Proxyæ¥å®ç°å¯¹æ•°æ®åŠ«æŒï¼Œvue2ä¸­ä½¿ç”¨Object-definePropertyæ¥åŠ«æŒæ•°æ®çš„getterå’Œsetteræ–¹æ³•çš„ï¼Œè¿™è¿™ç§æ–¹å¼å­˜åœ¨ç¼ºç‚¹å°±æ˜¯åœ¨ç»™å¯¹è±¡æ·»åŠ å’Œåˆ é™¤å±æ€§çš„æ—¶å€™ï¼Œæ˜¯æ— æ³•åŠ«æŒå’Œç›‘å¬çš„ã€‚æ‰€ä»¥å¿…é¡»ä½¿ç”¨-setå’Œ-deleteæ–¹æ³•ã€‚" class="headerlink" title="vue3ä¸­ä½¿ç”¨Proxyæ¥å®ç°å¯¹æ•°æ®åŠ«æŒï¼Œvue2ä¸­ä½¿ç”¨Object.definePropertyæ¥åŠ«æŒæ•°æ®çš„getterå’Œsetteræ–¹æ³•çš„ï¼Œè¿™è¿™ç§æ–¹å¼å­˜åœ¨ç¼ºç‚¹å°±æ˜¯åœ¨ç»™å¯¹è±¡æ·»åŠ å’Œåˆ é™¤å±æ€§çš„æ—¶å€™ï¼Œæ˜¯æ— æ³•åŠ«æŒå’Œç›‘å¬çš„ã€‚æ‰€ä»¥å¿…é¡»ä½¿ç”¨$setå’Œ$deleteæ–¹æ³•ã€‚"></a>vue3ä¸­ä½¿ç”¨Proxyæ¥å®ç°å¯¹æ•°æ®åŠ«æŒï¼Œvue2ä¸­ä½¿ç”¨Object.definePropertyæ¥åŠ«æŒæ•°æ®çš„getterå’Œsetteræ–¹æ³•çš„ï¼Œè¿™è¿™ç§æ–¹å¼å­˜åœ¨ç¼ºç‚¹å°±æ˜¯åœ¨ç»™å¯¹è±¡æ·»åŠ å’Œåˆ é™¤å±æ€§çš„æ—¶å€™ï¼Œæ˜¯æ— æ³•åŠ«æŒå’Œç›‘å¬çš„ã€‚æ‰€ä»¥å¿…é¡»ä½¿ç”¨$setå’Œ$deleteæ–¹æ³•ã€‚</h3></li><li><h3 id="vue3åˆ é™¤äº†-setå’Œ-off-once-ç§»é™¤äº†filter-å†…æ•›æ¨¡æ¿ç­‰ç‰¹æ€§"><a href="#vue3åˆ é™¤äº†-setå’Œ-off-once-ç§»é™¤äº†filter-å†…æ•›æ¨¡æ¿ç­‰ç‰¹æ€§" class="headerlink" title="vue3åˆ é™¤äº†$setå’Œ$off,$once.ç§»é™¤äº†filter,å†…æ•›æ¨¡æ¿ç­‰ç‰¹æ€§"></a>vue3åˆ é™¤äº†$setå’Œ$off,$once.ç§»é™¤äº†filter,å†…æ•›æ¨¡æ¿ç­‰ç‰¹æ€§</h3></li><li><h3 id="åœ¨ç¼–è¯‘æ–¹é¢åšäº†ä¼˜åŒ–ï¼šç”ŸæˆBlock-tree-Slotç¼–è¯‘ä¼˜åŒ–ï¼Œdiffç®—æ³•ä¼˜"><a href="#åœ¨ç¼–è¯‘æ–¹é¢åšäº†ä¼˜åŒ–ï¼šç”ŸæˆBlock-tree-Slotç¼–è¯‘ä¼˜åŒ–ï¼Œdiffç®—æ³•ä¼˜" class="headerlink" title="åœ¨ç¼–è¯‘æ–¹é¢åšäº†ä¼˜åŒ–ï¼šç”ŸæˆBlock tree,Slotç¼–è¯‘ä¼˜åŒ–ï¼Œdiffç®—æ³•ä¼˜"></a>åœ¨ç¼–è¯‘æ–¹é¢åšäº†ä¼˜åŒ–ï¼šç”ŸæˆBlock tree,Slotç¼–è¯‘ä¼˜åŒ–ï¼Œdiffç®—æ³•ä¼˜</h3></li><li><h3 id="vue3ä¸­å·²ç»å»æ‰äº†äº‹ä»¶æ€»çº¿ï¼Œå¯ä»¥ä½¿ç”¨mitt"><a href="#vue3ä¸­å·²ç»å»æ‰äº†äº‹ä»¶æ€»çº¿ï¼Œå¯ä»¥ä½¿ç”¨mitt" class="headerlink" title="vue3ä¸­å·²ç»å»æ‰äº†äº‹ä»¶æ€»çº¿ï¼Œå¯ä»¥ä½¿ç”¨mitt"></a>vue3ä¸­å·²ç»å»æ‰äº†äº‹ä»¶æ€»çº¿ï¼Œå¯ä»¥ä½¿ç”¨mitt</h3></li><li><h3 id="vue3ä¸­å¢åŠ äº†componsition-API"><a href="#vue3ä¸­å¢åŠ äº†componsition-API" class="headerlink" title="vue3ä¸­å¢åŠ äº†componsition API"></a>vue3ä¸­å¢åŠ äº†componsition API</h3></li><li><h3 id="vue3ä¸­ç§»é™¤äº†-children"><a href="#vue3ä¸­ç§»é™¤äº†-children" class="headerlink" title="vue3ä¸­ç§»é™¤äº†$children"></a>vue3ä¸­ç§»é™¤äº†$children</h3></li><li><h3 id="vue3ä¸­çš„æ¨èçš„æ„å»ºå·¥å…·å·²ç»ä»vue-cliè½¬æˆvite"><a href="#vue3ä¸­çš„æ¨èçš„æ„å»ºå·¥å…·å·²ç»ä»vue-cliè½¬æˆvite" class="headerlink" title="vue3ä¸­çš„æ¨èçš„æ„å»ºå·¥å…·å·²ç»ä»vue cliè½¬æˆvite"></a>vue3ä¸­çš„æ¨èçš„æ„å»ºå·¥å…·å·²ç»ä»vue cliè½¬æˆvite</h3></li><li><h3 id="vue3ä¸­çš„æ¨èçš„çŠ¶æ€ç®¡ç†å·¥å…·å·²ç»ä»vuexè½¬æˆpinia"><a href="#vue3ä¸­çš„æ¨èçš„çŠ¶æ€ç®¡ç†å·¥å…·å·²ç»ä»vuexè½¬æˆpinia" class="headerlink" title="vue3ä¸­çš„æ¨èçš„çŠ¶æ€ç®¡ç†å·¥å…·å·²ç»ä»vuexè½¬æˆpinia"></a>vue3ä¸­çš„æ¨èçš„çŠ¶æ€ç®¡ç†å·¥å…·å·²ç»ä»vuexè½¬æˆpinia</h3></li><li><h3 id="IDEæ”¯æŒVetur-gt-Volar"><a href="#IDEæ”¯æŒVetur-gt-Volar" class="headerlink" title="IDEæ”¯æŒVetur-&gt;Volar"></a>IDEæ”¯æŒVetur-&gt;Volar</h3></li><li><h3 id="vue3çš„å“åº”å¼æ˜¯ä½¿ç”¨äº†proxyï¼Œproxyä¸æ”¯æŒIEï¼Œæ‰€ä»¥vue3ä¹Ÿä¸æ”¯æŒIEï¼Œç›®å‰IEå·²ç»ä¸å†è¿›è¡Œæ›´æ–°ï¼Œå·²ç»è¢«æ·˜æ±°"><a href="#vue3çš„å“åº”å¼æ˜¯ä½¿ç”¨äº†proxyï¼Œproxyä¸æ”¯æŒIEï¼Œæ‰€ä»¥vue3ä¹Ÿä¸æ”¯æŒIEï¼Œç›®å‰IEå·²ç»ä¸å†è¿›è¡Œæ›´æ–°ï¼Œå·²ç»è¢«æ·˜æ±°" class="headerlink" title="vue3çš„å“åº”å¼æ˜¯ä½¿ç”¨äº†proxyï¼Œproxyä¸æ”¯æŒIEï¼Œæ‰€ä»¥vue3ä¹Ÿä¸æ”¯æŒIEï¼Œç›®å‰IEå·²ç»ä¸å†è¿›è¡Œæ›´æ–°ï¼Œå·²ç»è¢«æ·˜æ±°"></a>vue3çš„å“åº”å¼æ˜¯ä½¿ç”¨äº†proxyï¼Œproxyä¸æ”¯æŒIEï¼Œæ‰€ä»¥vue3ä¹Ÿä¸æ”¯æŒIEï¼Œç›®å‰IEå·²ç»ä¸å†è¿›è¡Œæ›´æ–°ï¼Œå·²ç»è¢«æ·˜æ±°</h3></li><li><h3 id="æ·»åŠ äº†å…¨æ–°çš„å…¨å±€api-createApp-æ¥æ›¿ä»£new-Vue-æ¥åˆ›å»ºvueå®ä¾‹"><a href="#æ·»åŠ äº†å…¨æ–°çš„å…¨å±€api-createApp-æ¥æ›¿ä»£new-Vue-æ¥åˆ›å»ºvueå®ä¾‹" class="headerlink" title="æ·»åŠ äº†å…¨æ–°çš„å…¨å±€api :createApp()æ¥æ›¿ä»£new Vue()æ¥åˆ›å»ºvueå®ä¾‹"></a>æ·»åŠ äº†å…¨æ–°çš„å…¨å±€api :createApp()æ¥æ›¿ä»£new Vue()æ¥åˆ›å»ºvueå®ä¾‹</h3></li></ol><table><thead><tr><th>2.x Global API</th><th>3.x Instance API (<code>app</code>)</th></tr></thead><tbody><tr><td>Vue.config</td><td>app.config</td></tr><tr><td>Vue.config.productionTip</td><td>åˆ é™¤</td></tr><tr><td>Vue.config.ignoredElements</td><td>app.config.compilerOptions.isCustomElement</td></tr><tr><td>Vue.component</td><td>app.component</td></tr><tr><td>Vue.directive</td><td>app.directive</td></tr><tr><td>Vue.mixin</td><td>app.mixin</td></tr><tr><td>Vue.use</td><td>app.use</td></tr><tr><td>Vue.prototype</td><td>app.config.globalProperties</td></tr><tr><td>Vue.extend</td><td>åˆ é™¤</td></tr></tbody></table><h3 id="13-å…¨å±€-API-Treeshaking"><a href="#13-å…¨å±€-API-Treeshaking" class="headerlink" title="13.å…¨å±€ API Treeshaking"></a>13.å…¨å±€ API Treeshaking</h3><div class="code-wrapper"><pre><code class="hljs vue">import Vue from &#x27;vue&#x27;Vue.nextTick(() =&gt; &#123;  // something DOM-related&#125;)</code></pre></div><p>åœ¨Vue2.Xä¸­Vue.nextTick()æ˜¯ä¸€ä¸ªæš´éœ²åœ¨å•ä¸ªVueå¯¹è±¡ä¸­çš„å…¨å±€çš„apiï¼Œäº‹å®ä¸Šï¼Œå®ä¾‹æ–¹æ³•$nextTick()åªæ˜¯ä¸€ä¸ªåŒ…è£…å™¨ï¼Œä¸ºäº†æ–¹ä¾¿Vue.nextTick()ï¼Œå›è°ƒå‡½æ•°çš„thisä¼šè‡ªåŠ¨ç»‘å®šåˆ°å½“å‰å®ä¾‹ä¸­ï¼Œä½†æ˜¯åœ¨viteå’Œwebpackä¸­ï¼ŒVue.nextTickä¸å¯ä»¥è¿›è¡Œtreeshaking,æ‰€ä»¥åœ¨Vue3ä¸­åšäº†ä¼˜åŒ–ï¼Œè®©nextTickå¯ä»¥è¿›è¡ŒtreeShaking,å…¨å±€çš„æ¨¡å—åªèƒ½ä½œä¸ºESæ¨¡å—æ„å»ºçš„å‘½åå¯¼å‡ºæ¥è¿›è¡Œè®¿é—®ï¼Œ</p><div class="code-wrapper"><pre><code class="hljs vue">import &#123; nextTick &#125; from &#x27;vue&#x27;nextTick(() =&gt; &#123;  // something DOM-related&#125;)</code></pre></div><div class="code-wrapper"><pre><code class="hljs vue">import &#123; shallowMount &#125; from &#x27;@vue/test-utils&#x27;import &#123; MyComponent &#125; from &#x27;./MyComponent.vue&#x27;import &#123; nextTick &#125; from &#x27;vue&#x27;test(&#x27;an async feature&#x27;, async () =&gt; &#123;  const wrapper = shallowMount(MyComponent)  // execute some DOM-related tasks  await nextTick()  // run your assertions&#125;)</code></pre></div><p>å¦‚æœåœ¨Vue3ä¸­ä½¿ç”¨Vue.nextTick()ä¼šå¯¼è‡´è‡­åæ˜­è‘—çš„<code>undefined is not a function</code>é”™è¯¯</p><p>é€šè¿‡æ­¤æ›´æ”¹ï¼Œå¦‚æœæ¨¡å—æ†ç»‘å™¨æ”¯æŒ tree-shakingï¼Œåˆ™æœªåœ¨ Vue åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å…¨å±€ API å°†ä»æœ€ç»ˆæ†ç»‘åŒ…ä¸­åˆ é™¤ï¼Œä»è€Œè·å¾—æœ€ä½³æ–‡ä»¶å¤§å°</p><h5 id="ä»¥ä¸‹Vue2çš„å…¨å±€QAPIä¼šå—åˆ°å½±å“"><a href="#ä»¥ä¸‹Vue2çš„å…¨å±€QAPIä¼šå—åˆ°å½±å“" class="headerlink" title="ä»¥ä¸‹Vue2çš„å…¨å±€QAPIä¼šå—åˆ°å½±å“"></a>ä»¥ä¸‹Vue2çš„å…¨å±€QAPIä¼šå—åˆ°å½±å“</h5><ul><li><code>Vue.nextTick</code></li><li><code>Vue.observable</code>ï¼ˆæ›¿æ¢ä¸º<code>Vue.reactive</code>ï¼‰</li><li><code>Vue.version</code></li><li><code>Vue.compile</code>ï¼ˆä»…åœ¨å®Œæ•´ç‰ˆæœ¬ä¸­ï¼‰</li><li><code>Vue.set</code>ï¼ˆä»…åœ¨å…¼å®¹ç‰ˆæœ¬ä¸­ï¼‰//ä¸è¦ä½¿ç”¨</li><li><code>Vue.delete</code>ï¼ˆä»…åœ¨å…¼å®¹ç‰ˆæœ¬ä¸­ï¼‰//ä¸è¦ä½¿ç”¨</li></ul><p>é™¤äº†å¦‚ä¸Šå…¨å±€APIä¹‹å¤–ï¼Œè®¸å¤šå†…éƒ¨ç»„ä»¶å°†ä¸å†ä½œä¸ºé»˜è®¤å¯¼å…¥çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦ä½¿ç”¨åˆ°æ—¶å†å¯¼å…¥ï¼Œæœ‰åˆ©äºtreeShaking,</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;transition&gt;  &lt;div v-show=&quot;ok&quot;&gt;hello&lt;/div&gt;&lt;/transition&gt;</code></pre></div><p>ä¼šè¢«ç¼–è¯‘æˆ</p><div class="code-wrapper"><pre><code class="hljs vue">import &#123; h, Transition, withDirectives, vShow &#125; from &#x27;vue&#x27;export function render() &#123;  return h(Transition, [withDirectives(h(&#x27;div&#x27;, &#x27;hello&#x27;), [[vShow, this.ok]])])&#125;</code></pre></div><p>å¯ä»¥å‡å°‘åŒ…çš„å¤§å°</p><p><strong>notice</strong></p><p><strong>ä¸Šè¿°å†…å®¹ä»…é€‚ç”¨äºä¸æ”¯æŒ tree-shaking çš„æ†ç»‘å™¨ä¸€èµ·ä½¿ç”¨çš„<a href="https://github.com/vuejs/core/tree/master/packages/vue#which-dist-file-to-use">ES æ¨¡å—æ„å»º</a>- UMD æ„å»ºä»ç„¶åŒ…å«æ‰€æœ‰åŠŸèƒ½å¹¶åœ¨ Vue å…¨å±€å˜é‡ä¸Šå…¬å¼€æ‰€æœ‰å†…å®¹ï¼ˆå¹¶ä¸”ç¼–è¯‘å™¨å°†ç”Ÿæˆé€‚å½“çš„è¾“å‡ºä»¥ä½¿ç”¨å…¨å±€ API è€Œä¸æ˜¯å¯¼å…¥ï¼‰ã€‚</strong></p><p>å†æ’ä»¶ä¸­ä½¿ç”¨æ—¶</p><p>Vue2.xä¸­ä½¿ç”¨å…¨å±€api</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> plugin = &#123;  <span class="hljs-attr">install</span>: <span class="hljs-function"><span class="hljs-params">Vue</span> =&gt;</span> &#123;    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> &#123;      <span class="hljs-comment">// ...</span>    &#125;)  &#125;&#125;</code></pre></div><p>Vue3.xä½¿ç”¨å…¨å±€API</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; nextTick &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">const</span> plugin = &#123;  <span class="hljs-attr">install</span>: <span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> &#123;    <span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> &#123;      <span class="hljs-comment">// ...</span>    &#125;)  &#125;&#125;</code></pre></div><p>åœ¨webpackä¸­å¦‚æœæŠŠä¸Šè¯‰ä»£ç æ‰“åŒ…æˆä¸€ä¸ªbuddle,ä»–ä¼šæŠŠvueæºç ä¹Ÿä¼šæ‰“åŒ…è¿›å»ï¼Œå¦‚æœè¦é¿å…è¿™æ ·çš„å‘ç”Ÿå¯ä»¥ä½¿ç”¨externalsæ’é™¤</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// webpack.config.js</span><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;  <span class="hljs-comment">/*...*/</span>  <span class="hljs-attr">externals</span>: &#123;    <span class="hljs-attr">vue</span>: <span class="hljs-string">&#x27;Vue&#x27;</span>  &#125;&#125;</code></pre></div><p>rollUpä¸­çš„å†™æ³•</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// rollup.config.js</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-comment">/*...*/</span>  <span class="hljs-attr">external</span>: [<span class="hljs-string">&#x27;vue&#x27;</span>]&#125;</code></pre></div><h3 id="14-v-model"><a href="#14-v-model" class="headerlink" title="14.v-model"></a>14.v-model</h3><p>åœ¨ç»„å»ºä¸­ä½¿ç”¨v-model</p><p>åœ¨vue2.x,<code>v-model</code>åœ¨ç»„ä»¶ä¸Šä½¿ç”¨ a ç›¸å½“äºä¼ é€’ä¸€ä¸ª<code>value</code>prop å¹¶å‘å‡ºä¸€ä¸ª<code>input</code>äº‹ä»¶ï¼š</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;ChildComponent v-model=&quot;pageTitle&quot; /&gt;&lt;!-- would be shorthand for: --&gt;&lt;ChildComponent :value=&quot;pageTitle&quot; @input=&quot;pageTitle = $event&quot; /&gt;</code></pre></div><p>å¦‚æœæƒ³æ›´æ”¹å±æ€§åå’Œäº‹ä»¶çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åœ¨ç»„ä»¶ä¸­æ·»åŠ modelé€‰é¡¹ï¼Œ</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;!-- ParentComponent.vue --&gt;&lt;ChildComponent v-model=&quot;pageTitle&quot; /&gt;</code></pre></div><div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-comment">// ChildComponent.vue</span>export default <span class="hljs-punctuation">&#123;</span>  model<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    prop<span class="hljs-punctuation">:</span> &#x27;title&#x27;<span class="hljs-punctuation">,</span>    event<span class="hljs-punctuation">:</span> &#x27;change&#x27;  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  props<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>    <span class="hljs-comment">// this allows using the `value` prop for a different purpose</span>    value<span class="hljs-punctuation">:</span> String<span class="hljs-punctuation">,</span>    <span class="hljs-comment">// use `title` as the prop which take the place of `value`</span>    title<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>      type<span class="hljs-punctuation">:</span> String<span class="hljs-punctuation">,</span>      default<span class="hljs-punctuation">:</span> &#x27;Default title&#x27;    <span class="hljs-punctuation">&#125;</span>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span></code></pre></div><p>æ‰€ä»¥v-modelå®é™…ä¸Šæ—¶è¿™æ ·çš„</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;ChildComponent :title=&quot;pageTitle&quot; @change=&quot;pageTitle = $event&quot; /&gt;</code></pre></div><h3 id="ä½¿ç”¨v-bind-sync"><a href="#ä½¿ç”¨v-bind-sync" class="headerlink" title="ä½¿ç”¨v-bind.sync#"></a>ä½¿ç”¨<code>v-bind.sync</code><a href="https://v3-migration.vuejs.org/breaking-changes/v-model.html#using-v-bind-sync">#</a></h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¸€ä¸ªé“å…·çš„â€œåŒå‘ç»‘å®šâ€ï¼ˆæœ‰æ—¶é™¤äº†ç°æœ‰<code>v-model</code>çš„ä¸åŒé“å…·ä¹‹å¤–ï¼‰ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å»ºè®®ä»¥<code>update:myPropName</code>. ä¾‹å¦‚ï¼Œå¯¹äº<code>ChildComponent</code>ä¸Šä¸€ä¸ªå¸¦æœ‰<code>title</code>prop çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼ è¾¾åˆ†é…æ–°å€¼çš„æ„å›¾ï¼š</p><div class="code-wrapper"><pre><code class="hljs vue">this.$emit(&#x27;update:title&#x27;, newValue)</code></pre></div><p>ç„¶åï¼Œå¦‚æœéœ€è¦ï¼Œçˆ¶çº§å¯ä»¥ä¾¦å¬è¯¥äº‹ä»¶å¹¶æ›´æ–°æœ¬åœ°æ•°æ®å±æ€§ã€‚ä¾‹å¦‚ï¼š</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;ChildComponent :title=&quot;pageTitle&quot; @update:title=&quot;pageTitle = $event&quot; /&gt;</code></pre></div><p><code>.sync</code>ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¿®é¥°ç¬¦å¯¹è¿™ç§æ¨¡å¼è¿›è¡Œäº†ç®€å†™ï¼š</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;ChildComponent :title.sync=&quot;pageTitle&quot; /&gt;</code></pre></div><p>åœ¨Vue3.xä¸­ è‡ªå®šä¹‰ç»„ä»¶çš„åŒå‘æ•°æ®ç»‘å®šæ—¶ä½¿ç”¨modelValueï¼Œ@update:modelValueæ¥æ›¿ä»£</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;ChildComponent v-model=&quot;pageTitle&quot; /&gt;&lt;!-- would be shorthand for: --&gt;&lt;ChildComponent  :modelValue=&quot;pageTitle&quot;  @update:modelValue=&quot;pageTitle = $event&quot;/&gt;</code></pre></div><p>å¦‚æœéœ€è¦ä¿®æ”¹modelçš„åç§°åˆ™ç›´æ¥ä¿®æ”¹</p><div class="code-wrapper"><pre><code class="hljs vue">&lt;ChildComponent v-model:title=&quot;pageTitle&quot; /&gt;&lt;!-- would be shorthand for: --&gt;&lt;ChildComponent :title=&quot;pageTitle&quot; @update:title=&quot;pageTitle = $event&quot; /&gt;</code></pre></div><p>ä¹Ÿå¯ä»¥ä½œä¸º.syncçš„æ›¿ä»£ï¼Œå¯ä»¥åœ¨ç»„ä»¶ä¸­åŒå‘æ•°æ®ç»‘å®šå¤šä¸ªå€¼</p><div class="code-wrapper"><pre><code class="hljs js">&lt;<span class="hljs-title class_">ChildComponent</span> v-<span class="hljs-attr">model</span>:title=<span class="hljs-string">&quot;pageTitle&quot;</span> v-<span class="hljs-attr">model</span>:content=<span class="hljs-string">&quot;pageContent&quot;</span> /&gt;&lt;!-- would be shorthand <span class="hljs-attr">for</span>: --&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span></span></span><span class="hljs-tag"><span class="language-xml">  <span class="hljs-attr">:title</span>=<span class="hljs-string">&quot;pageTitle&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">  @<span class="hljs-attr">update:title</span>=<span class="hljs-string">&quot;pageTitle = $event&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">  <span class="hljs-attr">:content</span>=<span class="hljs-string">&quot;pageContent&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">  @<span class="hljs-attr">update:content</span>=<span class="hljs-string">&quot;pageContent = $event&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">/&gt;</span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
      <category>daily</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>vue2å’Œvue3çš„åŒºåˆ«(vue2å‘vue3è¿ç§»)(äºŒ)</title>
    <link href="/2022/08/12/Vue3%E5%92%8CVue%E7%9A%84%E5%8C%BA%E5%88%AB(%E4%BA%8C)/"/>
    <url>/2022/08/12/Vue3%E5%92%8CVue%E7%9A%84%E5%8C%BA%E5%88%AB(%E4%BA%8C)/</url>
    
    <content type="html"><![CDATA[<h3 id="15-keyå±æ€§"><a href="#15-keyå±æ€§" class="headerlink" title="15.keyå±æ€§"></a>15.keyå±æ€§</h3><p>keyä¸»è¦é€‚ç”¨äºåœ¨Vueçš„è™šæ‹ŸDOMç®—æ³•ä¸­ï¼Œè·Ÿè¸ªèŠ‚ç‚¹çš„ï¼Œä»¥ä¾¿é‡ç”¨å’Œä¿®æ”¹ç°æœ‰çš„èŠ‚ç‚¹ï¼Œä»¥åŠä½•æ—¶ä¿®æ”¹æˆ–è€…é‡æ–°æ’åºã€‚</p><p>åœ¨Vue2.xä¸­ï¼Œkeyä¹Ÿè¢«æ¨èç”¨äºv-if,v-else,v-else-if</p><div class="code-wrapper"><pre><code class="hljs json">&lt;!-- Vue <span class="hljs-number">2.</span>x --&gt;&lt;div v-if=<span class="hljs-string">&quot;condition&quot;</span> key=<span class="hljs-string">&quot;yes&quot;</span>&gt;Yes&lt;/div&gt;&lt;div v-else key=<span class="hljs-string">&quot;no&quot;</span>&gt;No&lt;/div&gt;</code></pre></div><p>åœ¨vue3.xä¸­ä¸å†è¦æ±‚è¿™ä¹ˆä½¿ç”¨ï¼Œå› ä¸ºvueä¼šè‡ªå·±ç»™ä»–æ·»åŠ ä¸€ä¸ªunique key</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Vue 3.x --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;condition&quot;</span>&gt;</span>Yes<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span>&gt;</span>No<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><p>å¦‚æœä½ ç¡®å®æƒ³æ·»åŠ key,å¿…é¡»ä¿è¯keyå”¯ä¸€</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Vue 2.x --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;condition&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;a&quot;</span>&gt;</span>Yes<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;a&quot;</span>&gt;</span>No<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- Vue 3.x (recommended solution: remove keys) --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;condition&quot;</span>&gt;</span>Yes<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span>&gt;</span>No<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- Vue 3.x (alternate solution: make sure the keys are always unique) --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;condition&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;a&quot;</span>&gt;</span>Yes<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;b&quot;</span>&gt;</span>No<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><p> <strong><code>&lt;template v-for&gt;</code></strong></p><div class="code-wrapper"><pre><code class="hljs gauss">vue2.xä¸­ &lt;template&gt;æ ‡ç­¾ä¸èƒ½æ‹¥æœ‰<span class="hljs-built_in">key</span>,åªèƒ½åœ¨ä»–çš„å­å…ƒç´ ä¸­è®¾ç½®<span class="hljs-built_in">key</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Vue 2.x --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;item in list&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;&#x27;heading-&#x27; + item.id&quot;</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;&#x27;content-&#x27; + item.id&quot;</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><p>åœ¨vue3.xä¸­ï¼Œkeyåº”è¯¥è¢«è®¾ç½®åœ¨templateä¸Š</p><!-- Vue 3.x --><template v-for="item in list" :key="item.id">  <div>...</div>  <span>...</span></template><p>v-forä¹Ÿæ˜¯ä¸€æ ·</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Vue 2.x --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;item in list&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;item.isVisible&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;item.id&quot;</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;item.id&quot;</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><span class="hljs-comment">&lt;!-- Vue 3.x --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;item in list&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;item.id&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;item.isVisible&quot;</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><h3 id="16-v-if-ä¸-v-for-ä¼˜å…ˆçº§"><a href="#16-v-if-ä¸-v-for-ä¼˜å…ˆçº§" class="headerlink" title="16.v-if ä¸ v-for ä¼˜å…ˆçº§"></a>16.v-if ä¸ v-for ä¼˜å…ˆçº§</h3><p>åœ¨vue2.xä¸­ï¼Œåœ¨ç›¸åŒçš„å…ƒç´ ä¸­v-forçš„ä¼˜å…ˆçº§æ›´é«˜</p><p>Vue3.xä¸­ï¼Œv-ifçš„ä¼˜å…ˆçº§æ›´é«˜</p><h3 id="17-v-bind"><a href="#17-v-bind" class="headerlink" title="17.v-bind"></a>17.v-bind</h3><p>vue2.xä¸­</p><div class="code-wrapper"><pre><code class="hljs htaccess">&lt;!-- template --&gt;&lt;div id=&quot;red&quot; v-bind=&quot;&#123; id: &#x27;blue&#x27; &#125;&quot;&gt;&lt;/div&gt;&lt;!-- result --&gt;&lt;div id=&quot;red&quot;&gt;&lt;/div&gt;</code></pre></div><p>vue3.xä¸­</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- template --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;red&quot;</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">&quot;&#123; id: &#x27;blue&#x27; &#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- result --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;blue&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- template --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">&quot;&#123; id: &#x27;blue&#x27; &#125;&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;red&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- result --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;red&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><p>å¯¹äºç»‘å®šç›¸åŒçš„å±æ€§ï¼Œv2ä¸ä¼šè¦†ç›–ï¼Œè€Œv3ä¼šè¢«è¦†ç›– v3ä¸­ç»‘å®šæœ‰é¡ºåºè¦æ±‚</p><h3 id="18-v-on-nativeå·²ç»è¢«ç§»é™¤"><a href="#18-v-on-nativeå·²ç»è¢«ç§»é™¤" class="headerlink" title="18.v-on.nativeå·²ç»è¢«ç§»é™¤"></a>18.v-on.nativeå·²ç»è¢«ç§»é™¤</h3><h3 id="19-å‡½æ•°å¼ç»„ä»¶"><a href="#19-å‡½æ•°å¼ç»„ä»¶" class="headerlink" title="19.å‡½æ•°å¼ç»„ä»¶"></a>19.å‡½æ•°å¼ç»„ä»¶</h3><p>vue2.xä¸­å‡½æ•°å¼ç»„ä»¶ä¸»è¦ç”¨äºæ€§èƒ½ä¼˜åŒ–ï¼Œä»–çš„åˆå§‹åŒ–é€Ÿåº¦è¦å¿«äºæœ‰çŠ¶æ€ç»„ä»¶ï¼Œè€Œä¸”å¯ä»¥è¿”å›å¤šä¸ªæ ¹èŠ‚ç‚¹ï¼Œvue3.xä¸­æœ‰çŠ¶æ€ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–å¯ä»¥å’Œæ— çŠ¶æ€ç»„ä»¶ä¸€æ ·ï¼Œè€Œä¸”è¿˜å¯ä»¥æœ‰å¤šä¸ªè·ŸèŠ‚ç‚¹</p><h3 id="20-å¼‚æ­¥ç»„ä»¶"><a href="#20-å¼‚æ­¥ç»„ä»¶" class="headerlink" title="20.å¼‚æ­¥ç»„ä»¶"></a>20.å¼‚æ­¥ç»„ä»¶</h3><p>vue2.xä¸­å¼‚æ­¥ç»„ä»¶çš„å†™æ³•æ˜¯</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">asyncModal</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;./Modal.vue&#x27;</span>)</code></pre></div><p>æˆ–è€…å¯é…ç½®</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> asyncModal = &#123;  <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;./Modal.vue&#x27;</span>),  <span class="hljs-attr">delay</span>: <span class="hljs-number">200</span>,  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>,  <span class="hljs-attr">error</span>: <span class="hljs-title class_">ErrorComponent</span>,  <span class="hljs-attr">loading</span>: <span class="hljs-title class_">LoadingComponent</span>&#125;</code></pre></div><p>vue3ä¸­æ·»åŠ äº†ä¸€ä¸ªå®šä¹‰å¼‚æ­¥ç»„ä»¶çš„æ–¹æ³•</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; defineAsyncComponent &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">ErrorComponent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components/ErrorComponent.vue&#x27;</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">LoadingComponent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components/LoadingComponent.vue&#x27;</span><span class="hljs-comment">// Async component without options</span><span class="hljs-keyword">const</span> asyncModal = <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;./Modal.vue&#x27;</span>))<span class="hljs-comment">// Async component with options</span><span class="hljs-keyword">const</span> asyncModalWithOptions = <span class="hljs-title function_">defineAsyncComponent</span>(&#123;  <span class="hljs-attr">loader</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;./Modal.vue&#x27;</span>),  <span class="hljs-attr">delay</span>: <span class="hljs-number">200</span>,  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>,  <span class="hljs-attr">errorComponent</span>: <span class="hljs-title class_">ErrorComponent</span>,  <span class="hljs-attr">loadingComponent</span>: <span class="hljs-title class_">LoadingComponent</span>&#125;)</code></pre></div><p>è€Œä¸”vue2.xä¸­çš„é…ç½®é€‰é¡¹componentå˜æˆäº†loader</p><p>vue3.xä¸å†æ¥å—resolveï¼Œrejectå‚æ•°ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªpromise</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// 2.x version</span><span class="hljs-keyword">const</span> <span class="hljs-title function_">oldAsyncComponent</span> = (<span class="hljs-params">resolve, reject</span>) =&gt; &#123;  <span class="hljs-comment">/* ... */</span>&#125;<span class="hljs-comment">// 3.x version</span><span class="hljs-keyword">const</span> asyncComponent = <span class="hljs-title function_">defineAsyncComponent</span>(  <span class="hljs-function">() =&gt;</span>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;      <span class="hljs-comment">/* ... */</span>    &#125;))</code></pre></div><h3 id="21-emits-Option"><a href="#21-emits-Option" class="headerlink" title="21.emits Option"></a>21.<code>emits</code> Option</h3><p>vue2.xä¸­ä¸éœ€è¦å£°æ˜emitsçš„å€¼</p><div class="code-wrapper"><pre><code class="hljs js">&lt;template&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; text &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">&quot;$emit(&#x27;accepted&#x27;)&quot;</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>&lt;/template&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;text&#x27;</span>]</span></span><span class="language-javascript"><span class="language-xml">  &#125;</span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre></div><p>vue3.xä¸­éœ€è¦å®šä¹‰emits</p><div class="code-wrapper"><pre><code class="hljs js">&lt;template&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; text &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">&quot;$emit(&#x27;accepted&#x27;)&quot;</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>&lt;/template&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;text&#x27;</span>],</span></span><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">emits</span>: [<span class="hljs-string">&#x27;accepted&#x27;</span>]</span></span><span class="language-javascript"><span class="language-xml">  &#125;</span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre></div><div class="code-wrapper"><pre><code class="hljs js">ä¸‹é¢ä¾‹å­ä¸­&lt;template&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">&quot;$emit(&#x27;click&#x27;, $event)&quot;</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>&lt;/template&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">emits</span>: [] <span class="hljs-comment">// without declared event</span></span></span><span class="language-javascript"><span class="language-xml">&#125;</span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre></div><p>åœ¨çˆ¶ç»„ä»¶ä¸­ç›‘å¬clickäº‹ä»¶</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">my-button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">&quot;handleClick&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">my-button</span>&gt;</span></code></pre></div><p>clickä¼šè¢«è§¦å‘ä¸¤æ¬¡</p><h3 id="22-listenerç§»é™¤"><a href="#22-listenerç§»é™¤" class="headerlink" title="22.$listenerç§»é™¤"></a>22.$listenerç§»é™¤</h3><h3 id="23-attrsä¸­åŒ…å«classå’Œstyle"><a href="#23-attrsä¸­åŒ…å«classå’Œstyle" class="headerlink" title="23.$attrsä¸­åŒ…å«classå’Œstyle"></a>23.$attrsä¸­åŒ…å«classå’Œstyle</h3><p>vue2.xä¸­ï¼Œ<code>class</code>å’Œ<code>style</code>å±æ€§åœ¨ Vue 2 è™šæ‹Ÿ DOM å®ç°ä¸­å¾—åˆ°ä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚å› æ­¤ï¼Œå®ƒä»¬<em>ä¸</em>åŒ…å«åœ¨ ä¸­<code>$attrs</code>ï¼Œè€Œæ‰€æœ‰å…¶ä»–å±æ€§éƒ½åŒ…å«åœ¨ ä¸­ã€‚</p><p>ä½¿ç”¨æ—¶ä¼šå‡ºç°è¿™æ ·çš„å‰¯ä½œç”¨<code>inheritAttrs: false</code>ï¼š</p><p>è¿™æ ·$atträ¸­çš„å±æ€§ä¸å†è‡ªåŠ¨ç»‘å®šåˆ°å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸Šï¼Œè€Œæ˜¯ç”±å¼€å‘è€…æ¥å†³å®šæ€ä¹ˆç»‘å®šä»–ä»¬ï¼Œä½†æ˜¯classå’Œstyleä¸å±äº$attrçš„ä¸€éƒ¨åˆ†ï¼Œä»»ç„¶ä¼šåº”ç”¨åœ¨æ ¹å…ƒç´ ä¸Š</p><div class="code-wrapper"><pre><code class="hljs js">&lt;template&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">&quot;$attrs&quot;</span> /&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span>&lt;/template&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">inheritAttrs</span>: <span class="hljs-literal">false</span></span></span><span class="language-javascript"><span class="language-xml">&#125;</span></span><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre></div><div class="code-wrapper"><pre><code class="hljs js">&lt;my-component id=<span class="hljs-string">&quot;my-id&quot;</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;my-class&quot;</span>&gt;&lt;/my-component&gt;</code></pre></div><p>çœŸæ­£æ¸²æŸ“æˆçš„html</p><div class="code-wrapper"><pre><code class="hljs js">&lt;label <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;my-class&quot;</span>&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;my-id&quot;</span> /&gt;</span></span>&lt;/label&gt;</code></pre></div><p>åœ¨Vue3.xä¸­åˆ™åŒ…å«è¿™äº›</p><h3 id="24-v-onä¸å†æ”¯æŒæ•°å­—çš„keycode"><a href="#24-v-onä¸å†æ”¯æŒæ•°å­—çš„keycode" class="headerlink" title="24.v-onä¸å†æ”¯æŒæ•°å­—çš„keycode"></a>24.v-onä¸å†æ”¯æŒæ•°å­—çš„keycode</h3><h3 id="25-ä¸åœ¨æ”¯æŒ-on-off-once"><a href="#25-ä¸åœ¨æ”¯æŒ-on-off-once" class="headerlink" title="25.ä¸åœ¨æ”¯æŒ$on,$off,$once"></a>25.ä¸åœ¨æ”¯æŒ$on,$off,$once</h3><p>vue2.xä¸­æ”¯æŒäº‹ä»¶æ€»çº¿</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// eventBus.js</span><span class="hljs-keyword">const</span> eventBus = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>()<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> eventBus</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ChildComponent.vue</span><span class="hljs-keyword">import</span> eventBus <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./eventBus&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// adding eventBus listener</span>    eventBus.$on(<span class="hljs-string">&#x27;custom-event&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Custom event triggered!&#x27;</span>)    &#125;)  &#125;,  <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// removing eventBus listener</span>    eventBus.$off(<span class="hljs-string">&#x27;custom-event&#x27;</span>)  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ParentComponent.vue</span><span class="hljs-keyword">import</span> eventBus <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./eventBus&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">methods</span>: &#123;    <span class="hljs-title function_">callGlobalCustomEvent</span>(<span class="hljs-params"></span>) &#123;      eventBus.$emit(<span class="hljs-string">&#x27;custom-event&#x27;</span>) <span class="hljs-comment">// if ChildComponent is mounted, we will have a message in the console</span>    &#125;  &#125;&#125;</code></pre></div><p>vue3.xä¸­äº‹ä»¶æ€»çº¿å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åº“æ¥å®ç°ï¼Œä¾‹å¦‚<a href="https://github.com/developit/mitt">mitt</a>æˆ–<a href="https://github.com/scottcorgan/tiny-emitter">tiny-emitter</a></p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// eventBus.js</span><span class="hljs-keyword">import</span> emitter <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;tiny-emitter/instance&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">$on</span>: <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> emitter.<span class="hljs-title function_">on</span>(...args),  <span class="hljs-attr">$once</span>: <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> emitter.<span class="hljs-title function_">once</span>(...args),  <span class="hljs-attr">$off</span>: <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> emitter.<span class="hljs-title function_">off</span>(...args),  <span class="hljs-attr">$emit</span>: <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> emitter.<span class="hljs-title function_">emit</span>(...args)&#125;</code></pre></div><h3 id="26-filters"><a href="#26-filters" class="headerlink" title="26.filters"></a>26.filters</h3><p>vue3.xç§»é™¤äº†è¿‡æ»¤å™¨ï¼Œå¯ä»¥ä½¿ç”¨methodså’Œcomputedæ¥æ›¿ä»£</p><p>å…¨å±€çš„è¿‡æ»¤å™¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ¥åœ¨vue3ä¸­å®šä¹‰</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// main.js</span><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)app.<span class="hljs-property">config</span>.<span class="hljs-property">globalProperties</span>.<span class="hljs-property">$filters</span> = &#123;  <span class="hljs-title function_">currencyUSD</span>(<span class="hljs-params">value</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;$&#x27;</span> + value  &#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs js">&lt;template&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Bank Account Balance<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; $filters.currencyUSD(accountBalance) &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>&lt;/template&gt;</code></pre></div><h3 id="27-åˆ é™¤äº†inline-template"><a href="#27-åˆ é™¤äº†inline-template" class="headerlink" title="27.åˆ é™¤äº†inline-template"></a>27.åˆ é™¤äº†inline-template</h3><h3 id="28-åˆ é™¤äº†-children"><a href="#28-åˆ é™¤äº†-children" class="headerlink" title="28.åˆ é™¤äº†$children"></a>28.åˆ é™¤äº†$children</h3><p>vue2.xå¯ä»¥ä½¿ç”¨$childrenæ¥è®¿é—®ç›´æ¥å­ç»„ä»¶ï¼Œvue3.xä½¿ç”¨refsæ¥æ›¿ä»£å°±å¯ä»¥äº†</p><h3 id="29-è‡ªå®šä¹‰æŒ‡ä»¤"><a href="#29-è‡ªå®šä¹‰æŒ‡ä»¤" class="headerlink" title="29.è‡ªå®šä¹‰æŒ‡ä»¤"></a>29.è‡ªå®šä¹‰æŒ‡ä»¤</h3><p>æŒ‡ä»¤çš„é’©å­å‡½æ•°å·²ç»é‡æ–°å‘½åï¼Œæ›´å¥½çš„å’Œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé…åˆï¼Œæ­¤å¤–ï¼Œ<code>expression</code>å­—ç¬¦ä¸²ä¸å†ä½œä¸º<code>binding</code>å¯¹è±¡çš„ä¸€éƒ¨åˆ†ä¼ é€’</p><p>vue2.xä¸­çš„directiveçš„å¯é€‰é¡¹</p><p>bind  æŒ‡ä»¤åªç»‘å®šä¸€æ¬¡åˆ°å…ƒç´ ä¸­</p><p>inserted  å…ƒç´ åªè¢«æ’å…¥çˆ¶å…ƒç´ ä¸­ä¸€æ¬¡</p><p>update  è¯¥hookè¡¨ç¤ºå½“å…ƒç´ æ›´æ–°æ—¶ï¼Œchildrenè¿˜æ²¡æœ‰æ›´æ–°</p><p>componentUpdated  è¡¨ç¤ºç»„ä»¶å’Œå­å…ƒç´ éƒ½æ›´æ–°å®Œæ¯•</p><p>unbind è¡¨ç¤ºè§£ç»‘</p><p>vue2.xçš„è‡ªå®šä¹‰æŒ‡ä»¤</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-highlight</span>=<span class="hljs-string">&quot;&#x27;yellow&#x27;&quot;</span>&gt;</span>Highlight this text bright yellow<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs java">Vue.directive(<span class="hljs-string">&#x27;highlight&#x27;</span>, &#123;  bind(el, binding, vnode) &#123;    el.style.background = binding.value  &#125;&#125;)</code></pre></div><p>vue3.xä¸­æ–°å¢äº†created    è¿™ä¸ªå£°æ˜å‘¨æœŸæ˜¯åœ¨å…ƒç´ çš„å±æ€§å’Œäº‹ä»¶è¢«åº”ç”¨ä¹‹å‰</p><p>bind -&gt;beforeMount</p><p>inserted -&gt;mounted</p><p>beforeUpdate ç±»ä¼¼äºç»„ä»¶çš„beforeUpdate</p><p>updateè¢«ç§»é™¤</p><p>componentUpdated â†’ <strong>updated</strong></p><p><strong>beforeUnmount</strong>: new! Similar to component lifecycle hooks, this will be called right before an element is unmounted</p><p>unbind -&gt; <strong>unmounted</strong></p><div class="code-wrapper"><pre><code class="hljs html">const MyDirective = &#123;  created(el, binding, vnode, prevVnode) &#123;&#125;, // new  beforeMount() &#123;&#125;,  mounted() &#123;&#125;,  beforeUpdate() &#123;&#125;, // new  updated() &#123;&#125;,  beforeUnmount() &#123;&#125;, // new  unmounted() &#123;&#125;&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-highlight</span>=<span class="hljs-string">&quot;&#x27;yellow&#x27;&quot;</span>&gt;</span>Highlight this text bright yellow<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs html">const app = Vue.createApp(&#123;&#125;)app.directive(&#x27;highlight&#x27;, &#123;  beforeMount(el, binding, vnode) &#123;    el.style.background = binding.value  &#125;&#125;)</code></pre></div><h3 id="30-data-option"><a href="#30-data-option" class="headerlink" title="30.data option"></a>30.data option</h3><p>vue2.xä¸­è¿˜å¯ä»¥ä½¿ç”¨å¯¹è±¡ä½œä¸ºdataçš„å€¼ã€‚vue3.xä¸å¯ä»¥ä½¿ç”¨å¯¹è±¡ä½œä¸ºdata,å¿…é¡»ä½¿ç”¨function</p><h3 id="31-å…ƒç´ çš„æŒ‚è½½"><a href="#31-å…ƒç´ çš„æŒ‚è½½" class="headerlink" title="31.å…ƒç´ çš„æŒ‚è½½"></a>31.å…ƒç´ çš„æŒ‚è½½</h3><p>åœ¨vue2.xä¸­å½“æŒ‚è½½çš„å…ƒç´ æ˜¯ä¸€ä¸ªtemplayteçš„æ—¶å€™ï¼Œæ¸²æŸ“çš„å†…å®¹ä¼šæ›¿æ¢æ‰éœ€è¦æŒ‚è½½çš„å…ƒç´ ï¼Œåœ¨vue3.xä¸­ï¼Œéœ€è¦è¢«æ¸²æŸ“çš„å†…å®¹ä¼šæ·»åŠ åˆ°å…ƒç´ çš„childrenä¸­ï¼Œæ›¿ä»£å…ƒç´ çš„innerHTML</p><p>vue2.xä¸­</p><div class="code-wrapper"><pre><code class="hljs html">new Vue(&#123;  el: &#x27;#app&#x27;,  data() &#123;    return &#123;      message: &#x27;Hello Vue!&#x27;    &#125;  &#125;,  template: `    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;rendered&quot;</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  `&#125;)// orconst app = new Vue(&#123;  data() &#123;    return &#123;      message: &#x27;Hello Vue!&#x27;    &#125;  &#125;,  template: `    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;rendered&quot;</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  `&#125;)app.$mount(&#x27;#app&#x27;)</code></pre></div><p>æŒ‚è½½åˆ°å¯¹åº”çš„å…ƒç´ ä¸Š</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span>    Some app content  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre></div><p>æœ€ç»ˆæ¸²æŸ“çš„æ•ˆæœ</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;rendered&quot;</span>&gt;</span>Hello Vue!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre></div><p>vue3.xä¸­çš„æ•ˆæœ</p><div class="code-wrapper"><pre><code class="hljs html">const app = Vue.createApp(&#123;  data() &#123;    return &#123;      message: &#x27;Hello Vue!&#x27;    &#125;  &#125;,  template: `    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;rendered&quot;</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  `&#125;)app.mount(&#x27;#app&#x27;)</code></pre></div><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span> <span class="hljs-attr">data-v-app</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;rendered&quot;</span>&gt;</span>Hello Vue!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre></div><h3 id="32-transitionçš„å˜åŒ–"><a href="#32-transitionçš„å˜åŒ–" class="headerlink" title="32.transitionçš„å˜åŒ–"></a>32.transitionçš„å˜åŒ–</h3><p>.v-enterå·²è¢«æ›¿æ¢æˆ.v-enter-from</p><h3 id="33-vNode-ç”Ÿå‘½å‘¨æœŸäº‹ä»¶"><a href="#33-vNode-ç”Ÿå‘½å‘¨æœŸäº‹ä»¶" class="headerlink" title="33.vNode ç”Ÿå‘½å‘¨æœŸäº‹ä»¶"></a>33.vNode ç”Ÿå‘½å‘¨æœŸäº‹ä»¶</h3><p>åœ¨vue2.xä¸­ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶æ¥ç›‘å¬ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå¤„äºå“ªä¸ªé˜¶æ®µï¼Œè¿™äº›äº‹ä»¶çš„å‰ç¼€æ˜¯hook:,åœ¨ Vue 3 ä¸­ï¼Œæ­¤å‰ç¼€å·²æ›´æ”¹ä¸º<code>vue:</code>. æ­¤å¤–ï¼Œè¿™äº›äº‹ä»¶ç°åœ¨å¯ç”¨äº HTML å…ƒç´ å’Œç»„ä»¶</p><p>vue2.x </p><p>hook:åé¢è·Ÿçš„æ˜¯ç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„åç§°</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">child-component</span> @<span class="hljs-attr">hook:updated</span>=<span class="hljs-string">&quot;onUpdated&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><p>vue3.xä¸­</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">child-component</span> @<span class="hljs-attr">vue:updated</span>=<span class="hljs-string">&quot;onUpdated&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></code></pre></div><h3 id="34-æ•°ç»„çš„ç›‘å¬"><a href="#34-æ•°ç»„çš„ç›‘å¬" class="headerlink" title="34.æ•°ç»„çš„ç›‘å¬"></a>34.æ•°ç»„çš„ç›‘å¬</h3><p>vue3.xä¸­ï¼Œæ•°ç»„çš„ç›‘å¬éœ€è¦åŠ ä¸Šdeep</p><div class="code-wrapper"><pre><code class="hljs html">watch: &#123;  bookList: &#123;    handler(val, oldVal) &#123;      console.log(&#x27;book list changed&#x27;)    &#125;,    deep: true  &#125;,&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
      <category>daily</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>typescriptç¬”è®°</title>
    <link href="/2022/08/05/typescript%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/08/05/typescript%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>1.åœ¨å®šä¹‰ä¸€ä¸ªå˜é‡æ—¶ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹å¯ä»¥ç”¨ç±»å‹æ¨æ–­ï¼Œä¸ç”¨å®šä¹‰ç±»å‹</p><div class="code-wrapper"><pre><code class="hljs abnf">let msg <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hello there!&quot;</span><span class="hljs-comment">;</span></code></pre></div><p>2.tsçš„å¸¸ç”¨çš„æ•°æ®ç±»å‹</p><div class="code-wrapper"><pre><code class="hljs pgsql">string,number,<span class="hljs-type">boolean</span>,arrays,<span class="hljs-keyword">any</span>,<span class="hljs-keyword">function</span>,<span class="hljs-keyword">object</span>,<span class="hljs-keyword">union</span> <span class="hljs-keyword">type</span>,<span class="hljs-keyword">Type</span> Aliases,Interfacesï¼Œ<span class="hljs-keyword">Type</span> Assertionsï¼Œ<span class="hljs-type">bigint</span>ï¼Œsymbol,<span class="hljs-keyword">Type</span> Assertions,.Literal <span class="hljs-keyword">Types</span>,Enums ,<span class="hljs-keyword">null</span>,undefined,<span class="hljs-keyword">any</span>,<span class="hljs-type">unknown</span>,<span class="hljs-type">void</span>,never ,Tuple</code></pre></div><p>3.interfaceå’Œtype aliasesçš„åŒºåˆ«</p><div class="code-wrapper"><pre><code class="hljs typescript">å®ç°ç»§æ‰¿çš„æ–¹å¼ä¸åŒ<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Animal</span> &#123;  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>&#125;<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Bear</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> &#123;  <span class="hljs-attr">honey</span>: <span class="hljs-built_in">boolean</span>&#125;<span class="hljs-keyword">type</span> <span class="hljs-title class_">Animal</span> = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>&#125;<span class="hljs-keyword">type</span> <span class="hljs-title class_">Bear</span> = <span class="hljs-title class_">Animal</span> &amp; &#123;   <span class="hljs-attr">honey</span>: <span class="hljs-built_in">boolean</span> &#125;æ·»åŠ æ–°çš„å­—æ®µ<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Window</span> &#123;  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>&#125;<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Window</span> &#123;  <span class="hljs-attr">ts</span>: <span class="hljs-title class_">TypeScriptAPI</span>&#125;ç±»å‹åˆ«åä¸èƒ½å¤Ÿä¿®æ”¹å·²ç»åˆ›å»ºçš„å­—æ®µ<span class="hljs-keyword">type</span> <span class="hljs-title class_">Window</span> = &#123;  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>&#125;<span class="hljs-keyword">type</span> <span class="hljs-title class_">Window</span> = &#123;  <span class="hljs-attr">ts</span>: <span class="hljs-title class_">TypeScriptAPI</span>&#125; <span class="hljs-comment">// Error: Duplicate identifier &#x27;Window&#x27;.</span><span class="hljs-keyword">const</span> src = <span class="hljs-string">&#x27;const a = &quot;Hello World&quot;&#x27;</span>;<span class="hljs-variable language_">window</span>.<span class="hljs-property">ts</span>.<span class="hljs-title function_">transpileModule</span>(src, &#123;&#125;);æ¥å£åªèƒ½å£°æ˜å¯¹è±¡ï¼Œä¸èƒ½å¤Ÿé‡å‘½ååŸè¯­ç±»å‹åˆ«åä¸èƒ½å¤Ÿå£°æ˜åˆå¹¶ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¦‚æœæ˜¯å®šä¹‰éå¯¹è±¡ç±»å‹ï¼Œé€šå¸¸æ¨èä½¿ç”¨<span class="hljs-keyword">type</span>å¦‚æœæ˜¯å®šä¹‰å¯¹è±¡ç±»å‹ï¼Œé‚£ä¹ˆä»–ä»¬æ˜¯æœ‰åŒºåˆ«çš„ï¼š<span class="hljs-keyword">interface</span> å¯ä»¥é‡å¤çš„å¯¹æŸä¸ªæ¥å£æ¥å®šä¹‰å±æ€§å’Œæ–¹æ³•ï¼›è€Œtypeå®šä¹‰çš„æ˜¯åˆ«åï¼Œåˆ«åæ˜¯ä¸èƒ½é‡å¤çš„</code></pre></div><p>4.Type Assertionsç±»å‹æ–­è¨€</p><div class="code-wrapper"><pre><code class="hljs nim"><span class="hljs-type">TypeScript</span> åªå…è®¸ç±»å‹æ–­è¨€è½¬æ¢ä¸ºæ›´å…·ä½“æˆ–æ›´ä¸å…·ä½“çš„ç±»å‹ç‰ˆæœ¬ï¼Œè€Œä¸å¯ä»¥è½¬æˆæ²¡æœ‰å…³ç³»çš„ç±»å‹<span class="hljs-keyword">const</span> a = (<span class="hljs-type">expr</span> <span class="hljs-keyword">as</span> <span class="hljs-type">any</span>) <span class="hljs-keyword">as</span> T;  å¯ä»¥å°†ä¸¤ç§ä¸ç›¸å…³çš„ç±»å‹è¿›è¡Œè½¬æ¢æ—¶ï¼Œè¦è¿›è¡Œä¸¤æ¬¡æ–­è¨€ï¼Œå…ˆæ–­é›åŸ<span class="hljs-type">any</span>æˆ–è€…unknown</code></pre></div><p>5.Literal Types æ–‡æœ¬ç±»å‹</p><div class="code-wrapper"><pre><code class="hljs reasonml">const constantString = <span class="hljs-string">&quot;Hello World&quot;</span>;<span class="hljs-comment">//ä½¿ç”¨constå®šä¹‰çš„å¸¸é‡ç±»å‹</span><span class="hljs-keyword">function</span> print<span class="hljs-constructor">Text(<span class="hljs-params">s</span>: <span class="hljs-params">string</span>, <span class="hljs-params">alignment</span>: <span class="hljs-string">&quot;left&quot;</span> | <span class="hljs-string">&quot;right&quot;</span> | <span class="hljs-string">&quot;center&quot;</span>)</span> &#123;  <span class="hljs-comment">// ...</span>&#125;æ‚¨å¯ä»¥ä½¿ç”¨ <span class="hljs-keyword">as</span> const å°†æ•´ä¸ªå¯¹è±¡è½¬æ¢ä¸ºç±»å‹æ–‡å­—ï¼šconst req = &#123; url: <span class="hljs-string">&quot;https://example.com&quot;</span>, <span class="hljs-keyword">method</span>: <span class="hljs-string">&quot;GET&quot;</span> &#125; <span class="hljs-keyword">as</span> const;handle<span class="hljs-constructor">Request(<span class="hljs-params">req</span>.<span class="hljs-params">url</span>, <span class="hljs-params">req</span>.<span class="hljs-params">method</span>)</span>;</code></pre></div><p>.Enums æšä¸¾</p><p>7.tsçš„è¿è¡Œç¯å¢ƒ</p><div class="code-wrapper"><pre><code class="hljs crmsh">æ–¹å¼ä¸€ï¼štsc math.ts   <span class="hljs-keyword">node</span> <span class="hljs-title">math</span>.js  è¿™ç§æ–¹å¼ä¼šæ¯”è¾ƒéº»çƒ¦æ–¹å¼äºŒï¼šwebpackä¸­é…ç½®æœ¬åœ°çš„è¿è¡Œç¯å¢ƒ  ä½¿ç”¨ts-loaderæ–¹å¼ä¸‰ï¼šä½¿ç”¨ts-<span class="hljs-keyword">node</span><span class="hljs-title">npm</span> install ts-<span class="hljs-keyword">node</span> <span class="hljs-title">-g</span>npm install tslib @types/<span class="hljs-keyword">node</span> <span class="hljs-title">-g</span>ts-<span class="hljs-keyword">node</span> <span class="hljs-title">math</span>.ts</code></pre></div><p>8.unkonwnç±»å‹å’Œanyç±»å‹çš„åŒºåˆ«</p><p>ä»»ä½•ç±»å‹éƒ½å¯ä»¥æ˜¯anyç±»å‹,tsä¸ä¼šå¯¹anyç±»å‹çš„å˜é‡è¿›è¡Œç±»å‹æ£€æµ‹ï¼Œä»»ä½•ç±»å‹ä¹Ÿæ˜¯å¯ä»¥èµ‹å€¼ç»™unknown,ä½†æ˜¯ä½¿ç”¨è¿™ä¸ªå˜é‡å¿…é¡»è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™</p><p><img src="https://img1.imgtp.com/2022/08/05/Lt1elC2b.png" alt="QQæˆªå›¾20220715095600.png"></p><p>9.Tupleç±»å‹(å…ƒç»„)</p><p>å…ƒç»„ç±»å‹å°±æ˜¯ä¸åŒç±»å‹çš„æ•°ç»„çš„é›†åˆ</p><p><img src="https://img1.imgtp.com/2022/08/05/PyfvKidj.png" alt="QQæˆªå›¾20220715101013.png"></p><p>10.Neverç±»å‹</p><h5 id="Neverç±»å‹æŒ‡æ°¸ä¸å­˜åœ¨çš„ç±»å‹ã€‚-ä¾‹å¦‚ï¼Œnever-ç±»å‹æ˜¯é‚£äº›æ€»æ˜¯ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–æ ¹æœ¬å°±ä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•°è¡¨è¾¾å¼æˆ–ç®­å¤´å‡½æ•°è¡¨è¾¾å¼çš„è¿”å›å€¼ç±»å‹"><a href="#Neverç±»å‹æŒ‡æ°¸ä¸å­˜åœ¨çš„ç±»å‹ã€‚-ä¾‹å¦‚ï¼Œnever-ç±»å‹æ˜¯é‚£äº›æ€»æ˜¯ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–æ ¹æœ¬å°±ä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•°è¡¨è¾¾å¼æˆ–ç®­å¤´å‡½æ•°è¡¨è¾¾å¼çš„è¿”å›å€¼ç±»å‹" class="headerlink" title="Neverç±»å‹æŒ‡æ°¸ä¸å­˜åœ¨çš„ç±»å‹ã€‚ ä¾‹å¦‚ï¼Œnever ç±»å‹æ˜¯é‚£äº›æ€»æ˜¯ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–æ ¹æœ¬å°±ä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•°è¡¨è¾¾å¼æˆ–ç®­å¤´å‡½æ•°è¡¨è¾¾å¼çš„è¿”å›å€¼ç±»å‹"></a>Neverç±»å‹æŒ‡æ°¸ä¸å­˜åœ¨çš„ç±»å‹ã€‚ ä¾‹å¦‚ï¼Œnever ç±»å‹æ˜¯é‚£äº›æ€»æ˜¯ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–æ ¹æœ¬å°±ä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•°è¡¨è¾¾å¼æˆ–ç®­å¤´å‡½æ•°è¡¨è¾¾å¼çš„è¿”å›å€¼ç±»å‹</h5><p>11.å‡½æ•°å‚æ•°</p><p><img src="https://img1.imgtp.com/2022/08/05/8e9QZ1fu.png" alt="QQæˆªå›¾20220715111132.png"></p><ol start="12"><li>åŒ¿åå‡½æ•°çš„å‚æ•°ç±»å‹</li></ol><p><img src="https://img1.imgtp.com/2022/08/05/UiMI6HEs.png" alt="QQæˆªå›¾20220715111344.png"></p><p>13.å‡½æ•°å‚æ•°çš„å¯¹è±¡ç±»å‹</p><p><img src="https://img1.imgtp.com/2022/08/05/Itu8eHI1.png" alt="QQæˆªå›¾20220715112229.png"></p><p>14.å‡½æ•°å‚æ•°å¯¹è±¡å¯é€‰å‚æ•°</p><p><img src="https://img1.imgtp.com/2022/08/05/4knXfTJ1.png" alt="QQæˆªå›¾20220715112745.png"></p><p>15.è”åˆç±»å‹</p><p><img src="https://img1.imgtp.com/2022/08/05/xI0aQEuD.png" alt="QQæˆªå›¾20220715114922.png"></p><p>16.ä¸€ä¸ªå‚æ•°ä¸€ä¸ªå¯é€‰ç±»å‹çš„æ—¶å€™, å®ƒå…¶å®ç±»ä¼¼äºæ˜¯è¿™ä¸ªå‚æ•°æ˜¯ ç±»å‹|undefined çš„è”åˆç±»å‹</p><p>17.éç©ºç±»å‹æ–­è¨€!</p><p><img src="https://img1.imgtp.com/2022/08/05/T6LzBxdD.png" alt="QQæˆªå›¾20220715142334.png"></p><p>18.å¯é€‰é“¾æ“ä½œ</p><p><img src="https://img1.imgtp.com/2022/08/05/TaGoHMzn.png" alt="QQæˆªå›¾20220715151237.png"><br>19.!!è¿ç®—ç¬¦</p><p>å¯ä»¥å°†å…¶ä»–æ•°æ®ç±»å‹è½¬æ¢æˆboolean</p><p>20.??æ“ä½œç¬¦  ç©ºå€¼åˆå¹¶æ“ä½œç¬¦</p><div class="code-wrapper"><pre><code class="hljs actionscript"><span class="hljs-keyword">const</span> messgae1 = <span class="hljs-string">&quot;1111&quot;</span>;<span class="hljs-keyword">const</span> content = messgae1 ?? <span class="hljs-string">&quot;ä½ å¥½&quot;</span>;å¦‚æœmessage1æ˜¯<span class="hljs-literal">null</span>æˆ–è€…<span class="hljs-literal">undefined</span>,contentå°±ä¼šä½¿ç”¨åé¢çš„å€¼ï¼Œmessageæ˜¯ç©ºå­—ç¬¦ä¸²ä¸ç”Ÿæ•ˆ</code></pre></div><p>21.ç±»å‹ç¼©å°  Type Narrowing</p><p>ç±»å‹ç¼©å°å°±æ˜¯å°†ä¾‹å¦‚è”åˆç±»å‹è¿›è¡Œç²¾ç¡®åˆ°å…·ä½“çš„ç±»å‹</p><p>å¸¸è§çš„ç±»å‹ä¿æŠ¤æœ‰</p><p>typeof</p><p>===ï¼Œï¼==</p><p>instanceof</p><p>in</p><p>â€¦..</p><p><img src="https://img1.imgtp.com/2022/08/05/xmoxhxl5.png" alt="QQæˆªå›¾20220716003305.png"></p><p><img src="https://img1.imgtp.com/2022/08/05/DnVQP9fW.png" alt="QQæˆªå›¾20220716003335.png"></p><p><img src="https://img1.imgtp.com/2022/08/05/ECM7n6A2.png" alt="QQæˆªå›¾20220716003417"></p><p><img src="https://img1.imgtp.com/2022/08/05/eDTnB12m.png" alt="QQæˆªå›¾20220716003433"></p><p><img src="https://img1.imgtp.com/2022/08/05/s38SLBN0.png" alt="QQæˆªå›¾20220716003446"></p><p>22.å‡½æ•°ç±»å‹å®šä¹‰</p><p><img src="https://img1.imgtp.com/2022/08/05/E4FrxA0i.png"></p><p>23.å‚æ•°çš„å¯é€‰ç±»å‹</p><p><img src="https://img1.imgtp.com/2022/08/05/5GU46enS.png"></p><p>24.å‚æ•°çš„é»˜è®¤å€¼</p><p><img src="https://img1.imgtp.com/2022/08/05/0pGV9IBH.png"></p><p>25.å‰©ä½™å‚æ•°</p><p><img src="https://img1.imgtp.com/2022/08/05/b2Gi65SO.png"></p><p>26.æŒ‡å®šthisçš„ç»‘å®š</p><p><img src="https://img1.imgtp.com/2022/08/05/PLXzyda7.png"></p><p>27.å‡½æ•°çš„é‡è½½</p><p>é€šè¿‡è”åˆç±»å‹çš„æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š</p><p>â€‹ 1.éœ€è¦è¿›è¡Œå¾ˆå¤šç±»å‹é€»è¾‘åˆ¤æ–­</p><p>â€‹ 2.è¿”å›å€¼ç±»å‹ä¸èƒ½åˆ¤å®š</p><p><img src="https://img1.imgtp.com/2022/08/05/Xl0sI2DM.png"></p><p><img src="https://img1.imgtp.com/2022/08/05/obc6YOcv.png"></p><p>27.ç±»çš„å®šä¹‰</p><p><img src="https://img1.imgtp.com/2022/08/05/GQd3h5pF.png"></p><p>28.ç±»çš„ç»§æ‰¿</p><p><img src="https://img1.imgtp.com/2022/08/05/NwBuKZH2.png"></p><p>29.ç±»çš„å¤šæ€</p><p><img src="https://img1.imgtp.com/2022/08/05/95zR2UQ2.png"></p><p>30.ç±»çš„æˆå‘˜ä¿®é¥°ç¬¦</p><p>private ä¿®é¥°çš„å±æ€§å’Œæ–¹æ³•åªèƒ½åœ¨è¯¥ç±»å†…éƒ¨ä½¿ç”¨</p><p>protectedä¿®é¥°çš„å±æ€§å’Œæ–¹æ³•åªèƒ½åœ¨ç±»æœ¬èº«åŠå…¶å­ç±»å†…éƒ¨ä½¿ç”¨</p><p>publicæ˜¯é»˜è®¤çš„æˆå‘˜ä¿®é¥°ç¬¦ï¼Œå¯ä»¥åœ¨å¤–éƒ¨ï¼Œç±»ï¼Œå­ç±»ä½¿ç”¨</p><p><img src="https://img1.imgtp.com/2022/08/05/Pw02xjP0.png"></p><p>31.readonlyä¿®é¥°ç¬¦</p><p><img src="https://img1.imgtp.com/2022/08/05/KrYErakm.png"></p><p>32.è®¿é—®å™¨setter/getter</p><p><img src="https://img1.imgtp.com/2022/08/05/eVx6dPgv.png"></p><p>33.ç±»çš„é™æ€æˆå‘˜</p><p><img src="https://img1.imgtp.com/2022/08/05/ESG5cMLo.png"></p><p>34.æŠ½è±¡ç±»abstract</p><p>ä»€ä¹ˆæ˜¯ æŠ½è±¡æ–¹æ³•? åœ¨TypeScriptä¸­æ²¡æœ‰å…·ä½“å®ç°çš„æ–¹æ³•(æ²¡æœ‰æ–¹æ³•ä½“)ï¼Œå°±æ˜¯æŠ½è±¡æ–¹æ³•</p><p>æŠ½è±¡æ–¹æ³•ï¼Œå¿…é¡»å­˜åœ¨äºæŠ½è±¡ç±»ä¸­</p><p>æŠ½è±¡ç±»æ˜¯ä½¿ç”¨abstractå£°æ˜çš„ç±»</p><p><img src="https://img1.imgtp.com/2022/08/05/XmcOILgK.png"></p><p>35.ç±»æœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºå¦å¤–ä¸€å˜é‡çš„ç±»å‹</p><p>36.æ¥å£çš„å£°æ˜</p><p>â€‹ <img src="https://img1.imgtp.com/2022/08/05/3ANVJqpG.png"></p><p>37.æ¥å£çš„ç´¢å¼•ç±»å‹</p><p><img src="https://img1.imgtp.com/2022/08/05/1pM1SZre.png"></p><p>38.å‡½æ•°ç±»å‹</p><p>interfaceä¹Ÿå¯ä»¥å®šä¹‰å‡½æ•°ï¼Œå»ºè®®ä½¿ç”¨ç±»å‹åˆ«ååˆ—å®šä¹‰å‡½æ•°</p><p><img src="https://img1.imgtp.com/2022/08/05/xVRVoVov.png"></p><p>39.æ¥å£çš„ç»§æ‰¿</p><p><img src="https://img1.imgtp.com/2022/08/05/VlVrCRbV.png"></p><p><img src="https://img1.imgtp.com/2022/08/05/gvacaNKp.png"></p><p>40.äº¤å‰ç±»å‹</p><p><img src="https://img1.imgtp.com/2022/08/05/kExwu85c.png"></p><p>41.å­—é¢é‡èµ‹å€¼</p><p><img src="https://img1.imgtp.com/2022/08/05/LVx7kzYn.png"></p><p><img src="https://img1.imgtp.com/2022/08/05/UxFV3w0L.png" alt="QQæˆªå›¾20220716171033.png"></p><p>42.æšä¸¾ç±»å‹</p><p>æšä¸¾å…¶å®å°±æ˜¯å°†ä¸€ç»„å¯èƒ½å‡ºç°çš„å€¼ï¼Œä¸€ä¸ªä¸ªåˆ—ä¸¾å‡ºæ¥ï¼Œå®šä¹‰åœ¨ä¸€ä¸ªç±»å‹ä¸­ï¼Œè¿™ä¸ªç±»å‹å°±æ˜¯æšä¸¾ç±»å‹ï¼› pæšä¸¾å…è®¸å¼€å‘è€…å®šä¹‰ä¸€ç»„å‘½åå¸¸é‡ï¼Œå¸¸é‡å¯ä»¥æ˜¯æ•°å­—ã€å­—ç¬¦ä¸²ç±»å‹</p><p><img src="https://img1.imgtp.com/2022/08/05/JUcGQCK2.png" alt="QQæˆªå›¾20220716172406.png"></p><p><img src="https://img1.imgtp.com/2022/08/05/i4HcVm8N.png" alt="QQæˆªå›¾20220716172417.png"></p><p>43.æ³›å‹</p><p><img src="https://img1.imgtp.com/2022/08/05/A6dtGWoy.png" alt="QQæˆªå›¾20220717020140.png"></p><p><img src="https://img1.imgtp.com/2022/08/05/A6dtGWoy.png" alt="QQæˆªå›¾20220717020140.png"></p><p>44.æ³›å‹æ¥å£çš„å®šä¹‰</p><p><img src="https://img1.imgtp.com/2022/08/05/2ZbKkBg2.png" alt="QQæˆªå›¾20220717020609.png"></p><p>45.æ³›å‹ä½œä¸ºç±»</p><p><img src="https://img1.imgtp.com/2022/08/05/c0ucka5e.png" alt="QQæˆªå›¾20220717092242.png"></p><p>46.æ³›å‹çº¦æŸ</p><p><img src="https://img1.imgtp.com/2022/08/05/A9jQ0E9R.png" alt="QQæˆªå›¾20220717092443.png"></p><p>47.namespace</p><p>namespaceä¼šå½¢æˆç‹¬ç«‹çš„ç©ºé—´ï¼Œé‡Œé¢çš„å†…å®¹éœ€è¦ä½¿ç”¨exportï¼Œå¤–éƒ¨æ‰å¯ä»¥ä½¿ç”¨ï¼Œå¦åˆ™å¤–éƒ¨æ— æ³•è®¿é—®</p><p><img src="https://img1.imgtp.com/2022/08/05/qr2xvkmZ.png" alt="QQæˆªå›¾20220717174941.png"><br><img src="https://img1.imgtp.com/2022/08/05/Eq2OIARP.png" alt="QQæˆªå›¾20220717175005.png"><br>48.å‘½åç©ºé—´çš„æ‹†åˆ†</p><p>å¯ä»¥å°†å‘½åç©ºé—´çš„å†…å®¹æ‹†åˆ†åˆ°å¤šä¸ªæ–‡ä»¶ä¸­</p><p>49..d.tsæ–‡ä»¶  ç±»å‹å£°æ˜æ–‡ä»¶</p><p>å®ƒä»…ä»…ç”¨æ¥åšç±»å‹æ£€æµ‹ï¼Œå‘ŠçŸ¥typescriptæˆ‘ä»¬æœ‰å“ª äº›ç±»å‹</p><p>é‚£ä¹ˆtypescriptä¼šåœ¨å“ªé‡ŒæŸ¥æ‰¾æˆ‘ä»¬çš„ç±»å‹å£°æ˜å‘¢ï¼Ÿ</p><p>å†…ç½®ç±»å‹å£°æ˜ï¼›</p><p>å¤–éƒ¨å®šä¹‰ç±»å‹å£°æ˜ï¼›</p><p>è‡ªå·±å®šä¹‰ç±»å‹å£°æ˜ï¼›</p><p>ç±»å‹å£°æ˜æ–‡ä»¶ä¸»è¦é€‚ç”¨äºå¤–éƒ¨ç±»åº“ï¼Œä¾‹å¦‚å¼•å…¥çš„npmåŒ…æ²¡æœ‰åšç±»å‹å£°æ˜ï¼Œåˆ™éœ€è¦è‡ªå·±å†™ç±»å‹å£°æ˜æ–‡ä»¶</p><p>50.å†…ç½®ç±»å‹å£°æ˜</p><p>å†…ç½®ç±»å‹å£°æ˜æ˜¯typescriptè‡ªå¸¦çš„ã€å¸®åŠ©æˆ‘ä»¬å†…ç½®äº†JavaScriptè¿è¡Œæ—¶çš„ä¸€äº›æ ‡å‡†åŒ–APIçš„å£°æ˜æ–‡ä»¶ã€‚åŒ…æ‹¬æ¯”å¦‚Mathã€Dateç­‰å†…ç½®ç±»å‹ï¼Œä¹ŸåŒ…æ‹¬DOM APIï¼Œæ¯”å¦‚Windowã€Documentç­‰ï¼› å†…ç½®ç±»å‹å£°æ˜é€šå¸¸åœ¨æˆ‘ä»¬å®‰è£…typescriptçš„ç¯å¢ƒä¸­ä¼šå¸¦æœ‰çš„ï¼›</p><p>51.å¤–éƒ¨å®šä¹‰ç±»å‹å£°æ˜å’Œè‡ªå®šä¹‰å£°æ˜</p><p>å¤–éƒ¨ç±»å‹å£°æ˜é€šå¸¸æ˜¯æˆ‘ä»¬ä½¿ç”¨ä¸€äº›åº“ï¼ˆæ¯”å¦‚ç¬¬ä¸‰æ–¹åº“ï¼‰æ—¶ï¼Œéœ€è¦çš„ä¸€äº›ç±»å‹å£°æ˜</p><p>è¿™äº›åº“é€šå¸¸æœ‰ä¸¤ç§ç±»å‹å£°æ˜æ–¹å¼ï¼š</p><p> æ–¹å¼ä¸€ï¼šåœ¨è‡ªå·±åº“ä¸­è¿›è¡Œç±»å‹å£°æ˜ï¼ˆç¼–å†™.d.tsæ–‡ä»¶ï¼‰ï¼Œæ¯”å¦‚axios</p><p>æ–¹å¼äºŒï¼šé€šè¿‡ç¤¾åŒºçš„ä¸€ä¸ªå…¬æœ‰åº“DefinitelyTypedå­˜æ”¾ç±»å‹å£°æ˜æ–‡ä»¶</p><p>è¯¥åº“çš„GitHubåœ°å€ï¼š<a href="https://github.com/DefinitelyTyped/DefinitelyTyped/">https://github.com/DefinitelyTyped/DefinitelyTyped/</a></p><p>è¯¥åº“æŸ¥æ‰¾å£°æ˜å®‰è£…æ–¹å¼çš„åœ°å€ï¼š<a href="https://www.typescriptlang.org/dt/search?search">https://www.typescriptlang.org/dt/search?search</a>=</p><p>æ¯”å¦‚æˆ‘ä»¬å®‰è£…reactçš„ç±»å‹å£°æ˜ï¼š npm i @types/react â€“save-dev</p><p> ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦è‡ªå·±æ¥å®šä¹‰å£°æ˜æ–‡ä»¶å‘¢ï¼Ÿ</p><p>æƒ…å†µä¸€ï¼šæˆ‘ä»¬ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“æ˜¯ä¸€ä¸ªçº¯çš„JavaScriptåº“ï¼Œæ²¡æœ‰å¯¹åº”çš„å£°æ˜æ–‡ä»¶ï¼›æ¯”å¦‚lodash</p><p>æƒ…å†µäºŒï¼šæˆ‘ä»¬ç»™è‡ªå·±çš„ä»£ç ä¸­å£°æ˜ä¸€äº›ç±»å‹ï¼Œæ–¹ä¾¿åœ¨å…¶ä»–åœ°æ–¹ç›´æ¥è¿›è¡Œä½¿ç”¨ï¼›</p><p>52.tsconfig.jsæ–‡ä»¶</p>]]></content>
    
    
    <categories>
      
      <category>typescript</category>
      
      <category>note</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•é—®é¢˜è®°å½•</title>
    <link href="/2022/08/04/interview02/"/>
    <url>/2022/08/04/interview02/</url>
    
    <content type="html"><![CDATA[<h3 id="ä»æµè§ˆå™¨åœ°å€æ è¾“å…¥urlåˆ°æ˜¾ç¤ºé¡µé¢çš„æ­¥éª¤"><a href="#ä»æµè§ˆå™¨åœ°å€æ è¾“å…¥urlåˆ°æ˜¾ç¤ºé¡µé¢çš„æ­¥éª¤" class="headerlink" title="ä»æµè§ˆå™¨åœ°å€æ è¾“å…¥urlåˆ°æ˜¾ç¤ºé¡µé¢çš„æ­¥éª¤"></a>ä»æµè§ˆå™¨åœ°å€æ è¾“å…¥urlåˆ°æ˜¾ç¤ºé¡µé¢çš„æ­¥éª¤</h3><h3 id="å¦‚ä½•è¿›è¡Œç½‘ç«™æ€§èƒ½ä¼˜åŒ–"><a href="#å¦‚ä½•è¿›è¡Œç½‘ç«™æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="å¦‚ä½•è¿›è¡Œç½‘ç«™æ€§èƒ½ä¼˜åŒ–"></a>å¦‚ä½•è¿›è¡Œç½‘ç«™æ€§èƒ½ä¼˜åŒ–</h3><h3 id="è¯·æè¿°ä¸€ä¸‹-cookiesï¼ŒsessionStorage-å’Œ-localStorage-çš„åŒºåˆ«"><a href="#è¯·æè¿°ä¸€ä¸‹-cookiesï¼ŒsessionStorage-å’Œ-localStorage-çš„åŒºåˆ«" class="headerlink" title="è¯·æè¿°ä¸€ä¸‹ cookiesï¼ŒsessionStorage å’Œ localStorage çš„åŒºåˆ«"></a>è¯·æè¿°ä¸€ä¸‹ <code>cookies</code>ï¼Œ<code>sessionStorage</code> å’Œ <code>localStorage</code> çš„åŒºåˆ«</h3><h3 id="WEBæ ‡å‡†ä»¥åŠW3Cæ ‡å‡†æ˜¯ä»€ä¹ˆ"><a href="#WEBæ ‡å‡†ä»¥åŠW3Cæ ‡å‡†æ˜¯ä»€ä¹ˆ" class="headerlink" title="WEBæ ‡å‡†ä»¥åŠW3Cæ ‡å‡†æ˜¯ä»€ä¹ˆ"></a>WEBæ ‡å‡†ä»¥åŠW3Cæ ‡å‡†æ˜¯ä»€ä¹ˆ</h3><h3 id="HTTP-requestæŠ¥æ–‡ç»“æ„æ˜¯æ€æ ·çš„"><a href="#HTTP-requestæŠ¥æ–‡ç»“æ„æ˜¯æ€æ ·çš„" class="headerlink" title="HTTP requestæŠ¥æ–‡ç»“æ„æ˜¯æ€æ ·çš„"></a>HTTP requestæŠ¥æ–‡ç»“æ„æ˜¯æ€æ ·çš„</h3><h3 id="HTTP-responseæŠ¥æ–‡ç»“æ„æ˜¯æ€æ ·çš„"><a href="#HTTP-responseæŠ¥æ–‡ç»“æ„æ˜¯æ€æ ·çš„" class="headerlink" title="HTTP responseæŠ¥æ–‡ç»“æ„æ˜¯æ€æ ·çš„"></a>HTTP responseæŠ¥æ–‡ç»“æ„æ˜¯æ€æ ·çš„</h3><h3 id="å¦‚ä½•å‚ç›´å±…ä¸­ä¸€ä¸ªæµ®åŠ¨å…ƒç´ "><a href="#å¦‚ä½•å‚ç›´å±…ä¸­ä¸€ä¸ªæµ®åŠ¨å…ƒç´ " class="headerlink" title="å¦‚ä½•å‚ç›´å±…ä¸­ä¸€ä¸ªæµ®åŠ¨å…ƒç´ "></a>å¦‚ä½•å‚ç›´å±…ä¸­ä¸€ä¸ªæµ®åŠ¨å…ƒç´ </h3><h3 id="cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»€ä¹ˆ"><a href="#cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»€ä¹ˆ" class="headerlink" title="cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»€ä¹ˆ"></a>cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»€ä¹ˆ</h3><p>é¢è¯•æ€»ç»“</p><p>cssåŠ¨ç”»</p><p>ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’</p><p>jsonpå¦‚ä½•å®ç°è·¨åŸŸ</p><p>tcpä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹</p><p>æ­£åˆ™è¡¨è¾¾å¼</p><p>é¦–å±åŠ è½½ä¼˜åŒ–</p><p>promiseå®ç°</p><p>promise.allå®ç°</p><p>å¹¶å‘å¤šæ¡è¯·æ±‚ï¼Œç­‰æ‰€æœ‰æˆåŠŸååœ¨å“åº”</p><p>è‡ªå·±åšè¿‡å“ªäº›ç¼“å­˜</p><p>eventBus</p><p>å¦‚ä½•å®ç°è·¨åŸŸ</p><p>è®¾è®¡æ¨¡å¼</p><p>ä¸­è‹±æ–‡åˆ‡æ¢ï¼šå‰ç«¯å›½é™…åŒ–</p><p>è‡ªå·±webpackæ­å»ºé¡¹ç›®</p><p>å“ªäº›æ•°æ®éœ€è¦ç¼“å­˜</p><p>å‰ç«¯æ•°æ®å¯è§†åŒ–</p><p>vue-cliæ­å»º</p><p>vue3äº†è§£</p><p>æ•°æ®è¯·æ±‚æ¥å£æ‹¦æˆª</p><p>æœ‰æ²¡æœ‰åšè¿‡é‡æ„</p><p>v-forå’Œv-showåŒºåˆ«</p><p>v-forä¸ºä»€ä¹ˆä¸å¯ä»¥å’Œv-ifä¸€èµ·ç”¨</p><p>è‡ªå®šä¹‰å‘½ä»¤v-**æœ‰æ²¡æœ‰ç”¨è¿‡ï¼Œè®¾ç½®ä¼˜å…ˆçº§</p><p>ç”¨è¿‡å“ªäº›ç¼“å­˜</p><p>$nexttrickä½¿ç”¨åœºæ™¯</p><p>ç”¨è¿‡å“ªäº›é’©å­å‡½æ•°</p><p>visual Dom</p><p>vueä¸­routerå®ç°åŸç†</p><p>å¦‚ä½•å‡å°‘å›æµé‡ç»˜</p><p>ç”¨è¿‡å“ªäº›è®¾è®¡æ¨¡å¼ï¼Œå‰ç«¯æ¨¡å—åˆ†å±‚ tsä¸­æœ‰è¿›è¡Œæ¨¡å—çš„åˆ†å±‚</p><p>v-modelå’ŒsyncåŒºåˆ«</p><p>æµè§ˆå™¨æ¸²æŸ“çº¿ç¨‹æ˜¯å¼‚æ­¥è¿˜æ˜¯åŒæ­¥çš„</p><p>vueä¸­åŠ è½½å¤–éƒ¨jsæ–‡ä»¶å’Œvueä¸­jsçš„æ‰§è¡Œé¡ºåº</p><p>vueä¸­å¦‚ä½•è¿›è¡Œè·¨å¤šä¸ªç»„ä»¶ä¼ é€’ä¿¡æ¯</p><p>ç§»åŠ¨ç«¯å®‰å“å’Œiosçš„å…¼å®¹æ€§é—®é¢˜ï¼Œpcç«¯å…¼å®¹æ€§é—®é¢˜</p><p>é¡µé¢åµŒå…¥åˆ°appä¸­å¦‚ä½•åŒºåˆ†æ˜¯æ˜¯å¤–éƒ¨é¡µé¢è¿˜æ˜¯appé¡µé¢</p><h5 id="http2-http3çš„åŒºåˆ«"><a href="#http2-http3çš„åŒºåˆ«" class="headerlink" title="http2/http3çš„åŒºåˆ«"></a>http2/http3çš„åŒºåˆ«</h5><h5 id="ä¸€ç™¾ä¸‡æ¡æ•°æ®ä¸­æŸ¥è¯¢ä¸€æ¡æ•°æ®"><a href="#ä¸€ç™¾ä¸‡æ¡æ•°æ®ä¸­æŸ¥è¯¢ä¸€æ¡æ•°æ®" class="headerlink" title="ä¸€ç™¾ä¸‡æ¡æ•°æ®ä¸­æŸ¥è¯¢ä¸€æ¡æ•°æ®"></a>ä¸€ç™¾ä¸‡æ¡æ•°æ®ä¸­æŸ¥è¯¢ä¸€æ¡æ•°æ®</h5><h5 id="å¦‚ä½•æ ¹æ®ç”µè„‘ç³»ç»Ÿçš„äº®åº¦æ¥è°ƒæ•´background"><a href="#å¦‚ä½•æ ¹æ®ç”µè„‘ç³»ç»Ÿçš„äº®åº¦æ¥è°ƒæ•´background" class="headerlink" title="å¦‚ä½•æ ¹æ®ç”µè„‘ç³»ç»Ÿçš„äº®åº¦æ¥è°ƒæ•´background"></a>å¦‚ä½•æ ¹æ®ç”µè„‘ç³»ç»Ÿçš„äº®åº¦æ¥è°ƒæ•´background</h5><h5 id="å¦‚æœå‡ºç°é¡µé¢å‡ºç°å¤§é¢ç§¯ç©ºç™½è§£å†³æ–¹æ¡ˆ"><a href="#å¦‚æœå‡ºç°é¡µé¢å‡ºç°å¤§é¢ç§¯ç©ºç™½è§£å†³æ–¹æ¡ˆ" class="headerlink" title="å¦‚æœå‡ºç°é¡µé¢å‡ºç°å¤§é¢ç§¯ç©ºç™½è§£å†³æ–¹æ¡ˆ"></a>å¦‚æœå‡ºç°é¡µé¢å‡ºç°å¤§é¢ç§¯ç©ºç™½è§£å†³æ–¹æ¡ˆ</h5><h5 id="scroll-behaviorçš„å€¼ï¼ŒåŠå…¶ä½œç”¨"><a href="#scroll-behaviorçš„å€¼ï¼ŒåŠå…¶ä½œç”¨" class="headerlink" title="scroll-behaviorçš„å€¼ï¼ŒåŠå…¶ä½œç”¨"></a>scroll-behaviorçš„å€¼ï¼ŒåŠå…¶ä½œç”¨</h5><h5 id="DOCTYPEçš„ä½œç”¨"><a href="#DOCTYPEçš„ä½œç”¨" class="headerlink" title="DOCTYPEçš„ä½œç”¨"></a>DOCTYPEçš„ä½œç”¨</h5><h5 id="JSå¦‚ä½•ä¸Šä¼ å¤šå¼ pngæ ¼å¼çš„å›¾ç‰‡"><a href="#JSå¦‚ä½•ä¸Šä¼ å¤šå¼ pngæ ¼å¼çš„å›¾ç‰‡" class="headerlink" title="JSå¦‚ä½•ä¸Šä¼ å¤šå¼ pngæ ¼å¼çš„å›¾ç‰‡"></a>JSå¦‚ä½•ä¸Šä¼ å¤šå¼ pngæ ¼å¼çš„å›¾ç‰‡</h5>]]></content>
    
    
    <categories>
      
      <category>interview</category>
      
      <category>daily</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç‰›å®¢ç½‘æ”¶é›†é¢è¯•é¢˜ç­”æ¡ˆ</title>
    <link href="/2022/08/04/interview01/"/>
    <url>/2022/08/04/interview01/</url>
    
    <content type="html"><![CDATA[<h4 id="1-è¯´ä¸€è¯´cookie-sessionStorage-localStorage-åŒºåˆ«ï¼Ÿ"><a href="#1-è¯´ä¸€è¯´cookie-sessionStorage-localStorage-åŒºåˆ«ï¼Ÿ" class="headerlink" title="1.è¯´ä¸€è¯´cookie sessionStorage localStorage åŒºåˆ«ï¼Ÿ"></a>1.è¯´ä¸€è¯´cookie sessionStorage localStorage åŒºåˆ«ï¼Ÿ</h4><p><strong>æˆ‘çš„å›ç­”ï¼š</strong>cookieçš„å¤§å°åªæœ‰4k,cookieæ˜¯åœ¨æµè§ˆå™¨ä¸­å­˜å‚¨çš„ï¼Œåˆ†ä¸ºä¸¤ç§ï¼Œå†…å­˜cookieå’Œç¡¬ç›˜cookie,é»˜è®¤çš„cookieå°±æ˜¯å†…å­˜cookie,æ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œé»˜è®¤æƒ…å†µä¸‹å°±æ˜¯æµè§ˆå™¨å…³é—­ï¼Œcookieå°±ä¼šè¢«æµè§ˆå™¨åˆ é™¤ï¼Œç¡¬ç›˜cookieæ˜¯æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåœ¨è¿‡æœŸæ—¶é—´ä¹‹å‰ï¼Œæµè§ˆå™¨å…³é—­ï¼Œcookieä¸ä¼šè¢«åˆ é™¤ã€‚æŠŠè¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºè´Ÿæ•°æˆ–è€…0ï¼Œå¯ä»¥åˆ é™¤cookieã€‚</p><p>sessionStorageå’ŒlocalStorageä¸ä¼šè‡ªåŠ¨å­˜å‚¨ï¼Œéœ€è¦æ‰‹åŠ¨çš„å­˜å‚¨æ•°æ®ï¼Œå­˜å‚¨çš„æ•°æ®é‡ä¼šæ¯”cookieå¤§ã€‚sessionStorageåªä¼šåœ¨æœ¬æ¬¡ä¼šè¯ä¸­å­˜å‚¨ï¼Œä¸ä¼šåœ¨æ–°çš„é¡µé¢ä¸­è¢«è·å–ã€‚localStorageåœ¨é¡µé¢å…³é—­å¹¶ä¸”é‡æ–°æ‰“å¼€æ—¶ä¸ä¼šè¢«æ¸…é™¤ï¼ŒsessionStorageä¼šè¢«æ¸…é™¤ã€‚åœ¨é¡µé¢å†…å‘ç”Ÿè·³è½¬ä¸æ‰“å¼€æ–°çš„é¡µé¢çš„æ—¶å€™ï¼ŒsessionStorageå’Œlocalstorageä¸ä¼šè¢«åˆ é™¤ï¼Œåœ¨é¡µé¢ä¸­è·³è½¬æ‰“å¼€æ–°çš„é¡µé¢çš„æ—¶å€™ï¼ŒsessionStorageä¸ä¿å­˜ï¼Œlocalstorageä¼šä¿å­˜</p><p><strong>å‚è€ƒç­”æ¡ˆï¼š</strong>å¾—åˆ†ç‚¹ æ•°æ®å­˜å‚¨ä½ç½®ï¼Œç”Ÿå‘½å‘¨æœŸï¼Œå­˜å‚¨å¤§å°ï¼Œå†™å…¥æ–¹å¼ï¼Œæ•°æ®å…±äº«ï¼Œå‘é€è¯·æ±‚æ˜¯å¦æºå¸¦ï¼Œåº”ç”¨åœºæ™¯ã€‚ç›¸åŒç‚¹Cookie,SessionStorageï¼ŒLocalStorageéƒ½æ˜¯å­˜å‚¨åœ¨æµè§ˆå™¨æœ¬åœ°çš„ï¼Œä¸åŒç‚¹ï¼Œcookieé»˜è®¤æ˜¯æµè§ˆå™¨å…³é—­æ—¶å€™ä¼šè¢«åˆ é™¤ï¼Œå¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåœ¨è¿‡æœŸæ—¶é—´å†…æµè§ˆå™¨å…³é—­ï¼Œcookieä¸ä¼šåˆ é™¤ã€‚cookieä¸€èˆ¬æ˜¯ç”±æœåŠ¡ç«¯å†™å…¥çš„ï¼ŒSessionStorageå’ŒLocalStorageæ˜¯åœ¨å®¢æˆ·ç«¯å†™å…¥çš„ï¼Œcookieçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç”±æœåŠ¡ç«¯è®¾ç½®å¥½çš„ï¼Œè€ŒLocalStorageæ˜¯æ°¸è¿œå­˜åœ¨çš„ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨åˆ é™¤ã€‚SessionStorageé¡µé¢å…³é—­ä¼šè¢«æ¸…é™¤ã€‚sessionStorageåªä¼šåœ¨æœ¬æ¬¡ä¼šè¯ä¸­å­˜å‚¨ï¼Œä¸ä¼šåœ¨æ–°çš„é¡µé¢ä¸­è¢«è·å–ï¼Œé¡µé¢å†…å‘ç”Ÿè·³è½¬ä¸æ‰“å¼€æ–°çš„é¡µé¢æ—¶å€™ï¼ŒsessionStorageä¸ä¼šè¢«æ¸…é™¤ï¼Œcookieçš„å­˜å‚¨å¤§å°ä¸º4k,sessionStorageå’ŒlocalStorageå­˜å‚¨å¤§å°ä¸º5Mã€‚cookieï¼ŒsessionStorage,localStorageæ•°æ®å…±äº«éƒ½æ˜¯éµå¾ªåŒæºç­–ç•¥åŸåˆ™ï¼ŒSessionStorageè¿˜å¿…é¡»é™åˆ¶åœ¨åŒä¸€ä¸ªé¡µé¢ã€‚å‰ç«¯å‘åç«¯å‘é€æ•°æ®çš„æ—¶å€™ï¼Œcookieä¼šè‡ªåŠ¨æºå¸¦ï¼Œè€ŒlocalStorageå’ŒsessionStorageä¸­çš„æ•°æ®å¿…é¡»æ‰‹åŠ¨æ·»åŠ ã€‚åº”ç”¨åœºæ™¯ï¼šcookieå¯ä»¥å­˜å‚¨ç™»å½•çš„éªŒè¯ä¿¡æ¯SessionIdå’Œtoken,localStorageé€šå¸¸å­˜å‚¨ä¸æ˜“å˜åŠ¨çš„æ•°æ®æ¥å‡è½»æœåŠ¡å™¨çš„å‹åŠ›ï¼ŒSessionStorageå¯ä»¥ç”¨æ¥æ£€æµ‹ç”¨æˆ·æ˜¯å¦åˆ·æ–°è¿›å…¥é¡µé¢ï¼ŒåƒéŸ³ä¹æ’­æ”¾å™¨æ¢å¤æ’­æ”¾è¿›åº¦æ¡çš„åŠŸèƒ½</p><h4 id="2-è¯´ä¸€è¯´JSæ•°æ®ç±»å‹æœ‰å“ªäº›-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-è¯´ä¸€è¯´JSæ•°æ®ç±»å‹æœ‰å“ªäº›-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2.è¯´ä¸€è¯´JSæ•°æ®ç±»å‹æœ‰å“ªäº›,åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2.è¯´ä¸€è¯´JSæ•°æ®ç±»å‹æœ‰å“ªäº›,åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>æ•°æ®ç±»å‹æœ‰Null,undefined,Boolean,Number.String,Symbol,Bigint,Object8ç§æ•°æ®ç±»å‹</p><p>åŸºæœ¬æ•°æ®ç±»å‹æœ‰null,undefined,boolean,number,string,symbol,bigint,å¼•ç”¨æ•°æ®ç±»å‹åŒ…æ‹¬æ™®é€šçš„objectï¼Œæ•°ç»„ï¼Œæ­£åˆ™ï¼ŒDateå¯¹è±¡ï¼ŒMathå†…ç½®å¯¹è±¡ï¼ŒFunctionå¯¹è±¡ï¼ŒåŒ…æ‹¬ES6æ–°å¢çš„Mapå’ŒSetå¯¹è±¡</p><p>åŸºæœ¬æ•°æ®ç±»å‹æ˜¯å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå¼•ç”¨æ•°æ®ç±»å‹å­˜å‚¨åœ¨å †ä¸­çš„ï¼Œå¼•ç”¨æ•°æ®ç±»å‹åœ¨æ ˆä¸­å­˜å‚¨äº†æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å­˜å‚¨æ•°æ®æ‰€åœ¨çš„å †å†…å­˜çš„èµ·å§‹åœ°å€ã€‚</p><p>Symbolæ˜¯ES6ä¸­æ–°å¢çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯ä»¥äº§ç”Ÿä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å€¼ï¼Œä½œä¸ºObjectçš„keyã€‚Symbolåˆ›å»ºçš„å€¼å…·æœ‰å”¯ä¸€æ€§ï¼ŒSymbol(key)!==Symbol(key),è¦è·å–å¯¹è±¡ä¸­ç”¨symbolä½œä¸ºkeyçš„å±æ€§ï¼Œå¿…é¡»é€šè¿‡Object.getOwnPropertySymbols(obj)</p><p>Bigintä¹Ÿæ˜¯ES6æ–°å¢çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ¥ä»£è¡¨è¶…å‡ºæœ€å¤§æˆ–è€…æœ€å°Numberå¯ä»¥è¡¨ç¤ºçš„å€¼ï¼Œä¸å¯ä»¥å’ŒNumberæ··ç”¨</p><p>åˆ¤æ–­åŸºæœ¬æ•°æ®ç±»å‹å¯ä»¥ä½¿ç”¨typeof æ¥åˆ¤æ–­ï¼Œä½†æ˜¯typeof null ===object typeof function===â€™functionâ€™</p><p>æ— æ³•åˆ¤æ–­å…¶ä»–å¼•ç”¨æ•°æ®ç±»å‹ï¼Œå¿…é¡»ä½¿ç”¨instanceofæ¥åˆ¤æ–­</p><h4 id="3-è¯´ä¸€è¯´ä½ å¯¹é—­åŒ…çš„ç†è§£ï¼Ÿ"><a href="#3-è¯´ä¸€è¯´ä½ å¯¹é—­åŒ…çš„ç†è§£ï¼Ÿ" class="headerlink" title="3.è¯´ä¸€è¯´ä½ å¯¹é—­åŒ…çš„ç†è§£ï¼Ÿ"></a>3.è¯´ä¸€è¯´ä½ å¯¹é—­åŒ…çš„ç†è§£ï¼Ÿ</h4><p>é—­åŒ…å°±æ˜¯å†…éƒ¨å‡½æ•°è®¿é—®å¤–éƒ¨ç¯å¢ƒçš„è‡ªç”±å˜é‡ï¼Œå¤–éƒ¨å˜é‡å¯ä»¥å¼•ç”¨å¦ä¸€ä¸ªå‡½æ•°çš„å†…éƒ¨å‡½æ•°ï¼Œé€šè¿‡è¿™ä¸ªå†…éƒ¨å‡½æ•°çš„å¼•ç”¨æ¥è®¿é—®ä»–çš„ä¸Šå±‚ä½œç”¨åŸŸï¼Œå¦‚æœè¿™ä¸ªå¤–éƒ¨å˜é‡ä¾ç„¶å¼•ç”¨ç€è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼Œè€Œå¯¼è‡´å†…å­˜æ³„éœ²ã€‚é—­åŒ…å¯ä»¥æ¨¡ä»¿å—çº§ä½œç”¨åŸŸï¼Œèƒ½å¤Ÿå®ç°å‡½æ•°æŸ¯é‡ŒåŒ–ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ç‰¹æƒæ–¹æ³•ï¼ŒVueä¸­æ•°æ®å“åº”å¼Observerä½¿ç”¨äº†é—­åŒ…</p><h4 id="4-è¯´ä¸€è¯´promiseæ˜¯ä»€ä¹ˆä¸ä½¿ç”¨æ–¹æ³•ï¼Ÿ"><a href="#4-è¯´ä¸€è¯´promiseæ˜¯ä»€ä¹ˆä¸ä½¿ç”¨æ–¹æ³•ï¼Ÿ" class="headerlink" title="4.è¯´ä¸€è¯´promiseæ˜¯ä»€ä¹ˆä¸ä½¿ç”¨æ–¹æ³•ï¼Ÿ"></a>4.è¯´ä¸€è¯´promiseæ˜¯ä»€ä¹ˆä¸ä½¿ç”¨æ–¹æ³•ï¼Ÿ</h4><p>Promiseæ˜¯å¼‚æ­¥å¾®ä»»åŠ¡ï¼Œnew Promiseæ˜¯åŒæ­¥æ‰§è¡Œï¼Œnew Promise().then()æ˜¯å¼‚æ­¥çš„ï¼Œpromiseè§£å†³äº†å¼‚æ­¥å¤šå±‚åµŒå¥—å›è°ƒï¼Œé€ æˆå›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œè®©ä»£ç çš„å¯è¯»æ€§å¢åŠ ï¼Œæ›´åŠ å®¹æ˜“ç»´æŠ¤ã€‚</p><p>promiseçš„ä½¿ç”¨ï¼šé€šè¿‡new Promise()åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œä¼ å…¥ä¸€ä¸ªåŒ…å«resolve,rejectä½œä¸ºå‚æ•°çš„å‡½è°ƒå‡½æ•°ï¼Œæ‰§è¡ŒæˆåŠŸæ˜¯ä½¿ç”¨resolve(),æ‰§è¡Œå¤±è´¥æ˜¯ä½¿ç”¨reject,promsieæœ‰ä¸‰ç§çŠ¶æ€ï¼Œpadding ,rejected,fulfilled,å½“çŠ¶æ€å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œå°±ä¸ä¼šå†æ›´æ”¹ï¼Œæ‰€ä»¥fulfilledçŠ¶æ€æ‰§è¡Œresolveï¼ŒrejectedçŠ¶æ€æ‰§è¡Œreject,ç„¶åä¼šè°ƒç”¨å®ä¾‹æ–¹æ³•then(),thenæ˜¯å¼‚æ­¥è°ƒç”¨ï¼Œæœ‰ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æˆåŠŸçš„å›è°ƒï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å¤±è´¥çš„å›è°ƒï¼Œå¤±è´¥çš„å›è°ƒä¹Ÿå¯ä»¥é“¾å¼è°ƒç”¨ä½¿ç”¨catchä¼ å…¥å¤±è´¥çš„å›è°ƒï¼Œpromise.finally()ä¸ç®¡æˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½ä¼šæ‰§è¡Œï¼Œpromsieä¸­çš„ç±»æ–¹æ³•ï¼ŒPromsie.resolve()è½¬æ¢æˆfulfilledçŠ¶æ€ï¼Œå¹¶å°†å‚æ•°ä¼ ç»™then,Promise.reject()è½¬æ¢ä»rejectedçŠ¶æ€ï¼Œå¹¶å°†ç»™å®šçš„å¤±è´¥çš„ä¿¡æ¯ä¼ é€’ç»™catch,any()æ–¹æ³•ä¼šä¼ å…¥ä¸€ä¸ªpromiseæ•°ç»„ï¼Œåªè¦æœ‰ä¸€ä¸ªpromiseä¸ºfulfilledçŠ¶æ€ï¼Œåˆ™anyä¹Ÿæ˜¯fulfilled,åªæœ‰å…¨éƒ¨ä¸ºrejectedåˆ™ä¸ºrejected,allSettled()çŠ¶æ€åªæœ‰fulfilledçŠ¶æ€ï¼Œrace()è°å…ˆæ”¹å˜çŠ¶æ€å°±æ˜¯ä½¿ç”¨è°çš„çŠ¶æ€,all()åªæœ‰å…¨éƒ¨ä¸ºfulfilledæ‰æ˜¯fulfilledï¼Œæœ‰ä¸€ä¸ªä¸ºrejectåˆ™ä¸ºreject</p><h4 id="5-è¯´ä¸€è¯´è·¨åŸŸæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ"><a href="#5-è¯´ä¸€è¯´è·¨åŸŸæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ" class="headerlink" title="5.è¯´ä¸€è¯´è·¨åŸŸæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ"></a>5.è¯´ä¸€è¯´è·¨åŸŸæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ</h4><p>ç”±äºåŒæºç­–ç•¥ï¼Œå½“å‡ºç°è¯·æ±‚é¡µé¢çš„åœ°å€å’Œå½“å‰é¡µé¢åœ°å€åè®®ï¼ŒåŸŸåï¼Œç«¯å£å·æœ‰ä¸€ä¸ªä¸ä¸€è‡´å°±ä¼šå‡ºç°è·¨åŸŸã€‚</p><p>è§£å†³è·¨åŸŸçš„æ–¹æ³•</p><p>ä½¿ç”¨jsonpè¿›è¡Œè¯·æ±‚æ•°æ®ï¼Œå¹¶ä¸”é€šè¿‡å›è°ƒå‡½æ•°æ¥æºå¸¦è¿”å›çš„æ•°æ®</p><p>corsï¼šç›®å‰æœ€å¸¸ç”¨çš„ä¸€ç§è§£å†³åŠæ³•ï¼Œé€šè¿‡è®¾ç½®åç«¯å…è®¸è·¨åŸŸå®ç°ã€‚<br>res.setHeader(â€˜Access-Control-Allow-Originâ€™, â€˜*â€™);<br>res.setHeader(â€œAccess-Control-Allow-Methodsâ€, â€œGET, PUT, OPTIONS, POSTâ€);</p><p>nodeä¸­é—´ä»¶ã€nginxåå‘ä»£ç†ï¼šè·¨åŸŸé™åˆ¶çš„æ—¶å€™æµè§ˆå™¨ä¸èƒ½è·¨åŸŸè®¿é—®æœåŠ¡å™¨ï¼Œnodeä¸­é—´ä»¶å’Œnginxåå‘ä»£ç†ï¼Œéƒ½æ˜¯è®©è¯·æ±‚å‘ç»™ä»£ç†æœåŠ¡å™¨ï¼Œé™æ€é¡µé¢é¢å’Œä»£ç†æœåŠ¡å™¨æ˜¯åŒæºçš„ï¼Œç„¶åä»£ç†æœåŠ¡å™¨å†å‘åç«¯æœåŠ¡å™¨å‘è¯·æ±‚ï¼ŒæœåŠ¡å™¨å’ŒæœåŠ¡å™¨ä¹‹é—´ä¸å­˜åœ¨åŒæºé™åˆ¶</p><p>JSONPï¼šåˆ©ç”¨çš„åŸç†æ˜¯scriptæ ‡ç­¾å¯ä»¥è·¨åŸŸè¯·æ±‚èµ„æºï¼Œå°†å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°æ‹¼æ¥åœ¨urlä¸­ã€‚åç«¯æ”¶åˆ°è¯·æ±‚ï¼Œè°ƒç”¨è¯¥å›è°ƒå‡½æ•°ï¼Œå¹¶å°†æ•°æ®ä½œä¸ºå‚æ•°è¿”å›å»ï¼Œæ³¨æ„è®¾ç½®å“åº”å¤´è¿”å›æ–‡æ¡£ç±»å‹ï¼Œåº”è¯¥è®¾ç½®æˆjavascriptã€‚</p><p>postmessageï¼šH5æ–°å¢APIï¼Œé€šè¿‡å‘é€å’Œæ¥æ”¶APIå®ç°è·¨åŸŸé€šä¿¡ã€‚</p><p>webpackä¸­é…ç½®devServerä¸­çš„proxyå®ç°è·¨åŸŸ</p><h4 id="6-è¯´ä¸€è¯´BFC"><a href="#6-è¯´ä¸€è¯´BFC" class="headerlink" title="6.è¯´ä¸€è¯´BFC"></a>6.è¯´ä¸€è¯´BFC</h4><p>BFCå°±æ˜¯å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ã€‚ä»–ä¼šå½¢æˆä¸€å—ç‹¬ç«‹çš„åŒºåŸŸï¼Œä¸ä¼šå½±å“è¾¹ç•Œä»¥å¤–çš„å…ƒç´ </p><p>BFCäº§ç”Ÿçš„æ¡ä»¶</p><ol><li>æ ¹å…ƒç´ </li><li>æµ®åŠ¨å…ƒç´ ï¼ˆfloat:left/float:rightï¼‰</li><li>ç»å¯¹å®šä½å…ƒç´ (position:absolute,fixed)</li><li>è¡Œå†…å—å…ƒç´  display:inline-block</li><li>è¡¨æ ¼å•å…ƒæ ¼ display:table-cell è¡¨æ ¼çš„å•å…ƒæ ¼é»˜è®¤å°±æ˜¯</li><li>åŒ¿åè¡¨æ ¼å•å…ƒæ ¼å…ƒç´ </li><li>overflowè®¡ç®—å€¼ä¸æ˜¯visibleçš„å—å…ƒç´ </li><li>display:flex/inline-flexçš„ç›´æ¥å­å…ƒç´ </li><li>display:gridæˆ–è€…inline-gridçš„ç›´æ¥å­å…ƒç´ </li><li>display:flow-rootå…ƒç´ </li></ol><p>ä½œç”¨</p><p>â€‹    è§£å†³åŒä¸€ä¸ªBFCç›¸é‚»ä¸¤ä¸ªboxçš„marginä¼šæŠ˜å çš„é—®é¢˜</p><p>â€‹    è§£å†³æµ®åŠ¨é«˜åº¦å¡Œé™·çš„é—®é¢˜ï¼Œå¯ä»¥å®ç°æ¸…é™¤æµ®åŠ¨çš„æ•ˆæœã€‚é€šå¸¸æ˜¯overflow:hidden</p><p>â€‹        è§£å†³é«˜åº¦å¡Œé™·è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶</p><p>â€‹            æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ è§¦å‘BFCï¼Œå½¢æˆBFC</p><p>â€‹            æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ çš„é«˜åº¦æ˜¯auto</p><p>â€‹    BFCçš„é«˜åº¦æ˜¯autoçš„æƒ…å†µä¸‹ï¼Œé«˜åº¦çš„è®¡ç®—</p><p>â€‹            å¦‚æœåªæœ‰inline-level æ˜¯è¡Œé«˜çš„é¡¶éƒ¨å’Œåº•éƒ¨çš„è·ç¦»</p><p>â€‹            å¦‚æœæ˜¯block-level,æ˜¯ç”±æœ€é¡¶å±‚å—çš„ä¸Šè¾¹ç¼˜åˆ°æœ€åº•å±‚å—çš„ä¸‹è¾¹ç¼˜ä¹‹é—´è·ç¦»</p><p>â€‹            å¦‚æœæœ‰ç»å¯¹å®šä½å…ƒç´ ï¼Œå°†å¿½ç•¥</p><p>â€‹            å¦‚æœæœ‰æµ®åŠ¨å…ƒç´ ï¼Œåˆ™ä¼šå¢åŠ é«˜åº¦åŒ…å«æµ®åŠ¨å…ƒç´ çš„ä¸‹è¾¹ç¼˜</p><h4 id="7-è¯´ä¸€è¯´Vuexæ˜¯ä»€ä¹ˆï¼Œæ¯ä¸ªå±æ€§æ˜¯å¹²å˜›çš„ï¼Œå¦‚ä½•ä½¿ç”¨-ï¼Ÿ"><a href="#7-è¯´ä¸€è¯´Vuexæ˜¯ä»€ä¹ˆï¼Œæ¯ä¸ªå±æ€§æ˜¯å¹²å˜›çš„ï¼Œå¦‚ä½•ä½¿ç”¨-ï¼Ÿ" class="headerlink" title="7.è¯´ä¸€è¯´Vuexæ˜¯ä»€ä¹ˆï¼Œæ¯ä¸ªå±æ€§æ˜¯å¹²å˜›çš„ï¼Œå¦‚ä½•ä½¿ç”¨ ï¼Ÿ"></a>7.è¯´ä¸€è¯´Vuexæ˜¯ä»€ä¹ˆï¼Œæ¯ä¸ªå±æ€§æ˜¯å¹²å˜›çš„ï¼Œå¦‚ä½•ä½¿ç”¨ ï¼Ÿ</h4><p>VueXæ˜¯å…¨å±€çŠ¶æ€ç®¡ç†çš„å·¥å…·ã€‚vuexçš„å±æ€§æœ‰state,getter,mutations,action,moduleï¼Œstateå±æ€§ç”¨æ¥å­˜å‚¨å…¬å…±ç®¡ç†çš„æ•°æ®ï¼Œmutationså±æ€§å®šä¹‰å¯ä»¥ä¿®æ”¹stateä¸­çš„æ•°æ®ï¼Œæ˜¯åŒæ­¥ä¿®æ”¹çš„ï¼Œæ‰€ä»¥ä¸è¦åœ¨mutationä¸­ä¹¦å†™ajaxä»£ç ï¼Œè¿™æ ·æ•°æ®ä¸å¯è¿½è¸ªï¼Œgetterså±æ€§å¯ä»¥è®¤ä¸ºæ˜¯å®šä¹‰storeçš„è®¡ç®—å±æ€§ã€‚getterçš„è¿”å›å€¼ä¼šæ ¹æ®ä»–çš„ä¾èµ–è¢«ç¼“å­˜èµ·æ¥ï¼Œä¸”åªæœ‰å½“ä»–çš„ä¾èµ–å‘ç”Ÿäº†æ”¹å˜æ‰ä¼šè¢«é‡æ–°è®¡ç®—ï¼Œactionä¸­è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œå¯ä»¥æ“ä½œmutationæ¥ä¿®æ”¹æ•°æ®ï¼Œmutationæ˜¯ä¿®æ”¹æ•°æ®çš„å”¯ä¸€æ–¹æ³•ã€‚moduleå¯ä»¥å°†storeåˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„mutationï¼Œstate,getter,action,moduleã€‚é€šè¿‡store.stateå¯ä»¥è·å–state,å¯ä»¥ç”¨è®¡ç®—å±æ€§ä¸­çš„mapState,store.commitæ¥æäº¤mutation,å¯ä»¥ä½¿ç”¨mapMutationæ¥æ˜ å°„å¤šä¸ªmutation,store,dispatchæ¥åˆ†å‘action,å¯ä»¥ä½¿ç”¨mapActionæ¥æ˜ å°„å¤šä¸ªaction  ,è·å–getterå¯ä»¥ä½¿ç”¨store,getter,å¯ä»¥ä½¿ç”¨maGetteræ¥æ˜ å°„å¤šä¸ªgetter</p><h4 id="8-è¯´ä¸€è¯´JavaScriptæœ‰å‡ ç§æ–¹æ³•åˆ¤æ–­å˜é‡çš„ç±»å‹ï¼Ÿ"><a href="#8-è¯´ä¸€è¯´JavaScriptæœ‰å‡ ç§æ–¹æ³•åˆ¤æ–­å˜é‡çš„ç±»å‹ï¼Ÿ" class="headerlink" title="8.è¯´ä¸€è¯´JavaScriptæœ‰å‡ ç§æ–¹æ³•åˆ¤æ–­å˜é‡çš„ç±»å‹ï¼Ÿ"></a>8.è¯´ä¸€è¯´JavaScriptæœ‰å‡ ç§æ–¹æ³•åˆ¤æ–­å˜é‡çš„ç±»å‹ï¼Ÿ</h4><p>typeof å¯ä»¥ç”¨æ¥åˆ¤æ–­åŸºæœ¬æ•°æ®ç±»å‹  è¿˜å¯ä»¥åˆ¤æ–­Function ,å…¶ä»–å¼•ç”¨æ•°æ®ç±»å‹éƒ½æ˜¯è¿”å›Object,nullä¹Ÿæ˜¯è¿”å›object</p><p>constructorå¯ä»¥åˆ¤æ–­å¼•ç”¨æ•°æ®ç±»å‹ å°±æ˜¯åˆ¤æ–­instance.<strong>proto</strong>.constructor=Function</p><p>instanceOfä¹Ÿå¯ä»¥åˆ¤æ–­å¼•ç”¨æ•°æ®ç±»å‹ å•æ•°ä¸èƒ½åˆ¤æ–­åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå°±æ˜¯è¿ç”¨åŸå‹é“¾ï¼Œåˆ¤æ–­å³è¾¹çš„åŸå‹æ˜¯å¦åœ¨å·¦è¾¹çš„åŸå‹é“¾ä¸Š</p><p>Object.prototype.toString.callä¹Ÿå¯ä»¥ç”¨æ¥åˆ¤æ–­å¼•ç”¨æ•°æ®ç±»å‹</p><h4 id="9-è¯´ä¸€è¯´æ ·å¼ä¼˜å…ˆçº§çš„è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#9-è¯´ä¸€è¯´æ ·å¼ä¼˜å…ˆçº§çš„è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="9.è¯´ä¸€è¯´æ ·å¼ä¼˜å…ˆçº§çš„è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ"></a>9.è¯´ä¸€è¯´æ ·å¼ä¼˜å…ˆçº§çš„è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>æ ·å¼çš„ä¼˜å…ˆçº§åº”è¯¥åˆ†ä¸º4å¤§ç±»</p><p>ç¬¬ä¸€ç±» !importantçš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œæ— è®ºæ˜¯ä»€ä¹ˆå¼•ç”¨æ–¹å¼ï¼Œä»€ä¹ˆé€‰æ‹©å™¨</p><p>ç¬¬äºŒç±»æ˜¯å¼•ç”¨æ–¹å¼  è¡Œå†…æ ·å¼ä¼˜å…ˆçº§é«˜äºåµŒå…¥æ ·å¼å’Œå¤–éƒ¨æ ·å¼ï¼Œå¦‚æœåµŒå…¥æ ·å¼å’Œå¤–éƒ¨æ ·å¼ä½¿ç”¨ç›¸åŒçš„é€‰æ‹©å™¨ï¼Œåˆ™çœ‹ä»–ä»¬è°åå¼•å…¥ï¼Œè¢«è¦†ç›–</p><p>ç¬¬ä¸‰ç±»æ˜¯é€‰æ‹©å™¨</p><p>idé€‰æ‹©å™¨&gt;ç±»é€‰æ‹©å™¨ï¼Œå±æ€§é€‰æ‹©å™¨ï¼Œä¼ªç±»é€‰æ‹©å™¨&gt;å…ƒç´ é€‰æ‹©å™¨ï¼Œä¼ªå…ƒç´ é€‰æ‹©å™¨&gt;é€šé…ç¬¦é€‰æ‹©å™¨</p><p>ç¬¬å››ç±»æ˜¯é»˜è®¤æ ·å¼</p><p> important 10000<br> å†…è”é€‰æ‹©å™¨ 1000<br> idé€‰æ‹©å™¨ 100<br> ç±»é€‰æ‹©å™¨ï¼Œå±æ€§é€‰æ‹©å™¨ï¼Œä¼ªç±» 10<br> å…ƒç´ é€‰æ‹©å™¨ï¼Œä¼ªå…ƒç´  1<br> é€šé…é€‰æ‹©å™¨  0</p><h4 id="10-è¯´ä¸€è¯´JSå®ç°å¼‚æ­¥çš„æ–¹æ³•ï¼Ÿ"><a href="#10-è¯´ä¸€è¯´JSå®ç°å¼‚æ­¥çš„æ–¹æ³•ï¼Ÿ" class="headerlink" title="10.è¯´ä¸€è¯´JSå®ç°å¼‚æ­¥çš„æ–¹æ³•ï¼Ÿ"></a>10.è¯´ä¸€è¯´JSå®ç°å¼‚æ­¥çš„æ–¹æ³•ï¼Ÿ</h4><p>å¾—åˆ†ç‚¹ å›è°ƒå‡½æ•°ã€äº‹ä»¶ç›‘å¬ã€setTimeoutã€Promiseã€ç”Ÿæˆå™¨Generators/yieldã€async/await,</p><p>æ‰€æœ‰çš„å¼‚æ­¥ä»£ç éƒ½ä¼šåœ¨åŒæ­¥ä»£ç æ‰§è¡Œå®Œåï¼Œä»å¼‚æ­¥é˜Ÿåˆ—ä¸­å–å‡ºä¾æ¬¡æ‰§è¡Œã€‚å›è°ƒå‡½æ•°æ˜¯æœ€åŸºæœ¬çš„å¼‚æ­¥å‡½æ•°ï¼Œä¾‹å¦‚ajaxè¯·æ±‚ï¼Œå›è°ƒå‡½æ•°çš„æœ‰ç‚¹æ˜¯ç®€å•ï¼Œå®¹æ˜“ç†è§£å’Œå®ç°ï¼Œç¼ºç‚¹æ˜¯ä¸åˆ©äºä»£ç çš„é˜…è¯»å’Œç†è§£ï¼Œå„ä¸ªéƒ¨åˆ†è€¦åˆåº¦é«˜ï¼Œä½¿å¾—ç¨‹åºç»“æ„æ··ä¹±ï¼Œæµç¨‹éš¾ä»¥è¿½è¸ª(å°¤å…¶æ˜¯å¤šä¸ªå›è°ƒå‡½æ•°åµŒå¥—çš„æƒ…å†µï¼Œå®¹æ˜“å‡ºç°å›è°ƒåœ°ç‹±)ï¼Œè€Œä¸”æ¯ä¸ªä»»åŠ¡åªèƒ½æŒ‡å®šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°ä¸èƒ½ä½¿ç”¨try..catchæ¥æ•è·é”™è¯¯ï¼Œä¸èƒ½ç›´æ¥Â·return  ,PromiseåŒ…è£…äº†ä¸€ä¸ªå¼‚æ­¥è°ƒç”¨å¹¶ä¸”ç”Ÿæˆäº†ä¸€ä¸ªpromiseå®ä¾‹ï¼Œpromiseä¸ç»å¯ä»¥æ•è·é”™è¯¯ï¼Œè€Œä¸”å¯ä»¥å¾ˆå¥½çš„è§£å†³å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œç¼ºç‚¹æ˜¯æ²¡åŠæ³•å–æ¶ˆpromise,é”™è¯¯éœ€è¦ä½¿ç”¨å›è°ƒå‡½æ•°æ¥æ•è·ã€‚generatorå‡½æ•°æ˜¯ES6æä¾›çš„å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼Œgeneratoræ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ï¼Œå¯ä»¥æš‚åœå‡½æ•°ï¼Œyieldå¯ä»¥æš‚åœæ‰§è¡Œï¼Œnextå¯ä»¥ç»§ç»­æ‰§è¡Œ,æ¯æ¬¡è¿”å›éƒ½æ˜¯yieldçš„ç»“æœã€‚ä¼˜ç‚¹æ˜¯è¯­ä¹‰æ¸…æ™°ï¼Œä½†æ˜¯éœ€è¦æ‰‹åŠ¨è°ƒç”¨ã€‚async/awaitæ˜¯åŸºäºPromiseså®ç°çš„ï¼Œawaitä¼šé˜»å¡åé¢çš„ä»£ç çš„æ‰§è¡Œã€‚å¦‚æœå¤šä¸ªå¼‚æ­¥ä»£ç æ²¡æœ‰ä¾èµ–æ€§å´ä½¿ç”¨äº†awaitä¼šé™ä½æ€§èƒ½</p><h4 id="11-è¯´ä¸€è¯´Vue2-0-åŒå‘ç»‘å®šçš„åŸç†ä¸ç¼ºé™·ï¼Ÿ"><a href="#11-è¯´ä¸€è¯´Vue2-0-åŒå‘ç»‘å®šçš„åŸç†ä¸ç¼ºé™·ï¼Ÿ" class="headerlink" title="11.è¯´ä¸€è¯´Vue2.0 åŒå‘ç»‘å®šçš„åŸç†ä¸ç¼ºé™·ï¼Ÿ"></a>11.è¯´ä¸€è¯´Vue2.0 åŒå‘ç»‘å®šçš„åŸç†ä¸ç¼ºé™·ï¼Ÿ</h4><p>Vueçš„å“åº”å¼åŸç†ï¼šé‡‡ç”¨æ•°æ®åŠ«æŒå’Œå‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼ç›¸ç»“åˆçš„æ–¹å¼ï¼Œéå†å¯¹è±¡ä¸­çš„å±æ€§ä½¿ç”¨Object.definePropertyåŠ«æŒå„ä¸ªå±æ€§çš„getterå’Œsetteræ–¹æ³•ï¼Œåœ¨æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œè§¦å‘setter,è¿›è€Œè°ƒç”¨å¯¹åº”çš„notifyæ–¹æ³•æ‰§è¡Œä¾èµ–è¯¥å±æ€§çš„å‡½æ•°ï¼Œè¿›è€Œæ›´æ–°é¡µé¢çš„DOMã€‚è¯»å–è¯¥å±æ€§çš„æ—¶å€™ä¼šè§¦å‘getterï¼Œä½¿ç”¨Object.definePropertyä¸èƒ½å¤Ÿç›‘å¬å¯¹è±¡çš„æ–°å¢å±æ€§å’Œåˆ é™¤å±æ€§ã€‚ä¸å¯ä»¥ç›‘å¬é€šè¿‡æ•°ç»„ç´¢å¼•æ¥ä¿®æ”¹æ•°æ®ï¼Œä¸èƒ½å¤Ÿä¿®æ”¹length,è€Œç›‘å¬åˆ°å˜åŒ–</p><h4 id="12-è¯´ä¸€è¯´æ•°ç»„å»é‡éƒ½æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"><a href="#12-è¯´ä¸€è¯´æ•°ç»„å»é‡éƒ½æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ" class="headerlink" title="12.è¯´ä¸€è¯´æ•°ç»„å»é‡éƒ½æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"></a>12.è¯´ä¸€è¯´æ•°ç»„å»é‡éƒ½æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</h4><p>æ–¹å¼ä¸€ï¼šä½¿ç”¨new Set(arr)è¿›è¡Œå»é‡ï¼Œç„¶åå†ä½¿ç”¨Array.from()æˆ–è€…æ‰©å±•è¿ç®—ç¬¦è½¬æˆæ•°ç»„</p><p>æ–¹å¼äºŒ:    ä½¿ç”¨filter+indexOfæ¥å»é‡</p><p>æ–¹å¼ä¸‰:   ä½¿ç”¨åŒé‡forå¾ªç¯+spliceæ¥è¿›è¡Œå»é‡</p><p>æ–¹å¼å››:   ä½¿ç”¨[]+indexOfæ¥å»é‡</p><p>æ–¹å¼äº”:   ä½¿ç”¨sortå»é‡ï¼Œå…ˆè¿›è¡Œæ’åºï¼Œç„¶åå†è¿›è¡Œå½“å‰ç´¢å¼•å’Œä¸‹ä¸€ä¸ªç´¢å¼•å€¼è¿›è¡Œæ¯”è¾ƒï¼Œpushè¿›æ–°çš„æ•°ç»„</p><p>æ–¹å¼å…­:   ä½¿ç”¨å¯¹è±¡å±æ€§ä¸èƒ½ç›¸åŒçš„ç‰¹ç‚¹å»é‡ï¼Œä»¥æ•°ç»„æ¯ä¸€ä¸ªitemä½œä¸ºobjectçš„key,é€šè¿‡forå¾ªç¯åˆ¤æ–­obj[arr[i]]æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™push,å¹¶ä¸”obj[arr[i]]=1,å¦åˆ™å°±æ˜¯obj[arr[i]]++</p><p>æ–¹å¼ä¸ƒï¼šä½¿ç”¨includesæ¥å»é‡ï¼Œå¯ä»¥åŒºåˆ«Nan,å¯ä»¥åˆ¤æ–­æ–°çš„æ•°ç»„ä¸­æ˜¯å¦åŒ…å«è¿™ä¸ªå€¼ï¼Œä¸åŒ…å«å°±push</p><p>æ–¹å¼å…«ï¼šä½¿ç”¨hasOwnPropertyæ¥å»é‡</p><p>æ–¹å¼ä¹ï¼šå…ˆè¿›è¡Œæ’åºï¼Œç„¶ååœ¨è¿›è¡Œé€’å½’ï¼Œsplicesåˆ é™¤é‡å¤æ•°æ®</p><p>æ–¹å¼åï¼šä½¿ç”¨Mapæ•°æ®ç»“æ„æ¥å»é‡ï¼Œé€šè¿‡hasåˆ¤æ–­ï¼Œå¦‚æœä¸ºfalseå°±pushï¼Œå¹¶ä¸”setå€¼ï¼Œ</p><p>æ–¹å¼åä¸€ï¼šä½¿ç”¨reduce+includesæ¥å»é‡ï¼Œåˆ¤æ–­preä¸­æ˜¯å¦å­˜åœ¨</p><h4 id="13-è¯´ä¸€è¯´null-å’Œ-undefined-çš„åŒºåˆ«ï¼Œå¦‚ä½•è®©ä¸€ä¸ªå±æ€§å˜ä¸ºnull"><a href="#13-è¯´ä¸€è¯´null-å’Œ-undefined-çš„åŒºåˆ«ï¼Œå¦‚ä½•è®©ä¸€ä¸ªå±æ€§å˜ä¸ºnull" class="headerlink" title="13.è¯´ä¸€è¯´null å’Œ undefined çš„åŒºåˆ«ï¼Œå¦‚ä½•è®©ä¸€ä¸ªå±æ€§å˜ä¸ºnull"></a>13.è¯´ä¸€è¯´null å’Œ undefined çš„åŒºåˆ«ï¼Œå¦‚ä½•è®©ä¸€ä¸ªå±æ€§å˜ä¸ºnull</h4><p><strong>å¾—åˆ†ç‚¹ æ“ä½œçš„å˜é‡æ²¡æœ‰è¢«èµ‹å€¼ã€å…¨å±€å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€å‡½æ•°æ²¡æœ‰returnè¿”å›å€¼ã€å€¼ <code>null</code> ç‰¹æŒ‡å¯¹è±¡çš„å€¼æœªè®¾ç½® undefined == nullã€undefined !== null</strong> </p><p>ä¸€ä¸ªå˜é‡å®šä¹‰äº†ï¼Œä½†æ˜¯æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œé‚£ä»–çš„å€¼å°±æ˜¯undefinedã€‚å‡½æ•°æ²¡æœ‰æŒ‡å®šreturnçš„å€¼ï¼Œé»˜è®¤å°±æ˜¯undefinedã€‚å¯¹è±¡ä¸­æŸä¸ªå±æ€§ä¸å­˜åœ¨å°±æ˜¯undefinedï¼Œå‡½æ•°å®šä¹‰äº†å½¢å‚ï¼Œä½†æ˜¯æ²¡æœ‰å®šä¹‰é»˜è®¤å‚æ•°ï¼Œå®å‚å°±æ˜¯undefined,undefinedå¯ä»¥é€šè¿‡typeof æ¥åˆ¤æ–­æ˜¯å¦undefined,undefined==undefined,undefined===undefinedã€‚nullå°±æ˜¯å¯¹è±¡çš„å€¼æœªè®¾ç½®ï¼Œä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è®¾ç½®æŒ‡é’ˆåœ°å€å°±æ˜¯null,nullé€šè¿‡typeofåˆ¤æ–­ç±»å‹æ˜¯object,null==null,null===null,null==undefined,null!==undeined,undefinedè¡¨ç¤ºæœªè®¾ç½®å€¼çš„é»˜è®¤çŠ¶æ€ï¼Œnullè¡¨ç¤ºæ‰‹åŠ¨è®¾ç½®ä¸ºç©ºå¯¹è±¡ï¼Œå„¿ä¸æ˜¯é»˜è®¤çŠ¶æ€ï¼Œåœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå˜é‡ä¸éœ€è¦æ‰‹åŠ¨çš„èµ‹å€¼undefined,å¦‚æœéœ€è¦æ‰‹åŠ¨çš„é‡Šæ”¾å¯¹è±¡ï¼Œå¯ä»¥èµ‹å€¼null,typeofä¼šåˆ¤æ–­ä¸ºobject,æ˜¯å› ä¸ºjsæ•°æ®ç±»å‹åœ¨åº•å±‚éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¡¨ç¤ºçš„ï¼ŒäºŒè¿›åˆ¶çš„å‰ä¸‰ä½ä¸º0ä¼šè¢«typeofåˆ¤æ–­ä¸ºobjet,è€Œnullçš„äºŒè¿›åˆ¶å…¨æ˜¯0ï¼Œå½“å¯¹è±¡è¢«èµ‹å€¼ä¸º0ä»¥åå°±ä¼šè¢«åƒåœ¾å›æ”¶å™¨æ‹©æœºå›æ”¶å¹¶ä¸”é‡Šæ”¾å†…å­˜</p><h4 id="14-è¯´ä¸€ä¸‹æµ®åŠ¨"><a href="#14-è¯´ä¸€ä¸‹æµ®åŠ¨" class="headerlink" title="14.è¯´ä¸€ä¸‹æµ®åŠ¨"></a>14.è¯´ä¸€ä¸‹æµ®åŠ¨</h4><p>floatå±æ€§å¯ä»¥æŒ‡å®šä¸€ä¸ªå…ƒç´ å‘å·¦æˆ–è€…å‘å³æµ®åŠ¨ï¼Œæµ®åŠ¨å…ƒç´ ä¼šè„±ç¦»æ ‡å‡†æµ</p><p>æµ®åŠ¨è§„åˆ™ä¸€</p><p>â€‹    å…ƒç´ ä¸€æ—¦æµ®åŠ¨åï¼Œè„±ç¦»æ ‡å‡†æµ</p><p>â€‹            æœç€å‘å·¦æˆ–è€…å‘å³æ–¹å‘ç§»åŠ¨ï¼Œç›´åˆ°è‡ªå·±çš„è¾¹ç•Œç´§è´´è€…åŒ…å«å—(ä¸€èˆ¬æ˜¯çˆ¶å…ƒç´ )æˆ–è€…å…¶ä»–æµ®åŠ¨å…ƒç´ çš„è¾¹ç•Œä¸ºæ­¢</p><p>â€‹            å®šä½å…ƒç´ ä¼šå±‚å åœ¨æµ®åŠ¨å…ƒç´ ä¸Šé¢</p><p>æµ®åŠ¨è§„åˆ™äºŒ</p><p>â€‹    å¦‚æœå…ƒç´ æ˜¯å‘å·¦æˆ–è€…å‘å³æµ®åŠ¨ï¼Œæµ®åŠ¨çš„å…ƒç´ çš„å·¦å³è¾¹ç•Œä¸èƒ½è¶…è¿‡åŒ…å«å¿«çš„å·¦å³è¾¹ç•Œ</p><p>æµ®åŠ¨è§„åˆ™ä¸‰</p><p>â€‹    æµ®åŠ¨å…ƒç´ ä¹‹é—´ä¸èƒ½å¤Ÿå±‚å ï¼Œå¦‚æœä¸€ä¸ªå…ƒç´ æµ®åŠ¨ï¼Œåé¢çš„å…ƒç´ ä¼šç´§æŒ¨ç€å‰é¢çš„æµ®åŠ¨å…ƒç´ æ’åˆ—ï¼Œå¦‚æœå‰©ä¸‹çš„ç©ºé—´ä¸å¤Ÿæ”¾ä¸‹ä¸€ä¸ªæµ®åŠ¨å…ƒç´ åˆ™ä¼šå‘ä¸‹ç§»åŠ¨ï¼Œæ‰¾åˆ°å¯ä»¥æ”¾ä¸‹çš„ç©ºé—´</p><p>æµ®åŠ¨è§„åˆ™å››</p><p>â€‹    æµ®åŠ¨å…ƒç´ ä¸èƒ½ä¸è¡Œå†…çº§å†…å®¹å±‚å ï¼Œè¡Œå†…çº§å†…å®¹ä¼šè¢«æ¨å‡ºå»</p><p>æµ®åŠ¨è§„åˆ™äº”</p><p>â€‹    è¡Œå†…çº§å…ƒç´ ï¼Œinline-blockå…ƒç´ æµ®åŠ¨åï¼Œå…¶é¡¶éƒ¨å°†ä¸æ‰€åœ¨è¡Œçš„é¡¶éƒ¨å¯¹é½</p><p>æµ®åŠ¨çš„é—®é¢˜</p><p>â€‹    ç”±äºæµ®åŠ¨çš„å…ƒç´ è„±ç¦»äº†æ ‡å‡†æµÂ·ï¼Œå˜æˆäº†è„±æ ‡å…ƒç´ ï¼Œæ‰€ä»¥ä¸åœ¨å‘çˆ¶å…ƒç´ æ±‡æŠ¥é«˜åº¦ï¼Œçˆ¶å…ƒç´ è®¡ç®—é«˜åº¦çš„æ—¶å€™ä¸è®¡ç®—æµ®åŠ¨å…ƒç´ çš„é«˜åº¦ï¼Œæ‰€ä»¥ä¼šé€ æˆå†…å®¹å¡Œé™·</p><p>è§£å†³é«˜åº¦å¡Œé™·çš„æ–¹æ³•</p><p>â€‹    æ–¹æ³•ä¸€ï¼Œç»™çˆ¶å…ƒç´ è®¾ç½®å›ºå®šé«˜åº¦ã€‚æ‰©å±•æ€§ä¸å¥½</p><p>â€‹    æ–¹æ³•äºŒï¼Œç»™çˆ¶å…ƒç´ æœ€åæ·»åŠ ä¸€ä¸ªç©ºçš„å—çº§å…ƒç´ ï¼Œå¹¶ä¸”è®¾ç½®ä¸ºclear:bothã€‚è¿™æ ·ä¼šå¢åŠ æ— æ„ä¹‰çš„ç©ºæ ‡ç­¾ï¼Œç»´æŠ¤éº»çƒ¦ï¼Œè¿åäº†ç»“æ„ä¸æ ·å¼åˆ†ç¦»çš„åŸåˆ™</p><p>â€‹    æ–¹å¼ä¸‰ï¼Œç»™çˆ¶å…ƒç´ æ·»åŠ ä¸€ä¸ªä¼ªå…ƒç´ ï¼Œ::after,è®¾ç½®content:â€â€,display:blockï¼Œoverflow:hidden,clear:both,visibility:hidden,height:0,   ä¸ºäº†å…¼å®¹IE6/7è¿˜è¦åŠ ä¸Š*zoom:1</p><h4 id="15-è¯´ä¸€è¯´es6ä¸­ç®­å¤´å‡½æ•°ï¼Ÿ"><a href="#15-è¯´ä¸€è¯´es6ä¸­ç®­å¤´å‡½æ•°ï¼Ÿ" class="headerlink" title="15.è¯´ä¸€è¯´es6ä¸­ç®­å¤´å‡½æ•°ï¼Ÿ"></a>15.è¯´ä¸€è¯´es6ä¸­ç®­å¤´å‡½æ•°ï¼Ÿ</h4><p>ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰this,ç®­å¤´å‡½æ•°ä¸­çš„thisæŒ‡å‘æ˜¯ç”±ä¸Šå±‚ä½œç”¨åŸŸçš„ä¸­éç®­å¤´å‡½æ•°thiså†³å®šçš„ï¼Œç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰arguments,å¦‚æœç®­å¤´å‡½æ•°ä¸­å‡ºç°argumentsï¼Œåˆ™ç”±ä¸Šå±‚ä½œç”¨åŸŸéç®­å¤´å‡½æ•°çš„argumentså†³å®šï¼Œç®­å¤´å‡½æ•°ä¸­argumentså¯ä»¥ä½¿ç”¨restå‚æ•°æ›¿ä»£ï¼Œç®­å¤´å‡½æ•°ä¸å¯ä»¥ä½œä¸ºæ„é€ å‡½æ•°ï¼Œæ²¡æœ‰super()å’ŒåŸå‹,ç®­å¤´å‡½æ•°ä¸å¯ä»¥ä½¿ç”¨call,apply,bindæ˜¾ç¤ºç»‘å®šæ¥æ”¹å˜thisçš„æŒ‡å‘ï¼Œç®­å¤´å‡½æ•°ä¸å¯ä»¥ä½œä¸ºgeneratorå‡½æ•°ã€‚ç®­å¤´å‡½æ•°ä¸èƒ½ä½œä¸ºäº‹ä»¶ç»‘å®šçš„å›è°ƒå‡½æ•°ï¼Œå¦‚æœä½¿ç”¨äº†thisï¼Œè¯¥thisä¸ä¼šæŒ‡å‘è§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼Œè€Œæ˜¯æŒ‡å‘windowã€‚ç®­å¤´å‡½æ•°é€‚ç”¨äºéœ€è¦å¼•ç”¨ä¸Šå±‚ä½œç”¨åŸŸçš„this,å¯ä»¥æ›¿ä»£var _this=this,æˆ–è€…æ²¡æœ‰ä½¿ç”¨åˆ°thisçš„å‡½æ•°</p><h4 id="16-è¯´ä¸€è¯´call-apply-bindçš„ä½œç”¨å’ŒåŒºåˆ«ï¼Ÿ"><a href="#16-è¯´ä¸€è¯´call-apply-bindçš„ä½œç”¨å’ŒåŒºåˆ«ï¼Ÿ" class="headerlink" title="16.è¯´ä¸€è¯´call apply bindçš„ä½œç”¨å’ŒåŒºåˆ«ï¼Ÿ"></a>16.è¯´ä¸€è¯´call apply bindçš„ä½œç”¨å’ŒåŒºåˆ«ï¼Ÿ</h4><p>call,apply,bindå¯ä»¥æ˜¾ç¤ºè¿›è¡Œthisçš„ç»‘å®šï¼Œcallå¯ä»¥ä¼ å¤šä¸ªå‚æ•°ï¼Œå¹¶ä¸”ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œapplyç¬¬äºŒä¸ªå‚æ•°ä¼ çš„æ˜¯å‡½æ•°ï¼Œä¹Ÿæ˜¯ä¼šç«‹å³æ‰§è¡Œï¼Œbindå¯ä»¥ä¼ å¤šä¸ªå‚æ•°ï¼Œå¹¶ä¸”ä¼šè¿”å›æ–°çš„å‡½æ•°ï¼Œcall,applyè¿˜å¯ä»¥ç”¨äºå‡½æ•°çš„æ‰§è¡Œã€‚call,applyå¯ä»¥ç”¨äºå¯¹è±¡çš„ç»§æ‰¿ï¼Œå°†ä¼ªæ•°ç»„è½¬æˆçœŸæ•°ç»„ï¼Œè¿›è¡ŒåŸå‹é“¾æ–¹æ³•çš„å€Ÿè°ƒï¼Œç­‰ç­‰ï¼Œbindå¯ä»¥ç”¨äºreactä¸­thisçš„ç»‘å®š</p><h4 id="17-è¯´ä¸€è¯´thisæŒ‡å‘ï¼ˆæ™®é€šå‡½æ•°ã€ç®­å¤´å‡½æ•°ï¼‰ï¼Ÿ"><a href="#17-è¯´ä¸€è¯´thisæŒ‡å‘ï¼ˆæ™®é€šå‡½æ•°ã€ç®­å¤´å‡½æ•°ï¼‰ï¼Ÿ" class="headerlink" title="17.è¯´ä¸€è¯´thisæŒ‡å‘ï¼ˆæ™®é€šå‡½æ•°ã€ç®­å¤´å‡½æ•°ï¼‰ï¼Ÿ"></a>17.è¯´ä¸€è¯´thisæŒ‡å‘ï¼ˆæ™®é€šå‡½æ•°ã€ç®­å¤´å‡½æ•°ï¼‰ï¼Ÿ</h4><p>é»˜è®¤ç»‘å®šthisæ˜¯æŒ‡å‘å…¨å±€windowï¼Œæ™®é€šå‡½æ•°çš„è°ƒç”¨</p><p>éšå¼ç»‘å®šthisæ˜¯æŒ‡å‘è°ƒç”¨çš„å¯¹è±¡ï¼Œå¯¹è±¡è°ƒç”¨æ–¹æ³•æ—¶</p><p>æ˜¾ç¤ºç»‘å®šthisæŒ‡å‘ç»‘å®šçš„å€¼</p><p>newç»‘å®šthisæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</p><p>ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰this,thisæ˜¯ç”±ä¸Šå±‚ä½œç”¨åŸŸä¸­éç®­å¤´å‡½æ•°å†³å®šçš„</p><p>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œthisé»˜è®¤æ˜¯undefined</p><p>é»˜è®¤ç»‘å®šçš„ä¼˜å…ˆçº§æœ€ä½</p><p>æ˜¾ç¤ºç»‘å®šçš„ä¼˜å…ˆçº§é«˜äºéšå¼ç»‘å®š</p><p>newç»‘å®šçš„ä¼˜å…ˆçº§é«˜äºbind</p><p>newç»‘å®šä¼˜å…ˆçº§é«˜äºéšå¼ç»‘å®š</p><p>bindçš„ä¼˜å…ˆçº§é«˜äºcall/apply</p><p>newä¸å¯ä»¥å’Œcall/applyä¸€èµ·ä½¿ç”¨</p><p>setTimeoutä¸­thisé»˜è®¤æŒ‡å‘window</p><p>äº‹ä»¶ç»‘å®šä¸­thisæŒ‡å‘ç»‘å®šçš„å…ƒç´ </p><h4 id="18-è¯´ä¸€è¯´CSSå°ºå¯¸è®¾ç½®çš„å•ä½"><a href="#18-è¯´ä¸€è¯´CSSå°ºå¯¸è®¾ç½®çš„å•ä½" class="headerlink" title="18.è¯´ä¸€è¯´CSSå°ºå¯¸è®¾ç½®çš„å•ä½"></a>18.è¯´ä¸€è¯´CSSå°ºå¯¸è®¾ç½®çš„å•ä½</h4><p>pxæ˜¯ç»å¯¹é•¿åº¦å•ä½ï¼Œem,rem,vw/vhæ˜¯ç›¸å¯¹é•¿åº¦å•ä½</p><p>emæ˜¯åœ¨font-sizeä¸­é»˜è®¤ä½¿ç”¨ç›¸å¯¹äºçˆ¶å…ƒç´ çš„å­—ä½“å¤§å°,å¦‚æœè‡ªå·±å®šä¹‰äº†font-size,åˆ™æ ¹æ®è‡ªèº«çš„font-sizeè¿›è¡Œå®šä¹‰ï¼Œå…¶ä»–å±æ€§ä¹Ÿæ˜¯ç›¸å¯¹äºè‡ªèº«çš„font-size,</p><h4 id="19-è¯´ä¸€è¯´HTMLè¯­ä¹‰åŒ–ï¼Ÿ"><a href="#19-è¯´ä¸€è¯´HTMLè¯­ä¹‰åŒ–ï¼Ÿ" class="headerlink" title="19.è¯´ä¸€è¯´HTMLè¯­ä¹‰åŒ–ï¼Ÿ"></a>19.è¯´ä¸€è¯´HTMLè¯­ä¹‰åŒ–ï¼Ÿ</h4><h4 id="20-è¯´å‡ ä¸ªæœªçŸ¥å®½é«˜å…ƒç´ æ°´å¹³å‚ç›´å±…ä¸­æ–¹æ³•"><a href="#20-è¯´å‡ ä¸ªæœªçŸ¥å®½é«˜å…ƒç´ æ°´å¹³å‚ç›´å±…ä¸­æ–¹æ³•" class="headerlink" title="20.è¯´å‡ ä¸ªæœªçŸ¥å®½é«˜å…ƒç´ æ°´å¹³å‚ç›´å±…ä¸­æ–¹æ³•"></a>20.è¯´å‡ ä¸ªæœªçŸ¥å®½é«˜å…ƒç´ æ°´å¹³å‚ç›´å±…ä¸­æ–¹æ³•</h4><h4 id="21-è¯´ä¸€è¯´JSå˜é‡æå‡ï¼Ÿ"><a href="#21-è¯´ä¸€è¯´JSå˜é‡æå‡ï¼Ÿ" class="headerlink" title="21.è¯´ä¸€è¯´JSå˜é‡æå‡ï¼Ÿ"></a>21.è¯´ä¸€è¯´JSå˜é‡æå‡ï¼Ÿ</h4><p>å‡½æ•°å’Œvar å£°æ˜çš„å˜é‡åœ¨ä»£ç ç¼–è¯‘é˜¶æ®µä¼šæå‡åˆ°æœ€å‰é¢ï¼Œä½†æ­¤æ—¶varå£°æ˜çš„å˜é‡è¿˜æ²¡æœ‰èµ‹å€¼ï¼Œæ‰€ä»¥æ­¤æ—¶è®¿é—®æ˜¯undefined,è€Œå‡½æ•°å¯ä»¥åœ¨å‡½æ•°å®šä¹‰ä¹‹å‰è¢«è°ƒç”¨ï¼Œå› ä¸ºå‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå‡½æ•°å£°æ˜çš„æå‡ä¼˜å…ˆçº§ä¼šæ¯”å˜é‡æå‡é«˜ï¼Œlet,constä¸ä¼šå‡ºç°å˜é‡æå‡ï¼Œlet conståœ¨å®šä¹‰ä»¥å‰è®¿é—®ä¼šå‡ºç°æš‚æ—¶æ€§æ­»åŒº</p><h4 id="22-è¯´ä¸€è¯´-HashRouter-å’Œ-HistoryRouterçš„åŒºåˆ«å’ŒåŸç†ï¼Ÿ"><a href="#22-è¯´ä¸€è¯´-HashRouter-å’Œ-HistoryRouterçš„åŒºåˆ«å’ŒåŸç†ï¼Ÿ" class="headerlink" title="22.è¯´ä¸€è¯´ HashRouter å’Œ HistoryRouterçš„åŒºåˆ«å’ŒåŸç†ï¼Ÿ"></a>22.è¯´ä¸€è¯´ HashRouter å’Œ HistoryRouterçš„åŒºåˆ«å’ŒåŸç†ï¼Ÿ</h4><p>HashRouter  å’Œ HistoryRouteréƒ½æ˜¯åˆ©ç”¨æµè§ˆå™¨çš„ä¸¤ç§ç‰¹æ€§æ¥å®ç°å‰ç«¯è·¯ç”±çš„ï¼Œæ ¹æ®è¿™ä¸¤ç§ç‰¹æ€§ï¼Œå¯ä»¥å®ç°ä¸éœ€è¦åˆ·æ–°é¡µé¢çš„å»ä¿®æ”¹å†…å®¹ã€‚HashRouterå°±æ˜¯åˆ©ç”¨é€šè¿‡ç›‘å¬window.onhashchangeæ ¹æ®location.hashçš„å˜åŒ–æ¥ä¿®æ”¹Dom,urlä¸­hashRouterå’ŒhistoryRouterçš„ä¸åŒæ˜¯ï¼Œhashä¼šåœ¨urlä¸­æœ‰#è¿™æ ·çš„hashå€¼ï¼Œè€Œhistoryæ²¡æœ‰ã€‚historyRouteræ˜¯æ ¹æ®h5æ–°å¢çš„å†å²è°ƒç”¨æ ˆAPIæ¥å®ç°çš„ï¼Œä»–æœ‰å…­ç§æ¨¡å¼æ¥æ”¹å˜urlè€Œä¸ä¼šé‡æ–°åˆ·æ–°é¡µé¢</p><p>history.replaceState():æ›¿æ¢åŸæ¥çš„è·¯å¾„</p><p>history.pushState() ä½¿ç”¨æ–°çš„è·¯å¾„</p><p>history.popState()  è·¯å¾„çš„å›é€€</p><p>history.back() å‘åæ”¹å˜è·¯å¾„</p><p>history.go() è·³è½¬è‡³é‚£ä¸ªè·¯å¾„</p><p>é€šè¿‡window.onpopStateæ¥ç›‘å¬æµè§ˆå™¨çš„å‰è¿›å’Œåé€€ï¼ŒpushStateå’ŒreplaceStateéƒ½æ˜¯å¯ä»¥æºå¸¦å‚æ•°ï¼Œhashå¯ä»¥å…¼å®¹ä½ç‰ˆæœ¬çš„æµè§ˆå™¨ï¼Œå¦‚æœæƒ³ä¼ é€’ä»»æ„ç±»å‹çš„æ•°æ®åˆ°è®°å½•æ ˆå¯ä»¥ä½¿ç”¨history,historyéœ€è¦åç«¯é…åˆï¼Œå¦‚æœåç«¯ä¸é…åˆï¼Œå°±ä¼šå‡ºç°404ï¼Œè€Œhashä¸éœ€è¦</p><h4 id="23-è¯´ä¸€è¯´map-å’Œ-forEach-çš„åŒºåˆ«ï¼Ÿ"><a href="#23-è¯´ä¸€è¯´map-å’Œ-forEach-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="23.è¯´ä¸€è¯´map å’Œ forEach çš„åŒºåˆ«ï¼Ÿ"></a>23.è¯´ä¸€è¯´map å’Œ forEach çš„åŒºåˆ«ï¼Ÿ</h4><p>å¾—åˆ†ç‚¹ mapåˆ›å»ºæ–°æ•°ç»„ã€mapè¿”å›å¤„ç†åçš„å€¼ã€forEach()ä¸ä¿®æ”¹åŸæ•°ç»„ã€forEach()æ–¹æ³•è¿”å›undefined</p><p>mapä¼šè¿”å›æ–°çš„æ•°ç»„ï¼ŒforEachä¸ä¼šä¿®æ”¹åŸæ¥çš„æ•°ç»„ï¼Œmapéœ€è¦return foreachä¸éœ€è¦return,foreachä¸­returnæ˜¯æ— æ•ˆçš„ï¼Œmapä¸­thisé»˜è®¤æŒ‡å‘undefined,foreachä¸­thisé»˜è®¤æŒ‡å‘window,forEachä¸èƒ½ç»ˆç«¯æ‰§è¡Œï¼Œåªèƒ½å¤ŸæŠ›å‡ºå¼‚å¸¸æ¥ç»ˆæ­¢æ‰§è¡Œã€‚forEachæ²¡æœ‰è¿”å›å€¼æ–°çš„æ•°ç»„æ‰€ä»¥ä¸èƒ½å¤Ÿè¿›è¡Œé“¾å¼è°ƒç”¨ï¼Œmapçš„å¤„ç†æ•°ç»„æ¯”foreachå¿«</p><h4 id="24-è¯´ä¸€è¯´äº‹ä»¶å¾ªç¯Event-loopï¼Œå®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ï¼Ÿ"><a href="#24-è¯´ä¸€è¯´äº‹ä»¶å¾ªç¯Event-loopï¼Œå®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ï¼Ÿ" class="headerlink" title="24.è¯´ä¸€è¯´äº‹ä»¶å¾ªç¯Event loopï¼Œå®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ï¼Ÿ"></a>24.è¯´ä¸€è¯´äº‹ä»¶å¾ªç¯Event loopï¼Œå®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ï¼Ÿ</h4><p>jsä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒåŒæ­¥ä»£ç å…ˆæ‰§è¡Œï¼Œè¦åˆ°å®šæ—¶å™¨ï¼Œå°±ä¼šå…ˆå°†å®šæ—¶å™¨å…ˆæŒ‚èµ·ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œæ‰§è¡Œåˆ°å¼‚æ­¥ä»£ç ï¼Œå°±ä¼šå°†å¼‚æ­¥ä»£ç è¿›å…¥äº‹ä»¶é˜Ÿåˆ—ï¼Œå®ä»»åŠ¡å°±ä¼šè¿›å…¥å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¾®ä»»åŠ¡å°±æ˜¯è¿›å…¥å¾®ä»»åŠ¡äº‹ä»¶é˜Ÿåˆ—ï¼ŒåŒæ­¥ä»£ç æ‰§è¡Œå®Œåï¼Œå°±ä¼šä»äº‹ä»¶é˜Ÿåˆ—ä¸­å–å‡ºå¼‚æ­¥ä»£ç ï¼Œè¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡è°ƒç”¨æ ˆï¼Œå¾®ä»»åŠ¡å…ˆæ‰§è¡Œï¼Œæ‰§è¡Œå®Œååœ¨æ‰§è¡Œå®ä»»åŠ¡ï¼Œç­‰å®šæ—¶å™¨åˆ°æœŸä¹‹åä¹Ÿä¼šåŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ï¼Œå°±è¿™æ ·ä¸æ–­çš„å¾ªç¯å¾€å¤æ‰§è¡Œï¼Œå°±æ˜¯äº‹ä»¶å¾ªç¯ï¼Œäº‹ä»¶å¾ªç¯åŒ…æ‹¬æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯å’ŒNodeçš„äº‹ä»¶å¾ªç¯ï¼Œæµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯ä¸­å®ä»»åŠ¡åŒ…æ‹¬å®šæ—¶å™¨ï¼Œajaxè¯·æ±‚ï¼Œwindow.postmessage,setImmediate,UI render,Domç›‘å¬ï¼Œå¾®ä»»åŠ¡åŒ…æ‹¬promiseçš„thenå›è°ƒï¼Œasync/await,Mutation Obderverï¼ŒqueueMicrotaskã€‚Nodeçš„äº‹ä»¶å¾ªç¯ä¸­å¾®ä»»åŠ¡ä¸ºprocess.nexttick,promiseçš„thenå›è°ƒï¼ŒqueueMicrotask,å®ä»»åŠ¡é˜Ÿåˆ—åŒ…æ‹¬ï¼Œå®šæ—¶å™¨ï¼ŒIDäº‹ä»¶ï¼ŒsetImmediate,closeäº‹ä»¶</p><h4 id="25-è¯´ä¸€è¯´Vue3-0-å®ç°æ•°æ®åŒå‘ç»‘å®šçš„æ–¹æ³•-ï¼Ÿ"><a href="#25-è¯´ä¸€è¯´Vue3-0-å®ç°æ•°æ®åŒå‘ç»‘å®šçš„æ–¹æ³•-ï¼Ÿ" class="headerlink" title="25.è¯´ä¸€è¯´Vue3.0 å®ç°æ•°æ®åŒå‘ç»‘å®šçš„æ–¹æ³• ï¼Ÿ"></a>25.è¯´ä¸€è¯´Vue3.0 å®ç°æ•°æ®åŒå‘ç»‘å®šçš„æ–¹æ³• ï¼Ÿ</h4><p>vue3ä¸­å®ç°æ•°æ®åŒå‘ç»‘å®šé‡‡ç”¨new Proxyæ¥æ›¿ä»£Object.definePropertyå®ç°ï¼Œproxyå¯ä»¥ç›‘å¬æ•´ä¸ªå¯¹è±¡ï¼Œä½¿ç”¨new proxy()å°†éœ€è¦ç›‘å¬çš„å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œå¹¶ä¸”æœ‰13ä¸­æ‹¦æˆªå™¨ï¼Œå¯ä»¥å¯¹å¯¹è±¡ä»¥åŠå‡½æ•°è¿›è¡Œç›‘å¬ï¼Œä¾‹å¦‚ç›‘å¬å¯¹è±¡å±æ€§çš„getter,setter,deleteæ“ä½œ,inæ“ä½œï¼ŒdefinePropertyæ“ä½œç­‰ï¼Œå¯ä»¥è§£å†³object.definepropertyä¸å¯ä»¥ç›‘å¬å¯¹è±¡å±æ€§çš„æ–°å¢å’Œåˆ é™¤æ“ä½œï¼Œä¸å¯ä»¥ç›‘å¬æ•°ç»„é€šè¿‡ç´¢å¼•èµ‹å€¼ï¼Œå’Œæ‰‹åŠ¨ç»™lengthèµ‹å€¼ç­‰æ“ä½œ</p><h4 id="26-è¯´ä¸€ä¸‹Diffç®—æ³•ï¼Ÿ"><a href="#26-è¯´ä¸€ä¸‹Diffç®—æ³•ï¼Ÿ" class="headerlink" title="26.è¯´ä¸€ä¸‹Diffç®—æ³•ï¼Ÿ"></a>26.è¯´ä¸€ä¸‹Diffç®—æ³•ï¼Ÿ</h4><p>å¾—åˆ†ç‚¹ patchã€patchVnodeã€updateChildrenã€vueä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ä¸ºO(n) </p><p>diffç®—æ³•ä¸­çš„æ¯”è¾ƒè¿‡ç¨‹ï¼Œç¬¬ä¸€æ­¥ï¼špatchå‡½æ•°é¦–å…ˆä¼šå¯¹æ–°æ—§èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ—§çš„èŠ‚ç‚¹å­˜åœ¨ä¸”å’Œæ–°çš„èŠ‚ç‚¹ç±»å‹ä¸åŒï¼Œåˆ™ä¼šé”€æ¯æ—§çš„èŠ‚ç‚¹ã€‚å¦‚æœæ—§èŠ‚ç‚¹å­˜åœ¨ï¼Œå¦‚æœæ–°æ—§èŠ‚ç‚¹ç±»å‹ç›¸åŒæ—¶ï¼Œç„¶åå¯¹æ–°çš„èŠ‚ç‚¹çš„ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥æ›¿æ¢æˆæ–‡æœ¬èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯æ³¨é‡ŠèŠ‚ç‚¹ä¹Ÿæ˜¯ç›´æ¥çš„æ’å…¥ã€‚å¤„ç†é™æ€èŠ‚ç‚¹ï¼Œå¤„ç†fragmentç»„ä»¶èŠ‚ç‚¹ç­‰ï¼Œç„¶åå°±æ˜¯å¤„ç†æ™®é€šçš„Domå…ƒç´ å’Œç»„ä»¶èŠ‚ç‚¹ç­‰ç­‰ï¼Œåœ¨å¤„ç†æ™®é€šå…ƒç´ çš„æ—¶å€™ï¼Œä»–ä¼šå…ˆåˆ¤æ–­æ—§èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™ç›´æ¥æŒ‚åœ¨ã€‚å¦åˆ™è°ƒç”¨patchElementå‡½æ•°ã€‚åœ¨æ‰§è¡ŒpatchElementçš„æ—¶å€™é¦–å…ˆå¤„ç†propsçš„æƒ…å†µï¼Œå…ˆå°†æ–°çš„èŠ‚ç‚¹çš„propså…¨éƒ¨æŒ‚è½½åˆ°elä¸Šï¼Œåˆ¤æ–­æ—§èŠ‚ç‚¹çš„propsæ˜¯å¦ä¸éœ€è¦åœ¨æ–°çš„èŠ‚ç‚¹ä¸Šï¼Œå¦‚æœä¸éœ€è¦ï¼Œé‚£ä¹ˆåˆ é™¤å¯¹åº”çš„å±æ€§ã€‚ç„¶åé€šè¿‡è°ƒç”¨patchChildrenæ¥å¯¹æ¯”å­å…ƒç´ ï¼Œå¦‚æœæ–°çš„èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ï¼Œåˆ™ç›´æ¥è°ƒç”¨el.textContent=newChildren,å¦‚æœæ–°èŠ‚ç‚¹ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ—§èŠ‚ç‚¹æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œé‚£ä¹ˆç›´æ¥éå†æ–°çš„èŠ‚ç‚¹ï¼ŒæŒ‚è½½åˆ°elä¸Šï¼Œå¦‚æœæ–°æ—§èŠ‚ç‚¹éƒ½æ˜¯æ•°ç»„ï¼Œåˆ™ä¼šåˆ†ä¸ºæœ‰keyå’Œæ²¡æœ‰keyä¸¤ç§ï¼Œæœ‰keyåˆ™è°ƒç”¨patchKeyedChildrenæ–¹æ³•ï¼Œæ²¡æœ‰keyåˆ™è°ƒç”¨patchUnkeyedChildrenæ–¹æ³•ã€‚è°ƒç”¨patchUnkeyedChildrenæ–¹æ³•æ—¶ï¼Œä¼šè·å–åˆ°é•¿åº¦æœ€å°çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œforå¾ªç¯ä¾æ¬¡è¿›è¡Œpatchï¼Œpatchå®Œä¹‹åï¼Œå‰©ä¸‹çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ—§çš„é•¿åº¦å¤§äºæ–°çš„ï¼Œåˆ™ç§»é™¤è¿™äº›èŠ‚ç‚¹ï¼Œå¦‚æœæ–°çš„é•¿åº¦å¤§äºæ—§çš„é•¿åº¦åˆ™åˆ›å»ºæ–°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæœ‰keyåˆ™ä¼šè°ƒç”¨patchKeyedChildrenæ–¹æ³•ï¼Œé¦–å…ˆèŠ‚ç‚¹ä¼šä»å¤´éƒ¨å¼€å§‹æ¯”è¾ƒï¼Œå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ç›¸åŒåˆ™ä¼šè°ƒç”¨patch,å¹¶ä¸”i++,å¦‚æœèŠ‚ç‚¹ä¸åŒåˆ™ä¼šè·³å‡ºå¾ªç¯ï¼Œç„¶åå†ä»å°¾éƒ¨è¿›è¡Œæ¯”è¾ƒï¼Œé‡å¤ç›¸åŒçš„æ­¥éª¤ï¼Œå¹¶ä¸”e1â€“,e2â€“,å¦‚æœi&gt;e1è€Œä¸”i&lt;e2,å°±æ˜¯æ—§çš„èŠ‚ç‚¹éå†å®Œäº†ï¼Œä¾ç„¶æœ‰æ–°çš„èŠ‚ç‚¹ï¼Œåˆ™è¿›è¡ŒæŒ‚è½½ï¼Œå¦‚æœæ–°çš„èŠ‚ç‚¹éå†å®Œï¼Œæ—§çš„èŠ‚ç‚¹è¿˜æœ‰åˆ™ç§»é™¤æ—§çš„èŠ‚ç‚¹ã€‚å¯¹äºå‰©ä¸‹çš„æœªçŸ¥çš„åºåˆ—ï¼Œå°±æ˜¯æ— é¡»çš„åºåˆ—ï¼Œé¦–å…ˆä¼šæ ¹æ®keyå»ºç«‹mapç´¢å¼•å›¾ï¼Œ éå†å‰©ä¸‹çš„æ—§èŠ‚ç‚¹, æ–°æ—§å¯¹æ¯”, ç§»é™¤ä¸ä½¿ç”¨çš„æ—§èŠ‚ç‚¹ï¼ŒoldIndex = 0 æ˜¯ä¸€ä¸ªç‰¹æ®Šå€¼ï¼Œè¡¨ç¤ºæ–°èŠ‚ç‚¹æ²¡æœ‰å¯¹åº”çš„æ—§èŠ‚ç‚¹ã€‚ç”¨äºç¡®å®šæœ€é•¿ç¨³å®šå­åºåˆ—ï¼Œå»ºç«‹æ–°çš„vnodeçš„keyçš„ä½ç½®åœ¨æ—§çš„vnodeçš„æ˜ å°„ï¼Œç„¶åforéå†æ—§èŠ‚ç‚¹ä¸­è¿˜æ²¡æœ‰è¢«å¯¹æ¯”çš„èŠ‚ç‚¹ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹å·²ç»è¢«patchè¿‡ï¼Œåˆ™å¸è½½æ‰ï¼Œå¦‚æœåœ¨æ—§çš„vnodeä¸­keyå­˜åœ¨ï¼Œåœ¨è·å–ç›¸åŒçš„keyåœ¨æ–°vnodeçš„ä½ç½®ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™æ–°èŠ‚ç‚¹åœ¨æ—§èŠ‚ç‚¹çš„æ˜ å°„ä¸­è®¾ç½®æ‰€ä»¥æ—§èŠ‚ç‚¹çš„ç´¢å¼•ä½ç½®ï¼Œç„¶åè¿›è¡Œæ–°æ—§èŠ‚ç‚¹çš„patch,å¦‚æœåœ¨æ—§nodeä¸­keyä¸å­˜åœ¨ï¼Œè¯•å›¾å®šä½ä¸€ä¸ªç›¸åŒç±»å‹çš„æ²¡æœ‰keyçš„èŠ‚ç‚¹çš„ä½ç½®ï¼Œå‡†å¤‡ç”¨è¿™ä¸ªæ›¿æ¢æˆæ–°çš„å€¼ï¼Œä»æ–°ç»“ç‚¹ä¸­æ‰¾åˆ°ç±»å‹ç›¸åŒï¼Œä¸”åœ¨æ—§èŠ‚ç‚¹æ²¡æœ‰å¯¹åº”æ˜ å°„çš„èŠ‚ç‚¹ï¼Œè®¾ç½®è¿›å»ï¼Œå¦‚æœåœ¨æ–°çš„vnodeä¸­æ²¡æœ‰å¯¹åº”çš„æ˜ å°„ï¼Œå°±æ˜¯åœ¨æ–°çš„vnodeä¸­ä¸å­˜åœ¨è¿™ä¸ªkeyäº†ï¼Œå°±å¸è½½æ‰</p><h4 id="27-è¯´ä¸€è¯´ä¸‰æ å¸ƒå±€çš„å®ç°æ–¹æ¡ˆ"><a href="#27-è¯´ä¸€è¯´ä¸‰æ å¸ƒå±€çš„å®ç°æ–¹æ¡ˆ" class="headerlink" title="27.è¯´ä¸€è¯´ä¸‰æ å¸ƒå±€çš„å®ç°æ–¹æ¡ˆ"></a>27.è¯´ä¸€è¯´ä¸‰æ å¸ƒå±€çš„å®ç°æ–¹æ¡ˆ</h4><p>åœ£æ¯å¸ƒå±€ï¼ŒåŒé£ç¿¼å¸ƒå±€</p><h4 id="28-è¯´ä¸€ä¸‹æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿ"><a href="#28-è¯´ä¸€ä¸‹æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿ" class="headerlink" title="28.è¯´ä¸€ä¸‹æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿ"></a>28.è¯´ä¸€ä¸‹æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿ</h4><h4 id="29-è¯´ä¸€è¯´-vue-çš„-keep-alive-ï¼Ÿ"><a href="#29-è¯´ä¸€è¯´-vue-çš„-keep-alive-ï¼Ÿ" class="headerlink" title="29.è¯´ä¸€è¯´ vue çš„ keep-alive ï¼Ÿ"></a>29.è¯´ä¸€è¯´ vue çš„ keep-alive ï¼Ÿ</h4><h4 id="30-CSRFæ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#30-CSRFæ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="30.CSRFæ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ"></a>30.CSRFæ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ</h4><h4 id="31-XSSæ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#31-XSSæ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="31.XSSæ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ"></a>31.XSSæ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ</h4><h4 id="32-è¯´ä¸€è¯´jsç»§æ‰¿çš„æ–¹æ³•å’Œä¼˜ç¼ºç‚¹ï¼Ÿ"><a href="#32-è¯´ä¸€è¯´jsç»§æ‰¿çš„æ–¹æ³•å’Œä¼˜ç¼ºç‚¹ï¼Ÿ" class="headerlink" title="32.è¯´ä¸€è¯´jsç»§æ‰¿çš„æ–¹æ³•å’Œä¼˜ç¼ºç‚¹ï¼Ÿ"></a>32.è¯´ä¸€è¯´jsç»§æ‰¿çš„æ–¹æ³•å’Œä¼˜ç¼ºç‚¹ï¼Ÿ</h4><h4 id="33-è¯´ä¸€è¯´deferå’ŒasyncåŒºåˆ«ï¼Ÿ"><a href="#33-è¯´ä¸€è¯´deferå’ŒasyncåŒºåˆ«ï¼Ÿ" class="headerlink" title="33.è¯´ä¸€è¯´deferå’ŒasyncåŒºåˆ«ï¼Ÿ"></a>33.è¯´ä¸€è¯´deferå’ŒasyncåŒºåˆ«ï¼Ÿ</h4><p>é»˜è®¤æƒ…å†µä¸‹æµè§ˆå™¨ä¸‹è½½å®Œjsä»£ç ä¼šç«‹å³æ‰§è¡Œï¼Œå¦‚æœjséœ€è¦æ“ä½œdom,åˆ™ä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“ï¼Œasyncå±æ€§å¯ä»¥ä½¿åŠ è½½jsæ–‡æ¡£å’Œdomæ ‘çš„æ„å»ºåŒæ—¶è¿›è¡Œï¼Œå½“jsåŠ è½½å®Œæˆï¼Œjsä»£ç æ‰§è¡Œï¼Œä¼šé˜»å¡htmlçš„æ¸²æŸ“ï¼Œdeferä¼šç­‰åˆ°domæ„å»ºå®Œæˆä»¥åå†åŠ è½½jsä»£ç ã€‚</p><p>deferæ˜¯jsçš„ä¸‹è½½å’Œæ‰§è¡Œä¸é˜»å¡DOM treeçš„æ„å»ºï¼Œdeferä¸­çš„jsä»£ç æ‰§è¡Œçš„æ—¶å€™Domæ„å»ºå®Œæˆï¼Œdeferä¼šåœ¨DomcontenLoadä¹‹åæ‰§è¡Œï¼Œå¤šä¸ªè®¾ç½®deferçš„scriptä¼šæŒ‰é¡ºåºåŠ è½½ï¼Œdeferä»…é€‚ç”¨äºå¤–éƒ¨è„šæœ¬ï¼Œå¯¹scriptçš„å†…å®¹ä¼šå¿½ç•¥ã€‚è€Œasyncä¸èƒ½ä¿è¯é¡ºåºæ‰§è¡Œï¼Œä¸ä¼šé˜»å¡DOMæ¸²æŸ“ï¼Œä¸èƒ½ä¿è¯DOMContentLoadedä¹‹å‰æˆ–è€…ä¹‹åæ‰§è¡Œï¼Œasyncç”¨äºç‹¬ç«‹è„šæœ¬æ‰§è¡Œï¼Œå°±æ˜¯é‚£äº›ä¸éœ€è¦ä¾èµ–å¤–éƒ¨æ–‡ä»¶çš„è„šæœ¬</p><p>åŠ åˆ†é¡¹ï¼šé˜»å¡çš„åŸå› ï¼šç”±äºjsæ˜¯å¯ä»¥æ“ä½œdomçš„ï¼Œå¦‚æœåœ¨ä¿®æ”¹è¿™äº›å…ƒç´ çš„æ—¶å€™åŒæ—¶æ¸²æŸ“ç•Œé¢å³jsçº¿ç¨‹å’Œuiçº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œé‚£ä¹ˆæ¸²æŸ“çº¿ç¨‹å‰åè·å¾—çš„æ•°æ®å¯èƒ½ä¸ä¸€è‡´ï¼Œå› æ­¤ä¸ºäº†é˜²æ­¢æ¸²æŸ“å‡ºç°ä¸å¯ä»¥é¢„æµ‹çš„æ•ˆæœï¼Œæ‰€ä»¥æµè§ˆå™¨è®¾ç½®GUIæ¸²æŸ“çº¿ç¨‹å’Œjså¼•æ“ä¸ºäº’æ–¥çš„å…³ç³»å½“æµè§ˆå™¨æ‰§è¡Œjsä»£ç çš„æ—¶å€™æ¸²æŸ“çº¿ç¨‹å°±ä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°jsç¨‹åºæ‰§è¡Œå®Œæˆæ‰ä¼šæ¥ç€æ‰§è¡Œã€‚å¦‚æœjsæ‰§è¡Œäº‹ä»¶è¿‡é•¿ï¼Œå°±ä¼šé€ æˆæ¸²æŸ“ç•Œé¢è¿‡ç¨‹ä¸è¿è´¯ï¼Œå¯¼è‡´é¡µé¢æ¸²æŸ“åŠ è½½é˜»å¡çš„æ„Ÿè§‰</p><h4 id="34-è¯´ä¸€ä¸‹æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“é¡µé¢çš„"><a href="#34-è¯´ä¸€ä¸‹æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“é¡µé¢çš„" class="headerlink" title="34.è¯´ä¸€ä¸‹æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“é¡µé¢çš„"></a>34.è¯´ä¸€ä¸‹æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“é¡µé¢çš„</h4><p>æµè§ˆå™¨é¦–å…ˆä¼šè§£æé¡µé¢ï¼ŒæŠŠhtmlæ„å»ºæˆDOMæ ‘ï¼Œcssæ„å»ºæˆcssomæ ‘ï¼Œcssçš„åŠ è½½ä¸ä¼šé˜»å¡domæ ‘çš„æ„å»ºï¼Œç„¶åå°†domæ ‘å’Œcssomæ ‘æ•´åˆæˆrenderæ ‘ï¼Œå¦‚æœåŠ è½½åˆ°scriptæ ‡ç­¾ï¼Œä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“è¿›ç¨‹ï¼Œæ‰€ä»¥éœ€è¦æŠŠscriptæ”¾åœ¨åº•éƒ¨ï¼Œç„¶åæ‰§è¡Œjsä»£ç ï¼Œç»è¿‡å¸ƒå±€å’Œç»˜åˆ¶ï¼Œæœ€ç»ˆæ¸²æŸ“åˆ°å±å¹•ä¸Š</p><h4 id="35-è¯´ä¸€è¯´vue-computedå’Œwatchçš„åŒºåˆ«ï¼Ÿ"><a href="#35-è¯´ä¸€è¯´vue-computedå’Œwatchçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="35.è¯´ä¸€è¯´vue computedå’Œwatchçš„åŒºåˆ«ï¼Ÿ"></a>35.è¯´ä¸€è¯´vue computedå’Œwatchçš„åŒºåˆ«ï¼Ÿ</h4><p>å½“éœ€è¦ä¾èµ–å…¶ä»–çŠ¶æ€æ¥äº§ç”Ÿæ–°çš„çŠ¶æ€çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨computed,computedé€‚ç”¨äºè®¡ç®—æ¯”è¾ƒå¤šçš„åœºæ™¯ã€‚computedä¾èµ–äºå…¶ä»–çŠ¶æ€ï¼Œcomputedæ˜¯åŒæ­¥çš„ï¼Œè€Œä¸”æœ‰ç¼“å­˜ï¼Œå¦‚æœä¾èµ–çš„çŠ¶æ€æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä»–ä¸ä¼šé‡æ–°è®¡ç®—ï¼Œcomputedé»˜è®¤æ˜¯è°ƒç”¨getteræ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹æ•°æ®è°ƒç”¨setteræ–¹æ³•ï¼Œwatchæ˜¯ä½œä¸ºä¾¦å¬å™¨ï¼Œå¯ä»¥ç›‘å¬dataï¼Œprops,emitç­‰å±æ€§çš„å˜åŒ–ï¼Œä¹Ÿæ˜¯æœ‰æƒ°æ€§çš„ï¼Œwatchåœ¨æ•°æ®åˆå§‹åŒ–çš„æ—¶å€™ä¸ä¼šæ‰§è¡Œï¼Œåªæœ‰åœ¨æ•°æ®å˜åŒ–çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œï¼Œå¯ä»¥è®¾ç½®immediate:trueæ¥è®©watchç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼Œwatché»˜è®¤ä¸èƒ½å¤Ÿç›‘å¬å¯¹è±¡çš„å±æ€§çš„å˜åŒ–ï¼Œå¯ä»¥è®¾ç½®deep:true,å¯¹å¯¹è±¡è¿›è¡Œæ·±åº¦ç›‘å¬</p><h4 id="36-è¯´ä¸€è¯´-Vue-ä¸­-nextTick-ä½œç”¨ä¸åŸç†ï¼Ÿ"><a href="#36-è¯´ä¸€è¯´-Vue-ä¸­-nextTick-ä½œç”¨ä¸åŸç†ï¼Ÿ" class="headerlink" title="36.è¯´ä¸€è¯´ Vue ä¸­ $nextTick ä½œç”¨ä¸åŸç†ï¼Ÿ"></a>36.è¯´ä¸€è¯´ Vue ä¸­ $nextTick ä½œç”¨ä¸åŸç†ï¼Ÿ</h4><p>å¾—åˆ†ç‚¹ å¼‚æ­¥æ¸²æŸ“ã€è·å–DOMã€Promise </p><p>å°†å›è°ƒå»¶è¿Ÿåˆ°ä¸‹ä¸€æ¬¡DOMæ›´æ–°å¾ªç¯ä¹‹åæ‰§è¡Œï¼Œåœ¨ä¿®æ”¹æ•°æ®ä¹‹åç«‹å³æ‰§è¡Œå®ƒï¼Œç„¶åç­‰å¾…DOMæ›´æ–°</p><p>ueæ›´æ–°DOMæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œåœ¨ä¿®æ”¹æ•°æ®åï¼Œè§†å›¾ä¸ä¼šç«‹åˆ»æ›´æ–°ï¼Œè€Œæ˜¯ç­‰å¾…åŒä¸€äº‹ä»¶å¾ªç¯ä¸­æ‰€æœ‰æ•°æ®å˜åŒ–ä¹‹åï¼ŒåŒæ„æ›´æ–°è§†å›¾ï¼Œæ‰€ä»¥ä¿®æ”¹å®Œæ•°æ®ï¼Œç«‹åˆ»è·å¾—çš„æ˜¯æœªä¿®æ”¹çš„dom,nextTrickå°±å¯ä»¥åœ¨DOMæ›´æ–°ä¹‹åæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œè§£å†³å¼‚æ­¥æ¸²æŸ“ä¸å¯ä»¥è·å–åˆ°æ›´æ–°ä¹‹åçš„DOMçš„é—®é¢˜ï¼ŒnextTickä¼šè¿”å›ä¸€ä¸ªpromise,æ‰€ä»¥å¯ä»¥ä½¿ç”¨async/await</p><p>åº”ç”¨åœºæ™¯ï¼šåœ¨é’©å­å‡½æ•°created()é‡Œé¢æƒ³è¦è·å–æ“ä½œDomï¼ŒæŠŠæ“ä½œDOMçš„æ–¹æ³•æ”¾åœ¨$nextTickä¸­</p><h4 id="37-è¯´ä¸€è¯´newä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"><a href="#37-è¯´ä¸€è¯´newä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ" class="headerlink" title="37.è¯´ä¸€è¯´newä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"></a>37.è¯´ä¸€è¯´newä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</h4><ol><li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</li><li>è®©è¿™ä¸ªç©ºå¯¹è±¡çš„[[prototype]]å±æ€§æŒ‡å‘æ„é€ å‡½æ•°çš„prototype</li><li>è®©æ„é€ å‡½æ•°ä¸­çš„thisæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</li><li>æ‰§è¡Œè¯¥æ„é€ å‡½æ•°</li><li>å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</li></ol><h4 id="38-è¯´ä¸€ä¸‹token-èƒ½æ”¾åœ¨cookieä¸­å—ï¼Ÿ"><a href="#38-è¯´ä¸€ä¸‹token-èƒ½æ”¾åœ¨cookieä¸­å—ï¼Ÿ" class="headerlink" title="38.è¯´ä¸€ä¸‹token èƒ½æ”¾åœ¨cookieä¸­å—ï¼Ÿ"></a>38.è¯´ä¸€ä¸‹token èƒ½æ”¾åœ¨cookieä¸­å—ï¼Ÿ</h4><p>å¾—åˆ†ç‚¹ èƒ½ã€ä¸è®¾ç½®cookieæœ‰æ•ˆæœŸã€é‡æ–°ç™»å½•é‡å†™cookieè¦†ç›–åŸæ¥çš„cookie </p><p>tokenä¸€èˆ¬ç”¨æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œå®ƒå†…éƒ¨åŒ…å«çš„ä¿¡æ¯åŒ…æ‹¬uid(ç”¨æˆ·å”¯ä¸€çš„èº«ä»½æ ‡è¯†)ï¼Œtime(å½“å‰çš„æ—¶é—´æˆ³)ï¼Œsign(ç­¾åï¼Œtokençš„å‰å‡ ä½æ˜¯ä»¥å“ˆå¸Œç®—æ³•å‹ç¼©æˆçš„ä¸€å®šé•¿åº¦åœ°åå…­è¿›åˆ¶å­—ç¬¦ä¸²)ï¼Œtokenå¯ä»¥å­˜æ”¾åœ¨cookieï¼Œtokenæ˜¯å¦è¿‡æœŸç”±åç«¯å†³å®šï¼Œæ‰€ä»¥tokenå­˜å‚¨åœ¨cookieä¸­åªè¦ä¸è®¾ç½®cookieçš„è¿‡æœŸæ—¶é—´å°±å¯ä»¥ï¼Œå¦‚æœtokenå¤±æ•ˆï¼Œåªè¦è¿”å›å›ºå®šçŠ¶æ€è¡¨ç¤ºtokenå¤±æ•ˆï¼Œéœ€è¦é‡æ–°ç™»å½•ï¼Œé‡æ–°è®¾ç½®cookieä¸­çš„tokenå°±å¯ä»¥äº†ï¼Œ</p><h4 id="39-è¯´ä¸€ä¸‹æµè§ˆå™¨è¾“å…¥URLå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#39-è¯´ä¸€ä¸‹æµè§ˆå™¨è¾“å…¥URLå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="39.è¯´ä¸€ä¸‹æµè§ˆå™¨è¾“å…¥URLå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"></a>39.è¯´ä¸€ä¸‹æµè§ˆå™¨è¾“å…¥URLå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h4><h4 id="40-è¯´ä¸€è¯´ç»„ä»¶é€šä¿¡çš„æ–¹å¼ï¼Ÿ"><a href="#40-è¯´ä¸€è¯´ç»„ä»¶é€šä¿¡çš„æ–¹å¼ï¼Ÿ" class="headerlink" title="40.è¯´ä¸€è¯´ç»„ä»¶é€šä¿¡çš„æ–¹å¼ï¼Ÿ"></a>40.è¯´ä¸€è¯´ç»„ä»¶é€šä¿¡çš„æ–¹å¼ï¼Ÿ</h4><h4 id="41-è¯´ä¸€è¯´-v-if-å’Œ-v-showåŒºåˆ«ï¼Ÿ"><a href="#41-è¯´ä¸€è¯´-v-if-å’Œ-v-showåŒºåˆ«ï¼Ÿ" class="headerlink" title="41.è¯´ä¸€è¯´ v-if å’Œ v-showåŒºåˆ«ï¼Ÿ"></a>41.è¯´ä¸€è¯´ v-if å’Œ v-showåŒºåˆ«ï¼Ÿ</h4><p>v-ifæ˜¯æ¡ä»¶æ¸²æŸ“ï¼Œæ˜¯æƒ°æ€§çš„ï¼Œåªæœ‰åœ¨æ¡ä»¶åˆ¤æ–­ä¸ºtrueçš„æ—¶å€™æ‰ä¼šæ¸²æŸ“åˆ°é¡µé¢ä¸­å»ï¼Œv-showç›¸å½“äºè®¾ç½®displayæ¥è¿›è¡Œåˆ‡æ¢ï¼Œæ‰€æœ‰v-ifæœ‰æ›´é«˜çš„åˆ‡æ¢å¼€é”€ï¼Œv-showæœ‰æ›´é«˜çš„åˆ‡æ¢å¼€é”€ï¼Œå¦‚æœéœ€è¦é¢‘ç¹åˆ‡æ¢ï¼Œéœ€è¦ä½¿ç”¨v-showï¼Œv-elseå’Œtemplateä¸å¯ä»¥ç”¨äºv-showï¼Œv-showæ— è®ºå¦‚ä½•å®ƒçš„DOMå®é™…ä¸Šéƒ½æ˜¯å­˜åœ¨çš„ï¼Œåªæ˜¯é€šè¿‡CSSæ¥åˆ‡æ¢displayå±æ€§ï¼Œå½“v-ifå½“æ¡ä»¶ä¸ºfalseæ—¶ï¼Œå…¶å¯¹åº”çš„å…ƒç´ ä¸ä¼šæ¸²æŸ“åˆ°DOMä¸­</p><h4 id="42-Reactç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#42-Reactç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="42.Reactç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µæ˜¯ä»€ä¹ˆï¼Ÿ"></a>42.Reactç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µæ˜¯ä»€ä¹ˆï¼Ÿ</h4><h4 id="43-Reactç»„ä»¶é—´ä¼ å€¼çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"><a href="#43-Reactç»„ä»¶é—´ä¼ å€¼çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="43.Reactç»„ä»¶é—´ä¼ å€¼çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"></a>43.Reactç»„ä»¶é—´ä¼ å€¼çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</h4><p>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å€¼æ˜¯ä½¿ç”¨propsè¿›è¡Œä¼ é€’ï¼Œ</p><p>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ å€¼ï¼Œå¯ä»¥ä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’å›è°ƒå‡½æ•°ï¼Œå­ç»„ä»¶æ‰§è¡Œå›è°ƒå‡½æ•°å¹¶ä¼ é€’å‚æ•°</p><p>å­å­™ç»„ä»¶ä¹‹é—´çš„ä¼ é€’å¯ä»¥ä½¿ç”¨createContext()</p><p>å…„å¼Ÿç»„ä»¶é—´çš„æ•°æ®ä¼ é€’å¯ä»¥ä½¿ç”¨äº‹ä»¶æ€»çº¿æ¥ä¼ é€’</p><p>è¿˜å¯ä»¥ä½¿ç”¨reduxè¿›è¡Œå…¨å±€çŠ¶æ€ç®¡ç†</p><h4 id="44-è¯´ä¸€è¯´ç›’æ¨¡å‹ï¼Ÿ"><a href="#44-è¯´ä¸€è¯´ç›’æ¨¡å‹ï¼Ÿ" class="headerlink" title="44.è¯´ä¸€è¯´ç›’æ¨¡å‹ï¼Ÿ"></a>44.è¯´ä¸€è¯´ç›’æ¨¡å‹ï¼Ÿ</h4><p>ç›’æ¨¡å‹åˆ†ä¸ºIEçš„ç›’æ¨¡å‹å’ŒW3Cçš„ç›’æ¨¡å‹ï¼ŒW3Cçš„ç›’æ¨¡å‹æŒ‡çš„æ˜¯contentçš„å®½é«˜ï¼ŒIEçš„ç›’æ¨¡å‹æ˜¯å°†content,padding,marginåŒ…å«åœ¨å®½åº¦å’Œé«˜åº¦ä¹‹å†…ï¼Œå¯ä»¥ä½¿ç”¨css ,box-sizing:border-boxæ¥å°†W3Cçš„ç›’æ¨¡å‹è½¬æ¢æˆIEç›’æ¨¡å‹ï¼Œé»˜è®¤æ˜¯content-box</p><h4 id="45-è¯´ä¸€è¯´ä¼ªæ•°ç»„å’Œæ•°ç»„çš„åŒºåˆ«ï¼Ÿ"><a href="#45-è¯´ä¸€è¯´ä¼ªæ•°ç»„å’Œæ•°ç»„çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="45.è¯´ä¸€è¯´ä¼ªæ•°ç»„å’Œæ•°ç»„çš„åŒºåˆ«ï¼Ÿ"></a>45.è¯´ä¸€è¯´ä¼ªæ•°ç»„å’Œæ•°ç»„çš„åŒºåˆ«ï¼Ÿ</h4><p>å¾—åˆ†ç‚¹ ç±»å‹æ˜¯objectã€ä¸èƒ½ä½¿ç”¨æ•°ç»„æ–¹æ³•ã€å¯ä»¥è·å–é•¿åº¦ã€å¯ä»¥ä½¿ç”¨for inéå†</p><p>æ•°ç»„çš„ç±»å‹æ˜¯Array,ç±»æ•°ç»„çš„ç±»å‹æ˜¯object,ç±»æ•°ç»„å¯ä»¥ä½¿ç”¨lengthæŸ¥çœ‹é•¿åº¦ï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•æ¥è·å¾—å€¼ï¼Œä½†æ˜¯ä¸å¯ä»¥ä¿®æ”¹length,ä¸èƒ½ä½¿ç”¨arrayçš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨forinè¿›è¡Œéå†ï¼Œç±»æ•°ç»„å¸¸ç”¨çš„åœºæ™¯ï¼šå‡½æ•°å‚æ•°argumenrs,NodeListç­‰ï¼Œç±»æ•°ç»„è½¬æˆæ•°ç»„æ–¹æ³•ï¼ŒArray.from(arr),Array.prototype.slice.call(arr),ç´¢å¼•ä¸è¿ç»­æ—¶ä¼šè‡ªåŠ¨è¡¥ä½</p><h4 id="46-è¯´ä¸€è¯´å¦‚ä½•å®ç°å¯è¿‡æœŸçš„localstorageæ•°æ®ï¼Ÿ"><a href="#46-è¯´ä¸€è¯´å¦‚ä½•å®ç°å¯è¿‡æœŸçš„localstorageæ•°æ®ï¼Ÿ" class="headerlink" title="46.è¯´ä¸€è¯´å¦‚ä½•å®ç°å¯è¿‡æœŸçš„localstorageæ•°æ®ï¼Ÿ"></a>46.è¯´ä¸€è¯´å¦‚ä½•å®ç°å¯è¿‡æœŸçš„localstorageæ•°æ®ï¼Ÿ</h4><h4 id="47-è¯´ä¸€è¯´axiosçš„æ‹¦æˆªå™¨åŸç†åŠåº”ç”¨ï¼Ÿ"><a href="#47-è¯´ä¸€è¯´axiosçš„æ‹¦æˆªå™¨åŸç†åŠåº”ç”¨ï¼Ÿ" class="headerlink" title="47.è¯´ä¸€è¯´axiosçš„æ‹¦æˆªå™¨åŸç†åŠåº”ç”¨ï¼Ÿ"></a>47.è¯´ä¸€è¯´axiosçš„æ‹¦æˆªå™¨åŸç†åŠåº”ç”¨ï¼Ÿ</h4><h4 id="48-è¯´ä¸€è¯´åˆ›å»ºajaxè¿‡ç¨‹ï¼Ÿ"><a href="#48-è¯´ä¸€è¯´åˆ›å»ºajaxè¿‡ç¨‹ï¼Ÿ" class="headerlink" title="48.è¯´ä¸€è¯´åˆ›å»ºajaxè¿‡ç¨‹ï¼Ÿ"></a>48.è¯´ä¸€è¯´åˆ›å»ºajaxè¿‡ç¨‹ï¼Ÿ</h4><h4 id="49-è¯´ä¸€ä¸‹fetch-è¯·æ±‚æ–¹å¼ï¼Ÿ"><a href="#49-è¯´ä¸€ä¸‹fetch-è¯·æ±‚æ–¹å¼ï¼Ÿ" class="headerlink" title="49.è¯´ä¸€ä¸‹fetch è¯·æ±‚æ–¹å¼ï¼Ÿ"></a>49.è¯´ä¸€ä¸‹fetch è¯·æ±‚æ–¹å¼ï¼Ÿ</h4><h4 id="50-è¯´ä¸€ä¸‹æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥ä¿æŒå‰åç«¯å®æ—¶é€šä¿¡ï¼Ÿ"><a href="#50-è¯´ä¸€ä¸‹æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥ä¿æŒå‰åç«¯å®æ—¶é€šä¿¡ï¼Ÿ" class="headerlink" title="50.è¯´ä¸€ä¸‹æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥ä¿æŒå‰åç«¯å®æ—¶é€šä¿¡ï¼Ÿ"></a>50.è¯´ä¸€ä¸‹æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥ä¿æŒå‰åç«¯å®æ—¶é€šä¿¡ï¼Ÿ</h4><h4 id="51-è¯´ä¸€ä¸‹é‡ç»˜ã€å›æµåŒºåˆ«å¦‚ä½•é¿å…ï¼Ÿ"><a href="#51-è¯´ä¸€ä¸‹é‡ç»˜ã€å›æµåŒºåˆ«å¦‚ä½•é¿å…ï¼Ÿ" class="headerlink" title="51.è¯´ä¸€ä¸‹é‡ç»˜ã€å›æµåŒºåˆ«å¦‚ä½•é¿å…ï¼Ÿ"></a>51.è¯´ä¸€ä¸‹é‡ç»˜ã€å›æµåŒºåˆ«å¦‚ä½•é¿å…ï¼Ÿ</h4><p>å¯¹èŠ‚ç‚¹çš„å¤§å°ï¼Œä½ç½®çš„ä¿®æ”¹é‡æ–°è®¡ç®—è¢«ç§°ä¸ºå›æµï¼Œä¾‹å¦‚DOMç»“æ„çš„æ”¹å˜(æ·»åŠ æ–°çš„èŠ‚ç‚¹æˆ–è€…åˆ é™¤èŠ‚ç‚¹)</p><p>æ”¹å˜å¸ƒå±€ï¼Œä¾‹å¦‚ä¿®æ”¹äº†width,height,padding,font-sizeç­‰å€¼</p><p>çª—å£resizeã€(ä¿®æ”¹äº†çª—å£çš„å°ºå¯¸)</p><p>è°ƒç”¨getComputedStyleæ–¹æ³•è·å–å°ºå¯¸ï¼Œä½ç½®ä¿¡æ¯ç­‰</p><p>ä¿®æ”¹èƒŒæ™¯è‰²ï¼Œå­—ä½“é¢œè‰²ï¼Œè¾¹æ¡†é¢œè‰²ï¼Œè¾¹æ¡†æ ·å¼ç­‰ï¼Œ</p><p>å›æµä¸€å®šä¼šå¼•èµ·é‡ç»˜ï¼Œé‡ç»˜ä¸ä¸€å®šä¼šå¼•èµ·å›æµï¼Œæ‰€ä»¥åº”è¯¥å‡å°‘å›æµ</p><p>1.ä¿®æ”¹æ ·å¼å°½é‡ä¸€æ¬¡æ€§ä¿®æ”¹ï¼Œä¾‹å¦‚é€šè¿‡cssText,classList,classæ¥ä¿®æ”¹</p><p>2.é¿å…é¢‘ç¹çš„æ“ä½œDOMï¼Œå¯ä»¥æ˜¯ç”¨document.documentFragmentæ‰¹é‡ä¿®æ”¹ç‰‡æ®µ</p><p>3.é¿å…ä½¿ç”¨getComputedStyleé¢‘ç¹è·å–è®¡ç®—å€¼ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥å°†è®¡ç®—å€¼å­˜å‚¨èµ·æ¥</p><p>4.ä¿®æ”¹DOMå¯ä»¥å…ˆè®¾ç½®diaplay:noneï¼Œæ˜¯ä»–ä¸å­˜åœ¨renderæ ‘ï¼Œå†è¿›è¡Œä¿®æ”¹ï¼Œä¿®æ”¹å®Œæˆåå†åŠ å…¥renderæ ‘ä¸­</p><p>5.å¯¹æŸäº›å…ƒç´ ä½¿ç”¨position:absolute,fixedä½¿å…¶è„±ç¦»æ ‡å‡†æµï¼Œè¿™æ ·å¼€é”€ä¼šæ¯”è¾ƒå°</p><p>6.é»˜è®¤æƒ…å†µä¸‹ï¼Œæ ‡å‡†æµä¸­çš„å†…å®¹éƒ½ä¼šè¢«ç»˜åˆ¶åœ¨åŒä¸€ä¸ªå›¾å±‚ä¸Šï¼Œåˆ©ç”¨ä¸€äº›å±æ€§åˆ›å»ºä¸€ä¸ªæ–°çš„åˆæˆå›¾å±‚ï¼Œè¿™äº›layerå¯ä»¥ä½¿ç”¨GPUåŠ é€Ÿç»˜åˆ¶ï¼Œå› ä¸ºè¿™äº›å›¾å±‚éƒ½æ˜¯å•ç‹¬æ¸²æŸ“ï¼Œå‡å°‘äº†å›æµå’Œé‡ç»˜ï¼Œä¾‹å¦‚3d transform,vedio,canvas,iframe,opacityåŠ¨ç”»è½¬æ¢ï¼Œposition:fixed,animationæˆ–è€…transitionè®¾ç½®äº†opacity,transorm.åˆ†å±‚ç¡®å®å¯ä»¥æé«˜æ€§èƒ½ï¼Œä½†æ˜¯ä¸è¦è¿‡åº¦ä½¿ç”¨ï¼Œå¥¹æ˜¯ä»¥å†…å­˜ä¸ºä»£ä»·çš„</p><h4 id="52-è¯´ä¸€è¯´-Vue-åˆ—è¡¨ä¸ºä»€ä¹ˆåŠ -keyï¼Ÿ"><a href="#52-è¯´ä¸€è¯´-Vue-åˆ—è¡¨ä¸ºä»€ä¹ˆåŠ -keyï¼Ÿ" class="headerlink" title="52.è¯´ä¸€è¯´ Vue åˆ—è¡¨ä¸ºä»€ä¹ˆåŠ  keyï¼Ÿ"></a>52.è¯´ä¸€è¯´ Vue åˆ—è¡¨ä¸ºä»€ä¹ˆåŠ  keyï¼Ÿ</h4><p>å¾—åˆ†ç‚¹ æ€§èƒ½ä¼˜åŒ–ã€diffç®—æ³•èŠ‚ç‚¹æ¯”å¯¹ã€keyä¸èƒ½æ˜¯index</p><p>keyå±æ€§ä¸»è¦æ—¶ç”¨åœ¨Vueçš„è™šæ‹ŸDOMç®—æ³•ï¼Œåœ¨æ–°æ—§Vnodeå¯¹æ¯”æ—¶è¾¨è¯†vnodes,å¦‚æœä¸ä½¿ç”¨key,vueä¼šä½¿ç”¨ä¸€ç§æœ€å¤§é™åº¦å‡å°‘åŠ¨æ€å…ƒç´ å¹¶ä¸”å°½å¯èƒ½å‡å°‘çš„å°è¯•å°±åœ°ä¿®æ”¹/å¤ç”¨ç›¸åŒç±»å‹å…ƒç´ çš„ç®—æ³•ï¼Œè€Œä½¿ç”¨keyï¼Œä»–ä¼šåŸºäºkeyçš„å˜åŒ–é‡æ–°æ’åˆ—å…ƒç´ é¡ºåºï¼Œå¹¶ä¸”ç§»é™¤æˆ–è€…é”€æ¯ä¸éœ€è¦çš„å…ƒç´ </p><p>ç›¸åŒçš„çˆ¶å…ƒç´ çš„å­å…ƒç´ çš„keyå¿…é¡»å”¯ä¸€ï¼Œå¦‚æœæœ‰é‡å¤çš„å¯ä»¥ä¼šæ¸²æŸ“é”™è¯¯</p><p>å¦‚æœä½¿ç”¨indexä½œä¸ºkey,æ²¡æœ‰ä¼˜åŒ–æ•ˆæœï¼Œå› ä¸ºindexä¼šæ”¹å˜</p><p>å®ƒä¹Ÿå¯ä»¥ç”¨äºå¼ºåˆ¶æ›¿æ¢å…ƒç´ æˆ–è€…ç»„ä»¶è€Œä¸æ˜¯é‡å¤ä½¿ç”¨å®ƒæ—¶ã€‚å½“ä½ é‡åˆ°å¦‚ä¸‹åœºæ™¯æ—¶å®ƒå¯èƒ½ä¼šå¾ˆæœ‰ç”¨ï¼š</p><ul><li><p>å®Œæ•´åœ°è§¦å‘ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­</p></li><li><p>è§¦å‘è¿‡æ¸¡</p></li></ul><h4 id="53-è¯´ä¸€è¯´vue-router-å®ç°æ‡’åŠ è½½çš„æ–¹æ³•ï¼Ÿ"><a href="#53-è¯´ä¸€è¯´vue-router-å®ç°æ‡’åŠ è½½çš„æ–¹æ³•ï¼Ÿ" class="headerlink" title="53.è¯´ä¸€è¯´vue-router å®ç°æ‡’åŠ è½½çš„æ–¹æ³•ï¼Ÿ"></a>53.è¯´ä¸€è¯´vue-router å®ç°æ‡’åŠ è½½çš„æ–¹æ³•ï¼Ÿ</h4><div class="code-wrapper"><pre><code class="hljs livescript">vueå®ç°æ‡’åŠ è½½çš„ä¸¤ç§æ–¹æ³•componentï¼šresolve=&gt;<span class="hljs-built_in">require</span>([<span class="hljs-string">&quot;./app.vue&quot;</span>],resolve)component:()i=&gt;<span class="hljs-keyword">import</span>(<span class="hljs-comment">/*webpackChunkName:app*/</span><span class="hljs-string">&quot;./app.vue&quot;</span>)webpackChunkNameå¯ä»¥ä¸å†™ä¸è¦åœ¨è·¯ç”±ä¸­ä½¿ç”¨å¼‚æ­¥ç»„ä»¶ã€‚å¼‚æ­¥ç»„ä»¶ä»ç„¶å¯ä»¥åœ¨è·¯ç”±ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œä½†è·¯ç”±ç»„ä»¶æœ¬èº«å°±æ˜¯åŠ¨æ€å¯¼å…¥çš„ã€‚webpackä¼šè¿›è¡Œä»£ç åˆ†éš”ï¼Œè¿›è¡Œç‹¬ç«‹æ‰“åŒ…ï¼Œå½“ä½¿ç”¨é“å¾·æ—¶å€™æ‰ä¼šåŠ è½½ï¼Œvue-routeråªä¼šç¬¬ä¸€æ¬¡åŠ è½½æ—¶è·å–ï¼Œä»¥åéƒ½ä¼šä½¿ç”¨ç¼“å­˜</code></pre></div><h4 id="55-ReactRouteråŸºæœ¬ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#55-ReactRouteråŸºæœ¬ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="55.ReactRouteråŸºæœ¬ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ"></a>55.ReactRouteråŸºæœ¬ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</h4><h4 id="56-setStateæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ"><a href="#56-setStateæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ" class="headerlink" title="56.setStateæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ"></a>56.setStateæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ</h4><p>setStateåœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæˆ–è€…reactåˆæˆäº‹ä»¶ä¸­ï¼ŒsetStateæ˜¯å¼‚æ­¥çš„</p><p>åœ¨åŸç”Ÿçš„domäº‹ä»¶ä¸­ï¼ŒsetTimeoutä¸­ï¼ŒsetStateæ˜¯åŒæ­¥çš„</p><p>setStateè®¾è®¡ä¸ºå¼‚æ­¥ï¼Œå¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½ï¼Œå¦‚æœæ¯æ¬¡è°ƒç”¨setStateéƒ½è¿›è¡Œæ›´æ–°ï¼Œé‚£ä¹ˆæ„å‘³ç€renderå‡½æ•°ä¼šè¢«é¢‘ç¹çš„è°ƒç”¨ï¼Œé¡µé¢ä¼šé‡æ–°æ¸²æŸ“ï¼Œè¿™æ ·æ•ˆç‡å¾ˆä½ï¼Œæœ€å¥½çš„åŠæ³•å› è¯¥æ˜¯æ´»å¾—å¤šä¸ªæ›´æ–°ï¼Œç„¶åè¿›è¡Œæ‰¹é‡æ›´æ–°ï¼Œ</p><p>å¦‚æœåŒæ­¥è¿›è¡Œæ›´æ–°state,ä½†æ˜¯è¿˜æ²¡æœ‰æ‰§è¡Œrenderå‡½æ•°ï¼Œé‚£ä¹ˆstate,propsä¸èƒ½ä¿æŒåŒæ­¥ï¼Œstateå’Œpropsä¸ä¸€è‡´ï¼Œåœ¨å¼€å‘ä¸­ä¼šäº§ç”Ÿå¾ˆå¤šé—®é¢˜</p><h4 id="57-Reactäº‹ä»¶ç»‘å®šåŸç†"><a href="#57-Reactäº‹ä»¶ç»‘å®šåŸç†" class="headerlink" title="57.Reactäº‹ä»¶ç»‘å®šåŸç†"></a>57.Reactäº‹ä»¶ç»‘å®šåŸç†</h4><p>å¾—åˆ†ç‚¹ éåŸç”Ÿäº‹ä»¶ã€SyntheticBaseEvent </p><p>Reactä¸­çš„äº‹ä»¶ä¸æ˜¯åŸç”Ÿçš„äº‹ä»¶ï¼Œè€Œæ˜¯å¯¹åŸç”Ÿçš„eventè¿›è¡Œå°è£…çš„æ–°ç±»SyntheticBaseEventï¼Œæ¨¡æ‹Ÿå¤„DOMäº‹ä»¶çš„æ‰€æœ‰åŠŸèƒ½,é€šè¿‡event.nativeEventå¯ä»¥è·å¾—åŸç”Ÿäº‹ä»¶ï¼Œreactå°†æ‰€æœ‰çš„äº‹ä»¶éƒ½ç»‘å®šåœ¨rootæ ¹ç»„ä»¶ä¸Šï¼Œä¹‹å‰éƒ½æ˜¯ç»‘å®šåœ¨documentä¸Šçš„ï¼Œreactä¸­çš„äº‹ä»¶å’ŒDOMäº‹ä»¶ä¸ä¸€æ ·ï¼Œå’Œvueä¹Ÿä¸ä¸€æ ·ï¼Œreactå¹¶ä¸æ˜¯å°†clickäº‹ä»¶ç»‘å®šåœ¨è¯¥divçš„çœŸå®DOMä¸Šï¼Œè€Œæ˜¯åœ¨rootå¤„ç›‘å¬æ‰€æœ‰æ”¯æŒçš„äº‹ä»¶ï¼Œå½“äº‹ä»¶å‘ç”Ÿå¹¶å†’æ³¡åˆ°rootå¤„æ—¶ï¼Œreactå°†äº‹ä»¶å†…å®¹å°è£…å¹¶äº¤ç»™çœŸæ­£çš„å¤„ç†å‡½æ•°è¿è¡Œï¼Œè¿™æ ·çš„æ–¹å¼ä¸ä»…å‡å°‘äº†å†…å­˜çš„æ¶ˆè€—ï¼Œè¿˜èƒ½å†ç»„ä»¶æŒ‚è½½é”€æ¯æ—¶ç»Ÿä¸€è®¢é˜…å’Œç§»é™¤äº‹ä»¶ï¼Œå¦å¤–å†’æ³¡åˆ°rootä¸Šçš„äº‹ä»¶ä¹Ÿä¸æ˜¯åŸç”Ÿæµè§ˆå™¨äº‹ä»¶ï¼Œè€Œæ˜¯Reactè‡ªå·±å®ç°çš„åˆæˆäº‹ä»¶(SyntheticBaseEvent),å› æ­¤æˆ‘ä»¬å¦‚æœä¸æƒ³è¦äº‹ä»¶å†’æ³¡çš„è¯ï¼Œè°ƒç”¨event.stopPropagationæ˜¯æ— æ•ˆçš„ï¼Œåº”è¯¥è°ƒç”¨event.preventDefault</p><h4 id="58-Reactä¸­hooksçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#58-Reactä¸­hooksçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="58.Reactä¸­hooksçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>58.Reactä¸­hooksçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</h4><h4 id="59-è¯´ä¸€è¯´å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼Ÿ"><a href="#59-è¯´ä¸€è¯´å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼Ÿ" class="headerlink" title="59.è¯´ä¸€è¯´å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼Ÿ"></a>59.è¯´ä¸€è¯´å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼Ÿ</h4><h4 id="60-è¯´ä¸€è¯´æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ä½•é‡åŒ–ï¼Ÿ"><a href="#60-è¯´ä¸€è¯´æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ä½•é‡åŒ–ï¼Ÿ" class="headerlink" title="60.è¯´ä¸€è¯´æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ä½•é‡åŒ–ï¼Ÿ"></a>60.è¯´ä¸€è¯´æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ä½•é‡åŒ–ï¼Ÿ</h4><h4 id="61-è¯´ä¸€è¯´æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿ"><a href="#61-è¯´ä¸€è¯´æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿ" class="headerlink" title="61.è¯´ä¸€è¯´æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿ"></a>61.è¯´ä¸€è¯´æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿ</h4><h4 id="62-äº‹ä»¶æ‰©å±•ç¬¦ç”¨è¿‡å—-â€¦-ï¼Œä»€ä¹ˆåœºæ™¯ä¸‹ï¼Ÿ"><a href="#62-äº‹ä»¶æ‰©å±•ç¬¦ç”¨è¿‡å—-â€¦-ï¼Œä»€ä¹ˆåœºæ™¯ä¸‹ï¼Ÿ" class="headerlink" title="62.äº‹ä»¶æ‰©å±•ç¬¦ç”¨è¿‡å—(â€¦)ï¼Œä»€ä¹ˆåœºæ™¯ä¸‹ï¼Ÿ"></a>62.äº‹ä»¶æ‰©å±•ç¬¦ç”¨è¿‡å—(â€¦)ï¼Œä»€ä¹ˆåœºæ™¯ä¸‹ï¼Ÿ</h4><p>1.åœ¨æ•°ç»„è°ƒç”¨æ—¶å¯ä»¥æ›¿ä»£æ•°ç»„çš„applyæ–¹æ³•</p><p>2.ç”¨äºåˆå¹¶æ•°ç»„</p><p>3.ä¸è§£æ„èµ‹å€¼ç›¸ç»“åˆï¼Œç”Ÿæˆæ–°çš„æ•°ç»„</p><p>4.å°†å­—ç¬¦ä¸²è½¬æˆæ•°ç»„</p><p>5.ä»»ä½•iteratorå¯¹è±¡ï¼Œéƒ½å¯ä»¥é€šè¿‡å±•å¼€è¿ç®—ç¬¦è½¬æˆæ•°ç»„</p><p>6.ç”¨äºæ•°ç»„çš„æµ…æ‹·è´</p><p>7.æ„é€ å­—é¢é‡å¯¹è±¡å¯ä»¥ä½¿ç”¨å±•å¼€è¯­æ³•</p><p>8.åœ¨ new è¡¨è¾¾å¼ä¸­åº”ç”¨ï¼Œä½¿ç”¨ <code>new</code> å…³é”®å­—æ¥è°ƒç”¨æ„é€ å‡½æ•°æ—¶ï¼Œä¸èƒ½<strong>ç›´æ¥</strong>ä½¿ç”¨æ•°ç»„ + <code>apply</code> çš„æ–¹å¼ï¼ˆ<code>apply</code> æ‰§è¡Œçš„æ˜¯è°ƒç”¨ <code>[[Call]]</code> , è€Œä¸æ˜¯æ„é€  <code>[[Construct]]</code>ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨å±•å¼€è¯­æ³•æ›¿ä»£</p><h4 id="63-è¯´ä¸€è¯´vueé’©å­å‡½æ•°ï¼Ÿ"><a href="#63-è¯´ä¸€è¯´vueé’©å­å‡½æ•°ï¼Ÿ" class="headerlink" title="63.è¯´ä¸€è¯´vueé’©å­å‡½æ•°ï¼Ÿ"></a>63.è¯´ä¸€è¯´vueé’©å­å‡½æ•°ï¼Ÿ</h4><p>ç»„ä»¶ä»åˆ›å»ºï¼ŒæŒ‚è½½ï¼Œæ›´æ–°ï¼Œé”€æ¯çš„å…¨è¿‡ç¨‹å°±æ˜¯vueçš„å£°æ˜å‘¨æœŸï¼ŒåŒ…æ‹¬beforeCreate,created,beforemount,mounted,beforeUpdate,updated,beforeumount,umouted,</p><p>beforeCreateé’©å­å‡½æ•°ä¼šåœ¨å®ä¾‹åˆå§‹åŒ–ä¹‹åï¼Œè¿›è¡Œæ•°æ®ä¾¦å¬å’Œäº‹ä»¶/ä¾¦å¬å™¨çš„é…ç½®ä¹‹å‰åŒæ­¥è°ƒç”¨ï¼Œ</p><p>createdé’©å­å‡½æ•°ä¼šåœ¨ç»„ä»¶å®ä¾‹è¢«åˆ›å®Œæˆåè¢«ç«‹å³åŒæ­¥è°ƒç”¨ï¼Œæ­¤æ—¶$watch,computed,method,dataç­‰å±æ€§å¯ä»¥è¢«è°ƒç”¨ï¼Œä½†æ˜¯æŒ‚è½½é˜¶æ®µè¿˜æ²¡å¼€å§‹ï¼Œæ‰€ä»¥$elå±æ€§è¿˜ä¸å¯ä»¥ä½¿ç”¨ï¼Œ</p><p>beforeMounté’©å­å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè¯¥é’©å­å‡½æ•°ä¼šåœ¨æŒ‚è½½å‰è°ƒç”¨ï¼Œrenderå‡½æ•°é¦–æ¬¡è¢«è°ƒç”¨ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸ä¼šè¢«è°ƒç”¨</p><p>mountedé’©å­å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œåœ¨å®ä¾‹æŒ‚è½½å®Œæˆåè°ƒç”¨ï¼Œè¿™æ—¶å€™ä¼ ç»™app.mountçš„å…ƒç´ å·²ç»è¢«æ–°åˆ›å»ºçš„vm.$elæ›¿æ¢ï¼Œmountedä¸ä¼šä¿è¯æ‰€æœ‰å­ç»„ä»¶éƒ½è¢«æŒ‚è½½å®Œæˆã€‚å¦‚æœæƒ³æ‰§è¡Œåœ¨è¿™ä¸ªè§†å›¾æ¸²æŸ“å®Œæ¯•åæ‰§è¡Œä»£ç ï¼Œå¯ä»¥åœ¨mountedå†…éƒ¨ä½¿ç”¨vm.$nextTick</p><div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// ä»…åœ¨æ•´ä¸ªè§†å›¾éƒ½è¢«æ¸²æŸ“ä¹‹åæ‰ä¼šè¿è¡Œçš„ä»£ç </span>  &#125;)&#125;</code></pre></div><p>è¯¥é’©å­å‡½æ•°ä¸ä¼šå†æœåŠ¡ç«¯æ¸²æŸ“æ—¶è°ƒç”¨</p><p>beforeUpdateé’©å­å‡½æ•°æ˜¯åœ¨æ•°æ®å‘ç”Ÿå˜åŒ–ä¹‹åDOMæ›´æ–°ä¹‹å‰è°ƒç”¨ï¼Œé€‚åˆåœ¨DOMæ›´æ–°ä¹‹å‰è®¿é—®å®ƒï¼Œä¾‹å¦‚ç§»é™¤æ‰‹åŠ¨æ·»åŠ çš„äº‹ä»¶ç›‘å¬å™¨ã€‚<strong>è¯¥é’©å­åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨ï¼Œå› ä¸ºåªæœ‰åˆæ¬¡æ¸²æŸ“ä¼šåœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œã€‚</strong></p><p>updatedé’©å­å‡½æ•°ä¼šåœ¨æ•°æ®æ›´æ–°ä¹‹åè™šæ‹ŸDOMé‡æ–°æ¸²æŸ“å®Œæ¯•ä¹‹åè¢«è°ƒç”¨ï¼Œæ­¤æ—¶DOMå·²ç»æ›´æ–°å®Œæ¯•å¯ä»¥è¿›è¡ŒDOMæ“ä½œï¼Œä½†æ˜¯ä¸å»ºè®®ä¸‹è¯¥ç‹—å­ä¸­è¿›è¡ŒçŠ¶æ€çš„æ”¹å˜ï¼Œé€šå¸¸ä½¿ç”¨watchæˆ–è€…computedæ¥è¿›è¡ŒçŠ¶æ€ç›‘å¬ï¼Œupdatedä¸èƒ½ä¿è¯å­ç»„ä»¶å·²ç»æŒ‚è½½å®Œæˆï¼Œå¦‚æœæƒ³è¦åœ¨ç»„ä»¶å®Œå…¨æ¸²æŸ“ä»¥åæ“ä½œå¯ä»¥ä½¿ç”¨vm.$nextTick.è¯¥é’©å­å‡½æ•°ä¸èƒ½ç”¨äºæœåŠ¡ç«¯ã€‚</p><p>activitedé’©å­å‡½æ•°</p><p>è¯¥é’©å­ä¼šè¢«keep-aliveç¼“å­˜çš„ç»„ä»¶æ¿€æ´»æ—¶è°ƒç”¨ï¼Œè¯¥é’©å­åœ¨æœåŠ¡å™¨ç®¡æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨</p><p>deactivatedé’©å­å‡½æ•°ä¼šåœ¨è¢«keep-aliveç¼“å­˜çš„ç»„ä»¶å¤±æ´»æ—¶è°ƒç”¨ï¼Œåœ¨æœåŠ¡ç«¯ä¸å¯ç”¨</p><p>beforeMounté’©å­å‡½æ•°ä¼šåœ¨ç»„ä»¶å¸è½½ä¹‹å‰è°ƒç”¨ï¼Œåœ¨è¿™ä¸ªæ—¶å€™1å¯ä»¥è§£é™¤å¯¹äº‹ä»¶çš„ç›‘å¬ï¼Œ<strong>è¯¥é’©å­åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨ã€‚</strong></p><p>mountedé’©å­å‡½æ•°è°ƒç”¨æ—¶ï¼Œç»„ä»¶å·²ç»å¸è½½å®Œæˆï¼ŒæŒ‡ä»¤å’Œç›‘å¬å™¨éƒ½å¸è½½å®Œæˆï¼Œ<strong>è¯¥é’©å­åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨ã€‚</strong></p><p>çˆ¶å­ç»„ä»¶çš„å£°æ˜å‘¨æœŸ</p><p>æŒ‚è½½é˜¶æ®µ</p><p>çˆ¶beforeCreate-&gt;çˆ¶created-&gt;çˆ¶beforMount-&gt;å­beforeCreate-&gt;å­created-&gt;å­beforeMount-&gt;å­mounted-&gt;çˆ¶mounted</p><p>æ›´æ–°é˜¶æ®µ</p><p>çˆ¶beforeUpdate-&gt;å­beforeUpdate-&gt;å­updated-&gt;çˆ¶updated</p><p>é”€æ¯é˜¶æ®µ</p><p>çˆ¶beforeDestory-&gt;å­deforeDestory-&gt;å­destoryed-&gt;çˆ¶destoryed</p><h4 id="64-vueç”Ÿå‘½å‘¨æœŸçš„æºç å®ç°"><a href="#64-vueç”Ÿå‘½å‘¨æœŸçš„æºç å®ç°" class="headerlink" title="64.vueç”Ÿå‘½å‘¨æœŸçš„æºç å®ç°"></a>64.vueç”Ÿå‘½å‘¨æœŸçš„æºç å®ç°</h4><h4 id="65-nexttickæºç "><a href="#65-nexttickæºç " class="headerlink" title="65.nexttickæºç "></a>65.nexttickæºç </h4><h4 id="66-v8åƒåœ¾å›æ”¶"><a href="#66-v8åƒåœ¾å›æ”¶" class="headerlink" title="66.v8åƒåœ¾å›æ”¶"></a>66.v8åƒåœ¾å›æ”¶</h4><h4 id="68-è®¡ç®—æœºç½‘ç»œæ¨¡å‹æœ‰å“ªäº›ï¼Ÿå…·ä½“æ¯ä¸€å±‚å¹²ä»€ä¹ˆçš„ï¼Œä¼ è¾“çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Œæœ‰å“ªäº›åè®®ï¼Ÿ"><a href="#68-è®¡ç®—æœºç½‘ç»œæ¨¡å‹æœ‰å“ªäº›ï¼Ÿå…·ä½“æ¯ä¸€å±‚å¹²ä»€ä¹ˆçš„ï¼Œä¼ è¾“çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Œæœ‰å“ªäº›åè®®ï¼Ÿ" class="headerlink" title="68.è®¡ç®—æœºç½‘ç»œæ¨¡å‹æœ‰å“ªäº›ï¼Ÿå…·ä½“æ¯ä¸€å±‚å¹²ä»€ä¹ˆçš„ï¼Œä¼ è¾“çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Œæœ‰å“ªäº›åè®®ï¼Ÿ"></a>68.è®¡ç®—æœºç½‘ç»œæ¨¡å‹æœ‰å“ªäº›ï¼Ÿå…·ä½“æ¯ä¸€å±‚å¹²ä»€ä¹ˆçš„ï¼Œä¼ è¾“çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Œæœ‰å“ªäº›åè®®ï¼Ÿ</h4><h4 id="69-è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«ï¼Ÿï¼ˆæš‚å®šï¼‰"><a href="#69-è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«ï¼Ÿï¼ˆæš‚å®šï¼‰" class="headerlink" title="69.è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«ï¼Ÿï¼ˆæš‚å®šï¼‰"></a>69.è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«ï¼Ÿï¼ˆæš‚å®šï¼‰</h4><ol><li>ä¸€ä¸ªçº¿ç¨‹å±äºä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä½†è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹ä¾èµ–è¿›ç¨‹çš„å­˜åœ¨</li><li>è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œå¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜</li><li>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½</li><li>è¿›ç¨‹çš„åˆ‡æ¢å¼€é”€è¿œå¤§äºçº¿ç¨‹çš„åˆ‡æ¢å¼€é”€</li><li>è¿›ç¨‹é—´çš„é€šä¿¡IPCï¼Œçº¿ç¨‹é—´å¯ä»¥ç›´æ¥å†™è¿›æ•°æ®æ®µ(å¦‚å…¨å±€å˜é‡)æ¥è¿›è¡Œé€šä¿¡â€“éœ€è¦è¿›ç¨‹åŒæ­¥å’Œäº’æ–¥æ‰‹æ®µçš„è¾…åŠ©ï¼Œä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§</li><li>è¿›ç¨‹ç¼–ç¨‹è°ƒè¯•ç®€å•å¯é æ€§é«˜ï¼Œä½†æ˜¯åˆ›å»ºé”€æ¯å¼€é”€å¤§ï¼Œçº¿ç¨‹æ­£å¥½ç›¸åï¼Œå¼€é”€å°ï¼Œåˆ‡æ¢é€Ÿåº¦å¿«ï¼Œä½†æ˜¯ç¼–ç¨‹è°ƒè¯•ç›¸å¯¹å¤æ‚</li><li>è¿›ç¨‹é—´ä¸ä¼šç›¸äº’å½±å“ï¼Œä¸€ä¸ªçº¿ç¨‹æŒ‚æ‰ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹æŒ‚æ‰</li><li>è¿›ç¨‹é€‚åˆå¤šæ ¸ï¼Œå¤šæœºåˆ†å¸ƒï¼Œçº¿ç¨‹é€‚ç”¨äºå¤šæ ¸</li></ol><p>è¿›ç¨‹ï¼šæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œå¯åŠ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå°±ä¼šé»˜è®¤å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹(ä¹Ÿå¯èƒ½æ˜¯å¤šä¸ªè¿›ç¨‹)</p><p>çº¿ç¨‹ï¼šæ¯ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œéƒ½ä¼šå¯åŠ¨è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ç”¨æ¥æ‰§è¡Œç¨‹åºä¸­çš„ä»£ç ï¼Œè¿™å°±ä¸»çº¿ç¨‹ï¼Œæ‰€ä»¥è¯´è¿›ç¨‹æ˜¯çº¿ç¨‹çš„å®¹å™¨</p><p>æ“ä½œç³»ç»Ÿç±»ä¼¼äºä¸€ä¸ªå¤§å·¥å‚ï¼Œå·¥å‚ä¸­æœ‰å¾ˆå¤šè½¦é—´ï¼Œè¿™ä¸ªè½¦é—´å°±æ˜¯è¿›ç¨‹ï¼Œæ¯ä¸ªè½¦é—´æœ‰å¯èƒ½æœ‰ä¸€ç›’ä»¥ä¸Šçš„å·¥äººåœ¨å·¥å‚ï¼Œè¿™ä¸ªå·¥äººå°±æ˜¯çº¿ç¨‹</p><p>jsæ˜¯å•çº¿ç¨‹çš„ï¼Œjsçº¿ç¨‹æœ‰è‡ªå·±çš„å®¹å™¨è¿›ç¨‹ï¼Œæµè§ˆå™¨æˆ–è€…node</p><h4 id="70-åŸºæœ¬æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢"><a href="#70-åŸºæœ¬æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢" class="headerlink" title="70.åŸºæœ¬æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢"></a>70.åŸºæœ¬æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢</h4><p>1.console.log(null==undefined)//true<br>2.éç©ºå­—ç¬¦ä¸²é€šè¿‡Boolean()è½¬æˆtrue,ç©ºå­—ç¬¦ä¸²è½¬æˆfalseï¼Œå¯¹äºNumberç±»å‹ï¼Œé0æ•°å­—éƒ½ä¼šè½¬æˆtrue,0,NaNä¼šè½¬æˆfalse,å¯¹è±¡éƒ½ä¼šè¢«è½¬æˆtrue,undefinedä¼šè¢«è½¬æˆfalseï¼Œifæ¡ä»¶åˆ¤æ–­ä¼šè‡ªåŠ¨è½¬æˆbooleanè¿›è¡Œåˆ¤æ–­ï¼Œä½¿ç”¨!!ä¹Ÿå¯ä»¥è¿›è¡Œéšå¼è½¬æ¢<br>3.æ•°å€¼ç±»å‹çš„è½¬æ¢ï¼Œå¯ä»¥é€šè¿‡Number(),parseInt(),parseFloat()ä¸‰ä¸ªå‡½æ•°æ˜¾ç¤ºçš„è¿›è¡Œè½¬æ¢ï¼ŒNumber()å¯ä»¥ç”¨äºä»»ä½•æ•°æ®ç±»å‹ï¼ŒparseIntå’ŒparseFloatä¸»è¦ç”¨äºå­—ç¬¦ä¸²ï¼ŒNumber()è¿›è¡Œç±»å‹è½¬æ¢æ—¶ï¼Œ<br>booleanå€¼falseä¼šè½¬æˆ0ï¼Œtrueä¼šè½¬æˆ1ï¼Œnullä¼šè½¬æˆ0ï¼Œundefinedä¼šè¿”å›NaN,å¯¹äºå­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­åªåŒ…å«æ•°å­—åˆ™ä¼šè½¬æ¢æˆåè¿›åˆ¶çš„æ•°å­—ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å«æµ®ç‚¹æ•°ï¼Œåˆ™ä¼šè½¬æˆæµ®ç‚¹æ•°ï¼Œå¦‚æœåŒ…å«åå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²åˆ™ä¼šè½¬æˆåè¿›åˆ¶çš„æ•°å­—ï¼Œå¦‚æœæ˜¯ç©ºå­—ç¬¦ä¸²åˆ™ä¼šè½¬æˆ0ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å«å…¶å­—ç¬¦ï¼Œåˆ™ä¼šè½¬æˆNaNã€‚å¯¹è±¡ä¼šå…ˆè°ƒç”¨valueOfæŒ‰ç…§ä¸Šè¿°æ–¹å¼è¿›è¡Œè½¬æ¢ï¼Œå¦‚æœæ˜¯NaNåˆ™ä¼šå†è°ƒç”¨toStringå†è¿›è¡Œä¸Šè¿°çš„è½¬æ¢ã€‚<br>ä½¿ç”¨parseIntè¿›è¡Œç±»å‹è½¬æ¢æ—¶ï¼Œä»–ä¼šä»ç¬¬ä¸€ä¸ªéç©ºæ ¼çš„å­—ç¬¦è¿›è¡Œè½¬æ¢ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯åŠ å‡ï¼Œæ•°å­—å­—ç¬¦ï¼Œåˆ™ä¼šè½¬æˆNaN,ç©ºå­—ç¬¦ä¸²ä¹Ÿä¼šè½¬æˆNaN,å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ—¶åŠ å‡ï¼Œæ•°å­—åˆ™ä¼šä¸€ç›´åˆ°éæ•°å­—å­—ç¬¦ä½ç½®ï¼ŒparseIntä¼šè¿›è¡Œæˆªæ–­å­—ç¬¦ï¼Œå¦‚æœæ˜¯æµ®ç‚¹æ•°å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šé‡åˆ°.å°±ä¼šæˆªæ–­<br>parseFloatåªèƒ½è§£æåè¿›åˆ¶ï¼Œä¼šå¿½ç•¥ç¬¬äºŒä¸ª.ä»–ä¼šå¿½ç•¥å­—ç¬¦è½¬ä»¥0å¼€å¤´çš„å€¼<br>4.è½¬æˆå­—ç¬¦ä¸²ï¼Œ+â€â€å°±å¯ä»¥å˜æˆå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨toStringæ¥è½¬æ¢ï¼Œé™¤äº†nullå’Œundefinedéƒ½å¯ä»¥toStringï¼Œä½¿ç”¨String()ä¹Ÿå¯ä»¥è½¬æˆå­—ç¬¦è½¬ï¼Œæœ‰toStringåˆ™ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œnullåˆ™ä¼šè£…æˆâ€nullâ€,undefined=&gt;â€™undefinedâ€™</p><h4 id="71-webpack-çš„-plugin-å’Œ-loader-çš„åŒºåˆ«å’ŒåŸç†"><a href="#71-webpack-çš„-plugin-å’Œ-loader-çš„åŒºåˆ«å’ŒåŸç†" class="headerlink" title="71.webpack çš„ plugin å’Œ loader çš„åŒºåˆ«å’ŒåŸç†"></a>71.webpack çš„ plugin å’Œ loader çš„åŒºåˆ«å’ŒåŸç†</h4><h4 id="72-é™æ€èµ„æºä¸€èˆ¬é‡‡å–ä»€ä¹ˆç¼“å­˜ç­–ç•¥ï¼Ÿ"><a href="#72-é™æ€èµ„æºä¸€èˆ¬é‡‡å–ä»€ä¹ˆç¼“å­˜ç­–ç•¥ï¼Ÿ" class="headerlink" title="72.é™æ€èµ„æºä¸€èˆ¬é‡‡å–ä»€ä¹ˆç¼“å­˜ç­–ç•¥ï¼Ÿ"></a>72.é™æ€èµ„æºä¸€èˆ¬é‡‡å–ä»€ä¹ˆç¼“å­˜ç­–ç•¥ï¼Ÿ</h4><p>å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜</p><h4 id="73-ç§»åŠ¨ç«¯300msçš„å»¶è¿Ÿé—®é¢˜ï¼Œé—®ä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé—®é¢˜"><a href="#73-ç§»åŠ¨ç«¯300msçš„å»¶è¿Ÿé—®é¢˜ï¼Œé—®ä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé—®é¢˜" class="headerlink" title="73.ç§»åŠ¨ç«¯300msçš„å»¶è¿Ÿé—®é¢˜ï¼Œé—®ä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé—®é¢˜"></a>73.ç§»åŠ¨ç«¯300msçš„å»¶è¿Ÿé—®é¢˜ï¼Œé—®ä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé—®é¢˜</h4><h4 id="74-vueæ¨¡ç‰ˆç¼–è¯‘éƒ½æœ‰å“ªäº›é˜¶æ®µ"><a href="#74-vueæ¨¡ç‰ˆç¼–è¯‘éƒ½æœ‰å“ªäº›é˜¶æ®µ" class="headerlink" title="74.vueæ¨¡ç‰ˆç¼–è¯‘éƒ½æœ‰å“ªäº›é˜¶æ®µ"></a>74.vueæ¨¡ç‰ˆç¼–è¯‘éƒ½æœ‰å“ªäº›é˜¶æ®µ</h4><h4 id="75-vueè™šæ‹Ÿdomæ€ä¹ˆç”Ÿæˆçš„"><a href="#75-vueè™šæ‹Ÿdomæ€ä¹ˆç”Ÿæˆçš„" class="headerlink" title="75.vueè™šæ‹Ÿdomæ€ä¹ˆç”Ÿæˆçš„"></a>75.vueè™šæ‹Ÿdomæ€ä¹ˆç”Ÿæˆçš„</h4><h4 id="76-Vue2-3åŒºåˆ«"><a href="#76-Vue2-3åŒºåˆ«" class="headerlink" title="76.Vue2 3åŒºåˆ«"></a>76.Vue2 3åŒºåˆ«</h4><h4 id="77-æ‰‹å†™é˜²æŠ–èŠ‚æµ"><a href="#77-æ‰‹å†™é˜²æŠ–èŠ‚æµ" class="headerlink" title="77.æ‰‹å†™é˜²æŠ–èŠ‚æµ"></a>77.æ‰‹å†™é˜²æŠ–èŠ‚æµ</h4><h4 id="78-æ‰‹å†™domæ ‘è½¬jså¯¹è±¡"><a href="#78-æ‰‹å†™domæ ‘è½¬jså¯¹è±¡" class="headerlink" title="78.æ‰‹å†™domæ ‘è½¬jså¯¹è±¡"></a>78.æ‰‹å†™domæ ‘è½¬jså¯¹è±¡</h4><h4 id="79-ç»™ä¸€å¼ ä¸Šä¸‹é¢ å€’çš„ç…§ç‰‡å‰ç«¯å¦‚ä½•å°†å›¾ç‰‡ä½ç½®æ—‹è½¬çŸ«æ­£å‘é€ç»™åç«¯"><a href="#79-ç»™ä¸€å¼ ä¸Šä¸‹é¢ å€’çš„ç…§ç‰‡å‰ç«¯å¦‚ä½•å°†å›¾ç‰‡ä½ç½®æ—‹è½¬çŸ«æ­£å‘é€ç»™åç«¯" class="headerlink" title="79.ç»™ä¸€å¼ ä¸Šä¸‹é¢ å€’çš„ç…§ç‰‡å‰ç«¯å¦‚ä½•å°†å›¾ç‰‡ä½ç½®æ—‹è½¬çŸ«æ­£å‘é€ç»™åç«¯"></a>79.ç»™ä¸€å¼ ä¸Šä¸‹é¢ å€’çš„ç…§ç‰‡å‰ç«¯å¦‚ä½•å°†å›¾ç‰‡ä½ç½®æ—‹è½¬çŸ«æ­£å‘é€ç»™åç«¯</h4><h4 id="80-å¦‚æœä¸€ä¸ªé¡µé¢æ‰“å¼€å¾ˆæ…¢ï¼Œå¯èƒ½æ˜¯å“ªäº›åŸå› ï¼Œæ€ä¹ˆè¿›è¡Œä¼˜åŒ–"><a href="#80-å¦‚æœä¸€ä¸ªé¡µé¢æ‰“å¼€å¾ˆæ…¢ï¼Œå¯èƒ½æ˜¯å“ªäº›åŸå› ï¼Œæ€ä¹ˆè¿›è¡Œä¼˜åŒ–" class="headerlink" title="80.å¦‚æœä¸€ä¸ªé¡µé¢æ‰“å¼€å¾ˆæ…¢ï¼Œå¯èƒ½æ˜¯å“ªäº›åŸå› ï¼Œæ€ä¹ˆè¿›è¡Œä¼˜åŒ–"></a>80.å¦‚æœä¸€ä¸ªé¡µé¢æ‰“å¼€å¾ˆæ…¢ï¼Œå¯èƒ½æ˜¯å“ªäº›åŸå› ï¼Œæ€ä¹ˆè¿›è¡Œä¼˜åŒ–</h4><h4 id="81-TCPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œä»¥åŠæ¯æ¬¡çš„ä½œç”¨"><a href="#81-TCPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œä»¥åŠæ¯æ¬¡çš„ä½œç”¨" class="headerlink" title="81.TCPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œä»¥åŠæ¯æ¬¡çš„ä½œç”¨"></a>81.TCPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œä»¥åŠæ¯æ¬¡çš„ä½œç”¨</h4><h4 id="82-TCPå’ŒUDPçš„åŒºåˆ«ï¼ŒTCPçš„å¯é æ€§å¦‚ä½•ä¿è¯ï¼Œç²˜åŒ…å¦‚ä½•å¤„ç†ï¼Œæµé‡æ§åˆ¶ï¼Œæ»‘åŠ¨çª—å£åŸç†"><a href="#82-TCPå’ŒUDPçš„åŒºåˆ«ï¼ŒTCPçš„å¯é æ€§å¦‚ä½•ä¿è¯ï¼Œç²˜åŒ…å¦‚ä½•å¤„ç†ï¼Œæµé‡æ§åˆ¶ï¼Œæ»‘åŠ¨çª—å£åŸç†" class="headerlink" title="82.TCPå’ŒUDPçš„åŒºåˆ«ï¼ŒTCPçš„å¯é æ€§å¦‚ä½•ä¿è¯ï¼Œç²˜åŒ…å¦‚ä½•å¤„ç†ï¼Œæµé‡æ§åˆ¶ï¼Œæ»‘åŠ¨çª—å£åŸç†"></a>82.TCPå’ŒUDPçš„åŒºåˆ«ï¼ŒTCPçš„å¯é æ€§å¦‚ä½•ä¿è¯ï¼Œç²˜åŒ…å¦‚ä½•å¤„ç†ï¼Œæµé‡æ§åˆ¶ï¼Œæ»‘åŠ¨çª—å£åŸç†</h4><h4 id="83-Vueçš„å“åº”å¼åŸç†"><a href="#83-Vueçš„å“åº”å¼åŸç†" class="headerlink" title="83.Vueçš„å“åº”å¼åŸç†"></a>83.Vueçš„å“åº”å¼åŸç†</h4><h4 id="84-Vueä¸­computedå’Œdataé‡Œçš„å€¼çš„è”ç³»ï¼Œcomputedçš„ç‰¹ç‚¹ä»¥åŠå“åº”å¼å˜åŒ–"><a href="#84-Vueä¸­computedå’Œdataé‡Œçš„å€¼çš„è”ç³»ï¼Œcomputedçš„ç‰¹ç‚¹ä»¥åŠå“åº”å¼å˜åŒ–" class="headerlink" title="84.Vueä¸­computedå’Œdataé‡Œçš„å€¼çš„è”ç³»ï¼Œcomputedçš„ç‰¹ç‚¹ä»¥åŠå“åº”å¼å˜åŒ–"></a>84.Vueä¸­computedå’Œdataé‡Œçš„å€¼çš„è”ç³»ï¼Œcomputedçš„ç‰¹ç‚¹ä»¥åŠå“åº”å¼å˜åŒ–</h4><h4 id="85-Vue3ä¸Vue2ç›¸æ¯”æœ‰å“ªäº›å˜åŒ–ï¼ŒVue2ä¸­æ€ä¹ˆç›‘å¬æ•°ç»„å˜åŒ–ï¼Œproxy-å’Œ-defineProperty-çš„æ¯”è¾ƒ"><a href="#85-Vue3ä¸Vue2ç›¸æ¯”æœ‰å“ªäº›å˜åŒ–ï¼ŒVue2ä¸­æ€ä¹ˆç›‘å¬æ•°ç»„å˜åŒ–ï¼Œproxy-å’Œ-defineProperty-çš„æ¯”è¾ƒ" class="headerlink" title="85.Vue3ä¸Vue2ç›¸æ¯”æœ‰å“ªäº›å˜åŒ–ï¼ŒVue2ä¸­æ€ä¹ˆç›‘å¬æ•°ç»„å˜åŒ–ï¼Œproxy å’Œ defineProperty çš„æ¯”è¾ƒ"></a>85.Vue3ä¸Vue2ç›¸æ¯”æœ‰å“ªäº›å˜åŒ–ï¼ŒVue2ä¸­æ€ä¹ˆç›‘å¬æ•°ç»„å˜åŒ–ï¼Œproxy å’Œ defineProperty çš„æ¯”è¾ƒ</h4><p>è¯¦æƒ…è¯·çœ‹vue3å’Œvue2åŒºåˆ«</p><p>vue2ä¸­é‡å†™æ•°ç»„ä¸­çš„æ–¹æ³•ï¼Œä¸»è¦åˆ†ä¸ºè¿™å‡ æ­¥</p><ol><li>è·å–åˆ°ArrayåŸå‹é“¾ä¸Šçš„æ–¹æ³•ï¼Œå› ä¸ºæ‹¦æˆªåè¿˜éœ€è¦è°ƒç”¨åŸç”Ÿçš„æ–¹æ³•è¿›è¡Œæ“ä½œ</li><li>ä½¿ç”¨object.definepropertyæ‹¦æˆªæ•°ç»„çš„æ“ä½œ</li><li>å†æŠŠarrayçš„å®ä¾‹åŸå‹æŒ‡å‘ä¿®æ”¹åçš„å®ä¾‹åŸå‹</li></ol><p>proxyå’Œdefinepropertyçš„åŒºåˆ«</p><p>definepropertyçš„ä½œç”¨ä¸»è¦ä¸æ˜¯ç”¨æ¥ç›‘å¬å¯¹è±¡å±æ€§çš„å˜åŒ–ï¼Œdefinepropertyä¸å¯ä»¥ç›‘å¬æ•°ç»„çš„å˜åŒ–ï¼Œå¿…é¡»é‡å†™æ•°ç»„çš„æ–¹æ³•ï¼Œä¼šå¯¹å¯¹è±¡è¿›è¡Œä¿®æ”¹ï¼Œä¸èƒ½å¤Ÿç›‘å¬å¯¹è±¡å±æ€§çš„ä¿®æ”¹å’Œåˆ é™¤ï¼Œä¸å¯ä»¥ç›‘å¬æ•°ç»„æ‰‹åŠ¨ä¿®æ”¹lengthå’Œé€šè¿‡æ•°ç»„ä¸‹æ ‡ä¿®æ”¹å€¼ï¼Œproxyä»£ç†ï¼Œå¯ä»¥ä»£ç†å¯¹è±¡ï¼Œä¸éœ€è¦ä¿®æ”¹å…ƒç´ ç»„ï¼Œè€Œä¸”æœ‰åä¸‰ä¸­æ•è·å™¨ï¼Œè¿˜å¯ä»¥é…åˆreflectæ¥ä½¿ç”¨</p><h4 id="86-webpackçš„æ‰“åŒ…è¿‡ç¨‹ï¼Œloaderå’Œpluginçš„åŒºåˆ«ï¼Œæ€ä¹ˆå¯¹æ‰“åŒ…ä½“ç§¯è¿›è¡Œä¼˜åŒ–ç­‰"><a href="#86-webpackçš„æ‰“åŒ…è¿‡ç¨‹ï¼Œloaderå’Œpluginçš„åŒºåˆ«ï¼Œæ€ä¹ˆå¯¹æ‰“åŒ…ä½“ç§¯è¿›è¡Œä¼˜åŒ–ç­‰" class="headerlink" title="86.webpackçš„æ‰“åŒ…è¿‡ç¨‹ï¼Œloaderå’Œpluginçš„åŒºåˆ«ï¼Œæ€ä¹ˆå¯¹æ‰“åŒ…ä½“ç§¯è¿›è¡Œä¼˜åŒ–ç­‰"></a>86.webpackçš„æ‰“åŒ…è¿‡ç¨‹ï¼Œloaderå’Œpluginçš„åŒºåˆ«ï¼Œæ€ä¹ˆå¯¹æ‰“åŒ…ä½“ç§¯è¿›è¡Œä¼˜åŒ–ç­‰</h4><h4 id="87-window-onloadå’ŒDOMContentLoadedçš„åŒºåˆ«"><a href="#87-window-onloadå’ŒDOMContentLoadedçš„åŒºåˆ«" class="headerlink" title="87.window.onloadå’ŒDOMContentLoadedçš„åŒºåˆ«"></a>87.window.onloadå’ŒDOMContentLoadedçš„åŒºåˆ«</h4><h4 id="88-äº†è§£http2"><a href="#88-äº†è§£http2" class="headerlink" title="88.äº†è§£http2"></a>88.äº†è§£http2</h4><h4 id="89-ç½‘é¡µå¸ƒå±€çš„æ–¹å¼æœ‰å“ªäº›"><a href="#89-ç½‘é¡µå¸ƒå±€çš„æ–¹å¼æœ‰å“ªäº›" class="headerlink" title="89.ç½‘é¡µå¸ƒå±€çš„æ–¹å¼æœ‰å“ªäº›"></a>89.ç½‘é¡µå¸ƒå±€çš„æ–¹å¼æœ‰å“ªäº›</h4><h4 id="90-ä½¿ç”¨promiseå°è£…ajax"><a href="#90-ä½¿ç”¨promiseå°è£…ajax" class="headerlink" title="90.ä½¿ç”¨promiseå°è£…ajax"></a>90.ä½¿ç”¨promiseå°è£…ajax</h4><h4 id="91-å†™ä¸€ä¸ªvueçš„è‡ªå®šä¹‰æŒ‡ä»¤"><a href="#91-å†™ä¸€ä¸ªvueçš„è‡ªå®šä¹‰æŒ‡ä»¤" class="headerlink" title="91.å†™ä¸€ä¸ªvueçš„è‡ªå®šä¹‰æŒ‡ä»¤"></a>91.å†™ä¸€ä¸ªvueçš„è‡ªå®šä¹‰æŒ‡ä»¤</h4><h4 id="92-vuexçš„åŸç†ï¼Œæ•°æ®å­˜å‚¨åœ¨å“ªé‡Œ"><a href="#92-vuexçš„åŸç†ï¼Œæ•°æ®å­˜å‚¨åœ¨å“ªé‡Œ" class="headerlink" title="92.vuexçš„åŸç†ï¼Œæ•°æ®å­˜å‚¨åœ¨å“ªé‡Œ"></a>92.vuexçš„åŸç†ï¼Œæ•°æ®å­˜å‚¨åœ¨å“ªé‡Œ</h4><h4 id="93-è¯´ä¸€ä¸‹hrefå’Œsrcçš„åŒºåˆ«"><a href="#93-è¯´ä¸€ä¸‹hrefå’Œsrcçš„åŒºåˆ«" class="headerlink" title="93.è¯´ä¸€ä¸‹hrefå’Œsrcçš„åŒºåˆ«"></a>93.è¯´ä¸€ä¸‹hrefå’Œsrcçš„åŒºåˆ«</h4><h4 id="94-è¯´ä¸€ä¸‹ä½ çŸ¥é“çš„webpackæ‰“åŒ…æ„å»ºçš„ä¼˜åŒ–"><a href="#94-è¯´ä¸€ä¸‹ä½ çŸ¥é“çš„webpackæ‰“åŒ…æ„å»ºçš„ä¼˜åŒ–" class="headerlink" title="94.è¯´ä¸€ä¸‹ä½ çŸ¥é“çš„webpackæ‰“åŒ…æ„å»ºçš„ä¼˜åŒ–"></a>94.è¯´ä¸€ä¸‹ä½ çŸ¥é“çš„webpackæ‰“åŒ…æ„å»ºçš„ä¼˜åŒ–</h4><h4 id="95-è¯´ä¸€ä¸‹ä½ äº†è§£çš„pluginå’Œloader-ä»¥åŠå¦‚ä½•å»å†™ä¸€ä¸ªpluginå’Œloader"><a href="#95-è¯´ä¸€ä¸‹ä½ äº†è§£çš„pluginå’Œloader-ä»¥åŠå¦‚ä½•å»å†™ä¸€ä¸ªpluginå’Œloader" class="headerlink" title="95.è¯´ä¸€ä¸‹ä½ äº†è§£çš„pluginå’Œloader,ä»¥åŠå¦‚ä½•å»å†™ä¸€ä¸ªpluginå’Œloader"></a>95.è¯´ä¸€ä¸‹ä½ äº†è§£çš„pluginå’Œloader,ä»¥åŠå¦‚ä½•å»å†™ä¸€ä¸ªpluginå’Œloader</h4><h4 id="96-è¯´ä¸€ä¸‹transformçš„åŸç†-å…ˆå¹³ç§»å†æ—‹è½¬å’Œå…ˆæ—‹è½¬å†å¹³ç§»æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#96-è¯´ä¸€ä¸‹transformçš„åŸç†-å…ˆå¹³ç§»å†æ—‹è½¬å’Œå…ˆæ—‹è½¬å†å¹³ç§»æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="96.è¯´ä¸€ä¸‹transformçš„åŸç†(å…ˆå¹³ç§»å†æ—‹è½¬å’Œå…ˆæ—‹è½¬å†å¹³ç§»æœ‰ä»€ä¹ˆåŒºåˆ«)"></a>96.è¯´ä¸€ä¸‹transformçš„åŸç†(å…ˆå¹³ç§»å†æ—‹è½¬å’Œå…ˆæ—‹è½¬å†å¹³ç§»æœ‰ä»€ä¹ˆåŒºåˆ«)</h4><h4 id="97-å‡½æ•°å’Œå¯¹è±¡åŠå…¶ä¸Šä¸‹æ–‡å­˜å‚¨åœ¨å“ªé‡Œ"><a href="#97-å‡½æ•°å’Œå¯¹è±¡åŠå…¶ä¸Šä¸‹æ–‡å­˜å‚¨åœ¨å“ªé‡Œ" class="headerlink" title="97.å‡½æ•°å’Œå¯¹è±¡åŠå…¶ä¸Šä¸‹æ–‡å­˜å‚¨åœ¨å“ªé‡Œ"></a>97.å‡½æ•°å’Œå¯¹è±¡åŠå…¶ä¸Šä¸‹æ–‡å­˜å‚¨åœ¨å“ªé‡Œ</h4><h4 id="98-æ‰‹å†™è™šæ‹Ÿdomè½¬æ¢æˆçœŸå®çš„dom"><a href="#98-æ‰‹å†™è™šæ‹Ÿdomè½¬æ¢æˆçœŸå®çš„dom" class="headerlink" title="98.æ‰‹å†™è™šæ‹Ÿdomè½¬æ¢æˆçœŸå®çš„dom"></a>98.æ‰‹å†™è™šæ‹Ÿdomè½¬æ¢æˆçœŸå®çš„dom</h4><h4 id="99-ä¸ºä»€ä¹ˆä¸€ä¸ªç½‘ç«™çš„èµ„æºä¼šå­˜å‚¨åœ¨å¤šä¸ªåŸŸåä¸­"><a href="#99-ä¸ºä»€ä¹ˆä¸€ä¸ªç½‘ç«™çš„èµ„æºä¼šå­˜å‚¨åœ¨å¤šä¸ªåŸŸåä¸­" class="headerlink" title="99.ä¸ºä»€ä¹ˆä¸€ä¸ªç½‘ç«™çš„èµ„æºä¼šå­˜å‚¨åœ¨å¤šä¸ªåŸŸåä¸­"></a>99.ä¸ºä»€ä¹ˆä¸€ä¸ªç½‘ç«™çš„èµ„æºä¼šå­˜å‚¨åœ¨å¤šä¸ªåŸŸåä¸­</h4><h4 id="100-å¦‚ä½•å®ç°å‰ç«¯çš„æƒé™æ§åˆ¶"><a href="#100-å¦‚ä½•å®ç°å‰ç«¯çš„æƒé™æ§åˆ¶" class="headerlink" title="100.å¦‚ä½•å®ç°å‰ç«¯çš„æƒé™æ§åˆ¶"></a>100.å¦‚ä½•å®ç°å‰ç«¯çš„æƒé™æ§åˆ¶</h4><h4 id="101-è¯´ä¸€ä¸‹vue3ç›¸å¯¹äºvue2çš„ä¼˜åŒ–"><a href="#101-è¯´ä¸€ä¸‹vue3ç›¸å¯¹äºvue2çš„ä¼˜åŒ–" class="headerlink" title="101.è¯´ä¸€ä¸‹vue3ç›¸å¯¹äºvue2çš„ä¼˜åŒ–"></a>101.è¯´ä¸€ä¸‹vue3ç›¸å¯¹äºvue2çš„ä¼˜åŒ–</h4><h4 id="102-è¯´ä¸€ä¸‹viteç›¸å¯¹äºwebpackçš„ä¼˜åŒ–"><a href="#102-è¯´ä¸€ä¸‹viteç›¸å¯¹äºwebpackçš„ä¼˜åŒ–" class="headerlink" title="102.è¯´ä¸€ä¸‹viteç›¸å¯¹äºwebpackçš„ä¼˜åŒ–"></a>102.è¯´ä¸€ä¸‹viteç›¸å¯¹äºwebpackçš„ä¼˜åŒ–</h4><h4 id="103-å®ç°vueä¸­templateç”Ÿæˆè™šæ‹Ÿdom"><a href="#103-å®ç°vueä¸­templateç”Ÿæˆè™šæ‹Ÿdom" class="headerlink" title="103.å®ç°vueä¸­templateç”Ÿæˆè™šæ‹Ÿdom"></a>103.å®ç°vueä¸­templateç”Ÿæˆè™šæ‹Ÿdom</h4><h4 id="104-çŸ¥é“http499æ˜¯ä»€ä¹ˆ"><a href="#104-çŸ¥é“http499æ˜¯ä»€ä¹ˆ" class="headerlink" title="104.çŸ¥é“http499æ˜¯ä»€ä¹ˆ"></a>104.çŸ¥é“http499æ˜¯ä»€ä¹ˆ</h4><p>è¡¨ç¤ºå®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œå³HTTP 499 Client Closed Request,HTTP 499 è¡¨ç¤ºnginxä½¿ç”¨éæ ‡å‡†çŠ¶æ€ç ã€‚è¡¨æ˜å½“nginxæ­£åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯å…³é—­äº†è¿æ¥</p><h4 id="105-è¯´ä¸€è¯´mataæ ‡ç­¾çš„ä½œç”¨"><a href="#105-è¯´ä¸€è¯´mataæ ‡ç­¾çš„ä½œç”¨" class="headerlink" title="105.è¯´ä¸€è¯´mataæ ‡ç­¾çš„ä½œç”¨"></a>105.è¯´ä¸€è¯´mataæ ‡ç­¾çš„ä½œç”¨</h4><p>metaå…ƒç´ ç”¨æ¥å®šä¹‰å…ƒæ•°æ®çš„ï¼Œmetaæ ‡ç­¾ç”¨äºå®šä¹‰ä¸èƒ½ç”¨å…¶ä»–å…ƒæ•°æ®å…ƒç´ å®šä¹‰çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œheaderä¸­å®šä¹‰å…ƒæ•°æ®çš„æ ‡ç­¾æœ‰style,link,titleç­‰ï¼Œä¸èƒ½ç”¨è¿™äº›æ ‡ç­¾å®šä¹‰çš„æ•°æ®ï¼Œå°±å†™åœ¨metaä¸­ã€‚</p><p>metaå…ƒç´ å®šä¹‰çš„å…ƒæ•°æ®çš„ç±»å‹åŒ…æ‹¬ä»¥ä¸‹å‡ ç±»</p><p>å¦‚æœè®¾ç½®äº†charset metaå…ƒç´ å°±æ˜¯ä¸€ä¸ªå­—ç¬¦é›†å£°æ˜ï¼Œå‘Šè¯‰æ–‡æ¡£ä½¿ç”¨é‚£ç§å­—ç¬¦ç¼–ç </p><p>å¦‚æœè®¾ç½®äº†http-equivå±æ€§ï¼Œmetaå…ƒç´ åˆ™æ˜¯ç¼–è¯‘æŒ‡ä»¤  ä¸»è¦æ˜¯åšå…¼å®¹æ€§å¤„ç†ï¼Œå‘Šè¯‰IEæµè§ˆå™¨å»æ¨¡ä»¿é‚£ä¸ªæµè§ˆå™¨çš„è¡Œä¸ºï¼ŒIEæ¨¡ä»¿edgeçš„è¡Œä¸ºï¼Œchromeä½¿ç”¨1</p><div class="code-wrapper"><pre><code class="hljs routeros">&lt;meta <span class="hljs-attribute">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-string">&quot;IE=edge,chrome=1&quot;</span>&gt;</code></pre></div><p>å¦‚æœè®¾ç½®äº†nameå±æ€§ï¼Œmetaå…ƒç´ æä¾›çš„æ˜¯æ–‡æ¡£çº§åˆ«çš„å…ƒæ•°æ®ï¼Œåº”ç”¨äºæ•´ä¸ªé¡µé¢</p><h4 id="106-è¯´ä¸€ä¸‹cssçš„ä¼˜å…ˆçº§ï¼Œimportantçš„ç¼ºç‚¹"><a href="#106-è¯´ä¸€ä¸‹cssçš„ä¼˜å…ˆçº§ï¼Œimportantçš„ç¼ºç‚¹" class="headerlink" title="106.è¯´ä¸€ä¸‹cssçš„ä¼˜å…ˆçº§ï¼Œimportantçš„ç¼ºç‚¹"></a>106.è¯´ä¸€ä¸‹cssçš„ä¼˜å…ˆçº§ï¼Œimportantçš„ç¼ºç‚¹</h4><p>cssçš„ä¼˜å…ˆçº§æ˜¯æŒ‰ç…§cssçš„æƒé‡æ¥å åŠ çš„ï¼Œ</p><p>ï¼important  10000</p><p>å†…è”æ ·å¼ 1000</p><p>idé€‰æ‹©å™¨ 100</p><p>ç±»é€‰æ‹©å™¨ï¼Œå±æ€§é€‰æ‹©æƒï¼Œä¼ªç±»  10</p><p>å…ƒç´ é€‰æ‹©å™¨ï¼Œä¼ªå…ƒç´  1</p><p>é€šé…ç¬¦ 0</p><p>é€šè¿‡å„é¡¹å åŠ æ¥è®¡ç®—cssçš„ä¼˜å…ˆçº§</p><p>importantçš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œåœ¨å…¨å±€å’Œç»„ä»¶ä¸­è¦è°¨æ…ä½¿ç”¨ï¼Œåœ¨å¯¹ä¸€äº›ç»§æ‰¿å±æ€§ä½¿ç”¨importantï¼Œåœ¨ä¿®æ”¹è¿™ä¸ªå±æ€§çš„æ—¶å€™éœ€è¦å†æ¬¡æ·»åŠ importantï¼Œå¯èƒ½ä¼šé€ æˆæ··ä¹±</p><h4 id="107-è¯´ä¸€ä¸‹å“åº”å¼å¸ƒå±€"><a href="#107-è¯´ä¸€ä¸‹å“åº”å¼å¸ƒå±€" class="headerlink" title="107.è¯´ä¸€ä¸‹å“åº”å¼å¸ƒå±€"></a>107.è¯´ä¸€ä¸‹å“åº”å¼å¸ƒå±€</h4><h4 id="108-å†™ä¸€ä¸ªè¿”å›æ•°æ®ç±»å‹çš„å‡½æ•°ï¼Œè¦æ±‚è‡ªå®šä¹‰çš„ç±»å®ä¾‹åŒ–çš„å¯¹è±¡è¿”å›å®šä¹‰çš„ç±»å"><a href="#108-å†™ä¸€ä¸ªè¿”å›æ•°æ®ç±»å‹çš„å‡½æ•°ï¼Œè¦æ±‚è‡ªå®šä¹‰çš„ç±»å®ä¾‹åŒ–çš„å¯¹è±¡è¿”å›å®šä¹‰çš„ç±»å" class="headerlink" title="108.å†™ä¸€ä¸ªè¿”å›æ•°æ®ç±»å‹çš„å‡½æ•°ï¼Œè¦æ±‚è‡ªå®šä¹‰çš„ç±»å®ä¾‹åŒ–çš„å¯¹è±¡è¿”å›å®šä¹‰çš„ç±»å"></a>108.å†™ä¸€ä¸ªè¿”å›æ•°æ®ç±»å‹çš„å‡½æ•°ï¼Œè¦æ±‚è‡ªå®šä¹‰çš„ç±»å®ä¾‹åŒ–çš„å¯¹è±¡è¿”å›å®šä¹‰çš„ç±»å</h4><h4 id="109-è¯´ä¸€ä¸‹jsçš„äº‹ä»¶å¾ªç¯å’Œnodeäº‹ä»¶å¾ªç¯çš„åŒºåˆ«"><a href="#109-è¯´ä¸€ä¸‹jsçš„äº‹ä»¶å¾ªç¯å’Œnodeäº‹ä»¶å¾ªç¯çš„åŒºåˆ«" class="headerlink" title="109.è¯´ä¸€ä¸‹jsçš„äº‹ä»¶å¾ªç¯å’Œnodeäº‹ä»¶å¾ªç¯çš„åŒºåˆ«"></a>109.è¯´ä¸€ä¸‹jsçš„äº‹ä»¶å¾ªç¯å’Œnodeäº‹ä»¶å¾ªç¯çš„åŒºåˆ«</h4><p>jsçš„äº‹ä»¶å¾ªç¯æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­çš„ï¼Œnodeäº‹ä»¶å¾ªç¯æ˜¯è¿è¡Œåœ¨nodeç¯å¢ƒä¸­çš„</p><p>æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªæˆ‘ä»¬ç¼–å†™çš„javascriptä»£ç å’Œæµè§ˆå™¨apiè°ƒç”¨(setTimeout/ajax/äº‹ä»¶ç›‘å¬)çš„æ¡¥æ¢ï¼Œæ¡¥æ¢ä¹‹é—´ä»–ä»¬ç”¨å›è°ƒå‡½æ•°è¿›è¡Œæ²Ÿé€š</p><p>nodeäº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªæˆ‘ä»¬ç¼–å†™çš„javascriptä»£ç å’Œç³»ç»Ÿè°ƒç”¨(file syatem network)ä¹‹é—´çš„æ¡¥æ¢ï¼Œæ¡¥æ¢ä¹‹é—´é€šè¿‡å›è°ƒå‡½æ•°è¿›è¡Œæ²Ÿé€š</p><p>æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯ï¼š</p><p>â€‹    é¦–å…ˆä¼šåœ¨å‡½æ•°æ‰§è¡Œè°ƒç”¨æ ˆä¸­æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œå¦‚æœæ‰§è¡Œåˆ°å®šæ—¶å™¨ä¼šå…ˆå°†å®šæ—¶å™¨æŒ‚èµ·ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œæ‰§è¡Œåˆ°å¾®ä»»åŠ¡ä»£ç ï¼Œåˆ™å…ˆè¿›å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œåˆ°å®ä»»åŠ¡ï¼Œåˆ™è¿›å…¥å®ä»»åŠ¡é˜Ÿåˆ—ï¼ŒåŒæ­¥ä»£ç æ‰§è¡Œå®Œæˆåï¼Œåˆ™ä¼šå¼€å§‹æ‰§è¡Œå¼‚æ­¥é˜Ÿåˆ—ä¸­çš„ä»£ç ï¼Œå…ˆæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¹‹æ˜Ÿå®Œååœ¨æ‰§è¡Œå®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰å®šæ—¶å™¨æ‰§è¡Œå®Œåï¼Œåˆ™è¿›å…¥å®ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œï¼Œå¦‚æ­¤å¾€å¤ç›´åˆ°æ‰§è¡Œå®Œæˆ</p><p>å®ä»»åŠ¡é˜Ÿåˆ—ï¼šajaxï¼ŒsetTimeout ï¼ŒsetIntervalï¼ŒDOMç›‘å¬ï¼ŒUIrenderingç­‰</p><p>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼šPromiseçš„thenå›è°ƒï¼ŒMutation observer api queueMicrotask() async/awaitç­‰</p><p>nodeçš„äº‹ä»¶å¾ªç¯æ˜¯ç”±libuvæ¥å®ç°çš„ï¼Œlibuvé‡‡ç”¨çš„å°±æ˜¯éé˜»å¡å¼‚æ­¥IOçš„è°ƒç”¨æ–¹å¼</p><p>nodeäº‹ä»¶å¾ªç¯åˆ†æˆå¾ˆå¤šä¸ªé˜¶æ®µ</p><p>å®šæ—¶å™¨(Timer):setTimeOut ï¼ŒsetIterval</p><p>å¾…å®šå›è°ƒï¼ˆpending callbackï¼‰ å¯¹æŸäº›ç³»ç»Ÿæ“ä½œï¼ˆå¦‚TCPé”™è¯¯ç±»å‹ï¼‰æ‰§è¡Œå›è°ƒï¼Œæ¯”å¦‚TCPè¿æ¥æ—¶æ¥æ”¶åˆ° ECONNREFUSED</p><p>idle,prepare:è¿›å†…éƒ¨ä½¿ç”¨</p><p>è½®è¯¢ï¼šæ£€ç´¢æ–°çš„I/Oäº‹ä»¶ï¼Œæ‰§è¡Œä¸IOæœ‰å…³çš„å›è°ƒ</p><p>æ£€æµ‹ï¼šsetImmediate()å›è°ƒå‡½æ•°åœ¨è¿™é‡Œæ‰§è¡Œ</p><p>å…³é—­å›è°ƒå‡½æ•°:ä¸€äº›å…³é—­çš„å›è°ƒå‡½æ•°ï¼Œå¦‚socket.on(â€˜closeâ€™,)</p><p>nodeçš„äº‹ä»¶çš„å¾ªç¯æ›´åŠ å¤æ‚ï¼Œä»–ä¹Ÿåˆ†ä¸ºå¾®ä»»åŠ¡å’Œå®ä»»åŠ¡</p><p>å®ä»»åŠ¡ï¼šsetTimeout,setInterval,IOäº‹ä»¶ï¼ŒsetImmediate,closeäº‹ä»¶</p><p>å¾®ä»»åŠ¡ï¼špromise.then,async/awiat,process.nextTick,queueMicrotask</p><p>Nodeä¸­çš„äº‹ä»¶å¾ªç¯ä¸åªæ˜¯ å¾®ä»»åŠ¡é˜Ÿåˆ—å’Œ å®ä»»åŠ¡é˜Ÿåˆ—ï¼š</p><p>â€‹    å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š </p><p>â€‹        next tick queueï¼šprocess.nextTickï¼› </p><p>â€‹        other queueï¼šPromiseçš„thenå›è°ƒã€queueMicrotaskï¼›</p><p>â€‹    å®ä»»åŠ¡é˜Ÿåˆ—ï¼š </p><p>â€‹         timer queueï¼šsetTimeoutã€setIntervalï¼› </p><p>â€‹        poll queueï¼šIOäº‹ä»¶ï¼›</p><p>â€‹        check queueï¼šsetImmediateï¼› Ã¼ close queueï¼šcloseäº‹ä»¶</p><p>æ‰§è¡Œå®ä»»åŠ¡çš„æ—¶å€™éƒ½å¿…é¡»å…ˆåˆ¤æ–­å¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰å€¼</p><h4 id="110-å®ç°ä¸€ä¸ªæŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆå†™ä»£ç ï¼‰"><a href="#110-å®ç°ä¸€ä¸ªæŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆå†™ä»£ç ï¼‰" class="headerlink" title="110.å®ç°ä¸€ä¸ªæŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆå†™ä»£ç ï¼‰"></a>110.å®ç°ä¸€ä¸ªæŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆå†™ä»£ç ï¼‰</h4><h4 id="111-å®ç°å‡½æ•°çš„é“¾å¼è°ƒç”¨ï¼ˆå†™ä»£ç ï¼Œcomposeå‡½æ•°ï¼‰"><a href="#111-å®ç°å‡½æ•°çš„é“¾å¼è°ƒç”¨ï¼ˆå†™ä»£ç ï¼Œcomposeå‡½æ•°ï¼‰" class="headerlink" title="111.å®ç°å‡½æ•°çš„é“¾å¼è°ƒç”¨ï¼ˆå†™ä»£ç ï¼Œcomposeå‡½æ•°ï¼‰"></a>111.å®ç°å‡½æ•°çš„é“¾å¼è°ƒç”¨ï¼ˆå†™ä»£ç ï¼Œcomposeå‡½æ•°ï¼‰</h4><h4 id="112-å¦‚ä½•é…ç½®lessæ–‡ä»¶çš„loader"><a href="#112-å¦‚ä½•é…ç½®lessæ–‡ä»¶çš„loader" class="headerlink" title="112.å¦‚ä½•é…ç½®lessæ–‡ä»¶çš„loader"></a>112.å¦‚ä½•é…ç½®lessæ–‡ä»¶çš„loader</h4><div class="code-wrapper"><pre><code class="hljs cmake"><span class="hljs-keyword">test</span>:/\.<span class="hljs-keyword">less</span>$/,use:[style-loader,css-loader,postcss-loader,<span class="hljs-keyword">less</span>-loader]</code></pre></div><h4 id="113-webpackæ˜¯å¦‚ä½•åšåˆ°ä¸€æ­¥æ­¥å¤„ç†loaderæ–‡ä»¶çš„"><a href="#113-webpackæ˜¯å¦‚ä½•åšåˆ°ä¸€æ­¥æ­¥å¤„ç†loaderæ–‡ä»¶çš„" class="headerlink" title="113.webpackæ˜¯å¦‚ä½•åšåˆ°ä¸€æ­¥æ­¥å¤„ç†loaderæ–‡ä»¶çš„"></a>113.webpackæ˜¯å¦‚ä½•åšåˆ°ä¸€æ­¥æ­¥å¤„ç†loaderæ–‡ä»¶çš„</h4><h4 id="114-ä¸ºä»€ä¹ˆwebpackæ˜¯è‡ªä¸Šè€Œä¸‹æ‰§è¡Œçš„"><a href="#114-ä¸ºä»€ä¹ˆwebpackæ˜¯è‡ªä¸Šè€Œä¸‹æ‰§è¡Œçš„" class="headerlink" title="114.ä¸ºä»€ä¹ˆwebpackæ˜¯è‡ªä¸Šè€Œä¸‹æ‰§è¡Œçš„"></a>114.ä¸ºä»€ä¹ˆwebpackæ˜¯è‡ªä¸Šè€Œä¸‹æ‰§è¡Œçš„</h4><h4 id="115-å®ç°é˜²æŠ–å’ŒèŠ‚æµå‡½æ•°ï¼ˆå†™ä»£ç ï¼‰"><a href="#115-å®ç°é˜²æŠ–å’ŒèŠ‚æµå‡½æ•°ï¼ˆå†™ä»£ç ï¼‰" class="headerlink" title="115.å®ç°é˜²æŠ–å’ŒèŠ‚æµå‡½æ•°ï¼ˆå†™ä»£ç ï¼‰"></a>115.å®ç°é˜²æŠ–å’ŒèŠ‚æµå‡½æ•°ï¼ˆå†™ä»£ç ï¼‰</h4><h4 id="116-å¦‚ä½•ç”¨csså®ç°ä¸¤æ å¸ƒå±€"><a href="#116-å¦‚ä½•ç”¨csså®ç°ä¸¤æ å¸ƒå±€" class="headerlink" title="116.å¦‚ä½•ç”¨csså®ç°ä¸¤æ å¸ƒå±€"></a>116.å¦‚ä½•ç”¨csså®ç°ä¸¤æ å¸ƒå±€</h4><h4 id="117-è¯´ä¸€ä¸‹cssçš„positionå®šä½"><a href="#117-è¯´ä¸€ä¸‹cssçš„positionå®šä½" class="headerlink" title="117.è¯´ä¸€ä¸‹cssçš„positionå®šä½"></a>117.è¯´ä¸€ä¸‹cssçš„positionå®šä½</h4><p>è¿ç”¨positionè¿›è¡Œå®šä½ï¼Œå¸¸å–å¾—5ä¸ªå€¼æ˜¯ï¼š    static relative absolute fixed  sticky</p><p>positionçš„é»˜è®¤å€¼å°±æ˜¯static</p><p>ä½¿ç”¨å…¶ä»–å±æ€§å€¼å¯ä»¥è®©positionå˜æˆå®šä½å…ƒç´ </p><p>relative:ä¼šæŒ‰ç…§æ ‡å‡†æ–‡æ¡£æµè¿›è¡Œå¸ƒå±€ï¼Œå¯ä»¥é€šè¿‡left right top bottom æ¥è¿›è¡Œå®šä½ï¼Œå‚ç…§å¯¹è±¡æ˜¯å…ƒç´ åŸæ¥çš„ä½ç½®</p><p>fixedï¼šå…ƒç´ ä¼šè„±ç¦»æ ‡å‡†æµï¼Œå¯ä»¥é€šè¿‡leftï¼Œrightï¼Œtopï¼Œbottomè¿›è¡Œå®šä½ï¼Œå‚ç…§å¯¹è±¡æ˜¯è§†å£ã€‚ä¾‹å¦‚ç”»å¸ƒæ»šåŠ¨æ—¶ï¼Œå…ƒç´ ä¸åŠ¨</p><p>absoluteï¼šå…ƒç´ ä¼šè„±ç¦»æ–‡æ¡£æµï¼Œå¯ä»¥é€šè¿‡leftï¼Œrightï¼Œtopï¼Œbottomè¿›è¡Œå®šä½ï¼Œå‚ç…§å¯¹è±¡æ˜¯æœ€è¿‘å®šä½ï¼ˆpositionä¸ä¸ºstaticçš„å…ƒç´ ï¼‰çš„ç¥–å…ˆå…ƒç´ ï¼Œå¦åˆ™å°±ä¼šç›¸å¯¹äºè§†å£è¿›è¡Œå®šä½</p><h4 id="118-è¯´ä¸€ä¸‹jsçš„ä½œç”¨åŸŸ"><a href="#118-è¯´ä¸€ä¸‹jsçš„ä½œç”¨åŸŸ" class="headerlink" title="118.è¯´ä¸€ä¸‹jsçš„ä½œç”¨åŸŸ"></a>118.è¯´ä¸€ä¸‹jsçš„ä½œç”¨åŸŸ</h4><p>jsçš„ä½œç”¨åŸŸæœ‰å…¨å±€ä½œç”¨åŸŸï¼Œå‡½æ•°ä½œç”¨åŸŸï¼Œevalä½œç”¨åŸŸï¼Œå—çº§ä½œç”¨åŸŸ</p><p>å…¨å±€ä½œç”¨åŸŸå°±æ˜¯æœ€é¡¶å±‚çš„ä½œç”¨åŸŸï¼Œæ‰€æœ‰å˜é‡éƒ½å¯ä»¥è®¿é—®åˆ°ï¼Œå‡½æ•°ä½œç”¨åŸŸå°±æ˜¯æ¯ä¸ªå‡½æ•°å†…éƒ¨çš„ä½œç”¨åŸŸï¼Œevalä½œç”¨åŸŸå°±æ˜¯evalå‡½æ•°å†…éƒ¨çš„ä½œç”¨åŸŸï¼Œes6æ–°å¢äº†å—çº§ä½œç”¨åŸŸï¼Œå—çº§ä½œç”¨åŸŸæ˜¯å‡½æ•°ä½œç”¨åŸŸçš„å­é›†</p><h4 id="119-è¯´ä¸€ä¸‹jsçš„importå’Œnodeçš„requireçš„åŒºåˆ«"><a href="#119-è¯´ä¸€ä¸‹jsçš„importå’Œnodeçš„requireçš„åŒºåˆ«" class="headerlink" title="119.è¯´ä¸€ä¸‹jsçš„importå’Œnodeçš„requireçš„åŒºåˆ«"></a>119.è¯´ä¸€ä¸‹jsçš„importå’Œnodeçš„requireçš„åŒºåˆ«</h4><h4 id="120-è¯´ä¸€ä¸‹ä½ äº†è§£çš„jsçš„æ•°ç»„çš„å¸¸ç”¨æ–¹æ³•"><a href="#120-è¯´ä¸€ä¸‹ä½ äº†è§£çš„jsçš„æ•°ç»„çš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="120.è¯´ä¸€ä¸‹ä½ äº†è§£çš„jsçš„æ•°ç»„çš„å¸¸ç”¨æ–¹æ³•"></a>120.è¯´ä¸€ä¸‹ä½ äº†è§£çš„jsçš„æ•°ç»„çš„å¸¸ç”¨æ–¹æ³•</h4><p>æ•°ç»„å¸¸ç”¨çš„æ–¹æ³•æœ‰</p><p>Array.prototype.join()</p><p>Array.prototype.concat()</p><p>Array.prototype.slice()</p><p>Array.prototype.splice()</p><p>Array.prototype.push()</p><p>Array.prototype.shift()</p><p>Array.prototype.unshift()</p><p>Array.isArray()</p><p>Array.prototype.pop()</p><p>Array.prototype.map()</p><p>Array.prototype.forEach()</p><p>Array.prototype.reduce()</p><p>Array.prototype.sort()</p><p>Array.prototype.some()</p><p>Array.prototype.every()</p><p>Array.prototype.entry()</p><p>Array.prototype.find()</p><p>Array.prototype.findIndex()</p><p>Array.prototype.flat()/flatMap()</p><p>Array.prototype.indexOf()</p><p>Array.prototype.includes()</p><p>Array.from()</p><p>Array.of()</p><p>Array.prototype.toString()</p><p>Array.prototype.values()</p><h4 id="121-è¯´ä¸€ä¸‹GETå’ŒPOSTçš„åŒºåˆ«"><a href="#121-è¯´ä¸€ä¸‹GETå’ŒPOSTçš„åŒºåˆ«" class="headerlink" title="121.è¯´ä¸€ä¸‹GETå’ŒPOSTçš„åŒºåˆ«"></a>121.è¯´ä¸€ä¸‹GETå’ŒPOSTçš„åŒºåˆ«</h4><ul><li>GETåœ¨æµè§ˆå™¨å›é€€æ—¶æ˜¯æ— å®³çš„ï¼Œè€ŒPOSTä¼šå†æ¬¡æäº¤è¯·æ±‚</li><li>GETè¯·æ±‚ä¼šè¢«æµè§ˆå™¨ä¸»åŠ¨ç¼“å­˜ï¼Œè€ŒPOSTä¸ä¼šï¼Œé™¤éæ‰‹åŠ¨è®¾ç½®</li><li>GETè¯·æ±‚å‚æ•°ä¼šè¢«å®Œæ•´ä¿ç•™åœ¨æµè§ˆå™¨çš„å†å²è®°å½•é‡Œï¼Œè€ŒPOSTä¸­çš„å‚æ•°ä¸ä¼šè¢«ä¿ç•™</li><li>GETè¯·æ±‚åœ¨URLä¸­ä¼ é€çš„å‚æ•°æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œè€ŒPOSTæ²¡æœ‰é™åˆ¶</li><li>GETå‚æ•°é€šè¿‡URLä¼ é€’ï¼ŒPOSTæ”¾åœ¨Request bodyä¸­</li><li>GETè¯·æ±‚åªèƒ½è¿›è¡Œ url ç¼–ç ï¼Œè€ŒPOSTæ”¯æŒå¤šç§ç¼–ç æ–¹å¼</li><li>GETäº§ç”Ÿçš„URLåœ°å€å¯ä»¥è¢«æ”¶è—ï¼Œè€ŒPOSTä¸å¯ä»¥</li><li>å¯¹å‚æ•°çš„æ•°æ®ç±»å‹ï¼ŒGETåªæ¥å—ASCIIå­—ç¬¦ï¼Œè€ŒPOSTæ²¡æœ‰é™åˆ¶</li><li>GETæ¯”POSTæ›´ä¸å®‰å…¨ï¼Œå› ä¸ºå‚æ•°ç›´æ¥æš´éœ²åœ¨URLä¸Šï¼Œæ‰€ä»¥ä¸èƒ½ç”¨æ¥ä¼ é€’æ•æ„Ÿä¿¡æ¯</li></ul><h4 id="123-è¯´ä¸€ä¸‹pxï¼Œremï¼Œemçš„åŒºåˆ«å’Œè”ç³»"><a href="#123-è¯´ä¸€ä¸‹pxï¼Œremï¼Œemçš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="123.è¯´ä¸€ä¸‹pxï¼Œremï¼Œemçš„åŒºåˆ«å’Œè”ç³»"></a>123.è¯´ä¸€ä¸‹pxï¼Œremï¼Œemçš„åŒºåˆ«å’Œè”ç³»</h4><p>pxæ˜¯ç»å¯¹é•¿åº¦å•ä½ï¼Œremï¼Œemæ˜¯ç›¸å¯¹é•¿åº¦å•ä½ï¼Œemæ˜¯ç›¸å¯¹äºå…ƒç´ æœ¬èº«çš„font-sizeæ¥è¿›è¡Œå®šä½çš„ï¼Œå¦‚æœæœ¬èº«æ²¡æœ‰font-sizeåˆ™ä¼šç»§æ‰¿è‡ªçˆ¶å…ƒç´ çš„font-sizeï¼Œremæ˜¯æ ¹æ®æ ¹å…ƒç´ çš„font-size</p><h4 id="124-è¯´ä¸€ä¸‹instanceofçš„åŸç†"><a href="#124-è¯´ä¸€ä¸‹instanceofçš„åŸç†" class="headerlink" title="124.è¯´ä¸€ä¸‹instanceofçš„åŸç†"></a>124.è¯´ä¸€ä¸‹instanceofçš„åŸç†</h4><p>é€šè¿‡åˆ¤æ–­instanceçš„[[prototype]]æ˜¯å¦å’ŒåŸå‹é“¾ä¸Šçš„åŸå‹æ˜¯å¦åŒ¹é…</p><h4 id="125-è¯´ä¸€ä¸‹thisçš„æŒ‡å‘æœ‰å‡ ç§æ–¹å¼"><a href="#125-è¯´ä¸€ä¸‹thisçš„æŒ‡å‘æœ‰å‡ ç§æ–¹å¼" class="headerlink" title="125.è¯´ä¸€ä¸‹thisçš„æŒ‡å‘æœ‰å‡ ç§æ–¹å¼"></a>125.è¯´ä¸€ä¸‹thisçš„æŒ‡å‘æœ‰å‡ ç§æ–¹å¼</h4><p>1.é»˜è®¤ç»‘å®š  thisé»˜è®¤æ˜¯æŒ‡å‘å…¨å±€ï¼Œæµè§ˆå™¨ä¸­thisæŒ‡å‘window,nodeä¸­thisæŒ‡å‘global  åœ¨ç”±äºå…¼å®¹æ€§è€ƒè™‘å¯ä»¥ä½¿ç”¨globalThis  åœ¨å‡½æ•°å£°æ˜ä¸­ï¼Œthiså°±æ˜¯é»˜è®¤ç»‘å®š</p><p>2.éšå¼ç»‘å®š  åœ¨å¯¹è±¡ä¸­thisæ˜¯æŒ‡å‘è°ƒç”¨çš„å˜é‡</p><p>3.æ˜¾ç¤ºç»‘å®š   å¯ä»¥ä½¿ç”¨call ,apply ,bindæ¥æŒ‡å®šthisçš„æŒ‡å‘</p><p>4.newç»‘å®š   ä½¿ç”¨newåˆ›å»ºçš„å¯¹è±¡ï¼Œæ„é€ å‡½æ•°ä¸­çš„thisä¼šæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</p><h4 id="126-è¯´ä¸€ä¸‹v-modelçš„åŸç†"><a href="#126-è¯´ä¸€ä¸‹v-modelçš„åŸç†" class="headerlink" title="126.è¯´ä¸€ä¸‹v-modelçš„åŸç†"></a>126.è¯´ä¸€ä¸‹v-modelçš„åŸç†</h4><p>v-modelå°±æ˜¯å¦‚ä¸‹çš„è¯­ç³–</p><p>å¯¹äºinputï¼Œtextareaå…ƒç´ </p><div class="code-wrapper"><pre><code class="hljs routeros">&lt;input  :<span class="hljs-attribute">value</span>=<span class="hljs-string">&quot;text&quot;</span>  @<span class="hljs-attribute">input</span>=<span class="hljs-string">&quot;event =&gt; text = event.target.value&quot;</span>&gt;</code></pre></div><p>å¯¹äºæ–‡æœ¬å…ƒç´ textï¼Œtextareaä¼šç»‘å®švalue propertyç›‘å¬inputäº‹ä»¶ï¼Œcheckboxå’Œradioä¼šç»‘å®šchecked property ç›‘å¬changeäº‹ä»¶ï¼Œselectå±æ€§ä¼šç»‘å®švalueå±æ€§ï¼Œç›‘å¬changeäº‹ä»¶</p><h4 id="127-å¦‚ä½•å°è£…ä¸€ä¸ªå¼¹çª—ç»„ä»¶ï¼Œéœ€è¦è€ƒè™‘é‚£äº›é—®é¢˜"><a href="#127-å¦‚ä½•å°è£…ä¸€ä¸ªå¼¹çª—ç»„ä»¶ï¼Œéœ€è¦è€ƒè™‘é‚£äº›é—®é¢˜" class="headerlink" title="127.å¦‚ä½•å°è£…ä¸€ä¸ªå¼¹çª—ç»„ä»¶ï¼Œéœ€è¦è€ƒè™‘é‚£äº›é—®é¢˜"></a>127.å¦‚ä½•å°è£…ä¸€ä¸ªå¼¹çª—ç»„ä»¶ï¼Œéœ€è¦è€ƒè™‘é‚£äº›é—®é¢˜</h4><h4 id="128-è¯´ä¸€ä¸‹keep-aliveçš„åŸç†ï¼Œä»¥åŠå¦‚æœè¶…å‡ºç¼“å­˜é•¿åº¦ï¼Œå¦‚ä½•å¤„ç†"><a href="#128-è¯´ä¸€ä¸‹keep-aliveçš„åŸç†ï¼Œä»¥åŠå¦‚æœè¶…å‡ºç¼“å­˜é•¿åº¦ï¼Œå¦‚ä½•å¤„ç†" class="headerlink" title="128.è¯´ä¸€ä¸‹keep-aliveçš„åŸç†ï¼Œä»¥åŠå¦‚æœè¶…å‡ºç¼“å­˜é•¿åº¦ï¼Œå¦‚ä½•å¤„ç†"></a>128.è¯´ä¸€ä¸‹keep-aliveçš„åŸç†ï¼Œä»¥åŠå¦‚æœè¶…å‡ºç¼“å­˜é•¿åº¦ï¼Œå¦‚ä½•å¤„ç†</h4><h4 id="129-è¯´ä¸€ä¸‹ä½ å¯¹jwtè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œå®ƒçš„ä¼˜ç¼ºç‚¹"><a href="#129-è¯´ä¸€ä¸‹ä½ å¯¹jwtè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œå®ƒçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="129.è¯´ä¸€ä¸‹ä½ å¯¹jwtè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œå®ƒçš„ä¼˜ç¼ºç‚¹"></a>129.è¯´ä¸€ä¸‹ä½ å¯¹jwtè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œå®ƒçš„ä¼˜ç¼ºç‚¹</h4><h4 id="130-è¯´ä¸€ä¸‹newåˆ›å»ºå®ä¾‹çš„æ—¶å€™éƒ½åšäº†ä»€ä¹ˆ"><a href="#130-è¯´ä¸€ä¸‹newåˆ›å»ºå®ä¾‹çš„æ—¶å€™éƒ½åšäº†ä»€ä¹ˆ" class="headerlink" title="130.è¯´ä¸€ä¸‹newåˆ›å»ºå®ä¾‹çš„æ—¶å€™éƒ½åšäº†ä»€ä¹ˆ"></a>130.è¯´ä¸€ä¸‹newåˆ›å»ºå®ä¾‹çš„æ—¶å€™éƒ½åšäº†ä»€ä¹ˆ</h4><p>newåˆ›å»ºå®ä¾‹çš„è¿‡ç¨‹</p><ol><li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</li><li>æ–°åˆ›å»ºçš„å¯¹è±¡çš„[[prototype]]æŒ‡å‘æ„é€ å‡½æ•°çš„prototype</li><li>æ„é€ å‡½æ•°çš„thisæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</li><li>æ‰§è¡Œæ„é€ å‡½æ•°</li><li>å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œåˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</li></ol><h4 id="131-è¯´ä¸€ä¸‹ä½ å¯¹é—­åŒ…çš„ç†è§£"><a href="#131-è¯´ä¸€ä¸‹ä½ å¯¹é—­åŒ…çš„ç†è§£" class="headerlink" title="131.è¯´ä¸€ä¸‹ä½ å¯¹é—­åŒ…çš„ç†è§£"></a>131.è¯´ä¸€ä¸‹ä½ å¯¹é—­åŒ…çš„ç†è§£</h4><h4 id="132-è¯´ä¸€ä¸‹ä½ å¯¹flexå¸ƒå±€çš„ç†è§£ï¼Œä»¥åŠå…¶ä¸­å±æ€§çš„é»˜è®¤å€¼-æœªå®Œå¾…ç»­"><a href="#132-è¯´ä¸€ä¸‹ä½ å¯¹flexå¸ƒå±€çš„ç†è§£ï¼Œä»¥åŠå…¶ä¸­å±æ€§çš„é»˜è®¤å€¼-æœªå®Œå¾…ç»­" class="headerlink" title="132.è¯´ä¸€ä¸‹ä½ å¯¹flexå¸ƒå±€çš„ç†è§£ï¼Œä»¥åŠå…¶ä¸­å±æ€§çš„é»˜è®¤å€¼(æœªå®Œå¾…ç»­)"></a>132.è¯´ä¸€ä¸‹ä½ å¯¹flexå¸ƒå±€çš„ç†è§£ï¼Œä»¥åŠå…¶ä¸­å±æ€§çš„é»˜è®¤å€¼(æœªå®Œå¾…ç»­)</h4><p>flexæ˜¯ç”¨äºæŒ‰è¡Œæˆ–è€…æŒ‰åˆ—å¸ƒå±€å…ƒç´ çš„ä¸€ç»´å¸ƒå±€æ–¹æ³•ï¼Œå…ƒç´ å¯ä»¥é€šè¿‡è†¨èƒ€ä»¥å¡«å……é¢å¤–çš„ç©ºé—´ä»¥é€‚åº”æ›´å°çš„ç©ºé—´ã€‚flexå¸ƒå±€å¯ä»¥è§£å†³åŸæ¥å¸ƒå±€çš„ä¸€äº›ç—›ç‚¹ï¼Œä¾‹å¦‚å‚ç›´å±…ä¸­å—å…ƒç´ ï¼Œä¾‹å¦‚ä½¿å®¹å™¨çš„æ‰€æœ‰å­é¡¹ç­‰åˆ†å¯ç”¨å®½åº¦ï¼Œè€Œä¸ç”¨ç®¡å…·ä½“çš„å®½é«˜ï¼Œåœ¨å¤šåˆ—å¸ƒå±€ä¸­æ‰€æœ‰åˆ—éƒ½é‡‡ç”¨ç›¸åŒçš„é«˜åº¦ï¼Œå³ä½¿ä»–ä»¬åŒ…å«çš„å†…å®¹é‡ä¸åŒã€‚</p><p>å¼€å¯äº†flexå¸ƒå±€çš„å…ƒç´ å«flex item</p><p>flex container é‡Œé¢çš„ç›´æ¥å­å…ƒç´ å«åšflex item</p><p>å½“flex conteainerä¸­çš„å­å…ƒç´ å˜æˆflex itemæ—¶ï¼Œå…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><p>â€‹    flex itemçš„å¸ƒå±€å°†å—flex containerå±æ€§çš„è®¾ç½®æ¥æ¥æ§åˆ¶å’Œå¸ƒå±€</p><p>â€‹    flex itemä¸å†ä¸¥æ ¼åŒºåˆ†å—çº§å…ƒç´ å’Œè¡Œå†…çº§å…ƒç´ </p><p>â€‹    flex item é»˜è®¤æƒ…å†µä¸‹æ˜¯åŒ…è£¹å†…å®¹çš„ï¼Œä½†æ˜¯å¯ä»¥è®¾ç½®å®½åº¦å’Œé«˜åº¦</p><p>displayï¼šflexæˆ–è€…inline-flexå¯ä»¥å˜æˆ flex-container</p><p>flex containerçš„csså±æ€§æœ‰</p><p>â€‹    flex-flow</p><p>â€‹    flex-direction</p><p>â€‹    flex-wrap</p><p>â€‹    flex-flow</p><p>â€‹    justify-content</p><p>â€‹    align-items</p><p>â€‹    align-content</p><p>åº”ç”¨åœ¨flex itemsä¸Šçš„c s så±æ€§</p><p>â€‹    flex-grow</p><p>â€‹    flex-basis</p><p>â€‹    flex-shrink</p><p>â€‹    order</p><p>â€‹    align-self</p><p>â€‹    flex</p><h4 id="133-è¯´ä¸€ä¸‹ES6çš„å—çº§ä½œç”¨åŸŸï¼ˆå¾…è¡¥å……ï¼‰"><a href="#133-è¯´ä¸€ä¸‹ES6çš„å—çº§ä½œç”¨åŸŸï¼ˆå¾…è¡¥å……ï¼‰" class="headerlink" title="133.è¯´ä¸€ä¸‹ES6çš„å—çº§ä½œç”¨åŸŸï¼ˆå¾…è¡¥å……ï¼‰"></a>133.è¯´ä¸€ä¸‹ES6çš„å—çº§ä½œç”¨åŸŸï¼ˆå¾…è¡¥å……ï¼‰</h4><p>let const function classå£°æ˜éƒ½ä¼šå½¢æˆå—çº§ä½œç”¨åŸŸï¼Œå—çº§ä½œç”¨åŸŸå¯ä»¥è®©å˜é‡å¿…é¡»å…ˆå£°æ˜å†è®¿é—®ï¼Œå¦åˆ™ä¼šå‡ºç°æš‚æ—¶æ€§æ­»åŒºã€‚å—çº§ä½œç”¨åŸŸä¸ä¼šå‡ºç°å˜é‡æå‡ã€‚ä¾‹å¦‚åœ¨setTimeOutä¸­çš„é€šè¿‡é€’å½’è·å–domèŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ç‰¹æ€§æ¥ä»£æ›¿ç«‹å³æ‰§è¡Œå‡½æ•°</p><h4 id="134-è¯´ä¸€ä¸‹asyncå’Œawaitçš„åŸç†ï¼Œgeneratorç”¨æ¥åšä»€ä¹ˆ"><a href="#134-è¯´ä¸€ä¸‹asyncå’Œawaitçš„åŸç†ï¼Œgeneratorç”¨æ¥åšä»€ä¹ˆ" class="headerlink" title="134.è¯´ä¸€ä¸‹asyncå’Œawaitçš„åŸç†ï¼Œgeneratorç”¨æ¥åšä»€ä¹ˆ"></a>134.è¯´ä¸€ä¸‹asyncå’Œawaitçš„åŸç†ï¼Œgeneratorç”¨æ¥åšä»€ä¹ˆ</h4><p>asyncå’Œawaitå°±æ˜¯generatorå’Œpromise.thençš„è¯­æ³•ç³–</p><h4 id="135-å¦‚ä½•ç”¨ES5å®ç°ES6çš„classçš„staticå’Œprivate"><a href="#135-å¦‚ä½•ç”¨ES5å®ç°ES6çš„classçš„staticå’Œprivate" class="headerlink" title="135.å¦‚ä½•ç”¨ES5å®ç°ES6çš„classçš„staticå’Œprivate"></a>135.å¦‚ä½•ç”¨ES5å®ç°ES6çš„classçš„staticå’Œprivate</h4><p>static:ES5ä¸­æ˜¯ç›´æ¥åœ¨æ„é€ å‡½æ•°ä¸­æ·»åŠ </p><p>private:é»˜è®¤ä½¿ç”¨_æ¥æ›¿ä»£ï¼Œå¹¶ä¸”å®šä¹‰get setæ–¹æ³•</p><h4 id="136-ç”¨promiseå°è£…å®ç°readfileå’Œwritefileçš„åŒæ­¥è¯·æ±‚ï¼ˆå†™ä»£ç ï¼‰"><a href="#136-ç”¨promiseå°è£…å®ç°readfileå’Œwritefileçš„åŒæ­¥è¯·æ±‚ï¼ˆå†™ä»£ç ï¼‰" class="headerlink" title="136.ç”¨promiseå°è£…å®ç°readfileå’Œwritefileçš„åŒæ­¥è¯·æ±‚ï¼ˆå†™ä»£ç ï¼‰"></a>136.ç”¨promiseå°è£…å®ç°readfileå’Œwritefileçš„åŒæ­¥è¯·æ±‚ï¼ˆå†™ä»£ç ï¼‰</h4><h4 id="137-æ‰‹å†™ES6çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆå†™ä»£ç "><a href="#137-æ‰‹å†™ES6çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆå†™ä»£ç " class="headerlink" title="137.æ‰‹å†™ES6çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆå†™ä»£ç "></a>137.æ‰‹å†™ES6çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆå†™ä»£ç </h4>]]></content>
    
    
    <categories>
      
      <category>interview</category>
      
      <category>daily</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
