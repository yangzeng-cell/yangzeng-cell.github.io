

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="å…¥é—¨ä»»ä½•å¯ä»¥ä»åº”ç”¨çŠ¶æ€ä¸­æ´¾ç”Ÿå‡ºæ¥çš„å€¼éƒ½åº”è¯¥è¢«è‡ªåŠ¨æ´¾ç”Ÿå‡ºæ¥ã€‚ MobX æ˜¯ä¸€ä¸ªèº«ç»ç™¾æˆ˜çš„åº“ï¼Œå®ƒé€šè¿‡è¿ç”¨é€æ˜çš„å‡½æ•°å¼å“åº”ç¼–ç¨‹ï¼ˆTransparent Functional Reactive Programmingï¼ŒTFRPï¼‰ä½¿çŠ¶æ€ç®¡ç†å˜å¾—ç®€å•å’Œå¯æ‰©å±•ã€‚ ğŸ˜™ ç®€å•ç›´æ¥ç¼–å†™æ— æ¨¡æ¿çš„æç®€ä»£ç æ¥ç²¾å‡†æè¿°å‡ºä½ çš„æ„å›¾ã€‚è¦æ›´æ–°ä¸€ä¸ªè®°å½•å­—æ®µï¼Ÿä½¿ç”¨ç†Ÿæ‚‰çš„ JavaScript èµ‹å€¼å°±è¡Œã€‚è¦åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°æ•°æ®ï¼Ÿä¸éœ€è¦">
<meta property="og:type" content="article">
<meta property="og:title" content="mobxçš„ä½¿ç”¨">
<meta property="og:url" content="http://example.com/2022/09/20/mobx%E7%9A%84%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="å…¥é—¨ä»»ä½•å¯ä»¥ä»åº”ç”¨çŠ¶æ€ä¸­æ´¾ç”Ÿå‡ºæ¥çš„å€¼éƒ½åº”è¯¥è¢«è‡ªåŠ¨æ´¾ç”Ÿå‡ºæ¥ã€‚ MobX æ˜¯ä¸€ä¸ªèº«ç»ç™¾æˆ˜çš„åº“ï¼Œå®ƒé€šè¿‡è¿ç”¨é€æ˜çš„å‡½æ•°å¼å“åº”ç¼–ç¨‹ï¼ˆTransparent Functional Reactive Programmingï¼ŒTFRPï¼‰ä½¿çŠ¶æ€ç®¡ç†å˜å¾—ç®€å•å’Œå¯æ‰©å±•ã€‚ ğŸ˜™ ç®€å•ç›´æ¥ç¼–å†™æ— æ¨¡æ¿çš„æç®€ä»£ç æ¥ç²¾å‡†æè¿°å‡ºä½ çš„æ„å›¾ã€‚è¦æ›´æ–°ä¸€ä¸ªè®°å½•å­—æ®µï¼Ÿä½¿ç”¨ç†Ÿæ‚‰çš„ JavaScript èµ‹å€¼å°±è¡Œã€‚è¦åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°æ•°æ®ï¼Ÿä¸éœ€è¦">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zh.mobx.js.org/assets/zh.flow.png">
<meta property="og:image" content="https://zh.mobx.js.org/assets/action-state-view.png">
<meta property="og:image" content="https://zh.mobx.js.org/assets/computed-example.png">
<meta property="og:image" content="https://zh.mobx.js.org/assets/autorun.png">
<meta property="article:published_time" content="2022-09-20T22:40:53.000Z">
<meta property="article:modified_time" content="2022-12-09T16:18:46.810Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://zh.mobx.js.org/assets/zh.flow.png">
  
  
  
  <title>mobxçš„ä½¿ç”¨ - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Piggyçš„è®°å½•ç‰ˆ</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="mobxçš„ä½¿ç”¨"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-09-20 22:40" pubdate>
          2022å¹´9æœˆ20æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          19k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          160 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">mobxçš„ä½¿ç”¨</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="å…¥é—¨"><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h2><p><em>ä»»ä½•å¯ä»¥ä»åº”ç”¨çŠ¶æ€ä¸­æ´¾ç”Ÿå‡ºæ¥çš„å€¼éƒ½åº”è¯¥è¢«è‡ªåŠ¨æ´¾ç”Ÿå‡ºæ¥ã€‚</em></p>
<p>MobX æ˜¯ä¸€ä¸ªèº«ç»ç™¾æˆ˜çš„åº“ï¼Œå®ƒé€šè¿‡è¿ç”¨é€æ˜çš„å‡½æ•°å¼å“åº”ç¼–ç¨‹ï¼ˆTransparent Functional Reactive Programmingï¼ŒTFRPï¼‰ä½¿çŠ¶æ€ç®¡ç†å˜å¾—ç®€å•å’Œå¯æ‰©å±•ã€‚</p>
<p>ğŸ˜™</p>
<h5 id="ç®€å•ç›´æ¥"><a href="#ç®€å•ç›´æ¥" class="headerlink" title="ç®€å•ç›´æ¥"></a>ç®€å•ç›´æ¥</h5><p>ç¼–å†™æ— æ¨¡æ¿çš„æç®€ä»£ç æ¥ç²¾å‡†æè¿°å‡ºä½ çš„æ„å›¾ã€‚è¦æ›´æ–°ä¸€ä¸ªè®°å½•å­—æ®µï¼Ÿä½¿ç”¨ç†Ÿæ‚‰çš„ JavaScript èµ‹å€¼å°±è¡Œã€‚è¦åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°æ•°æ®ï¼Ÿä¸éœ€è¦ç‰¹æ®Šçš„å·¥å…·ï¼Œå“åº”æ€§ç³»ç»Ÿä¼šä¾¦æµ‹åˆ°ä½ æ‰€æœ‰çš„å˜æ›´å¹¶æŠŠå®ƒä»¬ä¼ é€åˆ°å…¶ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<p>ğŸš…</p>
<h5 id="è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“"><a href="#è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“" class="headerlink" title="è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“"></a>è½»æ¾å®ç°æœ€ä¼˜æ¸²æŸ“</h5><p>æ‰€æœ‰å¯¹æ•°æ®çš„å˜æ›´å’Œä½¿ç”¨éƒ½ä¼šåœ¨è¿è¡Œæ—¶è¢«è¿½è¸ªåˆ°ï¼Œå¹¶æ„æˆä¸€ä¸ªæˆªå–æ‰€æœ‰çŠ¶æ€å’Œè¾“å‡ºä¹‹é—´å…³ç³»çš„ä¾èµ–æ ‘ã€‚è¿™æ ·ä¿è¯äº†é‚£äº›ä¾èµ–äºçŠ¶æ€çš„è®¡ç®—åªæœ‰åœ¨çœŸæ­£éœ€è¦æ—¶æ‰ä¼šè¿è¡Œï¼Œå°±åƒ React ç»„ä»¶ä¸€æ ·ã€‚æ— éœ€ä½¿ç”¨è®°å¿†åŒ–æˆ–é€‰æ‹©å™¨ä¹‹ç±»å®¹æ˜“å‡ºé”™çš„æ¬¡ä¼˜æŠ€å·§æ¥å¯¹ç»„ä»¶è¿›è¡Œæ‰‹åŠ¨ä¼˜åŒ–ã€‚</p>
<p>ğŸ¤¹ğŸ»â€â™‚ï¸</p>
<h5 id="æ¶æ„è‡ªç”±"><a href="#æ¶æ„è‡ªç”±" class="headerlink" title="æ¶æ„è‡ªç”±"></a>æ¶æ„è‡ªç”±</h5><p>MobX ä¸ä¼šç”¨å®ƒè‡ªå·±çš„è§„åˆ™æ¥é™åˆ¶ä½ ï¼Œå®ƒå¯ä»¥è®©ä½ åœ¨ä»»æ„ UI æ¡†æ¶ä¹‹å¤–ç®¡ç†ä½ çš„åº”ç”¨çŠ¶æ€ã€‚è¿™æ ·ä¼šä½¿ä½ çš„ä»£ç ä½è€¦åˆã€å¯ç§»æ¤å’Œæœ€é‡è¦çš„â€”â€”å®¹æ˜“æµ‹è¯•ã€‚</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>
<span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>
<span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-react&quot;</span>

<span class="hljs-comment">// å¯¹åº”ç”¨çŠ¶æ€è¿›è¡Œå»ºæ¨¡ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Timer</span> &#123;
    secondsPassed = <span class="hljs-number">0</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)
    &#125;

    <span class="hljs-title function_">increase</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span> += <span class="hljs-number">1</span>
    &#125;

    <span class="hljs-title function_">reset</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">secondsPassed</span> = <span class="hljs-number">0</span>
    &#125;
&#125;

<span class="hljs-keyword">const</span> myTimer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Timer</span>()

<span class="hljs-comment">// æ„å»ºä¸€ä¸ªä½¿ç”¨ observable çŠ¶æ€çš„â€œç”¨æˆ·ç•Œé¢â€ã€‚</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">TimerView</span> = <span class="hljs-title function_">observer</span>(<span class="hljs-function">(<span class="hljs-params">&#123; timer &#125;</span>) =&gt;</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> timer.reset()&#125;&gt;å·²è¿‡ç§’æ•°ï¼š&#123;timer.secondsPassed&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
))

<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerView</span> <span class="hljs-attr">timer</span>=<span class="hljs-string">&#123;myTimer&#125;</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)

<span class="hljs-comment">// æ¯ç§’æ›´æ–°ä¸€æ¬¡â€˜å·²è¿‡ç§’æ•°ï¼šXâ€™ä¸­çš„æ–‡æœ¬ã€‚</span>
<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;
    myTimer.<span class="hljs-title function_">increase</span>()
&#125;, <span class="hljs-number">1000</span>)</code></pre></div>

<p>å›´ç»• React ç»„ä»¶ <code>TimerView</code> çš„ <code>observer</code> åŒ…è£…ä¼šè‡ªåŠ¨ä¾¦æµ‹åˆ°ä¾èµ–äº observable <code>timer.secondsPassed</code> çš„æ¸²æŸ“â€”â€”å³ä½¿è¿™ç§ä¾èµ–å…³ç³»æ²¡æœ‰è¢«æ˜ç¡®å®šä¹‰å‡ºæ¥ã€‚ å“åº”æ€§ç³»ç»Ÿä¼šè´Ÿè´£åœ¨æœªæ¥<em>æ°å¥½é‚£ä¸ª</em>å­—æ®µè¢«æ›´æ–°çš„æ—¶å€™å°†ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p>
<p>æ¯ä¸ªäº‹ä»¶ï¼ˆ<code>onClick</code> æˆ– <code>setInterval</code>ï¼‰éƒ½ä¼šè°ƒç”¨ä¸€ä¸ªç”¨æ¥æ›´æ–° <em>observable çŠ¶æ€</em> <code>myTimer.secondsPassed</code> çš„ <em>action</em>ï¼ˆ<code>myTimer.increase</code> æˆ– <code>myTimer.reset</code>ï¼‰ã€‚Observable çŠ¶æ€çš„å˜æ›´ä¼šè¢«ç²¾ç¡®åœ°ä¼ é€åˆ° <code>TimerView</code> ä¸­æ‰€æœ‰ä¾èµ–äºå®ƒä»¬çš„<em>è®¡ç®—</em>å’Œ<em>å‰¯ä½œç”¨</em>é‡Œã€‚</p>
<p><img src="https://zh.mobx.js.org/assets/zh.flow.png" srcset="/img/loading.gif" lazyload alt="MobX å•å‘æµ"></p>
<h1 id="MobX-ä¸»æ—¨"><a href="#MobX-ä¸»æ—¨" class="headerlink" title="MobX ä¸»æ—¨"></a>MobX ä¸»æ—¨</h1><p>MobxåŒºåˆ†äº†åº”ç”¨ç¨‹åºçš„ä¸‰ä¸ªæ¦‚å¿µ</p>
<ul>
<li>State</li>
<li>Actions</li>
<li>Derivations</li>
</ul>
<h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><p><em>State(çŠ¶æ€)</em> æ˜¯é©±åŠ¨ä½ çš„åº”ç”¨ç¨‹åºçš„æ•°æ®ã€‚</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Todo</span> &#123;
    id = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()
    title = <span class="hljs-string">&quot;&quot;</span>
    finished = <span class="hljs-literal">false</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">title</span>) &#123;
        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">title</span>: observable,
            <span class="hljs-attr">finished</span>: observable,
            <span class="hljs-attr">toggle</span>: action
        &#125;)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span> = title
    &#125;

    <span class="hljs-title function_">toggle</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">finished</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">finished</span>
    &#125;
&#125;</code></pre></div>

<p>å°† State å­˜å‚¨åœ¨ä»»ä½•æ‚¨å–œæ¬¢çš„æ•°æ®ç»“æ„ä¸­ï¼šæ™®é€šå¯¹è±¡ã€æ•°ç»„ã€ç±»ã€å¾ªç¯æ•°æ®ç»“æ„æˆ–å¼•ç”¨ã€‚è¿™ä¸MobXçš„å·¥ä½œæ–¹å¼æ— å…³ã€‚</p>
<p>åªè¦ç¡®ä¿æ‰€æœ‰å“åº”å¼çš„å±æ€§éƒ½è¢«æ ‡è®°ä¸º<code>observable</code></p>
<h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p>actionæ˜¯ç”¨æ¥æ”¹å˜stateä¸­çš„æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·äº‹ä»¶å¤„ç†ã€åç«¯æ¨é€æ•°æ®å¤„ç†ã€è°ƒåº¦å™¨äº‹ä»¶å¤„ç†ç­‰ç­‰ã€‚</p>
<h3 id="åˆ›å»º-Derivations-ä»¥ä¾¿è‡ªåŠ¨å¯¹-State-å˜åŒ–è¿›è¡Œå“åº”"><a href="#åˆ›å»º-Derivations-ä»¥ä¾¿è‡ªåŠ¨å¯¹-State-å˜åŒ–è¿›è¡Œå“åº”" class="headerlink" title="åˆ›å»º Derivations ä»¥ä¾¿è‡ªåŠ¨å¯¹ State å˜åŒ–è¿›è¡Œå“åº”"></a>åˆ›å»º Derivations ä»¥ä¾¿è‡ªåŠ¨å¯¹ State å˜åŒ–è¿›è¡Œå“åº”</h3><p><em>ä»»ä½•</em> æ¥æºæ˜¯<em>State(çŠ¶æ€)</em> å¹¶ä¸”ä¸éœ€è¦è¿›ä¸€æ­¥äº¤äº’çš„ä¸œè¥¿éƒ½æ˜¯ Derivation(æ´¾ç”Ÿ)</p>
<p>Derivations åŒ…æ‹¬è®¸å¤šæ–¹å¼:</p>
<ul>
<li><em>ç”¨æˆ·ç•Œé¢</em></li>
<li><em>æ´¾ç”Ÿæ•°æ®</em> , æ¯”å¦‚å‰©ä½™æœªå®Œæˆ<code>todos</code>çš„æ•°é‡</li>
<li><em>åç«¯é›†æˆ</em> , æ¯”å¦‚å‘é€æ”¹å˜åˆ°æœåŠ¡å™¨ç«¯</li>
</ul>
<p>Mobx åŒºåˆ†äº†ä¸¤ç§ Derivation :</p>
<ul>
<li><em>Computed values</em>,æ€»æ˜¯å¯ä»¥é€šè¿‡çº¯å‡½æ•°ä»å½“å‰çš„å¯è§‚æµ‹ State ä¸­æ´¾ç”Ÿã€‚</li>
<li><em>Reactions</em>, å½“ State æ”¹å˜æ—¶éœ€è¦è‡ªåŠ¨è¿è¡Œçš„å‰¯ä½œç”¨ (å‘½ä»¤å¼ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹ä¹‹é—´çš„æ¡¥æ¢)</li>
</ul>
<p>å½“æœ€å¼€å§‹ä½¿ç”¨MobXæ—¶ï¼Œäººä»¬å®¹æ˜“è¿‡åº¦ä½¿ç”¨ <em>Reaction</em>ã€‚</p>
<p>é»„é‡‘æ³•åˆ™æ˜¯ï¼Œå¦‚æœè¦åŸºäºå½“å‰ State åˆ›å»ºå€¼ï¼Œè¯·å§‹ç»ˆä½¿ç”¨ <em>computed</em></p>
<h4 id="é€šè¿‡-computed-å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡"><a href="#é€šè¿‡-computed-å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡" class="headerlink" title="é€šè¿‡ computed å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡"></a>é€šè¿‡ computed å¯¹æ´¾ç”Ÿå€¼è¿›è¡Œå»ºæ¨¡</h4><p>ä½ å¯ä»¥é€šè¿‡å®šä¹‰ getter æ–¹æ³•å¹¶ä½¿ç”¨ <code>makeObservable</code> å°†å…¶æ ‡è®°ä¸º <code>computed</code> çš„æ–¹å¼åˆ›å»ºä¸€ä¸ª <em>computed</em> å€¼ã€‚</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TodoList</span> &#123;
    todos = []
    <span class="hljs-keyword">get</span> <span class="hljs-title function_">unfinishedTodoCount</span>() &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">finished</span>).<span class="hljs-property">length</span>
    &#125;
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">todos</span>) &#123;
        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">todos</span>: observable,
            <span class="hljs-attr">unfinishedTodoCount</span>: computed
        &#125;)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span> = todos
    &#125;
&#125;</code></pre></div>

<p>Mobx ä¼šç¡®ä¿ <code>unfinishedTodoCount</code> ä¼šåœ¨todosæ•°ç»„å‘ç”Ÿå˜åŒ–ä¸­æˆ–è€… todosä¸­çš„ä¸€ä¸ªå¯¹è±¡ä¸­çš„ <code>finished</code>å±æ€§è¢«ä¿®æ”¹æ—¶è‡ªåŠ¨æ›´æ–°</p>
<h4 id="Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨"><a href="#Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨" class="headerlink" title="Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨"></a>Reactionä¼šäº§ç”Ÿå‰¯ä½œç”¨</h4><p>ä½œä¸ºç”¨æˆ·ï¼Œè¦æƒ³åœ¨å±å¹•ä¸Šçœ‹åˆ°çŠ¶æ€æˆ–è®¡ç®—å€¼çš„å˜åŒ–ï¼Œå°±éœ€è¦ä¸€ä¸ªé‡æ–°ç»˜åˆ¶éƒ¨åˆ†GUIçš„ <em>reactions</em> ã€‚</p>
<p>Reaction å’Œ computed ç±»ä¼¼ï¼Œä½†å¹¶ä¸äº§ç”Ÿä¿¡æ¯ï¼Œè€Œæ˜¯äº§ç”Ÿå‰¯ä½œç”¨ï¼Œå¦‚æ‰“å°åˆ°æ§åˆ¶å°ã€å‘å‡ºç½‘ç»œè¯·æ±‚ã€å¢é‡æ›´æ–° React ç»„ä»¶æ ‘ä»¥ä¾¿æ›´æ–°DOMç­‰ã€‚</p>
<p>ç®€è€Œè¨€ä¹‹ï¼Œ<em>reaction</em> æ˜¯ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Reactive_programming">å“åº”å¼ç¼–ç¨‹</a>å’Œ<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Imperative_programming">æŒ‡ä»¤å¼ç¼–ç¨‹</a>ä¹‹é—´çš„æ¡¥æ¢ã€‚</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ€å¸¸ç”¨çš„ reaction å½¢å¼æ˜¯UIç»„ä»¶ã€‚ æ³¨æ„ï¼Œaction å’Œ reaction éƒ½å¯èƒ½å¼•èµ·å‰¯ä½œç”¨ã€‚ å‰¯ä½œç”¨åº”æœ‰ä¸€ä¸ªæ¸…æ™°çš„ã€æ˜¾å¼çš„èµ·æºï¼Œä¾‹å¦‚åœ¨æäº¤è¡¨å•æ—¶å‘å‡ºç½‘ç»œè¯·æ±‚ï¼Œåº”è¯¥ä»ç›¸å…³çš„äº‹ä»¶å¤„ç†ç¨‹åºæ˜¾å¼è§¦å‘ã€‚</p>
<h2 id="åŸåˆ™"><a href="#åŸåˆ™" class="headerlink" title="åŸåˆ™"></a>åŸåˆ™</h2><p>Mobx ä½¿ç”¨å•å‘æ•°æ®æµï¼Œåˆ©ç”¨ <em>action</em> æ”¹å˜ <em>state</em> ï¼Œè¿›è€Œæ›´æ–°æ‰€æœ‰å—å½±å“çš„ <em>view</em></p>
<p><img src="https://zh.mobx.js.org/assets/action-state-view.png" srcset="/img/loading.gif" lazyload alt="Action, State, View"></p>
<ol>
<li>æ‰€æœ‰çš„ <em>derivations</em> å°†åœ¨ <em>state</em> æ”¹å˜æ—¶<strong>è‡ªåŠ¨ä¸”åŸå­åŒ–åœ°æ›´æ–°</strong>ã€‚å› æ­¤ä¸å¯èƒ½è§‚å¯Ÿä¸­é—´å€¼ã€‚</li>
<li>æ‰€æœ‰çš„ <em>derivations</em> é»˜è®¤å°†ä¼š<strong>åŒæ­¥</strong>æ›´æ–°ï¼Œè¿™æ„å‘³ç€ <em>action</em> å¯ä»¥åœ¨ <em>state</em> æ”¹å˜ ä¹‹åå®‰å…¨çš„ç›´æ¥è·å¾— computed å€¼ã€‚</li>
<li><em>computed value</em> çš„æ›´æ–°æ˜¯<strong>æƒ°æ€§</strong>çš„ï¼Œä»»ä½• computed value åœ¨éœ€è¦ä»–ä»¬çš„å‰¯ä½œç”¨å‘ç”Ÿä¹‹å‰éƒ½æ˜¯ä¸æ¿€æ´»çš„ã€‚</li>
<li>æ‰€æœ‰çš„ <em>computed value</em> éƒ½åº”æ˜¯<strong>çº¯å‡½æ•°</strong>,ä»–ä»¬ä¸åº”è¯¥ä¿®æ”¹ <em>state</em>ã€‚</li>
</ol>
<h2 id="Observable-state"><a href="#Observable-state" class="headerlink" title="Observable state"></a>Observable state</h2><p>å±æ€§ï¼Œå®Œæ•´çš„å¯¹è±¡ï¼Œæ•°ç»„ï¼ŒMaps å’Œ Sets éƒ½å¯ä»¥è¢«è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ã€‚ ä½¿å¾—å¯¹è±¡å¯è§‚å¯Ÿçš„åŸºæœ¬æ–¹æ³•æ˜¯ä½¿ç”¨ <code>makeObservable</code> ä¸ºæ¯ä¸ªå±æ€§æŒ‡å®šä¸€ä¸ªæ³¨è§£ã€‚ æœ€é‡è¦çš„æ³¨è§£å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>observable</code> å®šä¹‰ä¸€ä¸ªå­˜å‚¨ state çš„å¯è¿½è¸ªå­—æ®µã€‚</li>
<li><code>action</code> å°†ä¸€ä¸ªæ–¹æ³•æ ‡è®°ä¸ºå¯ä»¥ä¿®æ”¹ state çš„ actionã€‚</li>
<li><code>computed</code> æ ‡è®°ä¸€ä¸ªå¯ä»¥ç”± state æ´¾ç”Ÿå‡ºæ–°çš„å€¼å¹¶ä¸”ç¼“å­˜å…¶è¾“å‡ºçš„ getterã€‚</li>
</ul>
<p>åƒæ•°ç»„ï¼ŒMaps å’Œ Sets è¿™æ ·çš„é›†åˆéƒ½å°†è¢«è‡ªåŠ¨è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡</p>
<h4 id="makeObservable"><a href="#makeObservable" class="headerlink" title="makeObservable"></a><code>makeObservable</code></h4><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>makeObservable(target, annotations?, options?)</code></li>
</ul>
<p>è¿™ä¸ªå‡½æ•°ä¼šå°†å·²å­˜åœ¨çš„å¯¹è±¡å±æ€§è½¬æ¢æˆå¯è§‚å¯Ÿåœ°å¯¹è±¡ï¼Œä»»ä½•targetå¯¹è±¡åŒ…æ‹¬classéƒ½å¯ä»¥ä½œä¸ºtargetä¼ é€’ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<code>makeObservable</code> æ˜¯åœ¨ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨çš„ï¼Œå¹¶ä¸”å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>this</code> ã€‚ <code>annotations</code> å‚æ•°å°†ä¼šä¸ºæ¯ä¸€ä¸ªæˆå‘˜æ˜ å°„ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/observable-state.html#%E5%8F%AF%E7%94%A8%E7%9A%84%E6%B3%A8%E8%A7%A3">æ³¨è§£</a>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/enabling-decorators.html">è£…é¥°å™¨</a> æ—¶ï¼Œ<code>annotations</code> å‚æ•°å°†ä¼šè¢«å¿½ç•¥ã€‚</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, computed, action, flow &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;
    value

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;
        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">value</span>: observable,
            <span class="hljs-attr">double</span>: computed,
            <span class="hljs-attr">increment</span>: action,
            <span class="hljs-attr">fetch</span>: flow
        &#125;)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value
    &#125;

    <span class="hljs-keyword">get</span> <span class="hljs-title function_">double</span>() &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>
    &#125;

    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
    &#125;

    *<span class="hljs-title function_">fetch</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/api/value&quot;</span>)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = response.<span class="hljs-title function_">json</span>()
    &#125;
&#125;
æ‰€æœ‰å¸¦æ³¨è§£ çš„å­—æ®µéƒ½æ˜¯ ä¸å¯é…ç½®çš„ã€‚
æ‰€æœ‰çš„ä¸å¯è§‚å¯Ÿï¼ˆæ— çŠ¶æ€ï¼‰çš„å­—æ®µï¼ˆaction, flowï¼‰éƒ½æ˜¯ ä¸å¯å†™çš„ã€‚</code></pre></div>

<h4 id="makeAutoObservable"><a href="#makeAutoObservable" class="headerlink" title="makeAutoObservable"></a><code>makeAutoObservable</code></h4><p>ä½¿ç”¨ï¼š</p>
<ul>
<li><code>makeAutoObservable(target, overrides?, options?)</code></li>
</ul>
<p>ç›¸å½“äºæ˜¯åŠ å¼ºç‰ˆçš„makeObservableå‡½æ•°ï¼Œä»–ä¼šè‡ªåŠ¨æ ¹æ®ä¼ å…¥çš„å¯¹è±¡å±æ€§è‡ªåŠ¨è½¬æˆå¯è§‚å¯Ÿå±æ€§ï¼Œ</p>
<p>ä¸ä½¿ç”¨ <code>makeObservable</code> ç›¸æ¯”ï¼Œ<code>makeAutoObservable</code> å‡½æ•°æ›´ç´§å‡‘ï¼Œä¹Ÿæ›´å®¹æ˜“ç»´æŠ¤ï¼Œå› ä¸ºæ–°æˆå‘˜ä¸éœ€è¦æ˜¾å¼åœ°æåŠã€‚ ç„¶è€Œï¼Œ<code>makeAutoObservable</code> ä¸èƒ½è¢«ç”¨äºå¸¦æœ‰ super çš„ç±»æˆ– <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/subclassing.html">å­ç±»</a></p>
<p>æ¨æ–­è§„åˆ™ï¼š</p>
<ul>
<li>æ‰€æœ‰ <em>è‡ªæœ‰</em> å±æ€§éƒ½æˆä¸º <code>observable</code>ã€‚</li>
<li>æ‰€æœ‰ <code>get</code>ters éƒ½æˆä¸º <code>computed</code>ã€‚</li>
<li>æ‰€æœ‰ <code>set</code>ters éƒ½æˆä¸º <code>action</code>ã€‚</li>
<li>æ‰€æœ‰ <em>prototype ä¸­çš„ functions</em> éƒ½æˆä¸º <code>autoAction</code>ã€‚</li>
<li>æ‰€æœ‰ <em>prototype ä¸­çš„ generator functions</em> éƒ½æˆä¸º <code>flow</code>ã€‚ï¼ˆéœ€è¦æ³¨æ„ï¼Œgenerators å‡½æ•°åœ¨æŸäº›ç¼–è¯‘å™¨é…ç½®ä¸­æ— æ³•è¢«æ£€æµ‹åˆ°ï¼Œå¦‚æœ flow æ²¡æœ‰æ­£å¸¸è¿è¡Œï¼Œè¯·åŠ¡å¿…æ˜ç¡®åœ°æŒ‡å®š <code>flow</code> æ³¨è§£ã€‚ï¼‰</li>
<li>åœ¨ <code>overrides</code> å‚æ•°ä¸­æ ‡è®°ä¸º <code>false</code> çš„æˆå‘˜å°†ä¸ä¼šè¢«æ·»åŠ æ³¨è§£ã€‚ä¾‹å¦‚ï¼Œå°†å…¶ç”¨äºåƒæ ‡è¯†ç¬¦è¿™æ ·çš„åªè¯»å­—æ®µã€‚</li>
</ul>
<h4 id="observable"><a href="#observable" class="headerlink" title="observable"></a><code>observable</code></h4><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>observable(source, overrides?, options?)</code></li>
</ul>
<p><code>observable</code> æ³¨è§£å¯ä»¥ä½œä¸ºä¸€ä¸ªå‡½æ•°è¿›è¡Œè°ƒç”¨ï¼Œä»è€Œä¸€æ¬¡æ€§å°†æ•´ä¸ªå¯¹è±¡å˜æˆå¯è§‚å¯Ÿçš„ã€‚ <code>source</code> å¯¹è±¡å°†ä¼šè¢«å…‹éš†å¹¶ä¸”æ‰€æœ‰çš„æˆå‘˜éƒ½å°†ä¼šæˆä¸ºå¯è§‚å¯Ÿçš„ï¼Œç±»ä¼¼äº <code>makeAutoObservable</code> åšçš„é‚£æ ·ã€‚ åŒæ ·ï¼Œä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ª <code>overrides</code> å¯¹è±¡æ¥ä¸ºç‰¹å®šçš„æˆå‘˜æä¾›ç‰¹å®šçš„æ³¨è§£ã€‚ </p>
<p>ç”± <code>observable</code> è¿”å›çš„å¯¹è±¡å°†ä¼šä½¿ç”¨ Proxy åŒ…è£…ï¼Œè¿™æ„å‘³ç€ä¹‹åè¢«æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸­çš„å±æ€§ä¹Ÿå°†è¢«ä¾¦æµ‹å¹¶ä½¿å…¶è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ï¼ˆé™¤éç¦ç”¨ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/configuration.html#proxy-%E9%80%89%E9%A1%B9">proxy</a>ï¼‰ã€‚</p>
<p><code>observable</code> æ–¹æ³•ä¹Ÿå¯ä»¥è¢«åƒ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#observablearray">arrays</a>ï¼Œ<a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#observablemap">Maps</a> å’Œ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#observableset">Sets</a> è¿™æ ·çš„é›†åˆè°ƒç”¨ã€‚è¿™äº›é›†åˆä¹Ÿå°†è¢«å…‹éš†å¹¶è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ã€‚</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; observable, autorun &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">const</span> todos = <span class="hljs-title function_">observable</span>([
    &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Spoil tea&quot;</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span> &#125;,
    &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Make coffee&quot;</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> &#125;
])

<span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">&quot;Remaining:&quot;</span>,
        todos
            .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">completed</span>)
            .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">title</span>)
            .<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;, &quot;</span>)
    )
&#125;)
<span class="hljs-comment">// æ‰“å°: &#x27;Remaining: Make coffee&#x27;</span>

todos[<span class="hljs-number">0</span>].<span class="hljs-property">completed</span> = <span class="hljs-literal">false</span>
<span class="hljs-comment">// æ‰“å°: &#x27;Remaining: Spoil tea, Make coffee&#x27;</span>

todos[<span class="hljs-number">2</span>] = &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Take a nap&quot;</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> &#125;
<span class="hljs-comment">// æ‰“å°: &#x27;Remaining: Spoil tea, Make coffee, Take a nap&#x27;</span>

todos.<span class="hljs-title function_">shift</span>()
<span class="hljs-comment">// æ‰“å°: &#x27;Remaining: Make coffee, Take a nap&#x27;</span></code></pre></div>

<p>ä½¿ç”¨autorunå¯ä»¥åœ¨å“åº”å¼çš„æ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œè‡ªåŠ¨æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°</p>
<p>å¯è§‚å¯Ÿçš„æ•°ç»„è¿˜æœ‰ä¸€äº›ç‰¹åˆ«å¥½ç”¨çš„å®ç”¨å‡½æ•°ï¼š</p>
<ul>
<li><code>clear()</code> ä»æ•°ç»„ä¸­æ¸…é™¤æ‰€æœ‰å…ƒç´ ã€‚</li>
<li><code>replace(newItems)</code> å°†æ•°ç»„ä¸­ç°æœ‰çš„å…ƒç´ å…¨éƒ¨æ›¿æ¢æˆ newItemsã€‚</li>
<li><code>remove(value)</code> æ ¹æ® value ä»æ•°ç»„ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ‰¾åˆ°å¹¶åˆ é™¤äº†å…ƒç´ ï¼Œè¿”å› <code>true</code>ã€‚</li>
</ul>
<p><strong>æ³¨æ„ï¼šåŸºæœ¬æ•°æ®ç±»å‹å’Œç±»çš„å®ä¾‹ä¸èƒ½è½¬æ¢æˆå¯è§‚å¯Ÿçš„å¯¹è±¡</strong></p>
<p><strong><code>make(Auto)Observable</code> å’Œ <code>observable</code> ä¹‹é—´æœ€ä¸»è¦çš„åŒºåˆ«</strong>åœ¨äºï¼Œ<code>make(Auto)Observable</code> ä¼šä¿®æ”¹ä½ ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„å¯¹è±¡ï¼Œè€Œ <code>observable</code> ä¼šåˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„ <em>å‰¯æœ¬</em> å¯¹è±¡</p>
<p>ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ï¼Œ<code>observable</code> ä¼šåˆ›å»ºä¸€ä¸ª <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy"><code>Proxy</code></a> å¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨ä½ å°†è¯¥å¯¹è±¡å½“ä½œåŠ¨æ€æŸ¥è¯¢æ˜ å°„ä½¿ç”¨æ—¶æ•è·å°†è¦æ·»åŠ çš„å±æ€§ã€‚ å¦‚æœä½ æƒ³æŠŠä¸€ä¸ªå¯¹è±¡è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ï¼Œè€Œè¿™ä¸ªå¯¹è±¡å…·æœ‰ä¸€ä¸ªå¸¸è§„ç»“æ„ï¼Œå…¶ä¸­æ‰€æœ‰çš„æˆå‘˜éƒ½æ˜¯äº‹å…ˆå·²çŸ¥çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å»ºè®®ä½¿ç”¨ <code>makeObservable</code>ï¼Œå› ä¸ºéä»£ç†å¯¹è±¡çš„é€Ÿåº¦ç¨å¿«ä¸€äº›ï¼Œè€Œä¸”å®ƒä»¬åœ¨è°ƒè¯•å™¨å’Œ <code>console.log</code> ä¸­æ›´å®¹æ˜“æ£€æŸ¥ã€‚</p>
<p>å› æ­¤ï¼Œ<code>make(Auto)Observable</code> æ¨èåœ¨å·¥å‚å‡½æ•°ä¸­ä½¿ç”¨ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¯ä»¥å°† <code>&#123; proxy: false &#125;</code> ä½œä¸º option ä¼ å…¥ <code>observable</code> è·å–éä»£ç†å‰¯æœ¬</p>
<h2 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h2><h3 id="ä½¿ç”¨-actions-æ›´æ–°-state"><a href="#ä½¿ç”¨-actions-æ›´æ–°-state" class="headerlink" title="ä½¿ç”¨ actions æ›´æ–° state"></a>ä½¿ç”¨ actions æ›´æ–° state</h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>action</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li>
<li><code>action(fn)</code></li>
<li><code>action(name, fn)</code></li>
</ul>
<p>actionså°±æ˜¯ç”¨æ¥ä¿®æ”¹stateä¸­çš„æ•°æ®çš„ï¼Œ</p>
<p>å°½ç®¡ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/observable-state.html#makeautoobservable"><code>makeAutoObservable</code></a> å¯ä»¥è‡ªåŠ¨å¸®ä½ å£°æ˜ä¸€éƒ¨åˆ† actionsï¼Œä½†æ˜¯ MobX è¿˜æ˜¯è¦æ±‚ä½ å£°æ˜ä½ çš„ actionsã€‚Actions å¯ä»¥å¸®åŠ©ä½ æ›´å¥½çš„ç»„ç»‡ä½ çš„ä»£ç å¹¶æä¾›ä»¥ä¸‹æ€§èƒ½ä¼˜åŠ¿ï¼š</p>
<ol>
<li>å®ƒä»¬åœ¨ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#transaction">transactions</a> å†…éƒ¨è¿è¡Œã€‚ä»»ä½•å¯è§‚å¯Ÿå¯¹è±¡åœ¨æœ€å¤–å±‚çš„ action å®Œæˆä¹‹å‰éƒ½ä¸ä¼šè¢«æ›´æ–°ï¼Œè¿™ä¸€ç‚¹ä¿è¯äº†åœ¨ action å®Œæˆä¹‹å‰ï¼Œaction æ‰§è¡ŒæœŸé—´ç”Ÿæˆçš„ä¸­é—´å€¼æˆ–ä¸å®Œæ•´çš„å€¼å¯¹åº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†éƒ½æ˜¯ä¸å¯è§çš„ã€‚</li>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å…è®¸åœ¨ actions ä¹‹å¤–æ”¹å˜ stateã€‚è¿™æœ‰åŠ©äºåœ¨ä»£ç ä¸­æ¸…æ¥šåœ°å¯¹çŠ¶æ€æ›´æ–°å‘ç”Ÿçš„ä½ç½®è¿›è¡Œå®šä½ã€‚</li>
</ol>
<p><code>action</code> æ³¨è§£åº”è¯¥ä»…ç”¨äºä¼š<em>ä¿®æ”¹</em> state çš„å‡½æ•°ã€‚æ´¾ç”Ÿå…¶ä»–ä¿¡æ¯ï¼ˆæ‰§è¡ŒæŸ¥è¯¢æˆ–è€…è¿‡æ»¤æ•°æ®ï¼‰çš„å‡½æ•°<em>ä¸åº”è¯¥</em>è¢«æ ‡è®°ä¸º actionsï¼Œä»¥ä¾¿ MobX å¯ä»¥å¯¹å®ƒä»¬çš„è°ƒç”¨è¿›è¡Œè·Ÿè¸ªã€‚ å¸¦æœ‰ <code>action</code> æ³¨è§£çš„æˆå‘˜æ˜¯ä¸å¯æšä¸¾çš„ã€‚</p>
<p>makeObservable</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;
    value = <span class="hljs-number">0</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;
        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">value</span>: observable,
            <span class="hljs-attr">increment</span>: action
        &#125;)
    &#125;

    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-comment">// è§‚å¯Ÿè€…ä¸ä¼šçœ‹åˆ°ä¸­é—´çŠ¶æ€.</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
    &#125;
&#125;</code></pre></div>

<p>makeAutoObservable</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;
    value = <span class="hljs-number">0</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)
    &#125;

    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
    &#125;
&#125;</code></pre></div>

<p>action.bound</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, action &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;
    value = <span class="hljs-number">0</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;
        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">value</span>: observable,
            <span class="hljs-attr">increment</span>: action.<span class="hljs-property">bound</span>
        &#125;)
    &#125;

    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
    &#125;
&#125;

<span class="hljs-keyword">const</span> doubler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Doubler</span>()

<span class="hljs-comment">// è¿™æ ·è°ƒç”¨ increment æ˜¯å®‰å…¨çš„, å› ä¸ºå®ƒå·²ç»è¢«ç»‘å®šäº†ã€‚</span>
<span class="hljs-built_in">setInterval</span>(doubler.<span class="hljs-property">increment</span>, <span class="hljs-number">1000</span>)</code></pre></div>

<p>Action(fn)</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; observable, action &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">observable</span>(&#123; <span class="hljs-attr">value</span>: <span class="hljs-number">0</span> &#125;)

<span class="hljs-keyword">const</span> increment = <span class="hljs-title function_">action</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> &#123;
    state.<span class="hljs-property">value</span>++
    state.<span class="hljs-property">value</span>++
&#125;)

<span class="hljs-title function_">increment</span>(state)</code></pre></div>

<p>runInAction</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; observable, runInAction &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">observable</span>(&#123; <span class="hljs-attr">value</span>: <span class="hljs-number">0</span> &#125;)

<span class="hljs-title function_">runInAction</span>(<span class="hljs-function">() =&gt;</span> &#123;
    state.<span class="hljs-property">value</span>++
    state.<span class="hljs-property">value</span>++
&#125;)</code></pre></div>

<h3 id="ä½¿ç”¨-action-åŒ…è£…å‡½æ•°"><a href="#ä½¿ç”¨-action-åŒ…è£…å‡½æ•°" class="headerlink" title="ä½¿ç”¨ action åŒ…è£…å‡½æ•°"></a>ä½¿ç”¨ <code>action</code> åŒ…è£…å‡½æ•°</h3><p>ä¸ºäº†å°½å¯èƒ½åœ°åˆ©ç”¨ MobX çš„äº‹åŠ¡æ€§ï¼Œactions åº”è¯¥å°½å¯èƒ½è¢«ä¼ åˆ°å¤–å›´ã€‚å¦‚æœä¸€ä¸ªç±»æ–¹æ³•ä¼šä¿®æ”¹ stateï¼Œå¯ä»¥å°†å…¶æ ‡è®°ä¸º actionã€‚æŠŠäº‹ä»¶å¤„ç†å‡½æ•°æ ‡è®°ä¸º actions å°±æ›´å¥½äº†ï¼Œå› ä¸ºæœ€å¤–å±‚çš„äº‹åŠ¡èµ·ç€å†³å®šæ€§ä½œç”¨ã€‚ä¸€ä¸ªæœªè¢«æ ‡è®°çš„ã€ä¼šæ¥ç€è°ƒç”¨ä¸¤ä¸ª actions çš„äº‹ä»¶å¤„ç†å‡½æ•°ä»ç„¶å°†ä¼šç”Ÿæˆä¸¤ä¸ªäº‹åŠ¡ã€‚</p>
<p>ä¸ºäº†å¸®åŠ©åˆ›å»ºåŸºäº action çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œ<code>action</code> ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ³¨è§£ï¼Œæ›´æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ã€‚å¯ä»¥ä½¿ç”¨å‡½æ•°å°†å®ƒä½œä¸ºä¸€ä¸ªå‚æ•°æ¥è°ƒç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å®ƒå°†ä¼šè¿”å›ä¸€ä¸ªæœ‰ç€ç›¸åŒç­¾åçš„ä½¿ç”¨ <code>action</code> åŒ…è£…è¿‡çš„å‡½æ•°ã€‚</p>
<p>ä¾‹å¦‚åœ¨ React ä¸­ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼åŒ…è£… <code>onClick</code> äº‹ä»¶å¤„ç†å‡½æ•°</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">ResetButton</span> = (<span class="hljs-params">&#123; formState &#125;</span>) =&gt; (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span>
<span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;action(e</span> =&gt;</span> &#123;</span>
<span class="language-xml">            formState.resetPendingUploads()</span>
<span class="language-xml">            formState.resetValues()</span>
<span class="language-xml">            e.stopPropagation()</span>
<span class="language-xml">        &#125;)&#125;</span>
<span class="language-xml">    &gt;</span>
<span class="language-xml">        Reset form</span>
<span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
)</code></pre></div>

<p>ä¸ºäº†æ›´å¥½çš„è°ƒè¯•ä½“éªŒï¼Œæˆ‘ä»¬æ¨èä¸ºè¢«åŒ…è£…çš„å‡½æ•°å‘½åï¼Œæˆ–è€…å°†åç§°ä½œä¸º <code>action</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œä¼ é€’    </p>
<p><strong>æ³¨æ„ï¼šactionsä¸ä¼šè¢«è·Ÿè¸ª</strong>ï¼Œå°±æ˜¯ä¸èƒ½è§¦å‘autorun</p>
<p>actions çš„å¦ä¸€ä¸ªç‰¹å¾æ˜¯å®ƒä»¬æ˜¯ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/api.html#untracked">ä¸å¯è¿½è¸ª</a> çš„ã€‚å½“ä»å‰¯ä½œç”¨æˆ–è€…è®¡ç®—å€¼ï¼ˆéå¸¸ç½•è§ï¼‰ä¸­è°ƒç”¨ action æ—¶ï¼Œè¯¥ action è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡å°†ä¸ä¼šç®—ä½œè¯¥ derivation çš„ä¾èµ–é¡¹ã€‚</p>
<p><code>makeAutoObservable</code>ï¼Œ<code>extendObservable</code> å’Œ <code>observable</code> ä½¿ç”¨ä¸€ç§ç‰¹æ®Šçš„ <code>action</code>ï¼Œ å«åš <code>autoAction</code>ï¼Œ å®ƒä¼šåœ¨è¿è¡Œæ—¶ç¡®å®šå‡½æ•°æ˜¯ derivation è¿˜æ˜¯ actionã€‚</p>
<h3 id="action-bound"><a href="#action-bound" class="headerlink" title="action.bound"></a><code>action.bound</code></h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>action.bound</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li>
</ul>
<p><code>action.bound</code> æ³¨è§£å¯ç”¨äºå°†æ–¹æ³•è‡ªåŠ¨ç»‘å®šåˆ°æ­£ç¡®çš„å®ä¾‹ï¼Œè¿™æ · <code>this</code> ä¼šå§‹ç»ˆè¢«æ­£ç¡®ç»‘å®šåœ¨å‡½æ•°å†…éƒ¨</p>
<p>ä½¿ç”¨makeAutoObservable(o,{},{autoBind:true}) è‡ªåŠ¨ç»‘å®šæ‰€æœ‰çš„actionså’Œflow</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Doubler</span> &#123;
    value = <span class="hljs-number">0</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>, &#123;&#125;, &#123; <span class="hljs-attr">autoBind</span>: <span class="hljs-literal">true</span> &#125;)
    &#125;

    <span class="hljs-title function_">increment</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++
    &#125;
    
    *<span class="hljs-title function_">flow</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://example.com/value&quot;</span>)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-keyword">yield</span> response.<span class="hljs-title function_">json</span>()
    &#125;
&#125;</code></pre></div>

<h3 id="runInAction"><a href="#runInAction" class="headerlink" title="runInAction"></a><code>runInAction</code></h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>runInAction(fn)</code></li>
</ul>
<p>ä½¿ç”¨è¿™ä¸ªå·¥å…·å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªä¼šè¢«ç«‹å³è°ƒç”¨çš„ä¸´æ—¶ actionã€‚åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­éå¸¸æœ‰ç”¨ã€‚ </p>
<h3 id="Actions-å’Œç»§æ‰¿"><a href="#Actions-å’Œç»§æ‰¿" class="headerlink" title="Actions å’Œç»§æ‰¿"></a>Actions å’Œç»§æ‰¿</h3><p>åªæœ‰å®šä¹‰åœ¨<strong>åŸå‹</strong>ä¸Šçš„å‡½æ•°å¯ä»¥è¢«å­ç±»<strong>è¦†ç›–</strong>ï¼š</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> &#123;
    <span class="hljs-comment">// on instance class filed</span>
    arrowAction = <span class="hljs-function">() =&gt;</span> &#123;&#125;

    <span class="hljs-comment">// on prototype</span>
    <span class="hljs-title function_">action</span>(<span class="hljs-params"></span>) &#123;&#125;
    <span class="hljs-title function_">boundAction</span>(<span class="hljs-params"></span>) &#123;&#125;

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">arrowAction</span>: action
            <span class="hljs-attr">action</span>: action,
            <span class="hljs-attr">boundAction</span>: action.<span class="hljs-property">bound</span>,
        &#125;)
    &#125;
&#125;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Parent</span> &#123;
    <span class="hljs-comment">// THROWS: TypeError: Cannot redefine property: arrowAction</span>
    arrowAction = <span class="hljs-function">() =&gt;</span> &#123;&#125;

    <span class="hljs-comment">// OK</span>
    <span class="hljs-title function_">action</span>(<span class="hljs-params"></span>) &#123;&#125;
    <span class="hljs-title function_">boundAction</span>(<span class="hljs-params"></span>) &#123;&#125;

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">super</span>()
        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">arrowAction</span>: override,
            <span class="hljs-attr">action</span>: override,
            <span class="hljs-attr">boundAction</span>: override,
        &#125;)
    &#125;
&#125;</code></pre></div>

<p>æƒ³è¦å°†å•ä¸ªçš„ <em>action</em> <strong>ç»‘å®š</strong> åˆ° <code>this</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>action.bound</code> ä»£æ›¿ç®­å¤´å‡½æ•°</p>
<h3 id="å¼‚æ­¥-actions"><a href="#å¼‚æ­¥-actions" class="headerlink" title="å¼‚æ­¥ actions"></a>å¼‚æ­¥ actions</h3><p>ä»æœ¬è´¨ä¸Šè®²ï¼Œå¼‚æ­¥è¿›ç¨‹åœ¨ MobX ä¸­ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šå¤„ç†ï¼Œå› ä¸ºä¸è®ºæ˜¯ä½•æ—¶å¼•å‘çš„æ‰€æœ‰ reactions éƒ½å°†ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ è€Œä¸”å› ä¸ºå¯è§‚å¯Ÿå¯¹è±¡æ˜¯å¯å˜çš„ï¼Œå› æ­¤åœ¨ action æ‰§è¡Œè¿‡ç¨‹ä¸­ä¿æŒå¯¹å®ƒä»¬çš„å¼•ç”¨ä¸€èˆ¬æ˜¯å®‰å…¨çš„ã€‚ ç„¶è€Œï¼Œåœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°å¯è§‚å¯Ÿå¯¹è±¡çš„æ¯ä¸ªæ­¥éª¤ï¼ˆtickï¼‰éƒ½åº”è¯¥è¢«æ ‡è¯†ä¸º <code>action</code>ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨ä¸Šè¿°çš„ API ä»¥å¤šç§æ–¹å¼å®ç°è¿™ä¸€ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨å¤„ç† Promise æ—¶ï¼Œæ›´æ–° state çš„å¤„ç†ç¨‹åºåº”è¯¥è¢« <code>action</code> åŒ…è£…èµ·æ¥ï¼Œæˆ–è€…è¢«æ ‡è®°ä¸º actionsï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title class_">Promise</span> çš„å†³è®®å¤„ç†ç¨‹åºæ˜¯æˆ‘ä»¬ä»¥å†…è”çš„æ–¹å¼å¤„ç†çš„ï¼Œä½†æ˜¯ä¼šåœ¨ä¸€å¼€å§‹çš„ action æ‰§è¡Œå®Œæˆä¹‹åè¿è¡Œï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ action å¯¹å®ƒä»¬è¿›è¡ŒåŒ…è£…ï¼š

<span class="hljs-keyword">import</span> &#123; action, makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Store</span> &#123;
    githubProjects = []
    state = <span class="hljs-string">&quot;pending&quot;</span> <span class="hljs-comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)
    &#125;

    <span class="hljs-title function_">fetchProjects</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = []
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;pending&quot;</span>
        <span class="hljs-title function_">fetchGithubProjectsSomehow</span>().<span class="hljs-title function_">then</span>(
            <span class="hljs-title function_">action</span>(<span class="hljs-string">&quot;fetchSuccess&quot;</span>, <span class="hljs-function"><span class="hljs-params">projects</span> =&gt;</span> &#123;
                <span class="hljs-keyword">const</span> filteredProjects = <span class="hljs-title function_">somePreprocessing</span>(projects)
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = filteredProjects
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;done&quot;</span>
            &#125;),
            <span class="hljs-title function_">action</span>(<span class="hljs-string">&quot;fetchError&quot;</span>, <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;error&quot;</span>
            &#125;)
        )
    &#125;
&#125;</code></pre></div>



<p>å¦‚æœ Promise çš„å¤„ç†å‡½æ•°æ˜¯ç±»çš„å­—æ®µï¼Œå®ƒä»¬å°†ç”± <code>makeAutoObservable</code> è‡ªåŠ¨åŒ…è£…ä¸º <code>action</code>ï¼š</p>
<div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Store</span> &#123;
    githubProjects = []
    state = <span class="hljs-string">&quot;pending&quot;</span> <span class="hljs-comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)
    &#125;

    <span class="hljs-title function_">fetchProjects</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = []
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;pending&quot;</span>
        <span class="hljs-title function_">fetchGithubProjectsSomehow</span>().<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">projectsFetchSuccess</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">projectsFetchFailure</span>)
    &#125;

    projectsFetchSuccess = <span class="hljs-function"><span class="hljs-params">projects</span> =&gt;</span> &#123;
        <span class="hljs-keyword">const</span> filteredProjects = <span class="hljs-title function_">somePreprocessing</span>(projects)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = filteredProjects
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;done&quot;</span>
    &#125;

    projectsFetchFailure = <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;error&quot;</span>
    &#125;
&#125;</code></pre></div>

<p><code>await</code> ä¹‹åçš„ä»»ä½•æ“ä½œéƒ½ä¸ä¸å…¶åŒåœ¨ä¸€ä¸ª tick ä¸­ï¼Œå› æ­¤å®ƒä»¬éœ€è¦ä½¿ç”¨ action åŒ…è£…ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>runInAction</code>ï¼š</p>
<div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; runInAction, makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Store</span> &#123;
    githubProjects = []
    state = <span class="hljs-string">&quot;pending&quot;</span> <span class="hljs-comment">// &quot;pending&quot;, &quot;done&quot; or &quot;error&quot;</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)
    &#125;

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchProjects</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = []
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;pending&quot;</span>
        <span class="hljs-keyword">try</span> &#123;
            <span class="hljs-keyword">const</span> projects = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchGithubProjectsSomehow</span>()
            <span class="hljs-keyword">const</span> filteredProjects = <span class="hljs-title function_">somePreprocessing</span>(projects)
            <span class="hljs-title function_">runInAction</span>(<span class="hljs-function">() =&gt;</span> &#123;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = filteredProjects
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;done&quot;</span>
            &#125;)
        &#125; <span class="hljs-keyword">catch</span> (e) &#123;
            <span class="hljs-title function_">runInAction</span>(<span class="hljs-function">() =&gt;</span> &#123;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;error&quot;</span>
            &#125;)
        &#125;
    &#125;
&#125;</code></pre></div>

<p>ä½¿ç”¨flow+generator</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; flow, makeAutoObservable, flowResult &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Store</span> &#123;
    githubProjects = []
    state = <span class="hljs-string">&quot;pending&quot;</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">fetchProjects</span>: flow
        &#125;)
    &#125;

    <span class="hljs-comment">// æ³¨æ„æ˜Ÿå·, è¿™æ˜¯ä¸€ä¸ª generator å‡½æ•°!</span>
    *<span class="hljs-title function_">fetchProjects</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = []
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;pending&quot;</span>
        <span class="hljs-keyword">try</span> &#123;
            <span class="hljs-comment">// Yield ä»£æ›¿ await.</span>
            <span class="hljs-keyword">const</span> projects = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">fetchGithubProjectsSomehow</span>()
            <span class="hljs-keyword">const</span> filteredProjects = <span class="hljs-title function_">somePreprocessing</span>(projects)
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;done&quot;</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">githubProjects</span> = filteredProjects
        &#125; <span class="hljs-keyword">catch</span> (error) &#123;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">&quot;error&quot;</span>
        &#125;
    &#125;
&#125;

<span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Store</span>()
<span class="hljs-keyword">const</span> projects = <span class="hljs-keyword">await</span> <span class="hljs-title function_">flowResult</span>(store.<span class="hljs-title function_">fetchProjects</span>())</code></pre></div>

<h2 id="Computers"><a href="#Computers" class="headerlink" title="Computers"></a>Computers</h2><p>ä½¿ç”¨ï¼š</p>
<ul>
<li><code>computed</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li>
<li><code>computed(options)</code> <em>ï¼ˆæ³¨è§£ï¼‰</em></li>
<li><code>computed(fn, options?)</code></li>
</ul>
<p>è®¡ç®—å€¼å¯ä»¥ç”¨æ¥ä»å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ä¸­æ´¾ç”Ÿä¿¡æ¯ã€‚ è®¡ç®—å€¼é‡‡ç”¨æƒ°æ€§æ±‚å€¼ï¼Œä¼šç¼“å­˜å…¶è¾“å‡ºï¼Œå¹¶ä¸”åªæœ‰å½“å…¶ä¾èµ–çš„å¯è§‚å¯Ÿå¯¹è±¡è¢«æ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®—ã€‚ å®ƒä»¬åœ¨ä¸è¢«ä»»ä½•å€¼è§‚å¯Ÿæ—¶ä¼šè¢«æš‚æ—¶åœç”¨ã€‚</p>
<p>è®¡ç®—å€¼å¯ä»¥é€šè¿‡åœ¨ JavaScript <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get">getters</a> ä¸Šæ·»åŠ  <code>computed</code> æ³¨è§£æ¥åˆ›å»ºã€‚ ä½¿ç”¨ <code>makeObservable</code> å°† getter å£°æ˜ä¸º computedã€‚æˆ–è€…å¦‚æœä½ å¸Œæœ›æ‰€æœ‰çš„ getters è¢«è‡ªåŠ¨å£°æ˜ä¸º <code>computed</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>makeAutoObservable</code>ï¼Œ<code>observable</code> æˆ–è€… <code>extendObservable</code></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeObservable, observable, computed, autorun &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderLine</span> &#123;
    price = <span class="hljs-number">0</span>
    amount = <span class="hljs-number">1</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">price</span>) &#123;
        <span class="hljs-title function_">makeObservable</span>(<span class="hljs-variable language_">this</span>, &#123;
            <span class="hljs-attr">price</span>: observable,
            <span class="hljs-attr">amount</span>: observable,
            <span class="hljs-attr">total</span>: computed
        &#125;)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">price</span> = price
    &#125;

    <span class="hljs-keyword">get</span> <span class="hljs-title function_">total</span>() &#123;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Computing...&quot;</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">price</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span>
    &#125;
&#125;

<span class="hljs-keyword">const</span> order = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderLine</span>(<span class="hljs-number">0</span>)

<span class="hljs-keyword">const</span> stop = <span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Total: &quot;</span> + order.<span class="hljs-property">total</span>)
&#125;)
<span class="hljs-comment">// Computing...</span>
<span class="hljs-comment">// Total: 0</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(order.<span class="hljs-property">total</span>)
<span class="hljs-comment">// (ä¸ä¼šé‡æ–°è®¡ç®—!)</span>
<span class="hljs-comment">// 0</span>

order.<span class="hljs-property">amount</span> = <span class="hljs-number">5</span>
<span class="hljs-comment">// Computing...</span>
<span class="hljs-comment">// (æ— éœ€ autorun)</span>

order.<span class="hljs-property">price</span> = <span class="hljs-number">2</span>
<span class="hljs-comment">// Computing...</span>
<span class="hljs-comment">// Total: 10</span>

<span class="hljs-title function_">stop</span>()

order.<span class="hljs-property">price</span> = <span class="hljs-number">3</span>
<span class="hljs-comment">// è®¡ç®—å€¼å’Œ autorun éƒ½ä¸ä¼šè¢«é‡æ–°è®¡ç®—.</span></code></pre></div>

<p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœ <code>total</code> æ²¡æœ‰è¢«æ³¨è§£ï¼Œé‚£ä¹ˆ <code>autorun</code> ä¼šæŠŠå‰¯ä½œç”¨è¿è¡Œ 3 æ¬¡ï¼Œ å› ä¸ºå®ƒå°†ç›´æ¥ä¾èµ–äº <code>total</code> å’Œ <code>amount</code></p>
<p><img src="https://zh.mobx.js.org/assets/computed-example.png" srcset="/img/loading.gif" lazyload alt="computed graph"></p>
<p>ä¸Šå›¾æ˜¯ä¸ºä»¥ä¸Šç¤ºä¾‹åˆ›å»ºçš„ä¾èµ–å›¾ã€‚</p>
<h3 id="è§„åˆ™"><a href="#è§„åˆ™" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h3><p>ä½¿ç”¨è®¡ç®—å€¼æ—¶ï¼Œè¯·éµå¾ªä¸‹é¢çš„æœ€ä½³å®è·µï¼š</p>
<ol>
<li>å®ƒä»¬ä¸åº”è¯¥æœ‰å‰¯ä½œç”¨æˆ–è€…æ›´æ–°å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ã€‚</li>
<li>é¿å…åˆ›å»ºå’Œè¿”å›æ–°çš„å¯è§‚å¯Ÿå¯¹è±¡ã€‚</li>
<li>å®ƒä»¬ä¸åº”è¯¥ä¾èµ–éå¯è§‚å¯Ÿå¯¹è±¡çš„å€¼</li>
</ol>
<h2 id="ä½¿ç”¨-reactions-å¤„ç†å‰¯ä½œç”¨-ğŸš€"><a href="#ä½¿ç”¨-reactions-å¤„ç†å‰¯ä½œç”¨-ğŸš€" class="headerlink" title="ä½¿ç”¨ reactions å¤„ç†å‰¯ä½œç”¨ {ğŸš€}"></a>ä½¿ç”¨ reactions å¤„ç†å‰¯ä½œç”¨ {ğŸš€}</h2><p>ä¸ºäº†ç†è§£ MobXï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•åˆ›å»º reactionsã€‚ æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/reactions.html#autorun"><code>autorun</code></a> å·¥å…·å‡½æ•°ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/reactions.html#reaction"><code>reaction</code></a> å’Œ <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/reactions.html#when"><code>when</code></a></p>
<h3 id="Autorun"><a href="#Autorun" class="headerlink" title="Autorun"></a>Autorun</h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>autorun(effect: (reaction) =&gt; void)</code></li>
</ul>
<p><code>autorun</code> å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ¯å½“è¯¥å‡½æ•°æ‰€è§‚å¯Ÿçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒéƒ½åº”è¯¥è¿è¡Œã€‚ å½“ä½ è‡ªå·±åˆ›å»º <code>autorun</code> æ—¶ï¼Œå®ƒä¹Ÿä¼šè¿è¡Œä¸€æ¬¡ã€‚å®ƒä»…ä»…å¯¹å¯è§‚å¯ŸçŠ¶æ€çš„å˜åŒ–åšå‡ºå“åº”ï¼Œæ¯”å¦‚é‚£äº›ä½ ç”¨ <code>observable</code> æˆ–è€… <code>computed</code> æ³¨é‡Šçš„ã€‚</p>
<h3 id="tracking-å¦‚ä½•å·¥ä½œ"><a href="#tracking-å¦‚ä½•å·¥ä½œ" class="headerlink" title="tracking å¦‚ä½•å·¥ä½œ"></a>tracking å¦‚ä½•å·¥ä½œ</h3><p>Autorun é€šè¿‡åœ¨<em>å“åº”å¼ä¸Šä¸‹æ–‡</em>è¿è¡Œ <code>effect</code> æ¥å·¥ä½œã€‚åœ¨ç»™å®šçš„å‡½æ•°æ‰§è¡ŒæœŸé—´ï¼ŒMobX ä¼šæŒç»­è·Ÿè¸ªè¢« effect ç›´æ¥æˆ–é—´æ¥<em>è¯»å–</em>è¿‡çš„æ‰€æœ‰å¯è§‚å¯Ÿå¯¹è±¡å’Œè®¡ç®—å€¼ã€‚ ä¸€æ—¦å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼ŒMobX å°†æ”¶é›†å¹¶è®¢é˜…æ‰€æœ‰è¢«è¯»å–è¿‡çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå¹¶ç­‰å¾…å…¶ä¸­ä»»æ„ä¸€ä¸ªå†æ¬¡å‘ç”Ÿæ”¹å˜ã€‚ ä¸€æ—¦æœ‰æ”¹å˜å‘ç”Ÿï¼Œ<code>autorun</code> å°†ä¼šå†æ¬¡è§¦å‘ï¼Œé‡å¤æ•´ä¸ªè¿‡ç¨‹ã€‚</p>
<p><img src="https://zh.mobx.js.org/assets/autorun.png" srcset="/img/loading.gif" lazyload alt="autorun"></p>
<p>è¿™å°±æ˜¯ä¸‹é¢çš„ç¤ºä¾‹çš„å·¥ä½œæ–¹å¼ã€‚</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; makeAutoObservable, autorun &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;
    name
    energyLevel

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> = <span class="hljs-number">100</span>
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)
    &#125;

    <span class="hljs-title function_">reduceEnergy</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> -= <span class="hljs-number">10</span>
    &#125;

    <span class="hljs-keyword">get</span> <span class="hljs-title function_">isHungry</span>() &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> &lt; <span class="hljs-number">50</span>
    &#125;
&#125;

<span class="hljs-keyword">const</span> giraffe = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">&quot;Gary&quot;</span>)

<span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Energy level:&quot;</span>, giraffe.<span class="hljs-property">energyLevel</span>)
&#125;)

<span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;
    <span class="hljs-keyword">if</span> (giraffe.<span class="hljs-property">isHungry</span>) &#123;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Now I&#x27;m hungry!&quot;</span>)
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;I&#x27;m not hungry!&quot;</span>)
    &#125;
&#125;)

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Now let&#x27;s change state!&quot;</span>)
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;
    giraffe.<span class="hljs-title function_">reduceEnergy</span>()
&#125;</code></pre></div>

<p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºï¼š</p>
<div class="code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Energy</span> level: <span class="hljs-number">100</span>
<span class="hljs-attribute">I</span>&#x27;m not hungry!
<span class="hljs-attribute">Now</span> let&#x27;s change state!
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">90</span>
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">80</span>
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">70</span>
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">60</span>
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">50</span>
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">40</span>
<span class="hljs-attribute">Now</span> I&#x27;m hungry!
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">30</span>
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">20</span>
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">10</span>
<span class="hljs-attribute">Energy</span> level: <span class="hljs-number">0</span></code></pre></div>

<p>autorunä¼šæ¯”è¾ƒå‰åå€¼æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¸ä¼šæ‰§è¡Œï¼Œå½“å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ‰ä¼šé‡æ–°æ‰§è¡Œ</p>
<h3 id="Reaction"><a href="#Reaction" class="headerlink" title="Reaction"></a>Reaction</h3><p>ç”¨æ³•ï¼š</p>
<ul>
<li><code>reaction(() =&gt; value, (value, previousValue, reaction) =&gt; &#123; sideEffect &#125;, options?)</code>.</li>
</ul>
<p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯æŒ‡éœ€è¦ç›‘å¬é‚£ä¸ªstateçš„å˜åŒ–ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“æ•°æ®å˜åŒ–çš„æ—¶å€™éœ€è¦æ‰§è¡Œçš„å‡½æ•°ï¼Œreaction</p>
<p>å’Œautorunæ¯”è¾ƒï¼Œautorunæ˜¯é’ˆå¯¹æ‰€æœ‰çš„stateï¼Œreactionæ˜¯é’ˆå¯¹ç‰¹å®šçš„stateï¼Œè€Œä¸”reactionåœ¨åˆå§‹åŒ–ï¼Œä¸ä¼šæ‰§è¡Œï¼Œåªæœ‰åœ¨state</p>
<p>å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šæ‰§è¡Œ</p>
<p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œreaction åªä¼šåœ¨ <code>isHungry</code> å‘ç”Ÿæ”¹å˜æ—¶è¢«è§¦å‘ä¸€æ¬¡ã€‚ åœ¨ <em>effect</em> å‡½æ•°ä¸­ä½¿ç”¨çš„ <code>giraffe.energyLevel</code> çš„æ›´æ”¹ï¼Œå¹¶ä¸ä¼šè§¦å‘ <em>effect</em> å‡½æ•°ã€‚å¦‚æœä½ æƒ³è¦ <code>reaction</code> ä¹Ÿå¯¹è¿™ä¸ªå€¼çš„å˜åŒ–åšå‡ºååº”ï¼Œ ä½ éœ€è¦åœ¨ <em>data</em> å‡½æ•°ä¸­è®¿é—®å¹¶è¿”å›å®ƒã€‚</p>
<div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; makeAutoObservable, reaction &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;
    name
    energyLevel

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> = <span class="hljs-number">100</span>
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)
    &#125;

    <span class="hljs-title function_">reduceEnergy</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> -= <span class="hljs-number">10</span>
    &#125;

    <span class="hljs-keyword">get</span> <span class="hljs-title function_">isHungry</span>() &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">energyLevel</span> &lt; <span class="hljs-number">50</span>
    &#125;
&#125;

<span class="hljs-keyword">const</span> giraffe = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">&quot;Gary&quot;</span>)

<span class="hljs-title function_">reaction</span>(
    <span class="hljs-function">() =&gt;</span> giraffe.<span class="hljs-property">isHungry</span>,
    <span class="hljs-function"><span class="hljs-params">isHungry</span> =&gt;</span> &#123;
        <span class="hljs-keyword">if</span> (isHungry) &#123;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Now I&#x27;m hungry!&quot;</span>)
        &#125; <span class="hljs-keyword">else</span> &#123;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;I&#x27;m not hungry!&quot;</span>)
        &#125;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Energy level:&quot;</span>, giraffe.<span class="hljs-property">energyLevel</span>)
    &#125;
)

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Now let&#x27;s change state!&quot;</span>)
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;
    giraffe.<span class="hljs-title function_">reduceEnergy</span>()
&#125;</code></pre></div>

<p>è¾“å‡ºï¼š</p>
<div class="code-wrapper"><pre><code class="hljs pf">Now let&#x27;s change <span class="hljs-keyword">state</span>!
Now I&#x27;m hungry!
Energy level: <span class="hljs-number">40</span></code></pre></div>

<h3 id="When"><a href="#When" class="headerlink" title="When"></a>When</h3><p>ä½¿ç”¨ï¼š</p>
<ul>
<li><code>when(predicate: () =&gt; boolean, effect?: () =&gt; void, options?)</code></li>
<li><code>when(predicate: () =&gt; boolean, options?): Promise</code></li>
</ul>
<p><code>when</code> ä¼šè§‚å¯Ÿå¹¶è¿è¡Œç»™å®šçš„ <em>predicate</em> å‡½æ•°ï¼Œç›´åˆ°å…¶è¿”å› <code>true</code>ã€‚ ä¸€æ—¦ predicate è¿”å›äº† trueï¼Œç»™å®šçš„ <em>effect</em> å‡½æ•°å°±ä¼šæ‰§è¡Œå¹¶ä¸”è‡ªåŠ¨æ‰§è¡Œå™¨å‡½æ•°å°†ä¼šè¢«æ¸…ç†æ‰ã€‚</p>
<p>å¦‚æœä½ æ²¡æœ‰ä¼ å…¥ <code>effect</code> å‡½æ•°ï¼Œ<code>when</code> å‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code> ç±»å‹çš„ disposerï¼Œå¹¶å…è®¸ä½ æ‰‹åŠ¨å–æ¶ˆ</p>
<p><code>when</code> å¯¹äºä»¥å“åº”å¼çš„æ–¹å¼å°†å€¼æ¸…ç†æˆ–å–æ¶ˆæ‰ååˆ†æœ‰ç”¨ã€‚ ä¾‹å¦‚ï¼š</p>
<div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; when, makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyResource</span> &#123;
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>, &#123; <span class="hljs-attr">dispose</span>: <span class="hljs-literal">false</span> &#125;)
        <span class="hljs-title function_">when</span>(
            <span class="hljs-comment">// Once...</span>
            <span class="hljs-function">() =&gt;</span> !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVisible</span>,
            <span class="hljs-comment">// ... then.</span>
            <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">dispose</span>()
        )
    &#125;

    <span class="hljs-keyword">get</span> <span class="hljs-title function_">isVisible</span>() &#123;
        <span class="hljs-comment">// è¡¨ç¤ºæ­¤é¡¹ç›®æ˜¯å¦å¯è§.</span>
    &#125;

    <span class="hljs-title function_">dispose</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-comment">// æ¸…ç†ä¸€äº›èµ„æº.</span>
    &#125;
&#125;</code></pre></div>

<p>ä¸€æ—¦ <code>isVisible</code> å˜æˆ <code>false</code>ï¼Œ<code>dispose</code> æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼Œ å¹¶å¯¹ <code>MyResource</code> åšä¸€äº›æ¸…ç†æ“ä½œ</p>
<h3 id="await-when"><a href="#await-when" class="headerlink" title="await when(...)"></a><code>await when(...)</code></h3><p>å¦‚æœä½ æ²¡æœ‰æä¾› <code>effect</code> å‡½æ•°ï¼Œ<code>when</code> å°†ä¼šè¿”å›ä¸€ä¸ª <code>Promise</code>ã€‚è¿™æ ·ä¼šè·Ÿ <code>async / await</code> å¾ˆå¥½åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œè®©ä½ å¯ä»¥ç­‰å¾…å¯è§‚å¯Ÿå¯¹è±¡ä¸­çš„å˜åŒ–ã€‚</p>
<div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">when</span>(<span class="hljs-function">() =&gt;</span> that.<span class="hljs-property">isVisible</span>)
    <span class="hljs-comment">// etc...</span>
&#125;</code></pre></div>

<p>å¦‚æœè¦æå‰å–æ¶ˆ <code>when</code>ï¼Œå¯ä»¥å¯¹å®ƒè¿”å›çš„ Promise è°ƒç”¨ <code>.cancel()</code> å‡½æ•°ã€‚</p>
<h4 id="è§„åˆ™-1"><a href="#è§„åˆ™-1" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h4><p>è¿™é‡Œæ˜¯ä¸€äº› reactive context éœ€è¦éµå®ˆçš„è§„åˆ™ï¼š</p>
<ol>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå¯è§‚å¯Ÿå¯¹è±¡å‘ç”Ÿäº†æ”¹å˜ï¼Œå—å…¶å½±å“çš„ reactions ä¼šç«‹å³ï¼ˆåŒæ­¥ï¼‰è¿è¡Œã€‚ç„¶è€Œï¼Œå®ƒä»¬ç›´åˆ°å½“å‰æœ€å¤–å±‚çš„ (trans)action æ‰§è¡Œç»“æŸåæ‰ä¼šè¿è¡Œã€‚</li>
<li>autorun åªä¼šè·Ÿè¸ªç»™å®šå‡½æ•°åœ¨åŒæ­¥æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œä¸ä¼šè·Ÿè¸ªå¼‚æ­¥å‘ç”Ÿçš„å˜åŒ–ã€‚</li>
<li>autorun ä¸ä¼šè·Ÿè¸ªè¢«å…¶è°ƒç”¨çš„ action æ‰€è¯»å–çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå› ä¸º action å§‹ç»ˆ<em>ä¸ä¼šè¢«è¿½è¸ª</em>ã€‚</li>
</ol>
<h3 id="Always-dispose-of-reactions"><a href="#Always-dispose-of-reactions" class="headerlink" title="Always dispose of reactions"></a>Always dispose of reactions</h3><p>ä¼ é€’ç»™ <code>autorun</code>ï¼Œ<code>reaction</code> å’Œ <code>when</code> çš„å‡½æ•°åªæœ‰åœ¨å®ƒä»¬è§‚å¯Ÿçš„æ‰€æœ‰å¯¹è±¡éƒ½è¢« GC ä¹‹åæ‰ä¼šè¢« GCã€‚åŸåˆ™ä¸Šï¼Œå®ƒä»¬ä¸€ç›´ç­‰å¾…å¯è§‚å¯Ÿå¯¹è±¡å‘ç”Ÿæ–°çš„å˜åŒ–ã€‚ ä¸ºäº†é˜»æ­¢ reactions æ°¸è¿œåœ°ç­‰å¾…ä¸‹å»ï¼Œå®ƒä»¬æ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ª disposer å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥ç”¨æ¥åœæ­¢æ‰§è¡Œå¹¶ä¸”å–æ¶ˆè®¢é˜…æ‰€ä½¿ç”¨çš„ä»»ä½•å¯è§‚å¯Ÿå¯¹è±¡</p>
<div class="code-wrapper"><pre><code class="hljs arcade">const counter = observable(&#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;)

<span class="hljs-comment">// åˆå§‹åŒ–ä¸€ä¸ª autorun å¹¶ä¸”æ‰“å° 0.</span>
const disposer = autorun(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;
    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(counter.<span class="hljs-built_in">count</span>)
&#125;)

<span class="hljs-comment">// æ‰“å°: 1</span>
counter.<span class="hljs-built_in">count</span>++

<span class="hljs-comment">// åœæ­¢ autorun.</span>
disposer()

<span class="hljs-comment">// ä¸ä¼šæ‰“å°æ¶ˆæ¯.</span>
counter.<span class="hljs-built_in">count</span>++</code></pre></div>

<p>æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ï¼Œä¸€æ—¦ä¸å†éœ€è¦è¿™äº›æ–¹æ³•ä¸­çš„å‰¯ä½œç”¨æ—¶ï¼Œè¯·åŠ¡å¿…è°ƒç”¨å®ƒä»¬æ‰€è¿”å›çš„ disposer å‡½æ•°ã€‚ å¦åˆ™å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p>
<p><code>reaction</code> å’Œ <code>autorun</code> ä¸­ effect å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° <code>reaction</code> ä¹Ÿå¯ä»¥è¢«ç”¨æ¥æå‰æŠŠ reaction æ¸…ç†æ‰ï¼ˆé€šè¿‡è°ƒç”¨ <code>reaction.dispose()</code>ï¼‰ã€‚</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vat</span> &#123;
    value = <span class="hljs-number">1.2</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)
    &#125;
&#125;

<span class="hljs-keyword">const</span> vat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vat</span>()

<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderLine</span> &#123;
    price = <span class="hljs-number">10</span>
    amount = <span class="hljs-number">1</span>
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)

        <span class="hljs-comment">// è¿™ä¸ª autorun å°†ä¼šå’Œæœ¬ OrderLine å®ä¾‹ä¸€èµ·è¿›è¡Œ GC,</span>
        <span class="hljs-comment">// å› ä¸ºå®ƒåªä½¿ç”¨äº†æ¥è‡ª `this` çš„å¯è§‚å¯Ÿå¯¹è±¡.</span>
        <span class="hljs-comment">// æ‰€ä»¥ä¸ä¸€å®šéè¦åœ¨åˆ é™¤ OrderLine å®ä¾‹åç«‹åˆ»æŠŠå®ƒæ¸…ç†æ‰ã€‚</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">disposer1</span> = <span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;
            <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">price</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span>)
        &#125;)

        <span class="hljs-comment">// è¿™ä¸ª autorun å°†ä¸ä¼šå’Œæœ¬ OrderLine å®ä¾‹ä¸€èµ·è¿›è¡Œ GC,</span>
        <span class="hljs-comment">// å› ä¸º vat ä¿å­˜äº†å¯¹è¿™ä¸ª autorun çš„å¼•ç”¨ç”¨äºé€šçŸ¥æ”¹å˜,</span>
        <span class="hljs-comment">// è¿™æ ·åè¿‡æ¥åˆä¼šæŠŠ &#x27;this&#x27; ä¿å­˜åœ¨ä½œç”¨åŸŸä¸­ã€‚</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">disposer2</span> = <span class="hljs-title function_">autorun</span>(<span class="hljs-function">() =&gt;</span> &#123;
            <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">price</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span> * vat.<span class="hljs-property">value</span>)
        &#125;)
    &#125;

    <span class="hljs-title function_">dispose</span>(<span class="hljs-params"></span>) &#123;
        <span class="hljs-comment">// æ‰€ä»¥, ä¸ºäº†é¿å…å†…å­˜é—®é¢˜, å½“ä¸å†éœ€è¦ reactions ä¹‹å</span>
        <span class="hljs-comment">// åŠ¡å¿…è¦è°ƒç”¨ disposers.</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">disposer1</span>()
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">disposer2</span>()
    &#125;
&#125;</code></pre></div>

<h2 id="è°¨æ…åœ°ä½¿ç”¨-reactionsï¼"><a href="#è°¨æ…åœ°ä½¿ç”¨-reactionsï¼" class="headerlink" title="è°¨æ…åœ°ä½¿ç”¨ reactionsï¼"></a>è°¨æ…åœ°ä½¿ç”¨ reactionsï¼</h2><p>å°±åƒä¸Šé¢å·²ç»è¯´è¿‡çš„é‚£æ ·ï¼Œä½ ä¸ä¼šç»å¸¸åˆ›å»º reactionsã€‚ å¾ˆæœ‰å¯èƒ½ä½ çš„åº”ç”¨ç¨‹åºä¸ä¼šç›´æ¥ä½¿ç”¨è¿™äº› API ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œè€Œåªä¼šé€šè¿‡æ¯”å¦‚ä½¿ç”¨ mobx-react ç»‘å®šä¸­çš„ <code>observer</code> è¿™æ ·é—´æ¥çš„æ–¹å¼åˆ›å»ºå‡º reactionã€‚</p>
<p>åœ¨ä½ åˆ›å»º reaction ä¹‹å‰ï¼Œæœ€å¥½æ£€æŸ¥ä¸€ä¸‹å®ƒæ˜¯å¦ç¬¦åˆä¸‹é¢å‡ æ¡åŸåˆ™ï¼š</p>
<ol>
<li><strong>åªæœ‰åœ¨å¼•èµ·å‰¯ä½œç”¨çš„ä¸€æ–¹ä¸å‰¯ä½œç”¨ä¹‹é—´æ²¡æœ‰ç›´æ¥å…³ç³»çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨ reaction</strong>ï¼š å¦‚æœä¸€ä¸ªå‰¯ä½œç”¨ä¼šä¸ºäº†å“åº”å¾ˆå°çš„ä¸€ç»„ events æˆ– actions è€Œæ‰§è¡Œï¼Œé‚£ä¹ˆç›´æ¥ä»é‚£äº›ç‰¹å®šçš„ action ä¸­è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨é€šå¸¸ä¼šæ›´å®¹æ˜“ç†è§£ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŒ‰ä¸‹è¡¨å•æäº¤æŒ‰é’®ä¼šå¯¼è‡´ä¸€ä¸ª POST ç½‘ç»œè¯·æ±‚çš„å‘é€ï¼Œé‚£ä¹ˆä¸ºäº†å“åº” <code>onclick</code> äº‹ä»¶ï¼Œç›´æ¥è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨å°±ä¼šæ¯”é€šè¿‡ reaction é—´æ¥è§¦å‘æ›´å®¹æ˜“ç†è§£ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœä½ å¯¹è¡¨å•çŠ¶æ€çš„ä¸€åˆ‡ä¿®æ”¹æœ€åéƒ½ä¼šè¢«è‡ªåŠ¨å­˜å‚¨åˆ° localStorageï¼Œé‚£ä¹ˆä½¿ç”¨ä¸€ä¸ª reaction å¯èƒ½å°±ä¼šå¾ˆæœ‰å¸®åŠ©ï¼Œè¿™æ ·ä½ å°±ä¸ç”¨åœ¨æ¯ä¸ªç‹¬ç«‹çš„ <code>onChange</code> äº‹ä»¶ä¸­è§¦å‘è¿™ä¸ªå‰¯ä½œç”¨äº†ã€‚</li>
<li><strong>reactions ä¸åº”è¯¥æ›´æ–°å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡</strong>ï¼šè¿™ä¸ª reaction æ˜¯å¦ä¼šä¿®æ”¹å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ï¼Ÿå¦‚æœç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œé‚£ä¹ˆä½ ä¸€èˆ¬åº”è¯¥æŠŠä½ æƒ³è¦æ›´æ–°çš„å¯è§‚å¯Ÿå¯¹è±¡æ³¨è§£ä¸º <a target="_blank" rel="noopener" href="https://zh.mobx.js.org/computeds.html"><code>computed</code></a> å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå¾…åŠäº‹é¡¹çš„é›†åˆ <code>todos</code> å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆè¯·ä¸è¦ä½¿ç”¨ reaction æ¥è®¡ç®—å‰©ä½™å¾…åŠ <code>remainingTodos</code> çš„æ•°é‡ï¼Œè€Œè¦æŠŠ <code>remainingTodos</code> æ³¨è§£ä¸ºè®¡ç®—å€¼ã€‚è¿™å°†ä½¿å¾—ä»£ç æ›´å®¹æ˜“ç†è§£å’Œè°ƒè¯•ã€‚reaction ä¸åº”è¯¥è®¡ç®—ç”Ÿæˆæ–°çš„æ•°æ®ï¼Œè€Œåªåº”è¯¥è§¦å‘å‰¯ä½œç”¨ã€‚</li>
<li><strong>reactions åº”è¯¥æ˜¯ç‹¬ç«‹çš„</strong>ï¼šä½ çš„ä»£ç æ˜¯å¦ä¾èµ–å…¶ä»–å¿…é¡»é¦–å…ˆè¿è¡Œçš„ reactionï¼Ÿå¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œä½ å¯èƒ½è¿åäº†ç¬¬ä¸€æ¡è§„åˆ™ï¼Œ ä½ å¯ä»¥é€‰æ‹©å°†ä½ éœ€è¦åˆ›å»ºçš„æ–° reaction åˆå¹¶åˆ°å®ƒæ‰€ä¾èµ– reaction ä¸­ã€‚MobX å¹¶ä¸èƒ½ä¿è¯ reaction çš„æ‰§è¡Œé¡ºåºã€‚</li>
</ol>
<p>æœ‰äº›å®è·µå¹¶ä¸ç¬¦åˆä¸Šè¿°åŸåˆ™ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä»¬æ˜¯<em>åŸåˆ™</em>ï¼Œè€Œä¸æ˜¯<em>æ³•åˆ™</em>ã€‚ ä½†æ˜¯ï¼Œä¾‹å¤–æƒ…å†µå¾ˆå°‘è§ï¼Œåªæœ‰åœ¨ä¸‡ä¸å¾—å·²çš„æƒ…å†µä¸‹æ‰è¿åå®ƒä»¬ã€‚</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/react/" class="category-chain-item">react</a>
  
  
    <span>></span>
    
  <a href="/categories/react/mobx/" class="category-chain-item">mobx</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>mobxçš„ä½¿ç”¨</div>
      <div>http://example.com/2022/09/20/mobxçš„ä½¿ç”¨/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2022å¹´9æœˆ20æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/09/24/%E4%BB%80%E4%B9%88%E6%98%AFwebsocket/" title="ä»€ä¹ˆæ˜¯websocket">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ä»€ä¹ˆæ˜¯websocket</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/09/19/jest%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90/" title="jestå¸¸è§é—®é¢˜è§£æ">
                        <span class="hidden-mobile">jestå¸¸è§é—®é¢˜è§£æ</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
